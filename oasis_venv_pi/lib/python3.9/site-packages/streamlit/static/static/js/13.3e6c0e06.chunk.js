(window["webpackJsonpstreamlit-browser"]=window["webpackJsonpstreamlit-browser"]||[]).push([[13],{1040:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4;function k(t,e,n,r){var i,u;if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?k(u,i,n[i]):u[i]=n[i];else t[e]=n}function A(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function E(t){return t[t.length-1]}function M(t){return null==t||""===t?null:+t}function S(t){return function(e){return t*Math.exp(e)}}function C(t){return function(e){return Math.log(t*e)}}function O(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function D(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function F(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function T(t,e,n,r){var i=n(t[0]),a=n(E(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function N(t,e,n,r,i){var a=r(t[0]),o=r(E(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function j(t){return null!=t?a(t)?t:[t]:[]}function R(t){return"function"===typeof t}var P=Object.prototype.hasOwnProperty;function z(t,e){return P.call(t,e)}var B={};function L(t){return"[object Date]"===Object.prototype.toString.call(t)}function q(t){return"number"===typeof t}function I(t,e){for(var n="";--e>=0;)n+=t;return n}function U(t){return q(t)?t:L(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=j,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=j(t)).map(function(t,e){return null==t?null:(v.push(e),R(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=j(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)R(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return R(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return R(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return z(r,t)&&r[t]!==B}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===B&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=B),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===B||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=E(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=z,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=L,t.isFunction=R,t.isNumber=q,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?j(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):j(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=E(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=A(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;k(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?I(i,o)+a:"center"===r?I(i,~~(o/2))+a+I(i,Math.ceil(o/2)):a+I(i,o)},t.panLinear=function(t,e){return T(t,e,M,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return T(t,e,C(n),S(n))},t.panPow=function(t,e,n){return T(t,e,F(n),F(1/n))},t.panSymlog=function(t,e,n){return T(t,e,O(n),D(n))},t.peek=E,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=I,t.span=function(t){return t&&E(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||U,null==t||""===t?null:e(t)},t.toNumber=M,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=k,t.zero=d,t.zoomLinear=function(t,e,n){return N(t,e,n,M,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return N(t,e,n,C(r),S(r))},t.zoomPow=function(t,e,n,r){return N(t,e,n,F(r),F(1/r))},t.zoomSymlog=function(t,e,n,r){return N(t,e,n,O(r),D(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},1045:function(t,e,n){var r=n(19),i=n(1112);!function(t,e,n){"use strict";function a(t){var n=t||e.identity,r=[],i={};return r.add=function(t){var e=n(t);return i[e]||(i[e]=1,r.push(t)),r},r.remove=function(t){var e,a=n(t);return i[a]&&(i[a]=0,(e=r.indexOf(t))>=0&&r.splice(e,1)),r},r}function o(t,e){return u.apply(this,arguments)}function u(){return(u=i(r.mark(function t(e,n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.error(t.t0);case 8:case"end":return t.stop()}},t,null,[[0,5]])}))).apply(this,arguments)}var s=Symbol("vega_id"),l=1;function c(t){return t[s]}function f(t,e){return t[s]=e,t}function h(t){var e=t===Object(t)?t:{data:t};return c(e)?e:f(e,l++)}function d(t,e){for(var n in t)e[n]=t[n];return e}function p(t){return t&&t.constructor===v}function v(){var t=[],n=[],r=[],i=[],a=[],o=!1;return{constructor:v,insert:function(n){for(var r=e.array(n),i=0,a=r.length;i<a;++i)t.push(r[i]);return this},remove:function(t){for(var r=e.isFunction(t)?i:n,a=e.array(t),o=0,u=a.length;o<u;++o)r.push(a[o]);return this},modify:function(t,n,i){var o={field:n,value:e.constant(i)};return e.isFunction(t)?(o.filter=t,a.push(o)):(o.tuple=t,r.push(o)),this},encode:function(t,n){return e.isFunction(t)?a.push({filter:t,field:n}):r.push({tuple:t,field:n}),this},reflow:function(){return o=!0,this},pulse:function(e,u){var s,l,f,d,p,v,g={},m={};for(s=0,l=u.length;s<l;++s)g[c(u[s])]=1;for(s=0,l=n.length;s<l;++s)g[c(p=n[s])]=-1;for(s=0,l=i.length;s<l;++s)d=i[s],u.forEach(function(t){d(t)&&(g[c(t)]=-1)});for(s=0,l=t.length;s<l;++s)v=c(p=t[s]),g[v]?g[v]=1:e.add.push(h(t[s]));for(s=0,l=u.length;s<l;++s)p=u[s],g[c(p)]<0&&e.rem.push(p);function y(t,n,r){r?t[n]=r(t):e.encode=n,o||(m[c(t)]=t)}for(s=0,l=r.length;s<l;++s)p=(f=r[s]).tuple,d=f.field,(v=g[c(p)])>0&&(y(p,d,f.value),e.modifies(d));for(s=0,l=a.length;s<l;++s)f=a[s],d=f.filter,u.forEach(function(t){d(t)&&g[c(t)]>0&&y(t,f.field,f.value)}),e.modifies(f.field);if(o)e.mod=n.length||i.length?u.filter(function(t){return g[c(t)]>0}):u.slice();else for(v in m)e.mod.push(m[v]);return e}}}var g="_:mod:_";function m(){Object.defineProperty(this,g,{writable:!0,value:{}})}var y=m.prototype;y.set=function(t,n,r,i){var a=this,o=a[t],u=a[g];return null!=n&&n>=0?(o[n]!==r||i)&&(o[n]=r,u[n+":"+t]=-1,u[t]=-1):(o!==r||i)&&(a[t]=r,u[t]=e.isArray(r)?1+r.length:-1),a},y.modified=function(t,n){var r,i=this[g];if(!arguments.length){for(r in i)if(i[r])return!0;return!1}if(e.isArray(t)){for(r=0;r<t.length;++r)if(i[t[r]])return!0;return!1}return null!=n&&n>=0?n+1<i[t]||!!i[n+":"+t]:!!i[t]},y.clear=function(){return this[g]={},this};var b=0,x=new m;function _(t,e,n,r){this.id=++b,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}var w=_.prototype;function k(t){return function(e){var n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}w.targets=function(){return this._targets||(this._targets=a(e.id))},w.set=function(t){return this.value!==t?(this.value=t,1):0},w.skip=k(1),w.modified=k(2),w.parameters=function(t,n,r){n=!1!==n;var i,a,o,u,s=this,l=s._argval=s._argval||new m,c=s._argops=s._argops||[],f=[];function h(t,e,r){r instanceof _?(r!==s&&(n&&r.targets().add(s),f.push(r)),c.push({op:r,name:t,index:e})):l.set(t,e,r)}for(i in t)if(a=t[i],"pulse"===i)e.array(a).forEach(function(t){t instanceof _?t!==s&&(t.targets().add(s),f.push(t)):e.error("Pulse parameters must be operator instances.")}),s.source=a;else if(e.isArray(a))for(l.set(i,-1,Array(o=a.length)),u=0;u<o;++u)h(i,u,a[u]);else h(i,-1,a);return this.marshall().clear(),r&&(c.initonly=!0),f},w.marshall=function(t){var e,n,r,i,a,o=this._argval||x,u=this._argops;if(u){for(n=0,r=u.length;n<r;++n)a=(i=(e=u[n]).op).modified()&&i.stamp===t,o.set(e.name,e.index,i.value,a);if(u.initonly){for(n=0;n<r;++n)(e=u[n]).op.targets().remove(this);this._argops=null,this._update=null}}return o},w.evaluate=function(t){var e=this._update;if(e){var n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},w.run=function(t){return t.stamp<this.stamp?t.StopPropagation:(this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t);var e};var A=0;function E(t,e,n){this.id=++A,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function M(t,e,n){return new E(t,e,n)}var S=E.prototype;S._filter=e.truthy,S._apply=e.identity,S.targets=function(){return this._targets||(this._targets=a(e.id))},S.consume=function(t){return arguments.length?(this._consume=!!t,this):!!this._consume},S.receive=function(t){if(this._filter(t)){for(var e=this.value=this._apply(t),n=this._targets,r=n?n.length:0,i=0;i<r;++i)n[i].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},S.filter=function(t){var e=M(t);return this.targets().add(e),e},S.apply=function(t){var e=M(null,t);return this.targets().add(e),e},S.merge=function(){var t=M();this.targets().add(t);for(var e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},S.throttle=function(t){var e=-1;return this.filter(function(){var n=Date.now();return n-e>t?(e=n,1):0})},S.debounce=function(t){var n=M();return this.targets().add(M(null,null,e.debounce(t,function(t){var e=t.dataflow;n.receive(t),e&&e.run&&e.run()}))),n},S.between=function(t,e){var n=!1;return t.targets().add(M(null,null,function(){n=!0})),e.targets().add(M(null,null,function(){n=!1})),this.filter(function(){return n})};var C=n.read;function O(){return(O=i(r.mark(function t(e,i){var a,o,u;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=this,o=0,t.prev=2,t.next=5,a.loader().load(e,{context:"dataflow",response:n.responseType(i&&i.type)});case 5:u=t.sent;try{u=C(u,i)}catch(r){o=-2,a.warn("Data ingestion failed",e,r)}t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),o=-1,a.warn("Loading failed",e,t.t0);case 13:return t.abrupt("return",{data:u,status:o});case 14:case"end":return t.stop()}},t,this,[[2,9]])}))).apply(this,arguments)}function D(){return(D=i(r.mark(function t(n,i,a){var o,u,s;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(u=(o=this)._pending||F(o)).requests+=1,t.next=4,o.request(i,a);case 4:return s=t.sent,o.pulse(n,o.changeset().remove(e.truthy).insert(s.data||[])),u.done(),t.abrupt("return",s);case 8:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function F(t){var e,n=new Promise(function(t){e=t});return n.requests=0,n.done=function(){0===--n.requests&&(t._pending=null,e(t))},t._pending=n}var T={skip:!0};function N(t,n,r,i,a,o){var u,s,l=e.extend({},o,T);e.isFunction(r)||(r=e.constant(r)),void 0===i?u=function(e){return t.touch(r(e))}:e.isFunction(i)?(s=new _(null,i,a,!1),u=function(e){s.evaluate(e);var n=r(e),i=s.value;p(i)?t.pulse(n,i,o):t.update(n,i,l)}):u=function(e){return t.update(r(e),i,l)},n.apply(u)}function j(t,n,r,i,a,o){if(void 0===i)n.targets().add(r);else{var u=o||{},s=new _(null,function(t,n){return n=e.isFunction(n)?n:e.constant(n),t?function(e,r){var i=n(e,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:n}(r,i),a,!1);s.modified(u.force),s.rank=n.rank,n.targets().add(s),r&&(s.skip(!0),s.value=r.value,s.targets().add(r),t.connect(r,[s]))}}var R={};function P(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}var z=P.prototype;function B(t,e){return t?function(n,r){return t(n,r)&&e(n,r)}:e}function L(t,n){var r=[];return e.visitArray(t,n,function(t){r.push(t)}),r}function q(t,e){var n={};return t.visit(e,function(t){n[c(t)]=1}),function(t){return n[c(t)]?null:t}}function I(t,e,n,r){var i,a,o,u,s,l=this,c=0;for(this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n,o=0,u=n.length;o<u;++o)if((i=n[o]).stamp===e){if(i.fields)for(s in a=l.fields||(l.fields={}),i.fields)a[s]=1;i.changed(l.ADD)&&(c|=l.ADD),i.changed(l.REM)&&(c|=l.REM),i.changed(l.MOD)&&(c|=l.MOD)}this.changes=c}z.StopPropagation=R,z.ADD=1,z.REM=2,z.MOD=4,z.ADD_REM=3,z.ADD_MOD=5,z.ALL=7,z.REFLOW=8,z.SOURCE=16,z.NO_SOURCE=32,z.NO_FIELDS=64,z.fork=function(t){return new P(this.dataflow).init(this,t)},z.clone=function(){var t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},z.addAll=function(){var t=this;return this.source&&this.source.length!==this.add.length?((t=new P(this.dataflow).init(this)).add=t.source,t):t},z.init=function(t,e){var n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source),n},z.runAfter=function(t){this.dataflow.runAfter(t)},z.changed=function(t){var e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},z.reflow=function(t){if(t)return this.fork(7).reflow();var e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,q(this,1))),this},z.modifies=function(t){var n=this.fields||(this.fields={});return e.isArray(t)?t.forEach(function(t){return n[t]=!0}):n[t]=!0,this},z.modified=function(t,n){var r=this.fields;return!(!n&&!this.mod.length||!r)&&(arguments.length?e.isArray(t)?t.some(function(t){return r[t]}):r[t]:!!r)},z.filter=function(t,e){var n=this;return 1&t&&(n.addF=B(n.addF,e)),2&t&&(n.remF=B(n.remF,e)),4&t&&(n.modF=B(n.modF,e)),16&t&&(n.srcF=B(n.srcF,e)),n},z.materialize=function(t){var e=this;return 1&(t=t||7)&&e.addF&&(e.add=L(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=L(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=L(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},z.visit=function(t,n){var r,i,a=this,o=n;return 16&t?(e.visitArray(a.source,a.srcF,o),a):(1&t&&e.visitArray(a.add,a.addF,o),2&t&&e.visitArray(a.rem,a.remF,o),4&t&&e.visitArray(a.mod,a.modF,o),8&t&&(r=a.source)&&((i=a.add.length+a.mod.length)===r.length||(i?e.visitArray(r,q(a,5),o):e.visitArray(r,a.srcF,o))),a)};var U=e.inherits(I,P);function W(){return(W=i(r.mark(function t(n,i,u){var s,l,c,f,h,d,p,v,g,m,y;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l=(s=this).logLevel(),c=[],!s._pulse){t.next=3;break}return t.abrupt("return",V(s));case 3:if(!s._pending){t.next=6;break}return t.next=6,s._pending;case 6:if(!i){t.next=9;break}return t.next=9,o(s,i);case 9:if(s._touched.length){t.next=12;break}return s.info("Dataflow invoked, but nothing to do."),t.abrupt("return",s);case 12:f=++s._clock,h=0,s._pulse=new P(s,f,n),l>=e.Info&&(v=Date.now(),s.debug("-- START PROPAGATION ("+f+") -----")),s._touched.forEach(function(t){return s._enqueue(t,!0)}),s._touched=a(e.id),t.prev=17;case 18:if(!(s._heap.size()>0)){t.next=36;break}if((d=s._heap.pop()).rank===d.qrank){t.next=23;break}return s._enqueue(d,!0),t.abrupt("continue",18);case 23:if(!(p=d.run(s._getPulse(d,n))).then){t.next=30;break}return t.next=27,p;case 27:p=t.sent,t.next=31;break;case 30:p.async&&(c.push(p.async),p=R);case 31:l>=e.Debug&&s.debug(d.id,p===R?"STOP":p,d),p!==R&&d._targets&&d._targets.forEach(function(t){return s._enqueue(t)}),++h,t.next=18;break;case 36:t.next=42;break;case 38:t.prev=38,t.t0=t.catch(17),s._heap.clear(),g=t.t0;case 42:if(s._input={},s._pulse=null,l>=e.Info&&(v=Date.now()-v,s.info("> Pulse "+f+": "+h+" operators; "+v+"ms")),g&&(s._postrun=[],s.error(g)),!s._postrun.length){t.next=56;break}m=s._postrun.sort(function(t,e){return e.priority-t.priority}),s._postrun=[],y=0;case 50:if(!(y<m.length)){t.next=56;break}return t.next=53,o(s,m[y].callback);case 53:++y,t.next=50;break;case 56:if(!u){t.next=59;break}return t.next=59,o(s,u);case 59:return c.length&&Promise.all(c).then(function(t){return s.runAsync(null,function(){t.forEach(function(t){try{t(s)}catch(e){s.error(e)}})})}),t.abrupt("return",s);case 61:case"end":return t.stop()}},t,this,[[17,38]])}))).apply(this,arguments)}function H(){return(H=i(r.mark(function t(e,n,i){var a,o=this;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._running){t.next=5;break}return t.next=3,this._running;case 3:t.next=0;break;case 5:return a=function(){return o._running=null},(this._running=this.evaluate(e,n,i)).then(a,a),t.abrupt("return",this._running);case 8:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function V(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}U.fork=function(t){var e=new P(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,function(t){return e.add.push(t)}),t&e.REM&&this.visit(e.REM,function(t){return e.rem.push(t)}),t&e.MOD&&this.visit(e.MOD,function(t){return e.mod.push(t)})),e},U.changed=function(t){return this.changes&t},U.modified=function(t){var n=this,r=n.fields;return r&&n.changes&n.MOD?e.isArray(t)?t.some(function(t){return r[t]}):r[t]:0},U.filter=function(){e.error("MultiPulse does not support filtering.")},U.materialize=function(){e.error("MultiPulse does not support materialization.")},U.visit=function(t,e){var n=this,r=n.pulses,i=r.length,a=0;if(t&n.SOURCE)for(;a<i;++a)r[a].visit(t,e);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(t,e);return n};var G={skip:!1,force:!1};function $(t){var e=[];return{clear:function(){return e=[]},size:function(){return e.length},peek:function(){return e[0]},push:function(n){return e.push(n),Y(e,0,e.length-1,t)},pop:function(){var n,r=e.pop();return e.length?(n=e[0],e[0]=r,function(t,e,n){for(var r,i=e,a=t.length,o=t[e],u=1+(e<<1);u<a;)(r=u+1)<a&&n(t[u],t[r])>=0&&(u=r),t[e]=t[u],u=1+((e=u)<<1);t[e]=o,Y(t,i,e,n)}(e,0,t)):n=r,n}}}function Y(t,e,n,r){var i,a,o;for(i=t[n];n>e&&r(i,a=t[o=n-1>>1])<0;)t[n]=a,n=o;return t[n]=i}function X(){this.logger(e.logger()),this.logLevel(e.Error),this._clock=0,this._rank=0;try{this._loader=n.loader()}catch(t){}this._touched=a(e.id),this._input={},this._pulse=null,this._heap=$(function(t,e){return t.qrank-e.qrank}),this._postrun=[]}var J=X.prototype;function Q(t){return function(){return this._log[t].apply(this,arguments)}}function Z(t,e){_.call(this,t,null,e)}J.stamp=function(){return this._clock},J.loader=function(t){return arguments.length?(this._loader=t,this):this._loader},J.cleanThreshold=1e4,J.add=function(t,n,r,i){var a,o=1;return t instanceof _?a=t:t&&t.prototype instanceof _?a=new t:e.isFunction(t)?a=new _(null,t):(o=0,a=new _(t,n)),this.rank(a),o&&(i=r,r=n),r&&this.connect(a,a.parameters(r,i)),this.touch(a),a},J.connect=function(t,e){var n,r,i=t.rank;for(n=0,r=e.length;n<r;++n)if(i<e[n].rank)return void this.rerank(t)},J.rank=function(t){t.rank=++this._rank},J.rerank=function(t){for(var n,r,i,a=[t];a.length;)if(this.rank(n=a.pop()),r=n._targets)for(i=r.length;--i>=0;)a.push(n=r[i]),n===t&&e.error("Cycle detected in dataflow graph.")},J.pulse=function(t,e,n){this.touch(t,n||G);var r=new P(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},J.touch=function(t,e){var n=e||G;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},J.update=function(t,e,n){var r=n||G;return(t.set(e)||r.force)&&this.touch(t,r),this},J.changeset=v,J.ingest=function(t,e,n){return this.pulse(t,this.changeset().insert(C(e,n)))},J.parse=C,J.preload=function(t,e,n){return D.apply(this,arguments)},J.request=function(t,e){return O.apply(this,arguments)},J.events=function(t,n,r,i){for(var a,o=this,u=M(r,i),s=function(t){t.dataflow=o;try{u.receive(t)}catch(e){o.error(e)}finally{o.run()}},l=0,c=(a="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):e.array(t)).length;l<c;++l)a[l].addEventListener(n,s);return u},J.on=function(t,e,n,r,i){return(t instanceof _?j:N)(this,t,e,n,r,i),this},J.evaluate=function(t,e,n){return W.apply(this,arguments)},J.run=function(t,e,n){return this._pulse?V(this):(this.evaluate(t,e,n),this)},J.runAsync=function(t,e,n){return H.apply(this,arguments)},J.runAfter=function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},J._enqueue=function(t,e){var n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},J._getPulse=function(t,n){var r=t.source,i=this._clock;return r&&e.isArray(r)?new I(this,i,r.map(function(t){return t.pulse}),n):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==R&&(t.source=e.source),t)}(this._pulse,r&&r.pulse)},J.logger=function(t){return arguments.length?(this._log=t,this):this._log},J.error=Q("error"),J.warn=Q("warn"),J.info=Q("info"),J.debug=Q("debug"),J.logLevel=Q("level");var K=e.inherits(Z,_);K.run=function(t){var e,n=this;return t.stamp<this.stamp?t.StopPropagation:(this.skip()?this.skip(!1):e=this.evaluate(t),(e=e||t).then?e=e.then(function(t){return n.pulse=t}):e!==t.StopPropagation&&(this.pulse=e),e)},K.evaluate=function(t){var e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},K.transform=function(){};var tt={};function et(t){return t=t&&t.toLowerCase(),e.hasOwnProperty(tt,t)?tt[t]:null}t.Dataflow=X,t.EventStream=E,t.MultiPulse=I,t.Operator=_,t.Parameters=m,t.Pulse=P,t.Transform=Z,t.UniqueList=a,t.asyncCallback=o,t.changeset=v,t.definition=function(t){var e=et(t);return e&&e.Definition||null},t.derive=function(t){return d(t,h({}))},t.ingest=h,t.isChangeSet=p,t.isTuple=function(t){return!(!t||!c(t))},t.rederive=d,t.replace=function(t,e){return f(e,c(t))},t.stableCompare=function(t,e){return t?e?function(n,r){return t(n,r)||c(e(n))-c(e(r))}:function(e,n){return t(e,n)||c(e)-c(n)}:null},t.transform=et,t.transforms=tt,t.tupleid=c,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040),n(1562))},1053:function(t,e,n){var r=n(19),i=n(212),a=n(215);!function(t){"use strict";var e=r.mark(R),n=r.mark(B);function o(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function u(t){var e;return 1===t.length&&(e=t,t=function(t,n){return o(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}}var s=u(o),l=s.right,c=s.left;function f(t,e){var n=0;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(s=+s)>=s&&++n}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;null!=(v=e(v,++l,t))&&(v=+v)>=v&&++n}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n}function h(t){return 0|t.length}function d(t){return!(t>0)}function p(t){return"object"!==typeof t||"length"in t?t:Array.from(t)}function v(t,e){var n,r=0,i=0,a=0;if(void 0===e){var o=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;null!=f&&(f=+f)>=f&&(a+=(n=f-i)*(f-(i+=n/++r)))}}catch(b){u=!0,s=b}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}}else{var h=-1,d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value;null!=(y=e(y,++h,t))&&(y=+y)>=y&&(a+=(n=y-i)*(y-(i+=n/++r)))}}catch(b){p=!0,v=b}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}if(r>1)return a/(r-1)}function g(t,e){var n=v(t,e);return n?Math.sqrt(n):n}function m(t,e){var n,r;if(void 0===e){var i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;null!=l&&(void 0===n?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}}catch(m){a=!0,o=m}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var c=-1,f=!0,h=!1,d=void 0;try{for(var p,v=t[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=p.value;null!=(g=e(g,++c,t))&&(void 0===n?g>=g&&(n=r=g):(n>g&&(n=g),r<g&&(r=g)))}}catch(m){h=!0,d=m}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}}return[n,r]}function y(t){return t}function b(t,e,n,r){return function t(a,o){if(o>=r.length)return n(a);var u=new Map,s=r[o++],l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=a[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value,g=s(v,++l,a),m=u.get(g);m?m.push(v):u.set(g,[v])}}catch(S){f=!0,h=S}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}var y=!0,b=!1,x=void 0;try{for(var _,w=u[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var k=_.value,A=i(k,2),E=A[0],M=A[1];u.set(E,t(M,o))}}catch(S){b=!0,x=S}finally{try{y||null==w.return||w.return()}finally{if(b)throw x}}return e(u)}(t,0)}var x=Array.prototype.slice;function _(t){return function(){return t}}function w(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}var k=Math.sqrt(50),A=Math.sqrt(10),E=Math.sqrt(2);function M(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=k?10:a>=A?5:a>=E?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=k?10:a>=A?5:a>=E?2:1)}function S(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=k?i*=10:a>=A?i*=5:a>=E&&(i*=2),e<t?-i:i}function C(t){return Math.ceil(Math.log(f(t))/Math.LN2)+1}function O(){var t=y,e=m,n=C;function r(r){Array.isArray(r)||(r=Array.from(r));var i,a,o=r.length,u=new Array(o);for(i=0;i<o;++i)u[i]=t(r[i],i,r);var s=e(u),c=s[0],f=s[1],h=n(u,c,f);Array.isArray(h)||(h=S(c,f,h),h=w(Math.ceil(c/h)*h,f,h));for(var d=h.length;h[0]<=c;)h.shift(),--d;for(;h[d-1]>f;)h.pop(),--d;var p,v=new Array(d+1);for(i=0;i<=d;++i)(p=v[i]=[]).x0=i>0?h[i-1]:c,p.x1=i<d?h[i]:f;for(i=0;i<o;++i)c<=(a=u[i])&&a<=f&&v[l(h,a,0,d)].push(r[i]);return v}return r.value=function(e){return arguments.length?(t="function"===typeof e?e:_(e),r):t},r.domain=function(t){return arguments.length?(e="function"===typeof t?t:_([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:Array.isArray(t)?_(x.call(t)):_(t),r):n},r}function D(t,e){var n;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n<s||void 0===n&&s>=s)&&(n=s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;null!=(v=e(v,++l,t))&&(n<v||void 0===n&&v>=v)&&(n=v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n}function F(t,e){var n;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n>s||void 0===n&&s>=s)&&(n=s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;null!=(v=e(v,++l,t))&&(n>v||void 0===n&&v>=v)&&(n=v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n}function T(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o;r>n;){if(r-n>600){var a=r-n+1,u=e-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(u-a/2<0?-1:1);T(t,e,Math.max(n,Math.floor(e-u*l/a+c)),Math.min(r,Math.floor(e+(a-u)*l/a+c)),i)}var f=t[e],h=n,d=r;for(N(t,n,e),i(t[r],f)>0&&N(t,n,r);h<d;){for(N(t,h,d),++h,--d;i(t[h],f)<0;)++h;for(;i(t[d],f)>0;)--d}0===i(t[n],f)?N(t,n,d):N(t,++d,r),d<=e&&(n=d+1),e<=d&&(r=d-1)}return t}function N(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function j(t){return null===t?NaN:+t}function R(t,n){var i,a,o,u,s,l,c,f,h,d,p,v,g;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n){e.next=30;break}i=!0,a=!1,o=void 0,e.prev=4,u=t[Symbol.iterator]();case 6:if(i=(s=u.next()).done){e.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){e.next=11;break}return e.next=11,l;case 11:i=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),a=!0,o=e.t0;case 20:e.prev=20,e.prev=21,i||null==u.return||u.return();case 23:if(e.prev=23,!a){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:e.next=58;break;case 30:c=-1,f=!0,h=!1,d=void 0,e.prev=34,p=t[Symbol.iterator]();case 36:if(f=(v=p.next()).done){e.next=44;break}if(g=v.value,!(null!=(g=n(g,++c,t))&&(g=+g)>=g)){e.next=41;break}return e.next=41,g;case 41:f=!0,e.next=36;break;case 44:e.next=50;break;case 46:e.prev=46,e.t1=e.catch(34),h=!0,d=e.t1;case 50:e.prev=50,e.prev=51,f||null==p.return||p.return();case 53:if(e.prev=53,!h){e.next=56;break}throw d;case 56:return e.finish(53);case 57:return e.finish(50);case 58:case"end":return e.stop()}},e,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function P(t,e,n){if(r=(t=Float64Array.from(R(t,n))).length){if((e=+e)<=0||r<2)return F(t);if(e>=1)return D(t);var r,i=(r-1)*e,a=Math.floor(i),o=D(T(t,a).subarray(0,a+1));return o+(F(t.subarray(a+1))-o)*(i-a)}}function z(t,e){var n,r=-1,i=-1;if(void 0===e){var a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;++i,null!=c&&(n<c||void 0===n&&c>=c)&&(n=c,r=i)}}catch(m){o=!0,u=m}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}else{var f=!0,h=!1,d=void 0;try{for(var p,v=t[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=p.value;null!=(g=e(g,++i,t))&&(n<g||void 0===n&&g>=g)&&(n=g,r=i)}}catch(m){h=!0,d=m}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}}return r}function B(t){var e,i,a,o,u,s;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=!0,i=!1,a=void 0,n.prev=3,o=t[Symbol.iterator]();case 5:if(e=(u=o.next()).done){n.next=11;break}return s=u.value,n.delegateYield(s,"t0",8);case 8:e=!0,n.next=5;break;case 11:n.next=17;break;case 13:n.prev=13,n.t1=n.catch(3),i=!0,a=n.t1;case 17:n.prev=17,n.prev=18,e||null==o.return||o.return();case 20:if(n.prev=20,!i){n.next=23;break}throw a;case 23:return n.finish(20);case 24:return n.finish(17);case 25:case"end":return n.stop()}},n,null,[[3,13,17,25],[18,,20,24]])}function L(t,e){var n,r=-1,i=-1;if(void 0===e){var a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;++i,null!=c&&(n>c||void 0===n&&c>=c)&&(n=c,r=i)}}catch(m){o=!0,u=m}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}else{var f=!0,h=!1,d=void 0;try{for(var p,v=t[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=p.value;null!=(g=e(g,++i,t))&&(n>g||void 0===n&&g>=g)&&(n=g,r=i)}}catch(m){h=!0,d=m}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}}return r}function q(t,e){return[t,e]}function I(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(1===n.length)return L(t,n);var r=-1,i=-1,a=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;++i,(r<0?0===n(f,f):n(f,e)<0)&&(e=f,r=i)}}catch(h){u=!0,s=h}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}return r}function U(t){if(!(i=t.length))return[];for(var e=-1,n=F(t,W),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r}function W(t){return t.length}t.ascending=o,t.bin=O,t.bisect=l,t.bisectLeft=c,t.bisectRight=l,t.bisector=u,t.count=f,t.cross=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r="function"===typeof e[e.length-1]&&function(t){return function(e){return t.apply(void 0,a(e))}}(e.pop()),i=(e=e.map(p)).map(h),o=e.length-1,u=new Array(o+1).fill(0),s=[];if(o<0||i.some(d))return s;for(;;){s.push(u.map(function(t,n){return e[n][t]}));for(var l=o;++u[l]===i[l];){if(0===l)return r?s.map(r):s;u[l--]=0}}},t.cumsum=function(t,e){var n=0,r=0;return Float64Array.from(t,void 0===e?function(t){return n+=+t||0}:function(i){return n+=+e(i,r++,t)||0})},t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=g,t.extent=m,t.greatest=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=!1;if(1===n.length){var i,a=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,h=n(f);(r?o(h,i)>0:0===o(h,h))&&(e=f,i=h,r=!0)}}catch(b){u=!0,s=b}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}}else{var d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value;(r?n(y,e)>0:0===n(y,y))&&(e=y,r=!0)}}catch(b){p=!0,v=b}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}return e},t.greatestIndex=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(1===n.length)return z(t,n);var r=-1,i=-1,a=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;++i,(r<0?0===n(f,f):n(f,e)>0)&&(e=f,r=i)}}catch(h){u=!0,s=h}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}return r},t.group=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return b(t,y,y,n)},t.groups=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return b(t,Array.from,y,n)},t.histogram=O,t.least=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=!1;if(1===n.length){var i,a=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,h=n(f);(r?o(h,i)<0:0===o(h,h))&&(e=f,i=h,r=!0)}}catch(b){u=!0,s=b}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}}else{var d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value;(r?n(y,e)<0:0===n(y,y))&&(e=y,r=!0)}}catch(b){p=!0,v=b}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}return e},t.leastIndex=I,t.max=D,t.maxIndex=z,t.mean=function(t,e){var n=0,r=0;if(void 0===e){var i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;null!=l&&(l=+l)>=l&&(++n,r+=l)}}catch(m){a=!0,o=m}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var c=-1,f=!0,h=!1,d=void 0;try{for(var p,v=t[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=p.value;null!=(g=e(g,++c,t))&&(g=+g)>=g&&(++n,r+=g)}}catch(m){h=!0,d=m}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}}if(n)return r/n},t.median=function(t,e){return P(t,.5,e)},t.merge=function(t){return Array.from(B(t))},t.min=F,t.minIndex=L,t.pairs=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q,r=[],i=!1,a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;i&&r.push(n(e,c)),e=c,i=!0}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return r},t.permute=function(t,e){return Array.from(e,function(e){return t[e]})},t.quantile=P,t.quantileSorted=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}},t.quickselect=T,t.range=w,t.rollup=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return b(t,y,e,r)},t.rollups=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return b(t,Array.from,e,r)},t.scan=function(t,e){var n=I(t,e);return n<0?void 0:n},t.shuffle=function(t){for(var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length)-(r=+r);i;)n=Math.random()*i--|0,e=t[i+r],t[i+r]=t[n+r],t[n+r]=e;return t},t.sum=function(t,e){var n=0;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;(s=+s)&&(n+=s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;(v=+e(v,++l,t))&&(n+=v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n},t.thresholdFreedmanDiaconis=function(t,e,n){return Math.ceil((n-e)/(2*(P(t,.75)-P(t,.25))*Math.pow(f(t),-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*g(t)*Math.pow(f(t),-1/3)))},t.thresholdSturges=C,t.tickIncrement=M,t.tickStep=S,t.ticks=function(t,e,n){var r,i,a,o,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=M(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a},t.transpose=U,t.variance=v,t.zip=function(){return U(arguments)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},1112:function(t,e){function n(t,e,n,r,i,a,o){try{var u=t[a](o),s=u.value}catch(l){return void n(l)}u.done?e(s):Promise.resolve(s).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var o=t.apply(e,r);function u(t){n(o,i,a,u,s,"next",t)}function s(t){n(o,i,a,u,s,"throw",t)}u(void 0)})}}},1171:function(t,e,n){!function(t){"use strict";function e(t,e){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}t.domCanvas=e,t.canvas=e,t.image=function(){return"undefined"!==typeof Image?Image:null},Object.defineProperty(t,"__esModule",{value:!0})}(e)},1172:function(t,e,n){!function(t,e,n,r,i){"use strict";function a(t,e,n){var r=t-e+2*n;return t?r>0?r:1:0}var o="log",u="quantile",s="continuous",l="discrete",c="discretizing",f="interpolating",h="temporal";function d(){var t,e,i=r.scaleOrdinal().unknown(void 0),o=i.domain,u=i.range,s=[0,1],l=!1,c=0,f=0,h=.5;function p(){var r=o().length,i=s[1]<s[0],d=s[i-0],p=s[1-i],v=a(r,c,f);t=(p-d)/(v||1),l&&(t=Math.floor(t)),d+=(p-d-t*(r-c))*h,e=t*(1-c),l&&(d=Math.round(d),e=Math.round(e));var g=n.range(r).map(function(e){return d+t*e});return u(i?g.reverse():g)}return delete i.unknown,i.domain=function(t){return arguments.length?(o(t),p()):o()},i.range=function(t){return arguments.length?(s=[+t[0],+t[1]],p()):s.slice()},i.rangeRound=function(t){return s=[+t[0],+t[1]],l=!0,p()},i.bandwidth=function(){return e},i.step=function(){return t},i.round=function(t){return arguments.length?(l=!!t,p()):l},i.padding=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),c=f,p()):c},i.paddingInner=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),p()):c},i.paddingOuter=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),p()):f},i.align=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),p()):h},i.invertRange=function(t){if(null!=t[0]&&null!=t[1]){var r,i,a,l=+t[0],c=+t[1],f=s[1]<s[0],h=f?u().reverse():u(),d=h.length-1;if(l===l&&c===c&&(c<l&&(a=l,l=c,c=a),!(c<h[0]||l>s[1-f])))return r=Math.max(0,n.bisectRight(h,l)-1),i=l===c?r:n.bisectRight(h,c)-1,l-h[r]>e+1e-10&&++r,f&&(a=r,r=d-i,i=d-a),r>i?void 0:o().slice(r,i+1)}},i.invert=function(t){var e=i.invertRange([t,t]);return e?e[0]:e},i.copy=function(){return d().domain(o()).range(s).round(l).paddingInner(c).paddingOuter(f).align(h)},p()}var p=Array.prototype.map;function v(t){return p.call(t,function(t){return+t})}var g=Array.prototype.slice,m={};function y(t,n,r){return arguments.length>1?(m[t]=function(t,n,r){var i=function(){var e=n();return e.invertRange||(e.invertRange=e.invert?function(t){return function(e){var n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(e):e.invertExtent?function(t){return function(e){var n,r,i,a,o=t.range(),u=e[0],s=e[1],l=-1;for(s<u&&(r=u,u=s,s=r),i=0,a=o.length;i<a;++i)o[i]>=u&&o[i]<=s&&(l<0&&(l=i),n=i);if(!(l<0))return u=t.invertExtent(o[l]),s=t.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(e):void 0),e.type=t,e};return i.metadata=e.toSet(e.array(r)),i}(t,n,r),this):b(t)?m[t]:void 0}function b(t){return e.hasOwnProperty(m,t)}function x(t,e){var n=m[t];return n&&n.metadata[e]}y("identity",r.scaleIdentity),y("linear",r.scaleLinear,s),y(o,r.scaleLog,[s,o]),y("pow",r.scalePow,s),y("sqrt",r.scaleSqrt,s),y("symlog",r.scaleSymlog,s),y("time",r.scaleTime,[s,h]),y("utc",r.scaleUtc,[s,h]),y("sequential",r.scaleSequential,[s,f]),y("".concat("sequential","-").concat("linear"),r.scaleSequential,[s,f]),y("".concat("sequential","-").concat(o),r.scaleSequentialLog,[s,f,o]),y("".concat("sequential","-").concat("pow"),r.scaleSequentialPow,[s,f]),y("".concat("sequential","-").concat("sqrt"),r.scaleSequentialSqrt,[s,f]),y("".concat("sequential","-").concat("symlog"),r.scaleSequentialSymlog,[s,f]),y("".concat("diverging","-").concat("linear"),r.scaleDiverging,[s,f]),y("".concat("diverging","-").concat(o),r.scaleDivergingLog,[s,f,o]),y("".concat("diverging","-").concat("pow"),r.scaleDivergingPow,[s,f]),y("".concat("diverging","-").concat("sqrt"),r.scaleDivergingSqrt,[s,f]),y("".concat("diverging","-").concat("symlog"),r.scaleDivergingSymlog,[s,f]),y(u,r.scaleQuantile,[c,u]),y("quantize",r.scaleQuantize,c),y("threshold",r.scaleThreshold,c),y("bin-ordinal",function t(){var i=[],a=[];function o(t){return null==t||t!==t?void 0:a[(n.bisect(i,t)-1)%a.length]}return o.domain=function(t){return arguments.length?(i=v(t),o):i.slice()},o.range=function(t){return arguments.length?(a=g.call(t),o):a.slice()},o.tickFormat=function(t,n){return r.tickFormat(i[0],e.peek(i),null==t?10:t,n)},o.copy=function(){return t().domain(o.domain()).range(o.range())},o},[l,c]),y("ordinal",r.scaleOrdinal,l),y("band",d,l),y("point",function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(d().paddingInner(1))},l);var _=["clamp","base","constant","exponent"];function w(t,e,n){return i.piecewise(k(e||"rgb",n),t)}function k(t,e){var n=i[function(t){return"interpolate"+t.toLowerCase().split("-").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function A(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function E(t,e){for(var n in t)S(n,e(t[n]))}var M={};function S(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(M[t]=e,this):M[t]}E({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},A),E({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},function(t){return w(A(t))}),Object.defineProperty(t,"scaleImplicit",{enumerable:!0,get:function(){return r.scaleImplicit}}),Object.defineProperty(t,"tickFormat",{enumerable:!0,get:function(){return r.tickFormat}}),t.Band="band",t.BinOrdinal="bin-ordinal",t.Diverging="diverging",t.Identity="identity",t.Linear="linear",t.Log=o,t.Ordinal="ordinal",t.Point="point",t.Pow="pow",t.Quantile=u,t.Quantize="quantize",t.Sequential="sequential",t.Sqrt="sqrt",t.Symlog="symlog",t.Threshold="threshold",t.Time="time",t.UTC="utc",t.bandSpace=a,t.interpolate=k,t.interpolateColors=w,t.interpolateRange=function(t,n){var r=n[0],i=e.peek(n)-r;return function(e){return t(r+e*i)}},t.isContinuous=function(t){return x(t,s)},t.isDiscrete=function(t){return x(t,l)},t.isDiscretizing=function(t){return x(t,c)},t.isInterpolating=function(t){return x(t,f)},t.isLogarithmic=function(t){return x(t,o)},t.isQuantile=function(t){return x(t,u)},t.isTemporal=function(t){return x(t,h)},t.isValidScaleType=b,t.quantizeInterpolator=function(t,e){for(var n=new Array(e),r=e+1,i=0;i<e;)n[i]=t(++i/r);return n},t.scale=y,t.scaleCopy=function(t){var e=t.type,n=t.copy();return n.type=e,n},t.scaleFraction=function(t,n,r){var i,a,o,u=r-n;return u&&Number.isFinite(u)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=y(a)().domain([n,r]).range([0,1]),_.forEach(function(e){return t[e]?o[e](t[e]()):0}),o):e.constant(.5)},t.scheme=S,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040),n(1053),n(2121),n(1079))},1223:function(t,e,n){var r=n(96);!function(t,e,n,i,a){"use strict";var o,u,s,l,c,f="year",h="quarter",d="month",p="week",v="date",g="day",m="hours",y="minutes",b="seconds",x="milliseconds",_=[f,h,d,p,v,g,m,y,b,x].reduce(function(t,e,n){return t[e]=1+n,t},{});function w(t){var n=e.array(t).slice(),r={};return n.length||e.error("Missing time unit."),n.forEach(function(t){e.hasOwnProperty(_,t)?r[t]=1:e.error("Invalid time unit: ".concat(t,"."))}),(r[p]||r[g])&&(r[h]||r[d]||r[v])&&e.error("Incompatible time units: ".concat(t)),n.sort(function(t,e){return _[t]-_[e]}),n}var k=new Date;function A(t,n,r,i){var a=n||1,o=e.peek(t),u=function(t,e,n){return function(t,e,n){return e<=1?t:n?function(r,i){return n+e*Math.floor((t(r,i)-n)/e)}:function(n,r){return e*Math.floor(t(n,r)/e)}}(r[n||t],t===o&&a,e)},s=new Date,l=e.toSet(t),c=l[f]?u(f):e.constant(2012),_=l[d]?u(d):l[h]?u(h):e.zero,w=l[p]&&l[g]?u(g,1,p+g):l[p]?u(p,1):l[g]?u(g,1):l[v]?u(v,1):e.one,k=l[m]?u(m):e.zero,A=l[y]?u(y):e.zero,E=l[b]?u(b):e.zero,M=l[x]?u(x):e.zero;return function(t){s.setTime(+t);var e=c(s);return i(e,_(s),w(s,e),k(s),A(s),E(s),M(s))}}function E(t,e,n){return e+7*t-(n+6)%7}var M=(r(o={},f,function(t){return t.getFullYear()}),r(o,h,function(t){return 3*~~(t.getMonth()/3)}),r(o,d,function(t){return t.getMonth()}),r(o,v,function(t){return t.getDate()}),r(o,m,function(t){return t.getHours()}),r(o,y,function(t){return t.getMinutes()}),r(o,b,function(t){return t.getSeconds()}),r(o,x,function(t){return t.getMilliseconds()}),r(o,g,function(t,e){return E(1,t.getDay(),O(e))}),r(o,p,function(t,e){return E(C(t),0,O(e))}),r(o,p+g,function(t,e){return E(C(t),t.getDay(),O(e))}),o);function S(t){return k.setFullYear(t),k.setMonth(0),k.setDate(1),k.setHours(0,0,0,0),k}function C(t){return n.timeWeek.count(S(t.getFullYear())-1,t)}function O(t){return S(t).getDay()}function D(t,e,n,r,i,a,o){if(0<=t&&t<100){var u=new Date(-1,e,n,r,i,a,o);return u.setFullYear(t),u}return new Date(t,e,n,r,i,a,o)}var F=(r(u={},f,function(t){return t.getUTCFullYear()}),r(u,h,function(t){return 3*~~(t.getUTCMonth()/3)}),r(u,d,function(t){return t.getUTCMonth()}),r(u,v,function(t){return t.getUTCDate()}),r(u,m,function(t){return t.getUTCHours()}),r(u,y,function(t){return t.getUTCMinutes()}),r(u,b,function(t){return t.getUTCSeconds()}),r(u,x,function(t){return t.getUTCMilliseconds()}),r(u,g,function(t,e){return E(1,t.getUTCDay(),N(e))}),r(u,p,function(t,e){return E(T(t),0,N(e))}),r(u,p+g,function(t,e){return E(T(t),t.getUTCDay(),N(e))}),u);function T(t){var e=Date.UTC(t.getUTCFullYear(),0,1);return n.utcWeek.count(e-1,t)}function N(t){return k.setTime(Date.UTC(t,0,1)),k.getUTCDay()}function j(t,e,n,r,i,a,o){if(0<=t&&t<100){var u=new Date(Date.UTC(-1,e,n,r,i,a,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(t,e,n,r,i,a,o))}var R=(r(s={},f,n.timeYear),r(s,h,n.timeMonth.every(3)),r(s,d,n.timeMonth),r(s,p,n.timeWeek),r(s,v,n.timeDay),r(s,g,n.timeDay),r(s,m,n.timeHour),r(s,y,n.timeMinute),r(s,b,n.timeSecond),r(s,x,n.timeMillisecond),s),P=(r(l={},f,n.utcYear),r(l,h,n.utcMonth.every(3)),r(l,d,n.utcMonth),r(l,p,n.utcWeek),r(l,v,n.utcDay),r(l,g,n.utcDay),r(l,m,n.utcHour),r(l,y,n.utcMinute),r(l,b,n.utcSecond),r(l,x,n.utcMillisecond),l);function z(t){return R[t]}function B(t){return P[t]}function L(t,e,n){return t?t.offset(e,n):void 0}function q(t,e,n,r){return t?t.range(e,n,r):void 0}var I=(r(c={},f,"%Y "),r(c,h,"Q%q "),r(c,d,"%b "),r(c,v,"%d "),r(c,p,"W%U "),r(c,g,"%a "),r(c,m,"%H:00"),r(c,y,"00:%M"),r(c,b,":%S"),r(c,x,".%L"),r(c,"".concat(f,"-").concat(d),"%Y-%m "),r(c,"".concat(f,"-").concat(d,"-").concat(v),"%Y-%m-%d "),r(c,"".concat(m,"-").concat(y),"%H:%M"),c);function U(t,n,r){return e.isString(r)?t(r):function(t,n,r){r=r||{},e.isObject(r)||e.error("Invalid time multi-format specifier: ".concat(r));var i=n(b),a=n(y),o=n(m),u=n(v),s=n(p),l=n(d),c=n(h),_=n(f),w=t(r[x]||".%L"),k=t(r[b]||":%S"),A=t(r[y]||"%I:%M"),E=t(r[m]||"%I %p"),M=t(r[v]||r[g]||"%a %d"),S=t(r[p]||"%b %d"),C=t(r[d]||"%B"),O=t(r[h]||"%B"),D=t(r[f]||"%Y");return function(t){return(i(t)<t?w:a(t)<t?k:o(t)<t?A:u(t)<t?E:l(t)<t?s(t)<t?M:S:_(t)<t?c(t)<t?C:O:D)(t)}}(t,n,r)}var W=31536e6,H=[f,d,v,m,y,b,x],V=H.slice(0,-1),G=V.slice(0,-1),$=G.slice(0,-1),Y=$.slice(0,-1),X=[f,d],J=[f],Q=[[V,1,1e3],[V,5,5e3],[V,15,15e3],[V,30,3e4],[G,1,6e4],[G,5,3e5],[G,15,9e5],[G,30,18e5],[$,1,36e5],[$,3,108e5],[$,6,216e5],[$,12,432e5],[Y,1,864e5],[[f,p],1,6048e5],[X,1,2592e6],[X,3,7776e6],[J,1,W]];t.timeBin=function(t){var n,r,i=t.extent,o=t.maxbins||40,u=Math.abs(e.span(i))/o,s=a.bisector(function(t){return t[2]}).right(Q,u);return s===Q.length?(n=J,r=a.tickStep(i[0]/W,i[1]/W,o)):s?(n=(s=Q[u/Q[s-1][2]<Q[s][2]/u?s-1:s])[0],r=s[1]):(n=H,r=Math.max(a.tickStep(i[0],i[1],o),1)),{units:n,step:r}},t.timeFloor=function(t,e){return A(t,e||1,M,D)},t.timeFormat=function(t){return U(i.timeFormat,z,t)},t.timeInterval=z,t.timeOffset=function(t,e,n){return L(z(t),e,n)},t.timeSequence=function(t,e,n,r){return q(z(t),e,n,r)},t.timeUnitSpecifier=function(t,n){var r,i,a=e.extend({},I,n),o=w(t),u=o.length,s="",l=0;for(l=0;l<u;)for(r=o.length;r>l;--r)if(null!=a[i=o.slice(l,r).join("-")]){s+=a[i],l=r;break}return s.trim()},t.timeUnits=w,t.utcFloor=function(t,e){return A(t,e||1,F,j)},t.utcFormat=function(t){return U(i.utcFormat,B,t)},t.utcInterval=B,t.utcOffset=function(t,e,n){return L(B(t),e,n)},t.utcSequence=function(t,e,n,r){return q(B(t),e,n,r)},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040),n(1170),n(1091),n(1053))},1224:function(t,e,n){!function(t,e){"use strict";function n(){return new r}function r(){this.reset()}r.prototype={constructor:r,reset:function(){this.s=this.t=0},add:function(t){a(i,t,this.t),a(this,i.s,this.s),this.s?this.t+=i.t:this.s=i.t},valueOf:function(){return this.s}};var i=new r;function a(t,e,n){var r=t.s=e+n,i=r-e,a=r-i;t.t=e-a+(n-i)}var o=1e-6,u=1e-12,s=Math.PI,l=s/2,c=s/4,f=2*s,h=180/s,d=s/180,p=Math.abs,v=Math.atan,g=Math.atan2,m=Math.cos,y=Math.ceil,b=Math.exp,x=Math.log,_=Math.pow,w=Math.sin,k=Math.sign||function(t){return t>0?1:t<0?-1:0},A=Math.sqrt,E=Math.tan;function M(t){return t>1?0:t<-1?s:Math.acos(t)}function S(t){return t>1?l:t<-1?-l:Math.asin(t)}function C(t){return(t=w(t/2))*t}function O(){}function D(t,e){t&&T.hasOwnProperty(t.type)&&T[t.type](t,e)}var F={Feature:function(t,e){D(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)D(n[r].geometry,e)}},T={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){N(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)N(n[r],e,0)},Polygon:function(t,e){j(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)j(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)D(n[r],e)}};function N(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function j(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)N(t[n],e,1);e.polygonEnd()}function R(t,e){t&&F.hasOwnProperty(t.type)?F[t.type](t,e):D(t,e)}var P,z,B,L,q,I=n(),U=n(),W={point:O,lineStart:O,lineEnd:O,polygonStart:function(){I.reset(),W.lineStart=H,W.lineEnd=V},polygonEnd:function(){var t=+I;U.add(t<0?f+t:t),this.lineStart=this.lineEnd=this.point=O},sphere:function(){U.add(f)}};function H(){W.point=G}function V(){$(P,z)}function G(t,e){W.point=$,P=t,z=e,B=t*=d,L=m(e=(e*=d)/2+c),q=w(e)}function $(t,e){var n=(t*=d)-B,r=n>=0?1:-1,i=r*n,a=m(e=(e*=d)/2+c),o=w(e),u=q*o,s=L*a+u*m(i),l=u*r*w(i);I.add(g(l,s)),B=t,L=a,q=o}function Y(t){return[g(t[1],t[0]),S(t[2])]}function X(t){var e=t[0],n=t[1],r=m(n);return[r*m(e),r*w(e),w(n)]}function J(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Q(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Z(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function K(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function tt(t){var e=A(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var et,nt,rt,it,at,ot,ut,st,lt,ct,ft,ht,dt,pt,vt,gt,mt,yt,bt,xt,_t,wt,kt,At,Et,Mt,St=n(),Ct={point:Ot,lineStart:Ft,lineEnd:Tt,polygonStart:function(){Ct.point=Nt,Ct.lineStart=jt,Ct.lineEnd=Rt,St.reset(),W.polygonStart()},polygonEnd:function(){W.polygonEnd(),Ct.point=Ot,Ct.lineStart=Ft,Ct.lineEnd=Tt,I<0?(et=-(rt=180),nt=-(it=90)):St>o?it=90:St<-o&&(nt=-90),ct[0]=et,ct[1]=rt},sphere:function(){et=-(rt=180),nt=-(it=90)}};function Ot(t,e){lt.push(ct=[et=t,rt=t]),e<nt&&(nt=e),e>it&&(it=e)}function Dt(t,e){var n=X([t*d,e*d]);if(st){var r=Q(st,n),i=Q([r[1],-r[0],0],r);tt(i),i=Y(i);var a,o=t-at,u=o>0?1:-1,s=i[0]*h*u,l=p(o)>180;l^(u*at<s&&s<u*t)?(a=i[1]*h)>it&&(it=a):l^(u*at<(s=(s+360)%360-180)&&s<u*t)?(a=-i[1]*h)<nt&&(nt=a):(e<nt&&(nt=e),e>it&&(it=e)),l?t<at?Pt(et,t)>Pt(et,rt)&&(rt=t):Pt(t,rt)>Pt(et,rt)&&(et=t):rt>=et?(t<et&&(et=t),t>rt&&(rt=t)):t>at?Pt(et,t)>Pt(et,rt)&&(rt=t):Pt(t,rt)>Pt(et,rt)&&(et=t)}else lt.push(ct=[et=t,rt=t]);e<nt&&(nt=e),e>it&&(it=e),st=n,at=t}function Ft(){Ct.point=Dt}function Tt(){ct[0]=et,ct[1]=rt,Ct.point=Ot,st=null}function Nt(t,e){if(st){var n=t-at;St.add(p(n)>180?n+(n>0?360:-360):n)}else ot=t,ut=e;W.point(t,e),Dt(t,e)}function jt(){W.lineStart()}function Rt(){Nt(ot,ut),W.lineEnd(),p(St)>o&&(et=-(rt=180)),ct[0]=et,ct[1]=rt,st=null}function Pt(t,e){return(e-=t)<0?e+360:e}function zt(t,e){return t[0]-e[0]}function Bt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Lt={sphere:O,point:qt,lineStart:Ut,lineEnd:Vt,polygonStart:function(){Lt.lineStart=Gt,Lt.lineEnd=$t},polygonEnd:function(){Lt.lineStart=Ut,Lt.lineEnd=Vt}};function qt(t,e){t*=d;var n=m(e*=d);It(n*m(t),n*w(t),w(e))}function It(t,e,n){dt+=(t-dt)/++ft,pt+=(e-pt)/ft,vt+=(n-vt)/ft}function Ut(){Lt.point=Wt}function Wt(t,e){t*=d;var n=m(e*=d);At=n*m(t),Et=n*w(t),Mt=w(e),Lt.point=Ht,It(At,Et,Mt)}function Ht(t,e){t*=d;var n=m(e*=d),r=n*m(t),i=n*w(t),a=w(e),o=g(A((o=Et*a-Mt*i)*o+(o=Mt*r-At*a)*o+(o=At*i-Et*r)*o),At*r+Et*i+Mt*a);ht+=o,gt+=o*(At+(At=r)),mt+=o*(Et+(Et=i)),yt+=o*(Mt+(Mt=a)),It(At,Et,Mt)}function Vt(){Lt.point=qt}function Gt(){Lt.point=Yt}function $t(){Xt(wt,kt),Lt.point=qt}function Yt(t,e){wt=t,kt=e,t*=d,e*=d,Lt.point=Xt;var n=m(e);At=n*m(t),Et=n*w(t),Mt=w(e),It(At,Et,Mt)}function Xt(t,e){t*=d;var n=m(e*=d),r=n*m(t),i=n*w(t),a=w(e),o=Et*a-Mt*i,u=Mt*r-At*a,s=At*i-Et*r,l=A(o*o+u*u+s*s),c=S(l),f=l&&-c/l;bt+=f*o,xt+=f*u,_t+=f*s,ht+=c,gt+=c*(At+(At=r)),mt+=c*(Et+(Et=i)),yt+=c*(Mt+(Mt=a)),It(At,Et,Mt)}function Jt(t){return function(){return t}}function Qt(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Zt(t,e){return[p(t)>s?t+Math.round(-t/f)*f:t,e]}function Kt(t,e,n){return(t%=f)?e||n?Qt(ee(t),ne(e,n)):ee(t):e||n?ne(e,n):Zt}function te(t){return function(e,n){return[(e+=t)>s?e-f:e<-s?e+f:e,n]}}function ee(t){var e=te(t);return e.invert=te(-t),e}function ne(t,e){var n=m(t),r=w(t),i=m(e),a=w(e);function o(t,e){var o=m(e),u=m(t)*o,s=w(t)*o,l=w(e),c=l*n+u*r;return[g(s*i-c*a,u*n-l*r),S(c*i+s*a)]}return o.invert=function(t,e){var o=m(e),u=m(t)*o,s=w(t)*o,l=w(e),c=l*i-s*a;return[g(s*i+l*a,u*n+c*r),S(c*n-u*r)]},o}function re(t){function e(e){return(e=t(e[0]*d,e[1]*d))[0]*=h,e[1]*=h,e}return t=Kt(t[0]*d,t[1]*d,t.length>2?t[2]*d:0),e.invert=function(e){return(e=t.invert(e[0]*d,e[1]*d))[0]*=h,e[1]*=h,e},e}function ie(t,e,n,r,i,a){if(n){var o=m(e),u=w(e),s=r*n;null==i?(i=e+r*f,a=e-s/2):(i=ae(o,i),a=ae(o,a),(r>0?i<a:i>a)&&(i+=r*f));for(var l,c=i;r>0?c>a:c<a;c-=s)l=Y([o,-u*m(c),-u*w(c)]),t.point(l[0],l[1])}}function ae(t,e){(e=X(e))[0]-=t,tt(e);var n=M(-e[1]);return((-e[2]<0?-n:n)+f-o)%f}function oe(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:O,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function ue(t,e){return p(t[0]-e[0])<o&&p(t[1]-e[1])<o}function se(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function le(t,e,n,r,i){var a,o,u=[],s=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(ue(r,o)){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);i.lineEnd()}else u.push(n=new se(r,t,null,!0)),s.push(n.o=new se(r,null,n,!1)),u.push(n=new se(o,t,null,!1)),s.push(n.o=new se(o,null,n,!0))}}),u.length){for(s.sort(e),ce(u),ce(s),a=0,o=s.length;a<o;++a)s[a].e=n=!n;for(var l,c,f=u[0];;){for(var h=f,d=!0;h.v;)if((h=h.n)===f)return;l=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(a=0,o=l.length;a<o;++a)i.point((c=l[a])[0],c[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(l=h.p.z,a=l.length-1;a>=0;--a)i.point((c=l[a])[0],c[1]);else r(h.x,h.p.x,-1,i);h=h.p}l=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function ce(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}Zt.invert=Zt;var fe=n();function he(t){return p(t[0])<=s?t[0]:k(t[0])*((p(t[0])+s)%f-s)}function de(t,e){var n=he(e),r=e[1],i=w(r),a=[w(n),-m(n),0],u=0,h=0;fe.reset(),1===i?r=l+o:-1===i&&(r=-l-o);for(var d=0,p=t.length;d<p;++d)if(y=(v=t[d]).length)for(var v,y,b=v[y-1],x=he(b),_=b[1]/2+c,k=w(_),A=m(_),E=0;E<y;++E,x=C,k=D,A=F,b=M){var M=v[E],C=he(M),O=M[1]/2+c,D=w(O),F=m(O),T=C-x,N=T>=0?1:-1,j=N*T,R=j>s,P=k*D;if(fe.add(g(P*N*w(j),A*F+P*m(j))),u+=R?T+N*f:T,R^x>=n^C>=n){var z=Q(X(b),X(M));tt(z);var B=Q(a,z);tt(B);var L=(R^T>=0?-1:1)*S(B[2]);(r>L||r===L&&(z[0]||z[1]))&&(h+=R^T>=0?1:-1)}}return(u<-o||u<o&&fe<-o)^1&h}function pe(t,n,r,i){return function(a){var o,u,s,l=n(a),c=oe(),f=n(c),h=!1,d={point:p,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=x,u=[],o=[]},polygonEnd:function(){d.point=p,d.lineStart=g,d.lineEnd=m,u=e.merge(u);var t=de(o,i);u.length?(h||(a.polygonStart(),h=!0),le(u,ge,t,r,a)):t&&(h||(a.polygonStart(),h=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),h&&(a.polygonEnd(),h=!1),u=o=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function p(e,n){t(e,n)&&a.point(e,n)}function v(t,e){l.point(t,e)}function g(){d.point=v,l.lineStart()}function m(){d.point=p,l.lineEnd()}function y(t,e){s.push([t,e]),f.point(t,e)}function b(){f.lineStart(),s=[]}function x(){y(s[0][0],s[0][1]),f.lineEnd();var t,e,n,r,i=f.clean(),l=c.result(),d=l.length;if(s.pop(),o.push(s),s=null,d)if(1&i){if((e=(n=l[0]).length-1)>0){for(h||(a.polygonStart(),h=!0),a.lineStart(),t=0;t<e;++t)a.point((r=n[t])[0],r[1]);a.lineEnd()}}else d>1&&2&i&&l.push(l.pop().concat(l.shift())),u.push(l.filter(ve))}return d}}function ve(t){return t.length>1}function ge(t,e){return((t=t.x)[0]<0?t[1]-l-o:l-t[1])-((e=e.x)[0]<0?e[1]-l-o:l-e[1])}var me=pe(function(){return!0},function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,u){var c=a>0?s:-s,f=p(a-n);p(f-s)<o?(t.point(n,r=(r+u)/2>0?l:-l),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(c,r),t.point(a,r),e=0):i!==c&&f>=s&&(p(n-i)<o&&(n-=i*o),p(a-c)<o&&(a-=c*o),r=function(t,e,n,r){var i,a,u=w(t-n);return p(u)>o?v((w(e)*(a=m(r))*w(n)-w(r)*(i=m(e))*w(t))/(i*a*u)):(e+r)/2}(n,r,a,u),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(c,r),e=0),t.point(n=a,r=u),i=c},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var i;if(null==t)i=n*l,r.point(-s,i),r.point(0,i),r.point(s,i),r.point(s,0),r.point(s,-i),r.point(0,-i),r.point(-s,-i),r.point(-s,0),r.point(-s,i);else if(p(t[0]-e[0])>o){var a=t[0]<e[0]?s:-s;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])},[-s,-l]);function ye(t){var e=m(t),n=6*d,r=e>0,i=p(e)>o;function a(t,n){return m(t)*m(n)>e}function u(t,n,r){var i=[1,0,0],a=Q(X(t),X(n)),u=J(a,a),l=a[0],c=u-l*l;if(!c)return!r&&t;var f=e*u/c,h=-e*l/c,d=Q(i,a),v=K(i,f);Z(v,K(a,h));var g=d,m=J(v,g),y=J(g,g),b=m*m-y*(J(v,v)-1);if(!(b<0)){var x=A(b),_=K(g,(-m-x)/y);if(Z(_,v),_=Y(_),!r)return _;var w,k=t[0],E=n[0],M=t[1],S=n[1];E<k&&(w=k,k=E,E=w);var C=E-k,O=p(C-s)<o;if(!O&&S<M&&(w=M,M=S,S=w),O||C<o?O?M+S>0^_[1]<(p(_[0]-k)<o?M:S):M<=_[1]&&_[1]<=S:C>s^(k<=_[0]&&_[0]<=E)){var D=K(g,(-m+x)/y);return Z(D,v),[_,Y(D)]}}}function l(e,n){var i=r?t:s-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return pe(a,function(t){var e,n,c,f,h;return{lineStart:function(){f=c=!1,h=1},point:function(d,p){var v,g=[d,p],m=a(d,p),y=r?m?0:l(d,p):m?l(d+(d<0?s:-s),p):0;if(!e&&(f=c=m)&&t.lineStart(),m!==c&&(!(v=u(e,g))||ue(e,v)||ue(g,v))&&(g[0]+=o,g[1]+=o,m=a(g[0],g[1])),m!==c)h=0,m?(t.lineStart(),v=u(g,e),t.point(v[0],v[1])):(v=u(e,g),t.point(v[0],v[1]),t.lineEnd()),e=v;else if(i&&e&&r^m){var b;y&n||!(b=u(g,e,!0))||(h=0,r?(t.lineStart(),t.point(b[0][0],b[0][1]),t.point(b[1][0],b[1][1]),t.lineEnd()):(t.point(b[1][0],b[1][1]),t.lineEnd(),t.lineStart(),t.point(b[0][0],b[0][1])))}!m||e&&ue(e,g)||t.point(g[0],g[1]),e=g,c=m,n=y},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return h|(f&&c)<<1}}},function(e,r,i,a){ie(a,t,n,i,e,r)},r?[0,-t]:[-s,t-s])}var be=1e9,xe=-be;function _e(t,n,r,i){function a(e,a){return t<=e&&e<=r&&n<=a&&a<=i}function u(e,a,o,u){var l=0,f=0;if(null==e||(l=s(e,o))!==(f=s(a,o))||c(e,a)<0^o>0)do{u.point(0===l||3===l?t:r,l>1?i:n)}while((l=(l+o+4)%4)!==f);else u.point(a[0],a[1])}function s(e,i){return p(e[0]-t)<o?i>0?0:3:p(e[0]-r)<o?i>0?2:1:p(e[1]-n)<o?i>0?1:0:i>0?3:2}function l(t,e){return c(t.x,e.x)}function c(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var s,c,f,h,d,p,v,g,m,y,b,x=o,_=oe(),w={point:k,lineStart:function(){w.point=A,c&&c.push(f=[]),y=!0,m=!1,v=g=NaN},lineEnd:function(){s&&(A(h,d),p&&m&&_.rejoin(),s.push(_.result())),w.point=k,m&&x.lineEnd()},polygonStart:function(){x=_,s=[],c=[],b=!0},polygonEnd:function(){var n=function(){for(var e=0,n=0,r=c.length;n<r;++n)for(var a,o,u=c[n],s=1,l=u.length,f=u[0],h=f[0],d=f[1];s<l;++s)a=h,o=d,f=u[s],h=f[0],d=f[1],o<=i?d>i&&(h-a)*(i-o)>(d-o)*(t-a)&&++e:d<=i&&(h-a)*(i-o)<(d-o)*(t-a)&&--e;return e}(),r=b&&n,a=(s=e.merge(s)).length;(r||a)&&(o.polygonStart(),r&&(o.lineStart(),u(null,null,1,o),o.lineEnd()),a&&le(s,l,n,u,o),o.polygonEnd()),x=o,s=c=f=null}};function k(t,e){a(t,e)&&x.point(t,e)}function A(e,o){var u=a(e,o);if(c&&f.push([e,o]),y)h=e,d=o,p=u,y=!1,u&&(x.lineStart(),x.point(e,o));else if(u&&m)x.point(e,o);else{var s=[v=Math.max(xe,Math.min(be,v)),g=Math.max(xe,Math.min(be,g))],l=[e=Math.max(xe,Math.min(be,e)),o=Math.max(xe,Math.min(be,o))];!function(t,e,n,r,i,a){var o,u=t[0],s=t[1],l=0,c=1,f=e[0]-u,h=e[1]-s;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>l&&(l=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<c&&(c=o)}if(o=r-s,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>l&&(l=o)}if(o=a-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<c&&(c=o)}return l>0&&(t[0]=u+l*f,t[1]=s+l*h),c<1&&(e[0]=u+c*f,e[1]=s+c*h),!0}}}}}(s,l,t,n,r,i)?u&&(x.lineStart(),x.point(e,o),b=!1):(m||(x.lineStart(),x.point(s[0],s[1])),x.point(l[0],l[1]),u||x.lineEnd(),b=!1)}v=e,g=o,m=u}return w}}var we,ke,Ae,Ee=n(),Me={sphere:O,point:O,lineStart:function(){Me.point=Ce,Me.lineEnd=Se},lineEnd:O,polygonStart:O,polygonEnd:O};function Se(){Me.point=Me.lineEnd=O}function Ce(t,e){we=t*=d,ke=w(e*=d),Ae=m(e),Me.point=Oe}function Oe(t,e){t*=d;var n=w(e*=d),r=m(e),i=p(t-we),a=m(i),o=r*w(i),u=Ae*n-ke*r*a,s=ke*n+Ae*r*a;Ee.add(g(A(o*o+u*u),s)),we=t,ke=n,Ae=r}function De(t){return Ee.reset(),R(t,Me),+Ee}var Fe=[null,null],Te={type:"LineString",coordinates:Fe};function Ne(t,e){return Fe[0]=t,Fe[1]=e,De(Te)}var je={Feature:function(t,e){return Pe(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(Pe(n[r].geometry,e))return!0;return!1}},Re={Sphere:function(){return!0},Point:function(t,e){return ze(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(ze(n[r],e))return!0;return!1},LineString:function(t,e){return Be(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Be(n[r],e))return!0;return!1},Polygon:function(t,e){return Le(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Le(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(Pe(n[r],e))return!0;return!1}};function Pe(t,e){return!(!t||!Re.hasOwnProperty(t.type))&&Re[t.type](t,e)}function ze(t,e){return 0===Ne(t,e)}function Be(t,e){for(var n,r,i,a=0,o=t.length;a<o;a++){if(0===(r=Ne(t[a],e)))return!0;if(a>0&&(i=Ne(t[a],t[a-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<u*i)return!0;n=r}return!1}function Le(t,e){return!!de(t.map(qe),Ie(e))}function qe(t){return(t=t.map(Ie)).pop(),t}function Ie(t){return[t[0]*d,t[1]*d]}function Ue(t,n,r){var i=e.range(t,n-o,r).concat(n);return function(t){return i.map(function(e){return[t,e]})}}function We(t,n,r){var i=e.range(t,n-o,r).concat(n);return function(t){return i.map(function(e){return[e,t]})}}function He(){var t,n,r,i,a,u,s,l,c,f,h,d,v=10,g=v,m=90,b=360,x=2.5;function _(){return{type:"MultiLineString",coordinates:w()}}function w(){return e.range(y(i/m)*m,r,m).map(h).concat(e.range(y(l/b)*b,s,b).map(d)).concat(e.range(y(n/v)*v,t,v).filter(function(t){return p(t%m)>o}).map(c)).concat(e.range(y(u/g)*g,a,g).filter(function(t){return p(t%b)>o}).map(f))}return _.lines=function(){return w().map(function(t){return{type:"LineString",coordinates:t}})},_.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(d(s).slice(1),h(r).reverse().slice(1),d(l).reverse().slice(1))]}},_.extent=function(t){return arguments.length?_.extentMajor(t).extentMinor(t):_.extentMinor()},_.extentMajor=function(t){return arguments.length?(i=+t[0][0],r=+t[1][0],l=+t[0][1],s=+t[1][1],i>r&&(t=i,i=r,r=t),l>s&&(t=l,l=s,s=t),_.precision(x)):[[i,l],[r,s]]},_.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],u=+e[0][1],a=+e[1][1],n>t&&(e=n,n=t,t=e),u>a&&(e=u,u=a,a=e),_.precision(x)):[[n,u],[t,a]]},_.step=function(t){return arguments.length?_.stepMajor(t).stepMinor(t):_.stepMinor()},_.stepMajor=function(t){return arguments.length?(m=+t[0],b=+t[1],_):[m,b]},_.stepMinor=function(t){return arguments.length?(v=+t[0],g=+t[1],_):[v,g]},_.precision=function(e){return arguments.length?(x=+e,c=Ue(u,a,90),f=We(n,t,x),h=Ue(l,s,90),d=We(i,r,x),_):x},_.extentMajor([[-180,-90+o],[180,90-o]]).extentMinor([[-180,-80-o],[180,80+o]])}function Ve(t){return t}var Ge,$e,Ye,Xe,Je=n(),Qe=n(),Ze={point:O,lineStart:O,lineEnd:O,polygonStart:function(){Ze.lineStart=Ke,Ze.lineEnd=nn},polygonEnd:function(){Ze.lineStart=Ze.lineEnd=Ze.point=O,Je.add(p(Qe)),Qe.reset()},result:function(){var t=Je/2;return Je.reset(),t}};function Ke(){Ze.point=tn}function tn(t,e){Ze.point=en,Ge=Ye=t,$e=Xe=e}function en(t,e){Qe.add(Xe*t-Ye*e),Ye=t,Xe=e}function nn(){en(Ge,$e)}var rn,an,on,un,sn=1/0,ln=sn,cn=-sn,fn=cn,hn={point:function(t,e){t<sn&&(sn=t),t>cn&&(cn=t),e<ln&&(ln=e),e>fn&&(fn=e)},lineStart:O,lineEnd:O,polygonStart:O,polygonEnd:O,result:function(){var t=[[sn,ln],[cn,fn]];return cn=fn=-(ln=sn=1/0),t}},dn=0,pn=0,vn=0,gn=0,mn=0,yn=0,bn=0,xn=0,_n=0,wn={point:kn,lineStart:An,lineEnd:Sn,polygonStart:function(){wn.lineStart=Cn,wn.lineEnd=On},polygonEnd:function(){wn.point=kn,wn.lineStart=An,wn.lineEnd=Sn},result:function(){var t=_n?[bn/_n,xn/_n]:yn?[gn/yn,mn/yn]:vn?[dn/vn,pn/vn]:[NaN,NaN];return dn=pn=vn=gn=mn=yn=bn=xn=_n=0,t}};function kn(t,e){dn+=t,pn+=e,++vn}function An(){wn.point=En}function En(t,e){wn.point=Mn,kn(on=t,un=e)}function Mn(t,e){var n=t-on,r=e-un,i=A(n*n+r*r);gn+=i*(on+t)/2,mn+=i*(un+e)/2,yn+=i,kn(on=t,un=e)}function Sn(){wn.point=kn}function Cn(){wn.point=Dn}function On(){Fn(rn,an)}function Dn(t,e){wn.point=Fn,kn(rn=on=t,an=un=e)}function Fn(t,e){var n=t-on,r=e-un,i=A(n*n+r*r);gn+=i*(on+t)/2,mn+=i*(un+e)/2,yn+=i,bn+=(i=un*t-on*e)*(on+t),xn+=i*(un+e),_n+=3*i,kn(on=t,un=e)}function Tn(t){this._context=t}Tn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,f)}},result:O};var Nn,jn,Rn,Pn,zn,Bn=n(),Ln={point:O,lineStart:function(){Ln.point=qn},lineEnd:function(){Nn&&In(jn,Rn),Ln.point=O},polygonStart:function(){Nn=!0},polygonEnd:function(){Nn=null},result:function(){var t=+Bn;return Bn.reset(),t}};function qn(t,e){Ln.point=In,jn=Pn=t,Rn=zn=e}function In(t,e){Pn-=t,zn-=e,Bn.add(A(Pn*Pn+zn*zn)),Pn=t,zn=e}function Un(){this._string=[]}function Wn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Hn(t){return function(e){var n=new Vn;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Vn(){}function Gn(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),R(n,t.stream(hn)),e(hn.result()),null!=r&&t.clipExtent(r),t}function $n(t,e,n){return Gn(t,function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,u=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,u])},n)}function Yn(t,e,n){return $n(t,[[0,0],e],n)}function Xn(t,e,n){return Gn(t,function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])},n)}function Jn(t,e,n){return Gn(t,function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])},n)}Un.prototype={_radius:4.5,_circle:Wn(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Wn(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Vn.prototype={constructor:Vn,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Qn=16,Zn=m(30*d);function Kn(t,e){return+e?function(t,e){function n(r,i,a,u,s,l,c,f,h,d,v,m,y,b){var x=c-r,_=f-i,w=x*x+_*_;if(w>4*e&&y--){var k=u+d,E=s+v,M=l+m,C=A(k*k+E*E+M*M),O=S(M/=C),D=p(p(M)-1)<o||p(a-h)<o?(a+h)/2:g(E,k),F=t(D,O),T=F[0],N=F[1],j=T-r,R=N-i,P=_*j-x*R;(P*P/w>e||p((x*j+_*R)/w-.5)>.3||u*d+s*v+l*m<Zn)&&(n(r,i,a,u,s,l,T,N,D,k/=C,E/=C,M,y,b),b.point(T,N),n(T,N,D,k,E,M,c,f,h,d,v,m,y,b))}}return function(e){var r,i,a,o,u,s,l,c,f,h,d,p,v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){e.polygonStart(),v.lineStart=x},polygonEnd:function(){e.polygonEnd(),v.lineStart=m}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function m(){c=NaN,v.point=y,e.lineStart()}function y(r,i){var a=X([r,i]),o=t(r,i);n(c,f,l,h,d,p,c=o[0],f=o[1],l=r,h=a[0],d=a[1],p=a[2],Qn,e),e.point(c,f)}function b(){v.point=g,e.lineEnd()}function x(){m(),v.point=_,v.lineEnd=w}function _(t,e){y(r=t,e),i=c,a=f,o=h,u=d,s=p,v.point=y}function w(){n(c,f,l,h,d,p,i,a,r,o,u,s,Qn,e),v.lineEnd=b,b()}return v}}(t,e):function(t){return Hn({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var tr=Hn({point:function(t,e){this.stream.point(t*d,e*d)}});function er(t,e,n){function r(r,i){return[e+t*r,n-t*i]}return r.invert=function(r,i){return[(r-e)/t,(n-i)/t]},r}function nr(t,e,n,r){var i=m(r),a=w(r),o=i*t,u=a*t,s=i/t,l=a/t,c=(a*n-i*e)/t,f=(a*e+i*n)/t;function h(t,r){return[o*t-u*r+e,n-u*t-o*r]}return h.invert=function(t,e){return[s*t-l*e+c,f-l*t-s*e]},h}function rr(t){return ir(function(){return t})()}function ir(t){var e,n,r,i,a,o,u,s,l,c,f=150,p=480,v=250,g=0,m=0,y=0,b=0,x=0,_=0,w=null,k=me,E=null,M=Ve,S=.5;function C(t){return s(t[0]*d,t[1]*d)}function O(t){return(t=s.invert(t[0],t[1]))&&[t[0]*h,t[1]*h]}function D(){var t=nr(f,0,0,_).apply(null,e(g,m)),r=(_?nr:er)(f,p-t[0],v-t[1],_);return n=Kt(y,b,x),u=Qt(e,r),s=Qt(n,u),o=Kn(u,S),F()}function F(){return l=c=null,C}return C.stream=function(t){return l&&c===t?l:l=tr(function(t){return Hn({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(o(M(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,w=void 0,F()):k},C.postclip=function(t){return arguments.length?(M=t,E=r=i=a=null,F()):M},C.clipAngle=function(t){return arguments.length?(k=+t?ye(w=t*d):(w=null,me),F()):w*h},C.clipExtent=function(t){return arguments.length?(M=null==t?(E=r=i=a=null,Ve):_e(E=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),F()):null==E?null:[[E,r],[i,a]]},C.scale=function(t){return arguments.length?(f=+t,D()):f},C.translate=function(t){return arguments.length?(p=+t[0],v=+t[1],D()):[p,v]},C.center=function(t){return arguments.length?(g=t[0]%360*d,m=t[1]%360*d,D()):[g*h,m*h]},C.rotate=function(t){return arguments.length?(y=t[0]%360*d,b=t[1]%360*d,x=t.length>2?t[2]%360*d:0,D()):[y*h,b*h,x*h]},C.angle=function(t){return arguments.length?(_=t%360*d,D()):_*h},C.precision=function(t){return arguments.length?(o=Kn(u,S=t*t),F()):A(S)},C.fitExtent=function(t,e){return $n(C,t,e)},C.fitSize=function(t,e){return Yn(C,t,e)},C.fitWidth=function(t,e){return Xn(C,t,e)},C.fitHeight=function(t,e){return Jn(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&O,D()}}function ar(t){var e=0,n=s/3,r=ir(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*d,n=t[1]*d):[e*h,n*h]},i}function or(t,e){var n=w(t),r=(n+w(e))/2;if(p(r)<o)return function(t){var e=m(t);function n(t,n){return[t*e,w(n)/e]}return n.invert=function(t,n){return[t/e,S(n*e)]},n}(t);var i=1+n*(2*r-n),a=A(i)/r;function u(t,e){var n=A(i-2*r*w(e))/r;return[n*w(t*=r),a-n*m(t)]}return u.invert=function(t,e){var n=a-e;return[g(t,p(n))/r*k(n),S((i-(t*t+n*n)*r*r)/(2*r))]},u}function ur(){return ar(or).scale(155.424).center([0,33.6442])}function sr(){return ur().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function lr(t){return function(e,n){var r=m(e),i=m(n),a=t(r*i);return[a*i*w(e),a*w(n)]}}function cr(t){return function(e,n){var r=A(e*e+n*n),i=t(r),a=w(i),o=m(i);return[g(e*a,r*o),S(r&&n*a/r)]}}var fr=lr(function(t){return A(2/(1+t))});fr.invert=cr(function(t){return 2*S(t/2)});var hr=lr(function(t){return(t=M(t))&&t/w(t)});function dr(t,e){return[t,x(E((l+e)/2))]}function pr(t){var e,n,r,i=rr(t),a=i.center,o=i.scale,u=i.translate,l=i.clipExtent,c=null;function f(){var a=s*o(),u=i(re(i.rotate()).invert([0,0]));return l(null==c?[[u[0]-a,u[1]-a],[u[0]+a,u[1]+a]]:t===dr?[[Math.max(u[0]-a,c),e],[Math.min(u[0]+a,n),r]]:[[c,Math.max(u[1]-a,e)],[n,Math.min(u[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),f()):o()},i.translate=function(t){return arguments.length?(u(t),f()):u()},i.center=function(t){return arguments.length?(a(t),f()):a()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),f()):null==c?null:[[c,e],[n,r]]},f()}function vr(t){return E((l+t)/2)}function gr(t,e){var n=m(t),r=t===e?w(t):x(n/m(e))/x(vr(e)/vr(t)),i=n*_(vr(t),r)/r;if(!r)return dr;function a(t,e){i>0?e<-l+o&&(e=-l+o):e>l-o&&(e=l-o);var n=i/_(vr(e),r);return[n*w(r*t),i-n*m(r*t)]}return a.invert=function(t,e){var n=i-e,a=k(r)*A(t*t+n*n);return[g(t,p(n))/r*k(n),2*v(_(i/a,1/r))-l]},a}function mr(t,e){return[t,e]}function yr(t,e){var n=m(t),r=t===e?w(t):(n-m(e))/(e-t),i=n/r+t;if(p(r)<o)return mr;function a(t,e){var n=i-e,a=r*t;return[n*w(a),i-n*m(a)]}return a.invert=function(t,e){var n=i-e;return[g(t,p(n))/r*k(n),i-k(r)*A(t*t+n*n)]},a}hr.invert=cr(function(t){return t}),dr.invert=function(t,e){return[t,2*v(b(e))-l]},mr.invert=mr;var br=1.340264,xr=-.081106,_r=893e-6,wr=.003796,kr=A(3)/2;function Ar(t,e){var n=S(kr*w(e)),r=n*n,i=r*r*r;return[t*m(n)/(kr*(br+3*xr*r+i*(7*_r+9*wr*r))),n*(br+xr*r+i*(_r+wr*r))]}function Er(t,e){var n=m(e),r=m(t)*n;return[n*w(t)/r,w(e)/r]}function Mr(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?Ve:Hn({point:function(i,a){this.stream.point(i*t+n,a*e+r)}})}function Sr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Cr(t,e){return[m(e)*w(t),w(e)]}function Or(t,e){var n=m(e),r=1+m(t)*n;return[n*w(t)/r,w(e)/r]}function Dr(t,e){return[x(E((l+e)/2)),-t]}Ar.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(br+xr*i+a*(_r+wr*i))-e)/(br+3*xr*i+a*(7*_r+9*wr*i)))*r)*i*i,!(p(n)<u));++o);return[kr*t*(br+3*xr*i+a*(7*_r+9*wr*i))/m(r),S(w(r)/kr)]},Er.invert=cr(v),Sr.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,u=a*a;r-=n=(r*(1.007226+a*(.015085+u*(.028874*a-.044475-.005916*u)))-e)/(1.007226+a*(.045255+u*(.259866*a-.311325-.005916*11*u)))}while(p(n)>o&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},Cr.invert=cr(S),Or.invert=cr(function(t){return 2*v(t)}),Dr.invert=function(t,e){return[-e,2*v(b(t))-l]},t.geoAlbers=sr,t.geoAlbersUsa=function(){var t,e,n,r,i,a,u=sr(),s=ur().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=ur().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){a=[t,e]}};function f(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,f}return f.invert=function(t){var e=u.scale(),n=u.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:u).invert(t)},f.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([u.stream(e=n),s.stream(n),l.stream(n)])},f.precision=function(t){return arguments.length?(u.precision(t),s.precision(t),l.precision(t),h()):u.precision()},f.scale=function(t){return arguments.length?(u.scale(t),s.scale(.35*t),l.scale(t),f.translate(u.translate())):u.scale()},f.translate=function(t){if(!arguments.length)return u.translate();var e=u.scale(),a=+t[0],f=+t[1];return n=u.translate(t).clipExtent([[a-.455*e,f-.238*e],[a+.455*e,f+.238*e]]).stream(c),r=s.translate([a-.307*e,f+.201*e]).clipExtent([[a-.425*e+o,f+.12*e+o],[a-.214*e-o,f+.234*e-o]]).stream(c),i=l.translate([a-.205*e,f+.212*e]).clipExtent([[a-.214*e+o,f+.166*e+o],[a-.115*e-o,f+.234*e-o]]).stream(c),h()},f.fitExtent=function(t,e){return $n(f,t,e)},f.fitSize=function(t,e){return Yn(f,t,e)},f.fitWidth=function(t,e){return Xn(f,t,e)},f.fitHeight=function(t,e){return Jn(f,t,e)},f.scale(1070)},t.geoArea=function(t){return U.reset(),R(t,W),2*U},t.geoAzimuthalEqualArea=function(){return rr(fr).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=fr,t.geoAzimuthalEquidistant=function(){return rr(hr).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=hr,t.geoBounds=function(t){var e,n,r,i,a,o,u;if(it=rt=-(et=nt=1/0),lt=[],R(t,Ct),n=lt.length){for(lt.sort(zt),e=1,a=[r=lt[0]];e<n;++e)Bt(r,(i=lt[e])[0])||Bt(r,i[1])?(Pt(r[0],i[1])>Pt(r[0],r[1])&&(r[1]=i[1]),Pt(i[0],r[1])>Pt(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(u=Pt(r[1],i[0]))>o&&(o=u,et=i[0],rt=r[1])}return lt=ct=null,et===1/0||nt===1/0?[[NaN,NaN],[NaN,NaN]]:[[et,nt],[rt,it]]},t.geoCentroid=function(t){ft=ht=dt=pt=vt=gt=mt=yt=bt=xt=_t=0,R(t,Lt);var e=bt,n=xt,r=_t,i=e*e+n*n+r*r;return i<u&&(e=gt,n=mt,r=yt,ht<o&&(e=dt,n=pt,r=vt),(i=e*e+n*n+r*r)<u)?[NaN,NaN]:[g(n,e)*h,S(r/A(i))*h]},t.geoCircle=function(){var t,e,n=Jt([0,0]),r=Jt(90),i=Jt(6),a={point:function(n,r){t.push(n=e(n,r)),n[0]*=h,n[1]*=h}};function o(){var o=n.apply(this,arguments),u=r.apply(this,arguments)*d,s=i.apply(this,arguments)*d;return t=[],e=Kt(-o[0]*d,-o[1]*d,0).invert,ie(a,u,s,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"===typeof t?t:Jt([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(r="function"===typeof t?t:Jt(+t),o):r},o.precision=function(t){return arguments.length?(i="function"===typeof t?t:Jt(+t),o):i},o},t.geoClipAntimeridian=me,t.geoClipCircle=ye,t.geoClipExtent=function(){var t,e,n,r=0,i=0,a=960,o=500;return n={stream:function(n){return t&&e===n?t:t=_e(r,i,a,o)(e=n)},extent:function(u){return arguments.length?(r=+u[0][0],i=+u[0][1],a=+u[1][0],o=+u[1][1],t=e=null,n):[[r,i],[a,o]]}}},t.geoClipRectangle=_e,t.geoConicConformal=function(){return ar(gr).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=gr,t.geoConicEqualArea=ur,t.geoConicEqualAreaRaw=or,t.geoConicEquidistant=function(){return ar(yr).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=yr,t.geoContains=function(t,e){return(t&&je.hasOwnProperty(t.type)?je[t.type]:Pe)(t,e)},t.geoDistance=Ne,t.geoEqualEarth=function(){return rr(Ar).scale(177.158)},t.geoEqualEarthRaw=Ar,t.geoEquirectangular=function(){return rr(mr).scale(152.63)},t.geoEquirectangularRaw=mr,t.geoGnomonic=function(){return rr(Er).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Er,t.geoGraticule=He,t.geoGraticule10=function(){return He()()},t.geoIdentity=function(){var t,e,n,r,i,a,o=1,u=0,s=0,l=1,c=1,f=Ve,h=null,d=Ve;function p(){return r=i=null,a}return a={stream:function(t){return r&&i===t?r:r=f(d(i=t))},postclip:function(r){return arguments.length?(d=r,h=t=e=n=null,p()):d},clipExtent:function(r){return arguments.length?(d=null==r?(h=t=e=n=null,Ve):_e(h=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),p()):null==h?null:[[h,t],[e,n]]},scale:function(t){return arguments.length?(f=Mr((o=+t)*l,o*c,u,s),p()):o},translate:function(t){return arguments.length?(f=Mr(o*l,o*c,u=+t[0],s=+t[1]),p()):[u,s]},reflectX:function(t){return arguments.length?(f=Mr(o*(l=t?-1:1),o*c,u,s),p()):l<0},reflectY:function(t){return arguments.length?(f=Mr(o*l,o*(c=t?-1:1),u,s),p()):c<0},fitExtent:function(t,e){return $n(a,t,e)},fitSize:function(t,e){return Yn(a,t,e)},fitWidth:function(t,e){return Xn(a,t,e)},fitHeight:function(t,e){return Jn(a,t,e)}}},t.geoInterpolate=function(t,e){var n=t[0]*d,r=t[1]*d,i=e[0]*d,a=e[1]*d,o=m(r),u=w(r),s=m(a),l=w(a),c=o*m(n),f=o*w(n),p=s*m(i),v=s*w(i),y=2*S(A(C(a-r)+o*s*C(i-n))),b=w(y),x=y?function(t){var e=w(t*=y)/b,n=w(y-t)/b,r=n*c+e*p,i=n*f+e*v,a=n*u+e*l;return[g(i,r)*h,g(a,A(r*r+i*i))*h]}:function(){return[n*h,r*h]};return x.distance=y,x},t.geoLength=De,t.geoMercator=function(){return pr(dr).scale(961/f)},t.geoMercatorRaw=dr,t.geoNaturalEarth1=function(){return rr(Sr).scale(175.295)},t.geoNaturalEarth1Raw=Sr,t.geoOrthographic=function(){return rr(Cr).scale(249.5).clipAngle(90+o)},t.geoOrthographicRaw=Cr,t.geoPath=function(t,e){var n,r,i=4.5;function a(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),R(t,n(r))),r.result()}return a.area=function(t){return R(t,n(Ze)),Ze.result()},a.measure=function(t){return R(t,n(Ln)),Ln.result()},a.bounds=function(t){return R(t,n(hn)),hn.result()},a.centroid=function(t){return R(t,n(wn)),wn.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,Ve):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new Un):new Tn(e=t),"function"!==typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)},t.geoProjection=rr,t.geoProjectionMutator=ir,t.geoRotation=re,t.geoStereographic=function(){return rr(Or).scale(250).clipAngle(142)},t.geoStereographicRaw=Or,t.geoStream=R,t.geoTransform=function(t){return{stream:Hn(t)}},t.geoTransverseMercator=function(){var t=pr(Dr),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Dr,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(2123))},1341:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4,k=function(t){return"__proto__"!==t};function A(t,e,n,r){var i,u;if(k(e))if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):k(i)&&(u[i]=n[i]);else t[e]=n}function E(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function M(t){return t[t.length-1]}function S(t){return null==t||""===t?null:+t}function C(t){return function(e){return t*Math.exp(e)}}function O(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function F(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function T(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function N(t,e,n,r){var i=n(t[0]),a=n(M(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function j(t,e,n,r,i){var a=r(t[0]),o=r(M(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function R(t){return null!=t?a(t)?t:[t]:[]}function P(t){return"function"===typeof t}var z=Object.prototype.hasOwnProperty;function B(t,e){return z.call(t,e)}var L={};function q(t){return"[object Date]"===Object.prototype.toString.call(t)}function I(t){return"number"===typeof t}var U=1e4;function W(t,e){for(var n="";--e>=0;)n+=t;return n}function H(t){return I(t)?t:q(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=R,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=R(t)).map(function(t,e){return null==t?null:(v.push(e),P(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=R(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)P(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return P(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return P(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return B(r,t)&&r[t]!==L}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===L&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=L),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===L||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=M(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=B,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=q,t.isFunction=P,t.isNumber=I,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?R(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):R(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=M(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.lruCache=function(t){var e,n,r;t=+t||U;var i=function(){e={},n={},r=0},a=function(i,a){return++r>t&&(n=e,e={},r=1),e[i]=a};return i(),{clear:i,has:function(t){return B(e,t)||B(n,t)},get:function(t){return B(e,t)?e[t]:B(n,t)?a(t,n[t]):void 0},set:function(t,n){return B(e,t)?e[t]=n:a(t,n)}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=E(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?W(i,o)+a:"center"===r?W(i,~~(o/2))+a+W(i,Math.ceil(o/2)):a+W(i,o)},t.panLinear=function(t,e){return N(t,e,S,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return N(t,e,O(n),C(n))},t.panPow=function(t,e,n){return N(t,e,T(n),T(1/n))},t.panSymlog=function(t,e,n){return N(t,e,D(n),F(n))},t.peek=M,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=W,t.span=function(t){return t&&M(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||H,null==t||""===t?null:e(t)},t.toNumber=S,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=A,t.zero=d,t.zoomLinear=function(t,e,n){return j(t,e,n,S,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return j(t,e,n,O(r),C(r))},t.zoomPow=function(t,e,n,r){return j(t,e,n,T(r),T(1/r))},t.zoomSymlog=function(t,e,n,r){return j(t,e,n,D(r),F(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},1342:function(t,e,n){!function(t){"use strict";function e(t){return t}function n(t){if(null==t)return e;var n,r,i=t.scale[0],a=t.scale[1],o=t.translate[0],u=t.translate[1];return function(t,e){e||(n=r=0);var s=2,l=t.length,c=new Array(l);for(c[0]=(n+=t[0])*i+o,c[1]=(r+=t[1])*a+u;s<l;)c[s]=t[s],++s;return c}}function r(t){var e,r=n(t.transform),i=1/0,a=i,o=-i,u=-i;function s(t){(t=r(t))[0]<i&&(i=t[0]),t[0]>o&&(o=t[0]),t[1]<a&&(a=t[1]),t[1]>u&&(u=t[1])}function l(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(l);break;case"Point":s(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(s)}}for(e in t.arcs.forEach(function(t){for(var e,n=-1,s=t.length;++n<s;)(e=r(t[n],n))[0]<i&&(i=e[0]),e[0]>o&&(o=e[0]),e[1]<a&&(a=e[1]),e[1]>u&&(u=e[1])}),t.objects)l(t.objects[e]);return[i,a,o,u]}function i(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=a(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function a(t,e){var r=n(t.transform),i=t.arcs;function a(t,e){e.length&&e.pop();for(var n=i[t<0?~t:t],a=0,o=n.length;a<o;++a)e.push(r(n[a],a));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,o)}function o(t){return r(t)}function u(t){for(var e=[],n=0,r=t.length;n<r;++n)a(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=u(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=u(e.arcs);break;case"MultiLineString":n=e.arcs.map(u);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function o(t,e){var n={},r={},i={},a=[],o=-1;function u(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){n[t<0?~t:t]=1}),a.push(i)}}return e.forEach(function(n,r){var i,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(i=e[++o],e[o]=n,e[r]=i)}),e.forEach(function(e){var n,a,o=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),u=o[0],s=o[1];if(n=i[u])if(delete i[n.end],n.push(e),n.end=s,a=r[s]){delete r[a.start];var l=a===n?n:n.concat(a);r[l.start=n.start]=i[l.end=a.end]=l}else r[n.start]=i[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(e),n.start=u,a=i[u]){delete i[a.end];var c=a===n?n:a.concat(n);r[c.start=a.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=u]=i[n.end=s]=n}),u(i,r),u(r,i),e.forEach(function(t){n[t<0?~t:t]||a.push([t])}),a}function u(t,e,n){var r,i,a;if(arguments.length>1)r=function(t,e,n){var r,i=[],a=[];function o(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:r})}function u(t){t.forEach(o)}function s(t){t.forEach(u)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":u(e.arcs);break;case"MultiLineString":case"Polygon":s(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(s)}(e.arcs)}}(e),a.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(a=t.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:o(t,r)}}function s(t,e){var n={},r=[],i=[];function u(t){t.forEach(function(e){e.forEach(function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)})}),r.push(t)}function s(e){return function(t){for(var e,n=-1,r=t.length,i=t[r-1],a=0;++n<r;)e=i,i=t[n],a+=e[0]*i[1]-e[1]*i[0];return Math.abs(a)}(a(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":u(e.arcs);break;case"MultiPolygon":e.arcs.forEach(u)}}),r.forEach(function(t){if(!t._){var e=[],r=[t];for(t._=1,i.push(e);t=r.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),r.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:i.map(function(e){var r,i=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].length<2&&i.push(t)})})}),(r=(i=o(t,i)).length)>1)for(var a,u,l=1,c=s(i[0]);l<r;++l)(a=s(i[l]))>c&&(u=i[0],i[0]=i[l],i[l]=u,c=a);return i}).filter(function(t){return t.length>0})}}function l(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;t[i]<e?n=i+1:r=i}return n}function c(t){if(null==t)return e;var n,r,i=t.scale[0],a=t.scale[1],o=t.translate[0],u=t.translate[1];return function(t,e){e||(n=r=0);var s=2,l=t.length,c=new Array(l),f=Math.round((t[0]-o)/i),h=Math.round((t[1]-u)/a);for(c[0]=f-n,n=f,c[1]=h-r,r=h;s<l;)c[s]=t[s],++s;return c}}t.bbox=r,t.feature=function(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return i(t,e)})}:i(t,e)},t.merge=function(t){return a(t,s.apply(this,arguments))},t.mergeArcs=s,t.mesh=function(t){return a(t,u.apply(this,arguments))},t.meshArcs=u,t.neighbors=function(t){var e={},n=t.map(function(){return[]});function r(t,n){t.forEach(function(t){t<0&&(t=~t);var r=e[t];r?r.push(n):e[t]=[n]})}function i(t,e){t.forEach(function(t){r(t,e)})}var a={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(t,e){t.forEach(function(t){i(t,e)})}};for(var o in t.forEach(function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,n)}):e.type in a&&a[e.type](e.arcs,n)}),e)for(var u=e[o],s=u.length,c=0;c<s;++c)for(var f=c+1;f<s;++f){var h,d=u[c],p=u[f];(h=n[d])[o=l(h,p)]!==p&&h.splice(o,0,p),(h=n[p])[o=l(h,d)]!==d&&h.splice(o,0,d)}return n},t.quantize=function(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)s=t.bbox;else{if(!((n=Math.floor(e))>=2))throw new Error("n must be \u22652");var n,i=(s=t.bbox||r(t))[0],a=s[1],o=s[2],u=s[3];e={scale:[o-i?(o-i)/(n-1):1,u-a?(u-a)/(n-1):1],translate:[i,a]}}var s,l,f=c(e),h=t.objects,d={};function p(t){return f(t)}function v(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(v)};break;case"Point":e={type:"Point",coordinates:p(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(p)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(l in h)d[l]=v(h[l]);return{type:"Topology",bbox:s,transform:e,objects:d,arcs:t.arcs.map(function(t){var e,n=0,r=1,i=t.length,a=new Array(i);for(a[0]=f(t[0],0);++n<i;)((e=f(t[n],n))[0]||e[1])&&(a[r++]=e);return 1===r&&(a[r++]=[0,0]),a.length=r,a})}},t.transform=n,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})}(e)},1343:function(t,e,n){var r=n(212),i=n(19);!function(t,e){"use strict";var n=i.mark(a);function a(t,e){var r,a,o,u,s,l,c,f,h,d,p,v,g;return i.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=30;break}r=!0,a=!1,o=void 0,n.prev=4,u=t[Symbol.iterator]();case 6:if(r=(s=u.next()).done){n.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){n.next=11;break}return n.next=11,l;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),a=!0,o=n.t0;case 20:n.prev=20,n.prev=21,r||null==u.return||u.return();case 23:if(n.prev=23,!a){n.next=26;break}throw o;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:c=-1,f=!0,h=!1,d=void 0,n.prev=34,p=t[Symbol.iterator]();case 36:if(f=(v=p.next()).done){n.next=44;break}if(g=v.value,!(null!=(g=e(g,++c,t))&&(g=+g)>=g)){n.next=41;break}return n.next=41,g;case 41:f=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),h=!0,d=n.t1;case 50:n.prev=50,n.prev=51,f||null==p.return||p.return();case 53:if(n.prev=53,!h){n.next=56;break}throw d;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function o(t,n,r){var i=Float64Array.from(a(t,r));return i.sort(e.ascending),n.map(function(t){return e.quantileSorted(i,t)})}function u(t,e){return o(t,[.25,.5,.75],e)}function s(t,n){var r=t.length,i=e.deviation(t,n),a=u(t,n),o=(a[2]-a[0])/1.34;return 1.06*(i=Math.min(i,o)||i||Math.abs(a[0])||1)*Math.pow(r,-.2)}t.random=Math.random;var l=Math.sqrt(2*Math.PI),c=Math.SQRT2,f=NaN;function h(e,n){e=e||0,n=null==n?1:n;var r,i,a=0,o=0;if(f===f)a=f,f=NaN;else{do{r=(a=2*t.random()-1)*a+(o=2*t.random()-1)*o}while(0===r||r>1);a*=i=Math.sqrt(-2*Math.log(r)/r),f=o*i}return e+a*n}function d(t,e,n){var r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*l)}function p(t,e,n){var r,i=(t-(e=e||0))/(n=null==n?1:n),a=Math.abs(i);if(a>37)r=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(r=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),r/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):r=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-r:r}function v(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*c*function(t){var e,n=-Math.log((1-t)*(1+t));return n<6.25?e=1.6536545626831027+(e=.24015818242558962+(e=(e=(e=.00018673420803405714+(e=(e=(e=4.2347877827932404e-7+(e=(e=(e=1.0512122733215323e-9+(e=(e=(e=26335093153082323e-28+(e=(e=(e=6637638134358324e-30+(e=20972767875968562e-33+(e=(e=11157877678025181e-33+(e=128584807152564e-32+(e=(e=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?(n=Math.sqrt(n)-3.25,e=3.0838856104922208+(e=1.0052589676941592+(e=.005370914553590064+(e=(e=.002491442096107851+(e=(e=.0009532893797373805+(e=(e=24031110387097894e-21+(e=6828485145957318e-20+(e=(e=12475304481671779e-21+(e=29234449089955446e-22+(e=(e=15027403968909828e-22+(e=1.8239629214389228e-8+(e=(e=9.075656193888539e-8+(e=2.2137376921775787e-9)*n)*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=4.849906401408584+(e=1.0103004648645344+(e=(e=(e=7599527703001776e-20+(e=(e=4526062597223154e-21+(e=(e=2.2900482228026655e-7+(e=(e=2.914795345090108e-8+(e=(e=7.61570120807834e-9+(e=(e=1.5076572693500548e-9+(e=(e=-27109920616438573e-27)*n-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n):e=1/0,e*t}(2*t-1)}function g(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return h(n,r)},pdf:function(t){return d(t,n,r)},cdf:function(t){return p(t,n,r)},icdf:function(t){return v(t,n,r)}};return i.mean(t).stdev(e)}function m(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+h()*e)}function y(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;var r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*l*t)}function b(t,e,n){return p(Math.log(t),e,n)}function x(t,e,n){return Math.exp(v(t,e,n))}function _(e,n){return null==n&&(n=null==e?1:e,e=0),e+(n-e)*t.random()}function w(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function k(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function A(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function E(t,e,n,r){var i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function M(t,e,n,r){t=t.filter(function(t){var r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort(function(t,n){return e(t)-e(n)});var i,a,o,u=t.length,s=new Float64Array(u),l=new Float64Array(u),c=0,f=0,h=0,d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)o=g.value,s[c]=i=+e(o),l[c]=a=+n(o),f+=(i-f)/++c,h+=(a-h)/c}catch(y){p=!0,v=y}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}for(c=0;c<u;++c)s[c]-=f,l[c]-=h;return[s,l,f,h]}function S(t,e,n,r){var i,a,o=-1,u=!0,s=!1,l=void 0;try{for(var c,f=t[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;i=e(h),a=n(h),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}}catch(d){s=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}function C(t,e,n,r,i){var a=0,o=0;return S(t,e,n,function(t,e){var n=e-i(t),u=e-r;a+=n*n,o+=u*u}),1-a/o}function O(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){r+=(t-r)/++u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*t};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}}function D(t,e,n){var i,a,o,u,s=M(t,e,n),l=r(s,4),c=l[0],f=l[1],h=l[2],d=l[3],p=c.length,v=0,g=0,m=0,y=0,b=0;for(i=0;i<p;)a=c[i],o=f[i++],v+=((u=a*a)-v)/i,g+=(u*a-g)/i,m+=(u*u-m)/i,y+=(a*o-y)/i,b+=(u*o-b)/i;var x=m-v*v,_=v*x-g*g,w=(b*v-y*g)/_,k=(y*x-b*g)/_,A=-w*v,E=function(t){return w*(t-=h)*t+k*t+A+d};return{coef:[A-k*h+w*h*h+d,k-2*w*h,w],predict:E,rSquared:C(t,e,n,d,E)}}function F(t,e,n,r){var i,a,o,u,s=Array(t);for(i=0;i<t;++i)s[i]=0;for(i=t-1;i>=0;--i)for(o=e[i],u=1,s[i]+=o,a=1;a<=i;++a)u*=(i+1-a)/a,s[i-a]+=o*Math.pow(n,a)*u;return s[0]+=r,s}var T=2,N=1e-12;function j(t){return(t=1-t*t*t)*t*t}function R(t,e,n){var r=t[e],i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}var P=.1*Math.PI/180;function z(t,e,n){var r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}t.bandwidthNRD=s,t.bin=function(t){var e,n,r,i,a,o,u,s,l=t.maxbins||20,c=t.base||10,f=Math.log(c),h=t.divide||[5,2],d=t.extent[0],p=t.extent[1],v=t.span||p-d||Math.abs(d)||1;if(t.step)e=t.step;else if(t.steps){for(a=v/l,o=0,u=t.steps.length;o<u&&t.steps[o]<a;++o);e=t.steps[Math.max(0,o-1)]}else{for(n=Math.ceil(Math.log(l)/f),r=t.minstep||0,e=Math.max(r,Math.pow(c,Math.round(Math.log(v)/f)-n));Math.ceil(v/e)>l;)e*=c;for(o=0,u=h.length;o<u;++o)(a=e/h[o])>=r&&v/a<=l&&(e=a)}return i=(a=Math.log(e))>=0?0:1+~~(-a/f),s=Math.pow(c,-i-1),(t.nice||void 0===t.nice)&&(d=d<(a=Math.floor(d/e+s)*e)?a-e:a,p=Math.ceil(p/e)*e),{start:d,stop:p===d?d+e:p,step:e}},t.bootstrapCI=function(n,r,i,o){if(!n.length)return[void 0,void 0];var u,s,l,c,f=Float64Array.from(a(n,o)),h=f.length,d=r;for(l=0,c=Array(d);l<d;++l){for(u=0,s=0;s<h;++s)u+=f[~~(t.random()*h)];c[l]=u/h}return c.sort(e.ascending),[e.quantile(c,i/2),e.quantile(c,1-i/2)]},t.cumulativeLogNormal=b,t.cumulativeNormal=p,t.cumulativeUniform=k,t.densityLogNormal=y,t.densityNormal=d,t.densityUniform=w,t.dotbin=function(t,e,n,r){r=r||function(t){return t};for(var i,a=0,o=1,u=t.length,s=new Float64Array(u),l=r(t[0]),c=l,f=l+e;o<u;++o){if((i=r(t[o]))>=f){for(c=(l+c)/2;a<o;++a)s[a]=c;f=i+e,l=i}c=i}for(c=(l+c)/2;a<o;++a)s[a]=c;return n?function(t,e){for(var n,r,i=t.length,a=0,o=1;t[a]===t[o];)++o;for(;o<i;){for(n=o+1;t[o]===t[n];)++n;if(t[o]-t[o-1]<e){for(r=o+(a+n-o-o>>1);r<o;)t[r++]=t[o];for(;r>o;)t[r--]=t[a]}a=o,o=n}return t}(s,e+e/4):s},t.quantileLogNormal=x,t.quantileNormal=v,t.quantileUniform=A,t.quantiles=o,t.quartiles=u,t.randomInteger=function(e,n){null==n&&(n=e,e=0);var r,i,a,o={min:function(t){return arguments.length?(a=i-(r=t||0),o):r},max:function(t){return arguments.length?(a=(i=t||0)-r,o):i},sample:function(){return r+Math.floor(a*t.random())},pdf:function(t){return t===Math.floor(t)&&t>=r&&t<i?1/a:0},cdf:function(t){var e=Math.floor(t);return e<r?0:e>=i?1:(e-r+1)/a},icdf:function(t){return t>=0&&t<=1?r-1+Math.floor(t*a):NaN}};return o.min(e).max(n)},t.randomKDE=function(e,n){var r=g(),i={},a=0;return i.data=function(t){return arguments.length?(e=t,a=t?t.length:0,i.bandwidth(n)):e},i.bandwidth=function(t){return arguments.length?(!(n=t)&&e&&(n=s(e)),i):n},i.sample=function(){return e[~~(t.random()*a)]+n*r.sample()},i.pdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.pdf((t-e[o])/n);return i/n/a},i.cdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.cdf((t-e[o])/n);return i/a},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)},t.randomLCG=function(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}},t.randomLogNormal=function(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return m(n,r)},pdf:function(t){return y(t,n,r)},cdf:function(t){return b(t,n,r)},icdf:function(t){return x(t,n,r)}};return i.mean(t).stdev(e)},t.randomMixture=function(e,n){var r,i={},a=0;function o(t){var e,n=[],r=0;for(e=0;e<a;++e)r+=n[e]=null==t[e]?1:+t[e];for(e=0;e<a;++e)n[e]/=r;return n}return i.weights=function(t){return arguments.length?(r=o(n=t||[]),i):n},i.distributions=function(t){return arguments.length?(t?(a=t.length,e=t):(a=0,e=[]),i.weights(n)):e},i.sample=function(){for(var n=t.random(),i=e[a-1],o=r[0],u=0;u<a-1;o+=r[++u])if(n<o){i=e[u];break}return i.sample()},i.pdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].pdf(t);return n},i.cdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].cdf(t);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(n)},t.randomNormal=g,t.randomUniform=function(t,e){var n,r,i={min:function(t){return arguments.length?(n=t||0,i):n},max:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return _(n,r)},pdf:function(t){return w(t,n,r)},cdf:function(t){return k(t,n,r)},icdf:function(t){return A(t,n,r)}};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)},t.regressionExp=function(t,e,n){var r=0,i=0,a=0,o=0,u=0,s=0;S(t,e,n,function(t,e){var n=Math.log(e),l=t*e;r+=(e-r)/++s,a+=(l-a)/s,u+=(t*l-u)/s,i+=(e*n-i)/s,o+=(l*n-o)/s});var l=E(a/r,i/r,o/r,u/r),c=function(t){return l[0]*Math.exp(l[1]*t)};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:C(t,e,n,r,c)}},t.regressionLinear=O,t.regressionLoess=function(t,n,i,a){for(var o=M(t,n,i,!0),u=r(o,4),s=u[0],l=u[1],c=u[2],f=u[3],h=s.length,d=Math.max(2,~~(a*h)),p=new Float64Array(h),v=new Float64Array(h),g=new Float64Array(h).fill(1),m=-1;++m<=T;){for(var y=[0,d-1],b=0;b<h;++b){for(var x=s[b],_=y[0],w=y[1],k=x-s[_]>s[w]-x?_:w,A=0,S=0,C=0,O=0,D=0,F=1/Math.abs(s[k]-x||1),P=_;P<=w;++P){var z=s[P],B=l[P],L=j(Math.abs(x-z)*F)*g[P],q=z*L;A+=L,S+=q,C+=B*L,O+=B*q,D+=z*q}var I=E(S/A,C/A,O/A,D/A),U=r(I,2),W=U[0],H=U[1];p[b]=W+H*x,v[b]=Math.abs(l[b]-p[b]),R(s,b+1,y)}if(m===T)break;var V=e.median(v);if(Math.abs(V)<N)break;for(var G,$,Y=0;Y<h;++Y)G=v[Y]/(6*V),g[Y]=G>=1?N:($=1-G*G)*$}return function(t,e,n,r){for(var i,a=t.length,o=[],u=0,s=0,l=[];u<a;++u)i=t[u]+n,l[0]===i?l[1]+=(e[u]-l[1])/++s:(s=0,l[1]+=r,l=[i,e[u]],o.push(l));return l[1]+=r,o}(s,p,c,f)},t.regressionLog=function(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){++u,t=Math.log(t),r+=(t-r)/u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*Math.log(t)};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}},t.regressionPoly=function(t,e,n,i){if(1===i)return O(t,e,n);if(2===i)return D(t,e,n);var a,o,u,s,l,c=M(t,e,n),f=r(c,4),h=f[0],d=f[1],p=f[2],v=f[3],g=h.length,m=[],y=[],b=i+1;for(a=0;a<b;++a){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a)*d[u];for(m.push(s),l=new Float64Array(b),o=0;o<b;++o){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a+o);l[o]=s}y.push(l)}y.push(m);var x=function(t){var e,n,r,i,a,o=t.length-1,u=[];for(e=0;e<o;++e){for(i=e,n=e+1;n<o;++n)Math.abs(t[e][n])>Math.abs(t[e][i])&&(i=n);for(r=e;r<o+1;++r)a=t[r][e],t[r][e]=t[r][i],t[r][i]=a;for(n=e+1;n<o;++n)for(r=o;r>=e;r--)t[r][n]-=t[r][e]*t[e][n]/t[e][e]}for(n=o-1;n>=0;--n){for(a=0,r=n+1;r<o;++r)a+=t[r][n]*u[r];u[n]=(t[o][n]-a)/t[n][n]}return u}(y),_=function(t){t-=p;var e=v+x[0]+x[1]*t+x[2]*t*t;for(a=3;a<b;++a)e+=x[a]*Math.pow(t,a);return e};return{coef:F(b,x,-p,v),predict:_,rSquared:C(t,e,n,v,_)}},t.regressionPow=function(t,e,n){var r=0,i=0,a=0,o=0,u=0,s=0;S(t,e,n,function(t,e){var n=Math.log(t),l=Math.log(e);r+=(n-r)/++s,i+=(l-i)/s,a+=(n*l-a)/s,o+=(n*n-o)/s,u+=(e-u)/s});var l=E(r,i,a,o),c=function(t){return l[0]*Math.pow(t,l[1])};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:C(t,e,n,u,c)}},t.regressionQuad=D,t.sampleCurve=function(t,e,n,r){n=n||25,r=Math.max(n,r||200);var i=function(e){return[e,t(e)]},a=e[0],o=e[1],u=o-a,s=u/r,l=[i(a)],c=[];if(n===r){for(var f=1;f<r;++f)l.push(i(a+f/n*u));return l.push(i(o)),l}c.push(i(o));for(var h=n;--h>0;)c.push(i(a+h/n*u));for(var d=l[0],p=c[c.length-1];p;){var v=i((d[0]+p[0])/2);v[0]-d[0]>=s&&z(d,v,p)>P?c.push(v):(d=p,l.push(p),c.pop()),p=c[c.length-1]}return l},t.sampleLogNormal=m,t.sampleNormal=h,t.sampleUniform=_,t.setRandom=function(e){t.random=e},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053))},1344:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4,k=function(t){return"__proto__"!==t};function A(t,e,n,r){var i,u;if(k(e))if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):k(i)&&(u[i]=n[i]);else t[e]=n}function E(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function M(t){return t[t.length-1]}function S(t){return null==t||""===t?null:+t}function C(t){return function(e){return t*Math.exp(e)}}function O(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function F(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function T(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function N(t,e,n,r){var i=n(t[0]),a=n(M(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function j(t,e,n,r,i){var a=r(t[0]),o=r(M(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function R(t){return null!=t?a(t)?t:[t]:[]}function P(t){return"function"===typeof t}var z=Object.prototype.hasOwnProperty;function B(t,e){return z.call(t,e)}var L={};function q(t){return"[object Date]"===Object.prototype.toString.call(t)}function I(t){return"number"===typeof t}var U=1e4;function W(t,e){for(var n="";--e>=0;)n+=t;return n}function H(t){return I(t)?t:q(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=R,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=R(t)).map(function(t,e){return null==t?null:(v.push(e),P(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=R(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)P(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return P(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return P(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return B(r,t)&&r[t]!==L}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===L&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=L),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===L||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=M(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=B,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=q,t.isFunction=P,t.isNumber=I,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?R(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):R(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=M(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.lruCache=function(t){var e,n,r;t=+t||U;var i=function(){e={},n={},r=0},a=function(i,a){return++r>t&&(n=e,e={},r=1),e[i]=a};return i(),{clear:i,has:function(t){return B(e,t)||B(n,t)},get:function(t){return B(e,t)?e[t]:B(n,t)?a(t,n[t]):void 0},set:function(t,n){return B(e,t)?e[t]=n:a(t,n)}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=E(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?W(i,o)+a:"center"===r?W(i,~~(o/2))+a+W(i,Math.ceil(o/2)):a+W(i,o)},t.panLinear=function(t,e){return N(t,e,S,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return N(t,e,O(n),C(n))},t.panPow=function(t,e,n){return N(t,e,T(n),T(1/n))},t.panSymlog=function(t,e,n){return N(t,e,D(n),F(n))},t.peek=M,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=W,t.span=function(t){return t&&M(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||H,null==t||""===t?null:e(t)},t.toNumber=S,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=A,t.zero=d,t.zoomLinear=function(t,e,n){return j(t,e,n,S,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return j(t,e,n,O(r),C(r))},t.zoomPow=function(t,e,n,r){return j(t,e,n,T(r),T(1/r))},t.zoomSymlog=function(t,e,n,r){return j(t,e,n,D(r),F(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},1345:function(t,e,n){var r=n(212);!function(t,e,n,i,a,o,u,s,l,c,f,h,d,p){"use strict";function v(t){var e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function g(t){var e=l.rgb(t);return.2126*v(e.r)+.7152*v(e.g)+.0722*v(e.b)}function m(t,e){var n=g(t),r=g(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function y(t){var e=this.context.data[t];return e?e.values.value:[]}function b(t,e,n){var r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}function x(t,e){var n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(u.truthy).insert(e)),1}function _(t,e,n){if(t){var r=this.context.dataflow,i=t.mark.source;r.pulse(i,r.changeset().encode(t,e))}return void 0!==n?n:t}var w={};function k(t,e,n){var r=t+":"+n,i=w[r];return i&&i[0]===e||(w[r]=i=[e,e(n)]),i[1]}function A(t,e){return k("format",c.format,e)(t)}function E(t,e){return k("timeFormat",o.timeFormat,e)(t)}function M(t,e){return k("utcFormat",o.utcFormat,e)(t)}function S(t,e){return k("timeParse",f.timeParse,e)(t)}function C(t,e){return k("utcParse",f.utcParse,e)(t)}var O=new Date(2e3,0,1);function D(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(O.setYear(2e3),O.setMonth(t),O.setDate(e),E(O,n)):""}function F(t){return D(t,1,"%B")}function T(t){return D(t,1,"%b")}function N(t){return D(0,2+t,"%A")}function j(t){return D(0,2+t,"%a")}function R(t,e){var n;return u.isFunction(t)?t:u.isString(t)?(n=e.scales[t])&&n.value:void 0}function P(t,e){var n=R(t,(e||this).context);return n&&n.range?n.range():[]}function z(t,e){var n=R(t,(e||this).context);return n?n.domain():[]}function B(t,e){var n=R(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function L(t,e,n){return h.bandSpace(t||0,e||0,n||0)}function q(t,e){var n=R(t,(e||this).context);return n?n.copy():void 0}function I(t,e,n){var r=R(t,(n||this).context);return r&&void 0!==e?r(e):void 0}function U(t,e,n){var r=R(t,(n||this).context);return r?u.isArray(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function W(t,e){return function(n,r,i){if(n){var a=R(n,(i||this).context);return a&&a.path[t](r)}return e(r)}}var H=W("area",d.geoArea),V=W("bounds",d.geoBounds),G=W("centroid",d.geoCentroid);function $(t){var e=this.context.group,n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n}function Y(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function X(){return Y(this.context.dataflow,"warn",arguments)}function J(){return Y(this.context.dataflow,"info",arguments)}function Q(){return Y(this.context.dataflow,"debug",arguments)}function Z(){var t=[].slice.call(arguments);return t.unshift({}),u.extend.apply(null,t)}function K(t,e){return t===e||t!==t&&e!==e||(u.isArray(t)?!(!u.isArray(e)||t.length!==e.length)&&function(t,e){for(var n=0,r=t.length;n<r;++n)if(!K(t[n],e[n]))return!1;return!0}(t,e):!(!u.isObject(t)||!u.isObject(e))&&tt(t,e))}function tt(t,e){for(var n in t)if(!K(t[n],e[n]))return!1;return!0}function et(t){return function(e){return tt(t,e)}}function nt(t,e,r,i,a,o){var s,l,c=this.context.dataflow,f=this.context.data[t],h=f.input,d=f.changes,p=c.stamp();if(!1===c._trigger||!(h.value.length||e||i))return 0;if((!d||d.stamp<p)&&(f.changes=d=c.changeset(),d.stamp=p,c.runAfter(function(){f.modified=!0,c.pulse(h,d).run()},!0,1)),r&&(s=!0===r?u.truthy:u.isArray(r)||n.isTuple(r)?r:et(r),d.remove(s)),e&&d.insert(e),i&&(s=et(i),h.value.some(s)?d.remove(s):d.insert(i)),a)for(l in o)d.modify(a,l,o[l]);return 1}function rt(t){var e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)}function it(t){var e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}function at(t,e,n,r,i){t=R(t,(i||this).context);var a=p.Gradient(e,n),o=t.domain(),s=o[0],l=u.peek(o),c=u.identity;return l-s?c=h.scaleFraction(t,s,l):t=(t.interpolator?h.scale("sequential")().interpolator(t.interpolator()):h.scale("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(s!==(o=t.ticks(+r||15))[0]&&o.unshift(s),l!==u.peek(o)&&o.push(l)),o.forEach(function(e){return a.stop(c(e),t(e))}),a}function ot(t,e,n){var r=R(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}function ut(t){var e=null;return function(n){return n?p.pathRender(n,e=e||p.pathParse(t)):t}}var st={};function lt(t){return t.data}function ct(t,e){var n=y.call(e,t);return n.root&&n.root.lookup||st}function ft(t,e,n){var r=ct(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(lt):void 0}function ht(t,e){var n=ct(t,this)[e];return n?n.ancestors().map(lt):void 0}var dt="undefined"!==typeof window&&window||null;function pt(){return dt?dt.screen:{}}function vt(){return dt?[dt.innerWidth,dt.innerHeight]:[void 0,void 0]}function gt(){var t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}var mt=":",yt="@",bt="%";function xt(t,n,r,i){n[0].type!==e.Literal&&u.error("First argument to data functions must be a string literal.");var a=n[0].value,o=mt+a;if(!u.hasOwnProperty(o,i))try{i[o]=r.getData(a).tuplesRef()}catch(s){}}function _t(t,n,r,i){n[0].type!==e.Literal&&u.error("First argument to indata must be a string literal."),n[1].type!==e.Literal&&u.error("Second argument to indata must be a string literal.");var a=n[0].value,o=n[1].value,s=yt+o;u.hasOwnProperty(s,i)||(i[s]=r.getData(a).indataRef(r,o))}function wt(t,n,r,i){if(n[0].type===e.Literal)kt(r,i,n[0].value);else if(n[0].type===e.Identifier)for(t in r.scales)kt(r,i,t)}function kt(t,e,n){var r=bt+n;if(!u.hasOwnProperty(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}var At={random:function(){return a.random()},cumulativeNormal:a.cumulativeNormal,cumulativeLogNormal:a.cumulativeLogNormal,cumulativeUniform:a.cumulativeUniform,densityNormal:a.densityNormal,densityLogNormal:a.densityLogNormal,densityUniform:a.densityUniform,quantileNormal:a.quantileNormal,quantileLogNormal:a.quantileLogNormal,quantileUniform:a.quantileUniform,sampleNormal:a.sampleNormal,sampleLogNormal:a.sampleLogNormal,sampleUniform:a.sampleUniform,isArray:u.isArray,isBoolean:u.isBoolean,isDate:u.isDate,isDefined:function(t){return void 0!==t},isNumber:u.isNumber,isObject:u.isObject,isRegExp:u.isRegExp,isString:u.isString,isTuple:n.isTuple,isValid:function(t){return null!=t&&t===t},toBoolean:u.toBoolean,toDate:u.toDate,toNumber:u.toNumber,toString:u.toString,flush:u.flush,lerp:u.lerp,merge:Z,pad:u.pad,peek:u.peek,span:u.span,inrange:u.inrange,truncate:u.truncate,rgb:l.rgb,lab:l.lab,hcl:l.hcl,hsl:l.hsl,luminance:g,contrast:m,sequence:s.range,format:A,utcFormat:M,utcParse:C,utcOffset:o.utcOffset,utcSequence:o.utcSequence,timeFormat:E,timeParse:S,timeOffset:o.timeOffset,timeSequence:o.timeSequence,timeUnitSpecifier:o.timeUnitSpecifier,monthFormat:F,monthAbbrevFormat:T,dayFormat:N,dayAbbrevFormat:j,quarter:u.quarter,utcquarter:u.utcquarter,warn:X,info:J,debug:Q,extent:u.extent,inScope:$,intersect:function(t,e,n){if(!t)return[];var i=r(t,2),a=i[0],o=i[1],s=(new p.Bounds).set(a[0],a[1],o[0],o[1]),l=n||this.context.dataflow.scenegraph().root;return p.intersect(l,s,function(t){var e=null;if(t){var n=u.array(t.marktype),r=u.array(t.markname);e=function(t){return(!n.length||n.some(function(e){return t.marktype===e}))&&(!r.length||r.some(function(e){return t.name===e}))}}return e}(e))},clampRange:u.clampRange,pinchDistance:rt,pinchAngle:it,screen:pt,containerSize:gt,windowSize:vt,bandspace:L,setdata:x,pathShape:ut,panLinear:u.panLinear,panLog:u.panLog,panPow:u.panPow,panSymlog:u.panSymlog,zoomLinear:u.zoomLinear,zoomLog:u.zoomLog,zoomPow:u.zoomPow,zoomSymlog:u.zoomSymlog,encode:_,modify:nt},Et=["view","item","group","xy","x","y"],Mt="event.vega.",St="this.",Ct={};function Ot(t,e,n){return 1===arguments.length?At[t]:(At[t]=e,n&&(Ct[t]=n),Ft&&(Ft.functions[t]=St+t),this)}Ot("bandwidth",B,wt),Ot("copy",q,wt),Ot("domain",z,wt),Ot("range",P,wt),Ot("invert",U,wt),Ot("scale",I,wt),Ot("gradient",at,wt),Ot("geoArea",H,wt),Ot("geoBounds",V,wt),Ot("geoCentroid",G,wt),Ot("geoShape",ot,wt),Ot("indata",b,_t),Ot("data",y,xt),Ot("treePath",ft,xt),Ot("treeAncestors",ht,xt),Ot("vlSelectionTest",i.selectionTest,i.selectionVisitor),Ot("vlSelectionResolve",i.selectionResolve,i.selectionVisitor);var Dt={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(t){return"_["+u.stringValue("$"+t)+"]"},functions:function(t){var n=e.functions(t);for(var r in Et.forEach(function(t){return n[t]=Mt+t}),At)n[r]=St+r;return n},constants:e.constants,visitors:Ct},Ft=e.codegen(Dt);Object.defineProperty(t,"formatLocale",{enumerable:!0,get:function(){return c.formatDefaultLocale}}),Object.defineProperty(t,"timeFormatLocale",{enumerable:!0,get:function(){return f.timeFormatDefaultLocale}}),t.DataPrefix=mt,t.IndexPrefix=yt,t.ScalePrefix=bt,t.SignalPrefix="$",t.bandspace=L,t.bandwidth=B,t.codeGenerator=Ft,t.codegenParams=Dt,t.containerSize=gt,t.contrast=m,t.copy=q,t.data=y,t.dataVisitor=xt,t.dayAbbrevFormat=j,t.dayFormat=N,t.debug=Q,t.domain=z,t.encode=_,t.expressionFunction=Ot,t.format=A,t.functionContext=At,t.geoArea=H,t.geoBounds=V,t.geoCentroid=G,t.geoShape=ot,t.inScope=$,t.indata=b,t.indataVisitor=_t,t.info=J,t.invert=U,t.luminance=g,t.merge=Z,t.modify=nt,t.monthAbbrevFormat=T,t.monthFormat=F,t.pathShape=ut,t.pinchAngle=it,t.pinchDistance=rt,t.range=P,t.scale=I,t.scaleGradient=at,t.scaleVisitor=wt,t.screen=pt,t.setdata=x,t.timeFormat=E,t.timeParse=S,t.treeAncestors=ht,t.treePath=ft,t.utcFormat=M,t.utcParse=C,t.warn=X,t.windowSize=vt,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1346),n(1045),n(2145),n(1343),n(1223),n(1040),n(1053),n(1114),n(1169),n(1091),n(1172),n(1224),n(1563))},1346:function(t,e,n){!function(t,e){"use strict";var n,r,i,a,o,u="RawCode",s="Literal",l="Property",c="Identifier",f="ArrayExpression",h="BinaryExpression",d="CallExpression",p="ConditionalExpression",v="LogicalExpression",g="MemberExpression",m="ObjectExpression",y="UnaryExpression";function b(t){this.type=t}b.prototype.visit=function(t){var e,n,r;if(t(this))return 1;for(n=0,r=(e=function(t){switch(t.type){case f:return t.elements;case h:case v:return[t.left,t.right];case d:var e=t.arguments.slice();return e.unshift(t.callee),e;case p:return[t.test,t.consequent,t.alternate];case g:return[t.object,t.property];case m:return t.properties;case l:return[t.key,t.value];case y:return[t.argument];case c:case s:case u:default:return[]}}(this)).length;n<r;++n)if(e[n].visit(t))return 1};var x=1,_=2,w=3,k=4,A=5,E=6,M=7,S=8;(n={})[x]="Boolean",n[_]="<end>",n[w]="Identifier",n[k]="Keyword",n[A]="Null",n[E]="Numeric",n[M]="Punctuator",n[S]="String",n[9]="RegularExpression";var C="ArrayExpression",O="BinaryExpression",D="CallExpression",F="ConditionalExpression",T="Identifier",N="Literal",j="LogicalExpression",R="MemberExpression",P="ObjectExpression",z="Property",B="UnaryExpression",L="Unexpected token %0",q="Unexpected number",I="Unexpected string",U="Unexpected identifier",W="Unexpected reserved word",H="Unexpected end of input",V="Invalid regular expression",G="Invalid regular expression: missing /",$="Octal literals are not allowed in strict mode.",Y="Duplicate data property in object literal not allowed in strict mode",X="ILLEGAL",J="Disabled.",Q=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Z=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function K(t,e){if(!t)throw new Error("ASSERT: "+e)}function tt(t){return t>=48&&t<=57}function et(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function nt(t){return"01234567".indexOf(t)>=0}function rt(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function it(t){return 10===t||13===t||8232===t||8233===t}function at(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&Q.test(String.fromCharCode(t))}function ot(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&Z.test(String.fromCharCode(t))}var ut={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function st(){for(var t;i<a&&(rt(t=r.charCodeAt(i))||it(t));)++i}function lt(t){var e,n,o,u=0;for(n="u"===t?4:2,e=0;e<n;++e)i<a&&et(r[i])?(o=r[i++],u=16*u+"0123456789abcdef".indexOf(o.toLowerCase())):Et({},L,X);return String.fromCharCode(u)}function ct(){var t,e,n,o;for(e=0,"}"===(t=r[i])&&Et({},L,X);i<a&&et(t=r[i++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&Et({},L,X),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),o=56320+(e-65536&1023),String.fromCharCode(n,o))}function ft(){var t,e;for(t=r.charCodeAt(i++),e=String.fromCharCode(t),92===t&&(117!==r.charCodeAt(i)&&Et({},L,X),++i,(t=lt("u"))&&"\\"!==t&&at(t.charCodeAt(0))||Et({},L,X),e=t);i<a&&ot(t=r.charCodeAt(i));)++i,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==r.charCodeAt(i)&&Et({},L,X),++i,(t=lt("u"))&&"\\"!==t&&ot(t.charCodeAt(0))||Et({},L,X),e+=t);return e}function ht(){var t,e;return t=i,{type:1===(e=92===r.charCodeAt(i)?ft():function(){var t,e;for(t=i++;i<a;){if(92===(e=r.charCodeAt(i)))return i=t,ft();if(!ot(e))break;++i}return r.slice(t,i)}()).length?w:ut.hasOwnProperty(e)?k:"null"===e?A:"true"===e||"false"===e?x:w,value:e,start:t,end:i}}function dt(){var t,e,n,a,o=i,u=r.charCodeAt(i),s=r[i];switch(u){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++i,{type:M,value:String.fromCharCode(u),start:o,end:i};default:if(61===(t=r.charCodeAt(i+1)))switch(u){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return i+=2,{type:M,value:String.fromCharCode(u)+String.fromCharCode(t),start:o,end:i};case 33:case 61:return i+=2,61===r.charCodeAt(i)&&++i,{type:M,value:r.slice(o,i),start:o,end:i}}}return">>>="===(a=r.substr(i,4))?{type:M,value:a,start:o,end:i+=4}:">>>"===(n=a.substr(0,3))||"<<="===n||">>="===n?{type:M,value:n,start:o,end:i+=3}:s===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?{type:M,value:e,start:o,end:i+=2}:"<>=!+-*%&|^/".indexOf(s)>=0?{type:M,value:s,start:o,end:++i}:void Et({},L,X)}function pt(){var t,e,n;if(K(tt((n=r[i]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=i,t="","."!==n){if(t=r[i++],n=r[i],"0"===t){if("x"===n||"X"===n)return++i,function(t){for(var e="";i<a&&et(r[i]);)e+=r[i++];return 0===e.length&&Et({},L,X),at(r.charCodeAt(i))&&Et({},L,X),{type:E,value:parseInt("0x"+e,16),start:t,end:i}}(e);if(nt(n))return function(t){for(var e="0"+r[i++];i<a&&nt(r[i]);)e+=r[i++];return(at(r.charCodeAt(i))||tt(r.charCodeAt(i)))&&Et({},L,X),{type:E,value:parseInt(e,8),octal:!0,start:t,end:i}}(e);n&&tt(n.charCodeAt(0))&&Et({},L,X)}for(;tt(r.charCodeAt(i));)t+=r[i++];n=r[i]}if("."===n){for(t+=r[i++];tt(r.charCodeAt(i));)t+=r[i++];n=r[i]}if("e"===n||"E"===n)if(t+=r[i++],"+"!==(n=r[i])&&"-"!==n||(t+=r[i++]),tt(r.charCodeAt(i)))for(;tt(r.charCodeAt(i));)t+=r[i++];else Et({},L,X);return at(r.charCodeAt(i))&&Et({},L,X),{type:E,value:parseFloat(t),start:e,end:i}}function vt(){var t,e,n,u;return o=null,st(),t=i,e=function(){var t,e,n,o;for(K("/"===(t=r[i]),"Regular expression literal must start with a slash"),e=r[i++],n=!1,o=!1;i<a;)if(e+=t=r[i++],"\\"===t)it((t=r[i++]).charCodeAt(0))&&Et({},G),e+=t;else if(it(t.charCodeAt(0)))Et({},G);else if(n)"]"===t&&(n=!1);else{if("/"===t){o=!0;break}"["===t&&(n=!0)}return o||Et({},G),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";i<a&&ot((t=r[i]).charCodeAt(0));)++i,"\\"===t&&i<a?Et({},L,X):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&Et({},V,n),{value:n,literal:e}}(),u=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e){if(parseInt(e,16)<=1114111)return"x";Et({},V)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Et({},V)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:u,regex:{pattern:e.value,flags:n.value},start:t,end:i}}function gt(){var t;return st(),i>=a?{type:_,start:i,end:i}:at(t=r.charCodeAt(i))?ht():40===t||41===t||59===t?dt():39===t||34===t?function(){var t,e,n,o,u="",s=!1;for(K("'"===(t=r[i])||'"'===t,"String literal must starts with a quote"),e=i,++i;i<a;){if((n=r[i++])===t){t="";break}if("\\"===n)if((n=r[i++])&&it(n.charCodeAt(0)))"\r"===n&&"\n"===r[i]&&++i;else switch(n){case"u":case"x":"{"===r[i]?(++i,u+=ct()):u+=lt(n);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:nt(n)?(0!==(o="01234567".indexOf(n))&&(s=!0),i<a&&nt(r[i])&&(s=!0,o=8*o+"01234567".indexOf(r[i++]),"0123".indexOf(n)>=0&&i<a&&nt(r[i])&&(o=8*o+"01234567".indexOf(r[i++]))),u+=String.fromCharCode(o)):u+=n}else{if(it(n.charCodeAt(0)))break;u+=n}}return""!==t&&Et({},L,X),{type:S,value:u,octal:s,start:e,end:i}}():46===t?tt(r.charCodeAt(i+1))?pt():dt():tt(t)?pt():dt()}function mt(){var t;return i=(t=o).end,o=gt(),i=t.end,t}function yt(){var t;t=i,o=gt(),i=t}function bt(t,e,n){var r=new b("||"===t||"&&"===t?j:O);return r.operator=t,r.left=e,r.right=n,r}function xt(t,e){var n=new b(D);return n.callee=t,n.arguments=e,n}function _t(t){var e=new b(T);return e.name=t,e}function wt(t){var e=new b(N);return e.value=t.value,e.raw=r.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function kt(t,e,n){var r=new b(R);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function At(t,e,n){var r=new b(z);return r.key=e,r.value=n,r.kind=t,r}function Et(t,e){var n,r=Array.prototype.slice.call(arguments,2),a=e.replace(/%(\d)/g,function(t,e){return K(e<r.length,"Message reference must be in range"),r[e]});throw(n=new Error(a)).index=i,n.description=a,n}function Mt(t){t.type===_&&Et(t,H),t.type===E&&Et(t,q),t.type===S&&Et(t,I),t.type===w&&Et(t,U),t.type===k&&Et(t,W),Et(t,L,t.value)}function St(t){var e=mt();e.type===M&&e.value===t||Mt(e)}function Ct(t){return o.type===M&&o.value===t}function Ot(t){return o.type===k&&o.value===t}function Dt(){var t=[];for(i=o.start,St("[");!Ct("]");)Ct(",")?(mt(),t.push(null)):(t.push(Ut()),Ct("]")||St(","));return mt(),function(t){var e=new b(C);return e.elements=t,e}(t)}function Ft(){var t;return i=o.start,(t=mt()).type===S||t.type===E?(t.octal&&Et(t,$),wt(t)):_t(t.value)}function Tt(){var t,e,n;return i=o.start,(t=o).type===w?(n=Ft(),St(":"),At("init",n,Ut())):t.type!==_&&t.type!==M?(e=Ft(),St(":"),At("init",e,Ut())):void Mt(t)}function Nt(){var t,e,n=[],r={},a=String;for(i=o.start,St("{");!Ct("}");)e="$"+((t=Tt()).key.type===T?t.key.name:a(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Et({},Y):r[e]=!0,n.push(t),Ct("}")||St(",");return St("}"),function(t){var e=new b(P);return e.properties=t,e}(n)}var jt={if:1,this:1};function Rt(){var t,e,n;if(Ct("("))return function(){var t;return St("("),t=Wt(),St(")"),t}();if(Ct("["))return Dt();if(Ct("{"))return Nt();if(t=o.type,i=o.start,t===w||jt[o.value])n=_t(mt().value);else if(t===S||t===E)o.octal&&Et(o,$),n=wt(mt());else{if(t===k)throw new Error(J);t===x?((e=mt()).value="true"===e.value,n=wt(e)):t===A?((e=mt()).value=null,n=wt(e)):Ct("/")||Ct("/=")?(n=wt(vt()),yt()):Mt(mt())}return n}function Pt(){var t=[];if(St("("),!Ct(")"))for(;i<a&&(t.push(Ut()),!Ct(")"));)St(",");return St(")"),t}function zt(){var t;return i=o.start,function(t){return t.type===w||t.type===k||t.type===x||t.type===A}(t=mt())||Mt(t),_t(t.value)}function Bt(){var t;return St("["),t=Wt(),St("]"),t}function Lt(){var t=function(){var t;for(t=Rt();;)if(Ct("."))St("."),t=kt(".",t,zt());else if(Ct("("))t=xt(t,Pt());else{if(!Ct("["))break;t=kt("[",t,Bt())}return t}();if(o.type===M&&(Ct("++")||Ct("--")))throw new Error(J);return t}function qt(){var t,e;if(o.type!==M&&o.type!==k)e=Lt();else{if(Ct("++")||Ct("--"))throw new Error(J);if(Ct("+")||Ct("-")||Ct("~")||Ct("!"))t=mt(),e=qt(),e=function(t,e){var n=new b(B);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(Ot("delete")||Ot("void")||Ot("typeof"))throw new Error(J);e=Lt()}}return e}function It(t){var e=0;if(t.type!==M&&t.type!==k)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function Ut(){var t,e;return t=function(){var t,e,n,r,i,a,u,s,l,c;if(t=o,l=qt(),0===(i=It(r=o)))return l;for(r.prec=i,mt(),e=[t,o],a=[l,r,u=qt()];(i=It(o))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)u=a.pop(),s=a.pop().value,l=a.pop(),e.pop(),n=bt(s,l,u),a.push(n);(r=mt()).prec=i,a.push(r),e.push(o),n=qt(),a.push(n)}for(n=a[c=a.length-1],e.pop();c>1;)e.pop(),n=bt(a[c-1].value,a[c-2],n),c-=2;return n}(),Ct("?")&&(mt(),e=Ut(),St(":"),t=function(t,e,n){var r=new b(F);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,Ut())),t}function Wt(){var t=Ut();if(Ct(","))throw new Error(J);return t}var Ht={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Vt(t){function n(e,n,r){return function(i){return function(e,n,r,i){var a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}}var r="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(n){n.length<3&&e.error("Missing arguments to clamp function."),n.length>3&&e.error("Too many arguments to clamp function.");var r=n.map(t);return"Math.max("+r[1]+", Math.min("+r[2]+","+r[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(e){return"("+t(e[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase","String",0),lower:n("toLowerCase","String",0),substring:n("substring","String"),split:n("split","String"),replace:n("replace","String"),trim:n("trim","String",0),regexp:"RegExp",test:n("test","RegExp"),if:function(n){n.length<3&&e.error("Missing arguments to if function."),n.length>3&&e.error("Too many arguments to if function.");var r=n.map(t);return"("+r[0]+"?"+r[1]+":"+r[2]+")"}}}t.ASTNode=b,t.ArrayExpression=f,t.BinaryExpression=h,t.CallExpression=d,t.ConditionalExpression=p,t.Identifier=c,t.Literal=s,t.LogicalExpression=v,t.MemberExpression=g,t.ObjectExpression=m,t.Property=l,t.RawCode=u,t.UnaryExpression=y,t.codegen=function(t){var n=(t=t||{}).whitelist?e.toSet(t.whitelist):{},r=t.blacklist?e.toSet(t.blacklist):{},i=t.constants||Ht,a=(t.functions||Vt)(h),o=t.globalvar,u=t.fieldvar,s={},l={},c=0,f=e.isFunction(o)?o:function(t){return o+'["'+t+'"]'};function h(t){if(e.isString(t))return t;var n=d[t.type];return null==n&&e.error("Unsupported type: "+t.type),n(t)}var d={Literal:function(t){return t.raw},Identifier:function(t){var a=t.name;return c>0?a:e.hasOwnProperty(r,a)?e.error("Illegal identifier: "+a):e.hasOwnProperty(i,a)?i[a]:e.hasOwnProperty(n,a)?a:(s[a]=1,f(a))},MemberExpression:function(t){var e=!t.computed,n=h(t.object);e&&(c+=1);var r=h(t.property);return n===u&&(l[function(t){var e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:function(t){"Identifier"!==t.callee.type&&e.error("Illegal callee type: "+t.callee.type);var n=t.callee.name,r=t.arguments,i=e.hasOwnProperty(a,n)&&a[n];return i||e.error("Unrecognized function: "+n),e.isFunction(i)?i(r):i+"("+r.map(h).join(",")+")"},ArrayExpression:function(t){return"["+t.elements.map(h).join(",")+"]"},BinaryExpression:function(t){return"("+h(t.left)+t.operator+h(t.right)+")"},UnaryExpression:function(t){return"("+t.operator+h(t.argument)+")"},ConditionalExpression:function(t){return"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")"},LogicalExpression:function(t){return"("+h(t.left)+t.operator+h(t.right)+")"},ObjectExpression:function(t){return"{"+t.properties.map(h).join(",")+"}"},Property:function(t){c+=1;var e=h(t.key);return c-=1,e+":"+h(t.value)}};function p(t){var e={code:h(t),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},e}return p.functions=a,p.constants=i,p},t.constants=Ht,t.functions=Vt,t.parse=function(t){i=0,a=(r=t).length,o=null,yt();var e=Wt();if(o.type!==_)throw new Error("Unexpect token after expression.");return e},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040))},1561:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1341),i=n(1045),a=n(2114),o=n(2117),u=n(2120),s=n(2122),l=n(2126),c=n(2128),f=n(2130),h=n(2132),d=n(2134),p=n(2135),v=n(2136),g=n(1223),m=n(1565),y=n(2138),b=n(1172),x=n(1564),_=n(2140),w=n(1345),k=n(2146),A=n(1566);r.extend(i.transforms,a,o,u,s,l,c,f,h,d,p),Object.keys(r).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})}),Object.keys(v).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return v[t]}})}),Object.keys(g).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return g[t]}})}),Object.keys(m).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return m[t]}})}),Object.keys(y).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return y[t]}})}),Object.defineProperty(e,"Dataflow",{enumerable:!0,get:function(){return i.Dataflow}}),Object.defineProperty(e,"EventStream",{enumerable:!0,get:function(){return i.EventStream}}),Object.defineProperty(e,"MultiPulse",{enumerable:!0,get:function(){return i.MultiPulse}}),Object.defineProperty(e,"Operator",{enumerable:!0,get:function(){return i.Operator}}),Object.defineProperty(e,"Parameters",{enumerable:!0,get:function(){return i.Parameters}}),Object.defineProperty(e,"Pulse",{enumerable:!0,get:function(){return i.Pulse}}),Object.defineProperty(e,"Transform",{enumerable:!0,get:function(){return i.Transform}}),Object.defineProperty(e,"changeset",{enumerable:!0,get:function(){return i.changeset}}),Object.defineProperty(e,"definition",{enumerable:!0,get:function(){return i.definition}}),Object.defineProperty(e,"ingest",{enumerable:!0,get:function(){return i.ingest}}),Object.defineProperty(e,"isTuple",{enumerable:!0,get:function(){return i.isTuple}}),Object.defineProperty(e,"transform",{enumerable:!0,get:function(){return i.transform}}),Object.defineProperty(e,"transforms",{enumerable:!0,get:function(){return i.transforms}}),Object.defineProperty(e,"tupleid",{enumerable:!0,get:function(){return i.tupleid}}),Object.defineProperty(e,"interpolate",{enumerable:!0,get:function(){return b.interpolate}}),Object.defineProperty(e,"interpolateColors",{enumerable:!0,get:function(){return b.interpolateColors}}),Object.defineProperty(e,"interpolateRange",{enumerable:!0,get:function(){return b.interpolateRange}}),Object.defineProperty(e,"quantizeInterpolator",{enumerable:!0,get:function(){return b.quantizeInterpolator}}),Object.defineProperty(e,"scale",{enumerable:!0,get:function(){return b.scale}}),Object.defineProperty(e,"scheme",{enumerable:!0,get:function(){return b.scheme}}),Object.defineProperty(e,"projection",{enumerable:!0,get:function(){return x.projection}}),Object.defineProperty(e,"View",{enumerable:!0,get:function(){return _.View}}),Object.defineProperty(e,"expressionFunction",{enumerable:!0,get:function(){return w.expressionFunction}}),Object.defineProperty(e,"formatLocale",{enumerable:!0,get:function(){return w.formatLocale}}),Object.defineProperty(e,"timeFormatLocale",{enumerable:!0,get:function(){return w.timeFormatLocale}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return k.parse}}),Object.defineProperty(e,"runtime",{enumerable:!0,get:function(){return A.parse}}),Object.defineProperty(e,"runtimeContext",{enumerable:!0,get:function(){return A.context}}),e.version="5.10.0"},1562:function(t,e,n){(function(t){var r=n(19),i=n(1112);!function(e,n,a,o,u){"use strict";var s=/^([A-Za-z]+:)?\/\//,l=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,f="file://";function h(t,e){return d.apply(this,arguments)}function d(){return(d=i(r.mark(function t(e,n){var i,a;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sanitize(e,n);case 2:return i=t.sent,a=i.href,t.abrupt("return",i.localFile?this.file(a):this.http(a,n));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function p(t,e){return v.apply(this,arguments)}function v(){return(v=i(r.mark(function t(e,i){var a,o,u,h,d,p,v;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.extend({},this.options,i),a=this.fileAccess,o={href:null},p=l.test(e.replace(c,"")),null!=e&&"string"===typeof e&&p||n.error("Sanitize failure, invalid URI: "+n.stringValue(e)),v=s.test(e),(d=i.baseURL)&&!v&&(e.startsWith("/")||"/"===d[d.length-1]||(e="/"+e),e=d+e),h=(u=e.startsWith(f))||"file"===i.mode||"http"!==i.mode&&!v&&a,u?e=e.slice(f.length):e.startsWith("//")&&("file"===i.defaultProtocol?(e=e.slice(2),h=!0):e=(i.defaultProtocol||"http")+":"+e),Object.defineProperty(o,"localFile",{value:!!h}),o.href=e,i.target&&(o.target=i.target+""),i.rel&&(o.rel=i.rel+""),t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function g(t){return t?function(e){return new Promise(function(n,r){t.readFile(e,function(t,e){t?r(t):n(e)})})}:m}function m(){return y.apply(this,arguments)}function y(){return(y=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No file system access.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}function b(t){return t?function(){var e=i(r.mark(function e(i,a){var o,u,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.extend({},this.options.http,a),u=a&&a.response,e.next=4,t(i,o);case 4:return s=e.sent,e.abrupt("return",s.ok?n.isFunction(s[u])?s[u]():s.text():n.error(s.status+""+s.statusText));case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}():x}function x(){return _.apply(this,arguments)}function _(){return(_=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No HTTP fetch method available.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}var w={boolean:n.toBoolean,integer:n.toNumber,number:n.toNumber,date:n.toDate,string:n.toString,unknown:n.identity},k=[function(t){return"true"===t||"false"===t||!0===t||!1===t},function(t){return S(t)&&Number.isInteger(+t)},S,function(t){return!Number.isNaN(Date.parse(t))}],A=["boolean","integer","number","date"];function E(t,e){if(!t||!t.length)return"unknown";var n,r,i,a,o=0,u=t.length,s=k.length,l=k.map(function(t,e){return e+1});for(r=0,u=t.length;r<u;++r)for(n=e?t[r][e]:t[r],i=0;i<s;++i)if(l[i]&&null!=(a=n)&&a===a&&!k[i](n)&&(l[i]=0,++o===k.length))return"string";return o=l.reduce(function(t,e){return 0===t?e:t},0)-1,A[o]}function M(t,e){return e.reduce(function(e,n){return e[n]=E(t,n),e},{})}function S(t){return!Number.isNaN(+t)&&!(t instanceof Date)}function C(t){var e=function(e,r){var i={delimiter:t};return O(e,r?n.extend(r,i):i)};return e.responseType="text",e}function O(t,e){return e.header&&(t=e.header.map(n.stringValue).join(e.delimiter)+"\n"+t),a.dsvFormat(e.delimiter).parse(t+"")}function D(e,r){var i,a=r&&r.property?n.field(r.property):n.identity;return!n.isObject(e)||(i=e,"function"===typeof t&&n.isFunction(t.isBuffer)&&t.isBuffer(i))?a(JSON.parse(e)):function(t,e){return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(a(e))}O.responseType="text",D.responseType="json";var F={interior:function(t,e){return t!==e},exterior:function(t,e){return t===e}};function T(t,e){var r,i,a,u;return t=D(t,e),e&&e.feature?(r=o.feature,a=e.feature):e&&e.mesh?(r=o.mesh,a=e.mesh,u=F[e.filter]):n.error("Missing TopoJSON feature or mesh parameter."),(i=(i=t.objects[a])?r(t,i,u):n.error("Invalid TopoJSON object: "+a))&&i.features||[i]}T.responseType="json";var N={dsv:O,csv:C(","),tsv:C("\t"),json:D,topojson:T};function j(t,e){return arguments.length>1?(N[t]=e,this):n.hasOwnProperty(N,t)?N[t]:null}var R=function(t,e){return function(n){return{options:n||{},sanitize:p,load:h,fileAccess:!!e,file:g(e),http:b(t)}}}("undefined"!==typeof fetch&&fetch,null);e.format=N,e.formats=j,e.inferType=E,e.inferTypes=M,e.loader=R,e.read=function(t,e,r){var i=j((e=e||{}).type||"json");return i||n.error("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n){if(t.length){n=n||u.timeParse;var r,i,a,o,s,l,c,f=t.columns||Object.keys(t[0]);for("auto"===e&&(e=M(t,f)),f=Object.keys(e),r=f.map(function(t){var r,i,a=e[t];if(a&&(0===a.indexOf("date:")||0===a.indexOf("utc:")))return("'"===(i=(r=a.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?u.utcParse(i):n(i);if(!w[a])throw Error("Illegal format pattern: "+t+":"+a);return w[a]}),o=0,l=t.length,c=f.length;o<l;++o)for(i=t[o],s=0;s<c;++s)a=f[s],i[a]=r[s](i[a])}}(t,e.parse,r),n.hasOwnProperty(t,"columns")&&delete t.columns,t},e.responseType=function(t){var e=j(t);return e&&e.responseType||"text"},e.typeParsers=w,Object.defineProperty(e,"__esModule",{value:!0})}(e,n(1040),n(2113),n(1342),n(1091))}).call(this,n(47).Buffer)},1563:function(t,e,n){!function(t,e,n,r,i,a){"use strict";function o(t){this.clear(),t&&this.union(t)}var u=o.prototype;u.clone=function(){return new o(this)},u.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},u.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},u.equals=function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},u.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},u.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},u.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},u.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},u.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},u.rotate=function(t,e,n){var r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},u.rotatedPoints=function(t,e,n){var r=this.x1,i=this.y1,a=this.x2,o=this.y2,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,c=n-e*s-n*u;return[u*r-s*i+l,s*r+u*i+c,u*r-s*o+l,s*r+u*o+c,u*a-s*i+l,s*a+u*i+c,u*a-s*o+l,s*a+u*o+c]},u.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},u.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},u.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},u.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},u.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},u.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},u.width=function(){return this.x2-this.x1},u.height=function(){return this.y2-this.y1};var s=0,l="p_";function c(t){return t&&t.gradient}function f(t,e,n){var r=t.id,i=t.gradient,a="radial"===i?l:"";return r||(r=t.id="gradient_"+s++,"radial"===i?(t.x1=h(t.x1,.5),t.y1=h(t.y1,.5),t.r1=h(t.r1,0),t.x2=h(t.x2,.5),t.y2=h(t.y2,.5),t.r2=h(t.r2,.5),a=l):(t.x1=h(t.x1,0),t.y1=h(t.y1,0),t.x2=h(t.x2,1),t.y2=h(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+a+r+")"}function h(t,e){return null!=t?t:e}function d(t){this.mark=t,this.bounds=this.bounds||new o}function p(t){d.call(this,t),this.items=this.items||[]}function v(t){this._pending=0,this._loader=t||r.loader()}e.inherits(p,d);var g=v.prototype;function m(t){t._pending+=1}function y(t){t._pending-=1}g.pending=function(){return this._pending},g.sanitizeURL=function(t){var e=this;return m(e),e._loader.sanitize(t,{context:"href"}).then(function(t){return y(e),t}).catch(function(){return y(e),null})},g.loadImage=function(t){var e=this,r=n.image();return m(e),e._loader.sanitize(t,{context:"image"}).then(function(t){var n=t.href;if(!n||!r)throw{url:n};var i=new r;return i.onload=function(){y(e)},i.onerror=function(){y(e)},i.src=n,i}).catch(function(t){return y(e),{complete:!1,width:0,height:0,src:t&&t.url||""}})},g.ready=function(){var t=this;return new Promise(function(e){!function n(r){t.pending()?setTimeout(function(){n(!0)},10):e(r)}(!1)})};var b={basis:{curve:i.curveBasis},"basis-closed":{curve:i.curveBasisClosed},"basis-open":{curve:i.curveBasisOpen},bundle:{curve:i.curveBundle,tension:"beta",value:.85},cardinal:{curve:i.curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:i.curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:i.curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:i.curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:i.curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:i.curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:i.curveLinear},"linear-closed":{curve:i.curveLinearClosed},monotone:{horizontal:i.curveMonotoneY,vertical:i.curveMonotoneX},natural:{curve:i.curveNatural},step:{curve:i.curveStep},"step-after":{curve:i.curveStepAfter},"step-before":{curve:i.curveStepBefore}};function x(t,n,r){var i=e.hasOwnProperty(b,t)&&b[t],a=null;return i&&(a=i.curve||i[n||"vertical"],i.tension&&null!=r&&(a=a[i.tension](r))),a}var _={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},w=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function k(t){var e,n,r,i,a,o,u,s,l,c,f,h=[];for(s=0,c=(e=t.slice().replace(w[0],"###$1").split(w[1]).slice(1)).length;s<c;++s){for(r=(n=e[s]).slice(1).trim().replace(w[2],"$1###$2").split(w[3]),i=[o=n.charAt(0)],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(u=_[o.toLowerCase()],i.length-1>u)for(l=1,f=i.length;l<f;l+=u)h.push([o].concat(i.slice(l,l+u)));else h.push(i)}return h}var A=Math.PI/180,E=1e-14,M=Math.PI/2,S=2*Math.PI,C=Math.sqrt(3)/2,O={},D={},F=[].join;function T(t){var e=F.call(t);if(D[e])return D[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=l*o,f=-s*u,h=s*o,d=l*u,p=Math.cos(i),v=Math.sin(i),g=Math.cos(a),m=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),_=n+p-x*v,w=r+v+x*p,k=n+g,A=r+m,E=k+x*m,M=A-x*g;return D[e]=[c*_+f*w,h*_+d*w,c*E+f*M,h*E+d*M,c*k+f*A,h*k+d*A]}var N=["l",0,0,0,0,0,0,0];function j(t,e,n){var r=N[0]=t[0];if("a"===r||"A"===r)N[1]=e*t[1],N[2]=n*t[2],N[3]=t[3],N[4]=t[4],N[5]=t[5],N[6]=e*t[6],N[7]=n*t[7];else if("h"===r||"H"===r)N[1]=e*t[1];else if("v"===r||"V"===r)N[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)N[i]=(i%2==1?e:n)*t[i];return N}function R(t,e,n,r,i,a){var o,u,s,l,c,f=null,h=0,d=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,m=e.length;g<m;++g){switch(o=e[g],1===i&&1===a||(o=j(o,i,a)),o[0]){case"l":h+=o[1],d+=o[2],t.lineTo(h+n,d+r);break;case"L":h=o[1],d=o[2],t.lineTo(h+n,d+r);break;case"h":h+=o[1],t.lineTo(h+n,d+r);break;case"H":h=o[1],t.lineTo(h+n,d+r);break;case"v":d+=o[1],t.lineTo(h+n,d+r);break;case"V":d=o[1],t.lineTo(h+n,d+r);break;case"m":h+=o[1],d+=o[2],t.moveTo(h+n,d+r);break;case"M":h=o[1],d=o[2],t.moveTo(h+n,d+r);break;case"c":u=h+o[5],s=d+o[6],p=h+o[3],v=d+o[4],t.bezierCurveTo(h+o[1]+n,d+o[2]+r,p+n,v+r,u+n,s+r),h=u,d=s;break;case"C":h=o[5],d=o[6],p=o[3],v=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,h+n,d+r);break;case"s":u=h+o[3],s=d+o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,h+o[1]+n,d+o[2]+r,u+n,s+r),p=h+o[1],v=d+o[2],h=u,d=s;break;case"S":u=o[3],s=o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"q":u=h+o[3],s=d+o[4],p=h+o[1],v=d+o[2],t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"Q":u=o[3],s=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"t":u=h+o[1],s=d+o[2],null===f[0].match(/[QqTt]/)?(p=h,v=d):"t"===f[0]?(p=2*h-l,v=2*d-c):"q"===f[0]&&(p=2*h-p,v=2*d-v),l=p,c=v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),d=s,p=(h=u)+o[1],v=d+o[2];break;case"T":u=o[1],s=o[2],p=2*h-p,v=2*d-v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"a":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+h+n,o[7]+d+r]),h+=o[6],d+=o[7];break;case"A":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),h=o[6],d=o[7];break;case"z":case"Z":t.closePath()}f=o}}function P(t,e,n,r){for(var i=function(t,e,n,r,i,a,o,u,s){var l=F.call(arguments);if(O[l])return O[l];var c=o*A,f=Math.sin(c),h=Math.cos(c),d=h*(u-t)*.5+f*(s-e)*.5,p=h*(s-e)*.5-f*(u-t)*.5,v=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=h/n,m=f/n,y=-f/r,b=h/r,x=g*u+m*s,_=y*u+b*s,w=g*t+m*e,k=y*t+b*e,E=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;E<0&&(E=0);var C=Math.sqrt(E);a==i&&(C=-C);var D=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),N=Math.atan2(_-T,x-D),j=Math.atan2(k-T,w-D)-N;j<0&&1===a?j+=S:j>0&&0===a&&(j-=S);for(var R=Math.ceil(Math.abs(j/(M+.001))),P=[],z=0;z<R;++z){var B=N+z*j/R,L=N+(z+1)*j/R;P[z]=[D,T,B,L,n,r,f,h]}return O[l]=P}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),a=0;a<i.length;++a){var o=T(i[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var z={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,S)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function B(t){return e.hasOwnProperty(z,t)?z[t]:function(t){if(!e.hasOwnProperty(L,t)){var n=k(t);L[t]={draw:function(t,e){R(t,n,0,0,Math.sqrt(e)/2)}}}return L[t]}(t)}var L={},q=.448084975506;function I(t){return t.x}function U(t){return t.y}function W(t){return t.width}function H(t){return t.height}function V(t){return"function"===typeof t?t:function(){return+t}}function G(t,e,n){return Math.max(e,Math.min(t,n))}function $(){var t=I,e=U,n=W,r=H,i=V(0),o=i,u=i,s=i,l=null;function c(c,f,h){var d,p=null!=f?f:+t.call(this,c),v=null!=h?h:+e.call(this,c),g=+n.call(this,c),m=+r.call(this,c),y=Math.min(g,m)/2,b=G(+i.call(this,c),0,y),x=G(+o.call(this,c),0,y),_=G(+u.call(this,c),0,y),w=G(+s.call(this,c),0,y);if(l||(l=d=a.path()),b<=0&&x<=0&&_<=0&&w<=0)l.rect(p,v,g,m);else{var k=p+g,A=v+m;l.moveTo(p+b,v),l.lineTo(k-x,v),l.bezierCurveTo(k-q*x,v,k,v+q*x,k,v+x),l.lineTo(k,A-w),l.bezierCurveTo(k,A-q*w,k-q*w,A,k-w,A),l.lineTo(p+_,A),l.bezierCurveTo(p+q*_,A,p,A-q*_,p,A-_),l.lineTo(p,v+b),l.bezierCurveTo(p,v+q*b,p+q*b,v,p+b,v),l.closePath()}if(d)return l=null,d+""||null}return c.x=function(e){return arguments.length?(t=V(e),c):t},c.y=function(t){return arguments.length?(e=V(t),c):e},c.width=function(t){return arguments.length?(n=V(t),c):n},c.height=function(t){return arguments.length?(r=V(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=V(t),o=null!=e?V(e):i,s=null!=n?V(n):i,u=null!=r?V(r):o,c):i},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}function Y(){var t,e,n,r,i,o,u,s,l=null;function c(t,e,n){var r=n/2;if(i){var a=u-e,c=t-o;if(a||c){var f=Math.sqrt(a*a+c*c),h=(a/=f)*s,d=(c/=f)*s,p=Math.atan2(c,a);l.moveTo(o-h,u-d),l.lineTo(t-a*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+h,u+d),l.arc(o,u,s,p,p+Math.PI)}else l.arc(t,e,r,0,S);l.closePath()}else i=1;o=t,u=e,s=r}function f(o){var u,s,f,h=o.length,d=!1;for(null==l&&(l=f=a.path()),u=0;u<=h;++u)!(u<h&&r(s=o[u],u,o))===d&&(d=!d)&&(i=0),d&&c(+t(s,u,o),+e(s,u,o),+n(s,u,o));if(f)return l=null,f+""||null}return f.x=function(e){return arguments.length?(t=e,f):t},f.y=function(t){return arguments.length?(e=t,f):e},f.size=function(t){return arguments.length?(n=t,f):n},f.defined=function(t){return arguments.length?(r=t,f):r},f.context=function(t){return arguments.length?(l=null==t?null:t,f):l},f}function X(t,e){return null!=t?t:e}var J=function(t){return t.x||0},Q=function(t){return t.y||0},Z=function(t){return!(!1===t.defined)},K=i.arc().startAngle(function(t){return t.startAngle||0}).endAngle(function(t){return t.endAngle||0}).padAngle(function(t){return t.padAngle||0}).innerRadius(function(t){return t.innerRadius||0}).outerRadius(function(t){return t.outerRadius||0}).cornerRadius(function(t){return t.cornerRadius||0}),tt=i.area().x(J).y1(Q).y0(function(t){return(t.y||0)+(t.height||0)}).defined(Z),et=i.area().y(Q).x1(J).x0(function(t){return(t.x||0)+(t.width||0)}).defined(Z),nt=i.line().x(J).y(Q).defined(Z),rt=$().x(J).y(Q).width(function(t){return t.width||0}).height(function(t){return t.height||0}).cornerRadius(function(t){return X(t.cornerRadiusTopLeft,t.cornerRadius)||0},function(t){return X(t.cornerRadiusTopRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomLeft,t.cornerRadius)||0}),it=i.symbol().type(function(t){return B(t.shape||"circle")}).size(function(t){return X(t.size,64)}),at=Y().x(J).y(Q).defined(Z).size(function(t){return t.size||1});function ot(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function ut(t,e,n,r){return rt.context(t)(e,n,r)}function st(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){var r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}var lt,ct,ft,ht=S-1e-8;function dt(t){return lt=t,dt}function pt(){}function vt(t,e){lt.add(t,e)}function gt(t,e){vt(ct=t,ft=e)}function mt(t){vt(t,lt.y1)}function yt(t){vt(lt.x1,t)}function bt(t,e,n,r){var i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function xt(t,e,n,r,i){var a,o=r-t+3*e-3*n,u=t+n-2*e,s=t-e,l=0,c=0;Math.abs(o)>E?(a=u*u+s*o)>=0&&(l=(-u+(a=Math.sqrt(a)))/o,c=(-u-a)/o):l=.5*s/u,0<l&&l<1&&i(_t(l,t,e,n,r)),0<c&&c<1&&i(_t(c,t,e,n,r))}function _t(t,e,n,r,i){var a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*r+u*t*i}dt.beginPath=pt,dt.closePath=pt,dt.moveTo=gt,dt.lineTo=gt,dt.rect=function(t,e,n,r){vt(t+n,e+r),gt(t,e)},dt.quadraticCurveTo=function(t,e,n,r){bt(ct,t,n,mt),bt(ft,e,r,yt),gt(n,r)},dt.bezierCurveTo=function(t,e,n,r,i,a){xt(ct,t,n,i,mt),xt(ft,e,r,a,yt),gt(i,a)},dt.arc=function(t,e,n,r,i,a){if(ct=n*Math.cos(i)+t,ft=n*Math.sin(i)+e,Math.abs(i-r)>ht)vt(t-n,e-n),vt(t+n,e+n);else{var o,u,s=function(r){return vt(n*Math.cos(r)+t,n*Math.sin(r)+e)};if(s(r),s(i),i!==r)if((r%=S)<0&&(r+=S),(i%=S)<0&&(i+=S),i<r&&(a=!a,o=r,r=i,i=o),a)for(i-=S,o=r-r%M,u=0;u<4&&o>i;++u,o-=M)s(o);else for(o=r-r%M+M,u=0;u<4&&o<i;++u,o+=M)s(o)}};var wt=(wt=n.canvas(1,1))?wt.getContext("2d"):null,kt=new o;function At(t){return function(e,n){if(!wt)return!0;t(wt,e),kt.clear().union(e.bounds).intersect(n).round();for(var r=kt.x1,i=kt.y1,a=kt.x2,o=kt.y2,u=i;u<=o;++u)for(var s=r;s<=a;++s)if(wt.isPointInPath(s,u))return!0;return!1}}function Et(t,e){return e.contains(t.x||0,t.y||0)}function Mt(t,e){var n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(kt.set(n,r,n+i,r+a))}function St(t,e){var n=t.x||0,r=t.y||0;return Ct(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function Ct(t,e,n,r,i){var a,o,u,s,l=t.x1,c=t.y1,f=t.x2,h=t.y2,d=r-e,p=i-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(a=-d,o=-(l-e)),1===s&&(a=d,o=f-e),2===s&&(a=-p,o=-(c-n)),3===s&&(a=p,o=h-n),Math.abs(a)<1e-10&&o<0)return!1;if(u=o/a,a<0){if(u>g)return!1;u>v&&(v=u)}else if(a>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function Ot(t,e){return null==t?e:t}function Dt(t,e,n){return c(n)?function(t,e,n){for(var r=n.width(),i=n.height(),a=e.stops,o=a.length,u="radial"===e.gradient?t.createRadialGradient(n.x1+Ot(e.x1,.5)*r,n.y1+Ot(e.y1,.5)*i,Math.max(r,i)*Ot(e.r1,0),n.x1+Ot(e.x2,.5)*r,n.y1+Ot(e.y2,.5)*i,Math.max(r,i)*Ot(e.r2,.5)):t.createLinearGradient(n.x1+Ot(e.x1,0)*r,n.y1+Ot(e.y1,0)*i,n.x1+Ot(e.x2,1)*r,n.y1+Ot(e.y2,0)*i),s=0;s<o;++s)u.addColorStop(a[s].offset,a[s].color);return u}(t,n,e.bounds):n}function Ft(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Dt(t,e,e.fill),!0)}var Tt=[];function Nt(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Dt(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Tt),t.lineDashOffset=e.strokeDashOffset||0),!0)}function jt(t,e){return t.zindex-e.zindex||t.index-e.index}function Rt(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(jt)}function Pt(t,e){var n,r,i=t.items;if(i&&i.length){var a=Rt(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}}function zt(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var a=Rt(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Bt(t){return function(e,n,r){Pt(n,function(n){r&&!r.intersects(n.bounds)||qt(t,e,n,n)})}}function Lt(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||qt(t,e,n.items[0],n.items)}}function qt(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(n.fill&&Ft(e,n,i)&&e.fill(),n.stroke&&Nt(e,n,i)&&e.stroke()))}function It(t){return t=t||e.truthy,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,zt(n,function(n){var u=n.bounds;if((!u||u.contains(a,o))&&u)return t(e,n,r,i,a,o)?n:void 0})}}function Ut(t,e){return function(n,r,i,a){var o,u,s=Array.isArray(r)?r[0]:r,l=null==e?s.fill:e,c=s.stroke&&n.isPointInStroke;return c&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!t(n,r)&&(l&&n.isPointInPath(i,a)||c&&n.isPointInStroke(i,a))}}function Wt(t){return It(Ut(t))}function Ht(t,e){return"translate("+t+","+e+")"}function Vt(t){return"rotate("+t+")"}function Gt(t){return Ht(t.x||0,t.y||0)}function $t(t){return Ht(t.x||0,t.y||0)+(t.angle?" "+Vt(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}function Yt(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=A),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",$t(n)),t("d",e(null,n))},bound:function(t,n){var r=n.x||0,i=n.y||0;return e(dt(t),n),st(t,n).translate(r,i),n.angle&&t.rotate(n.angle*A,r,i),t},draw:Bt(r),pick:Wt(r),isect:n||At(r)}}var Xt=Yt("arc",function(t,e){return K.context(t)(e)});function Jt(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i=Ut(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(dt(t),r),st(t,r[0]))},draw:Lt(r),pick:function(t,e,n,r,a,o){var u=e.items,s=e.bounds;return!u||!u.length||s&&!s.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,u,n,r)?u[0]:null)},isect:Et,tip:n}}var Qt=Jt("area",function(t,e){var n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?et:tt).curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,u=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<u&&(u=r,n=t[o]);return n});function Zt(t,e){t.beginPath(),ot(e)?ut(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}var Kt=1;function te(t,n,r){var i=n.clip,a=t._defs,o=n.clip_id||(n.clip_id="clip"+Kt++),u=a.clipping[o]||(a.clipping[o]={id:o});return e.isFunction(i)?u.path=i(null):ot(r)?u.path=ut(null,r,0,0):(u.width=r.width||0,u.height=r.height||0),"url(#"+o+")"}function ee(t){var e=null!=(e=t.strokeWidth)?e:1;return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function ne(t,e){var n=ee(e);t("d",ut(null,e,n,n))}function re(t,e,n,r){var i=ee(e);t.beginPath(),ut(t,e,(n||0)+i,(r||0)+i)}var ie=Ut(re),ae=Ut(re,!1),oe={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Gt(e))},bound:function(t,e){if(!e.clip&&e.items)for(var n=e.items,r=0,i=n.length;r<i;++r)t.union(n[r].bounds);return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),st(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){var r=this;Pt(e,function(e){var i=e.x||0,a=e.y||0,o=e.strokeForeground,u=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&u&&(re(t,e,i,a),e.fill&&Ft(t,e,u)&&t.fill(),e.stroke&&!o&&Nt(t,e,u)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&Zt(t,e),n&&n.translate(-i,-a),Pt(e,function(e){r.draw(t,e,n)}),n&&n.translate(i,a),t.restore(),o&&e.stroke&&u&&(re(t,e,i,a),Nt(t,e,u)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;var o=this,u=n*t.pixelRatio,s=r*t.pixelRatio;return zt(e,function(l){var c,f,h,d,p,v,g,m,y;if((!(m=l.bounds)||m.contains(i,a))&&(d=l.x||0,p=l.y||0,v=d+(l.width||0),g=p+(l.height||0),!(y=l.clip)||!(i<d||i>v||a<d||a>g)))return t.save(),t.translate(d,p),d=i-d,p=a-p,y&&ot(l)&&!ie(t,l,u,s)?(t.restore(),null):(f=l.strokeForeground,(h=!1!==e.interactive)&&f&&l.stroke&&ae(t,l,u,s)?(t.restore(),l):(!(c=zt(l,function(t){return function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,d,p)?o.pick(t,n,r,d,p):null}))&&h&&(l.fill||!f&&l.stroke)&&ie(t,l,u,s)&&(c=l),t.restore(),c||null))})},isect:Mt,content:function(t,e,n){t("clip-path",e.clip?te(n,e,e):null)},background:function(t,e){t("class","background"),ne(t,e)},foreground:function(t,e){t("class","foreground"),e.strokeForeground?ne(t,e):t("d","")}};function ue(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(function(e){t.image=e,t.image.url=t.url})),n}function se(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function le(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function ce(t,e){return"center"===t?e/2:"right"===t?e:0}function fe(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var he={type:"image",tag:"image",nested:!1,attr:function(t,e,n){var r=ue(e,n),i=e.x||0,a=e.y||0,o=se(e,r),u=le(e,r),s=!1===e.aspect?"none":"xMidYMid";i-=ce(e.align,o),a-=fe(e.baseline,u),!r.src&&r.toDataURL?t("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href"):t("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),t("transform",Ht(i,a)),t("width",o),t("height",u),t("preserveAspectRatio",s)},bound:function(t,e){var n=e.image,r=e.x||0,i=e.y||0,a=se(e,n),o=le(e,n);return r-=ce(e.align,a),i-=fe(e.baseline,o),t.set(r,i,r+a,i+o)},draw:function(t,e,n){var r=this;Pt(e,function(e){if(!n||n.intersects(e.bounds)){var i,a,o,u,s=ue(e,r),l=e.x||0,c=e.y||0,f=se(e,s),h=le(e,s);l-=ce(e.align,f),c-=fe(e.baseline,h),!1!==e.aspect&&(a=s.width/s.height,o=e.width/e.height,a===a&&o===o&&a!==o&&(o<a?(c+=(h-(u=f/a))/2,h=u):(l+=(f-(u=h*a))/2,f=u))),(s.complete||s.toDataURL)&&(t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,l,c,f,h))}})},pick:It(),isect:e.truthy,get:ue,xOffset:ce,yOffset:fe},de=Jt("line",function(t,e){var n=e[0],r=n.interpolate||"linear";return nt.curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null});function pe(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*A,s=e.pathCache;s&&s.path===n||((e.pathCache=s=k(n)).path=n),u&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(u),R(t,s,0,0,a,o),t.rotate(-u),t.translate(-r,-i)):R(t,s,r,i,a,o)}var ve={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",$t(e)),t("d",e.path)},bound:function(t,e){return pe(dt(t),e)?t.set(0,0,0,0):st(t,e,!0),e.angle&&t.rotate(e.angle*A,e.x||0,e.y||0),t},draw:Bt(pe),pick:Wt(pe),isect:At(pe)};function ge(t,e){t.beginPath(),ut(t,e)}var me={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",ut(null,e))},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Bt(ge),pick:Wt(ge),isect:Mt};function ye(t,e,n){var r,i,a,o;return!(!e.stroke||!Nt(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var be,xe={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Gt(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Pt(e,function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&ye(t,e,r)&&t.stroke()}})},pick:It(function(t,e,n,r){return!!t.isPointInStroke&&ye(t,e,1)&&t.isPointInStroke(n,r)}),isect:St},_e=Yt("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),we=Yt("symbol",function(t,e){return it.context(t)(e)},Et),ke={height:Ce,measureWidth:Me,estimateWidth:Ae,width:Ae,canvas:Oe};function Ae(t,e){return be=Ce(t),Ee(Te(t,e))}function Ee(t){return~~(.8*t.length*be)}function Me(t,e){return Ce(t)<=0?0:(wt.font=je(t),Se(Te(t,e)))}function Se(t){return wt.measureText(t).width}function Ce(t){return null!=t.fontSize?t.fontSize:11}function Oe(t){ke.width=t&&wt?Me:Ae}function De(t){return null!=t.lineHeight?t.lineHeight:Ce(t)+2}function Fe(t){return n=t.lineBreak&&t.text&&!e.isArray(t.text)?t.text.split(t.lineBreak):t.text,e.isArray(n)?n.length>1?n:n[0]:n;var n}function Te(t,e){return null==e?"":t.limit>0?function(t,e){var n,r=+t.limit,i=e+"";if(ke.width===Me?(wt.font=je(t),n=Se):(be=Ce(t),n=Ee),n(i)<r)return i;var a,o=t.ellipsis||"\u2026",u="rtl"===t.dir,s=0,l=i.length;if(r-=n(o),u){for(;s<l;)a=s+l>>>1,n(i.slice(a))>r?s=a+1:l=a;return o+i.slice(s)}for(;s<l;)a=1+(s+l>>>1),n(i.slice(0,a))<r?s=a:l=a-1;return i.slice(0,s)+o}(t,e):e+""}function Ne(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function je(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Ce(t)+"px "+Ne(t,e)}function Re(t){var e=t.baseline,n=Ce(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:0)}Oe(!0);var Pe={left:"start",center:"middle",right:"end"},ze=new o;function Be(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-M,n+=i*Math.cos(e),r+=i*Math.sin(e)),ze.x1=n,ze.y1=r,ze}function Le(t,n,r){var i,a=ke.height(n),o=n.align,u=Be(n),s=u.x1,l=u.y1,c=n.dx||0,f=(n.dy||0)+Re(n)-Math.round(.8*a),h=Fe(n);if(e.isArray(h)?(a+=De(n)*(h.length-1),i=h.reduce(function(t,e){return Math.max(t,ke.width(n,e))},0)):i=ke.width(n,h),"center"===o?c-=i/2:"right"===o&&(c-=i),t.set(c+=s,f+=l,c+i,f+a),n.angle&&!r)t.rotate(n.angle*A,s,l);else if(2===r)return t.rotatedPoints(n.angle*A,s,l);return t}var qe={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Re(e),a=Be(e),o=a.x1,u=a.y1,s=e.angle||0;t("text-anchor",Pe[e.align]||"start"),s?(n=Ht(o,u)+" "+Vt(s),(r||i)&&(n+=" "+Ht(r,i))):n=Ht(o+r,u+i),t("transform",n)},bound:Le,draw:function(t,n,r){Pt(n,function(n){var i,a,o,u,s,l,c,f=null==n.opacity?1:n.opacity;if(!(r&&!r.intersects(n.bounds)||0===f||n.fontSize<=0||null==n.text||0===n.text.length)){if(t.font=je(n),t.textAlign=n.align||"left",a=(i=Be(n)).x1,o=i.y1,n.angle&&(t.save(),t.translate(a,o),t.rotate(n.angle*A),a=o=0),a+=n.dx||0,o+=(n.dy||0)+Re(n),l=Fe(n),e.isArray(l))for(s=De(n),u=0;u<l.length;++u)c=Te(n,l[u]),n.fill&&Ft(t,n,f)&&t.fillText(c,a,o),n.stroke&&Nt(t,n,f)&&t.strokeText(c,a,o),o+=s;else c=Te(n,l),n.fill&&Ft(t,n,f)&&t.fillText(c,a,o),n.stroke&&Nt(t,n,f)&&t.strokeText(c,a,o);n.angle&&t.restore()}})},pick:It(function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Be(e),u=o.x1,s=o.y1,l=Le(ze,e,1),c=-e.angle*A,f=Math.cos(c),h=Math.sin(c),d=f*i-h*a+(u-f*u+h*s),p=h*i+f*a+(s-h*u-f*s);return l.contains(d,p)}),isect:function(t,e){var n=Le(ze,t,2);return Ct(e,n[0],n[1],n[2],n[3])||Ct(e,n[0],n[1],n[4],n[5])||Ct(e,n[4],n[5],n[6],n[7])||Ct(e,n[2],n[3],n[6],n[7])}},Ie=Jt("trail",function(t,e){return at.context(t)(e)},function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}),Ue={arc:Xt,area:Qt,group:oe,image:he,line:de,path:ve,rect:me,rule:xe,shape:_e,symbol:we,text:qe,trail:Ie};function We(t,e,n){var r=Ue[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new o),t,n)}var He={mark:null};function Ve(t,e,n){var r,i,a,u,s=Ue[t.marktype],l=s.bound,c=t.items,f=c&&c.length;if(s.nested)return f?a=c[0]:(He.mark=t,a=He),u=We(a,l,n),e=e&&e.union(u)||u;if(e=e||t.bounds&&t.bounds.clear()||new o,f)for(r=0,i=c.length;r<i;++r)e.union(We(c[r],l,n));return t.bounds=e}var Ge=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function $e(t,e){return JSON.stringify(t,Ge,e)}function Ye(t){return function t(e){var n,r,i,a=e.marktype,o=e.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=e,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&t(o[r]);return a&&Ve(e),e}("string"===typeof t?JSON.parse(t):t)}function Xe(t){arguments.length?this.root=Ye(t):(this.root=Qe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new p(this.root)])}var Je=Xe.prototype;function Qe(t,e){return{bounds:new o,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0}}function Ze(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Ke(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function tn(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=Ze(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function en(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function nn(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function rn(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function an(t,e){this._active=null,this._handlers={},this._loader=t||r.loader(),this._tooltip=e||on}function on(t,e,n,r){t.element().setAttribute("title",r||"")}Je.toJSON=function(t){return $e(this.root,t||0)},Je.mark=function(t,e,n){var r=Qe(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var un=an.prototype;function sn(t){this._el=null,this._bgcolor=null,this._loader=new v(t)}un.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},un.element=function(){return this._el},un.canvas=function(){return this._el&&this._el.firstChild},un.origin=function(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},un.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},un.on=function(){},un.off=function(){},un._handlerIndex=function(t,e,n){for(var r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},un.handlers=function(t){var e,n=this._handlers,r=[];if(t)r.push.apply(r,n[this.eventName(t)]);else for(e in n)r.push.apply(r,n[e]);return r},un.eventName=function(t){var e=t.indexOf(".");return e<0?t:t.slice(0,e)},un.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(function(e){var n=new MouseEvent(t.type,t),r=Ze(null,"a");for(var i in e)r.setAttribute(i,e[i]);r.dispatchEvent(n)}).catch(function(){})},un.handleTooltip=function(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Ue[o.marktype]).tip){for((a=rn(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);var r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},un.getItemBoundingClientRect=function(t){if(e=this.canvas()){for(var e,n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();t.mark&&(t=t.mark.group);)a+=t.x||0,o+=t.y||0;return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}}};var ln=sn.prototype;ln.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},ln.element=function(){return this._el},ln.canvas=function(){return this._el&&this._el.firstChild},ln.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},ln.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},ln.dirty=function(){},ln.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},ln._render=function(){},ln.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then(function(){return e}):Promise.resolve(e)},ln._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(t){t&&i(),n._ready=null})}return r},ln.sanitizeURL=function(t){return this._load("sanitizeURL",t)},ln.loadImage=function(t){return this._load("loadImage",t)};var cn="mouseout";function fn(t,e){an.call(this,t,e),this._down=null,this._touch=null,this._first=!0}var hn=e.inherits(fn,an);function dn(t,e,n){return function(r){var i=this._active,a=this.pickEvent(r);a===i?this.fire(t,r):(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r),this.fire(t,r))}}function pn(t){return function(e){this.fire(t,e),this._active=null}}hn.initialize=function(t,e,n){var r=this._canvas=t&&Ke(t,"canvas");if(r){var i=this;this.events.forEach(function(t){r.addEventListener(t,function(e){hn[t]?hn[t].call(i,e):i.fire(t,e)})})}return an.prototype.initialize.call(this,t,e,n)},hn.canvas=function(){return this._canvas},hn.context=function(){return this._canvas.getContext("2d")},hn.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],hn.DOMMouseScroll=function(t){this.fire("mousewheel",t)},hn.mousemove=dn("mousemove","mouseover","mouseout"),hn.dragover=dn("dragover","dragenter","dragleave"),hn.mouseout=pn("mouseout"),hn.dragleave=pn("dragleave"),hn.mousedown=function(t){this._down=this._active,this.fire("mousedown",t)},hn.click=function(t){this._down===this._active&&(this.fire("click",t),this._down=null)},hn.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},hn.touchmove=function(t){this.fire("touchmove",t,!0)},hn.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},hn.fire=function(t,e,n){var r,i,a=n?this._touch:this._active,o=this._handlers[t];if(e.vegaType=t,"click"===t&&a&&a.href?this.handleHref(e,a,a.href):"mousemove"!==t&&t!==cn||this.handleTooltip(e,a,t!==cn),o)for(r=0,i=o.length;r<i;++r)o[r].handler.call(this._obj,e,a)},hn.on=function(t,e){var n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(r[n]||(r[n]=[])).push({type:t,handler:e}),this},hn.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},hn.pickEvent=function(t){var e=rn(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},hn.pick=function(t,e,n,r,i){var a=this.context();return Ue[t.marktype].pick.call(this,a,t,e,n,r,i)};var vn="undefined"!==typeof window&&window.devicePixelRatio||1;function gn(t){sn.call(this,t),this._redraw=!1,this._dirty=new o}var mn=e.inherits(gn,sn),yn=sn.prototype,bn=new o;function xn(t,e,n){return bn.set(0,0,e,n).translate(-t[0],-t[1])}function _n(t,e){an.call(this,t,e);var n=this;n._hrefHandler=kn(n,function(t,e){e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=kn(n,function(t,e){n.handleTooltip(t,e,t.type!==cn)})}mn.initialize=function(t,e,r,i,a,o){return this._options=o,this._canvas=n.canvas(1,1,o&&o.type),t&&(en(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),yn.initialize.call(this,t,e,r,i,a)},mn.resize=function(t,e,n,r){return yn.resize.call(this,t,e,n,r),function(t,e,n,r,i,a){var o,u="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),l=u?vn:i;for(o in t.width=e*l,t.height=n*l,a)s[o]=a[o];u&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context),this._redraw=!0,this},mn.canvas=function(){return this._canvas},mn.context=function(){return this._canvas?this._canvas.getContext("2d"):null},mn.dirty=function(t){var e=function(t,e){if(null==e)return t;for(var n=bn.clear().union(t);null!=e;e=e.mark.group)n.translate(e.x||0,e.y||0);return n}(t.bounds,t.mark.group);this._dirty.union(e)},mn._render=function(t){var e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;return e.save(),this._redraw||a.empty()?(this._redraw=!1,a=xn(n,r,i).expand(1)):a=function(t,e,n){return e.expand(1).round(),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(xn(n,r,i)),n),this.clear(-n[0],-n[1],r,i),this.draw(e,t,a),e.restore(),this._dirty.clear(),this},mn.draw=function(t,n,r){var i=Ue[n.marktype];n.clip&&function(t,n){var r=n.clip;t.save(),e.isFunction(r)?(t.beginPath(),r(t),t.clip()):Zt(t,n.group)}(t,n),i.draw.call(this,t,n,r),n.clip&&t.restore()},mn.clear=function(t,e,n,r){var i=this.context();i.clearRect(t,e,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(t,e,n,r))};var wn=e.inherits(_n,an);function kn(t,e){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,e.call(t._obj,n,r)}}function An(t,e,n){var r,i,a="<"+t;if(e)for(r in e)null!=(i=e[r])&&(a+=" "+r+'="'+i+'"');return n&&(a+=" "+n),a+">"}function En(t){return"</"+t+">"}wn.initialize=function(t,e,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mousemove",this._tooltipHandler),r.removeEventListener(cn,this._tooltipHandler)),this._svg=r=t&&Ke(t,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mousemove",this._tooltipHandler),r.addEventListener(cn,this._tooltipHandler)),an.prototype.initialize.call(this,t,e,n)},wn.canvas=function(){return this._svg},wn.on=function(t,e){var n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){var i={type:t,handler:e,listener:kn(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},wn.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};var Mn={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Sn={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Cn=Object.keys(Sn),On=Mn.xmlns;function Dn(t){sn.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Fn=e.inherits(Dn,sn),Tn=sn.prototype;function Nn(t,e,n){var r,i,a;if("radial"===e.gradient){var o=tn(t,n++,"pattern",On);o.setAttribute("id",l+e.id),o.setAttribute("viewBox","0,0,1,1"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("preserveAspectRatio","xMidYMid slice"),(o=tn(o,0,"rect",On)).setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("fill","url("+Un()+"#"+e.id+")"),(t=tn(t,n++,"radialGradient",On)).setAttribute("id",e.id),t.setAttribute("fx",e.x1),t.setAttribute("fy",e.y1),t.setAttribute("fr",e.r1),t.setAttribute("cx",e.x2),t.setAttribute("cy",e.y2),t.setAttribute("r",e.r2)}else(t=tn(t,n++,"linearGradient",On)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2);for(r=0,i=e.stops.length;r<i;++r)(a=tn(t,r,"stop",On)).setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return en(t,r),n}function jn(t,e,n){var r;return(t=tn(t,n,"clipPath",On)).setAttribute("id",e.id),e.path?(r=tn(t,0,"path",On)).setAttribute("d",e.path):((r=tn(t,0,"rect",On)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)),en(t,1),n+1}function Rn(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Pn(t,e,n,r,i){var a,o=t._svg;if(!o&&(o=Ze(a=e.ownerDocument,r,On),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){var u=Ze(a,"path",On);o.appendChild(u),u.__data__=t;var s=Ze(a,"g",On);o.appendChild(s),s.__data__=t;var l=Ze(a,"path",On);o.appendChild(l),l.__data__=t,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Fn.initialize=function(t,e,n,r){return t&&(this._svg=tn(t,0,"svg",On),this._svg.setAttribute("class","marks"),en(t,1),this._root=tn(this._svg,0,"g",On),en(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),Tn.initialize.call(this,t,e,n,r)},Fn.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),Tn.background.apply(this,arguments)},Fn.resize=function(t,e,n,r){return Tn.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},Fn.canvas=function(){return this._svg},Fn.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in Mn)t[e]=Mn[e];var n=this._bgcolor?An("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+En("rect"):"";return An("svg",t)+n+this._svg.innerHTML+En("svg")},Fn._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),en(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},Fn.updateDefs=function(){var t,e=this._svg,n=this._defs,r=n.el,i=0;for(t in n.gradient)r||(n.el=r=tn(e,0,"defs",On)),i=Nn(r,n.gradient[t],i);for(t in n.clipping)r||(n.el=r=tn(e,0,"defs",On)),i=jn(r,n.clipping[t],i);r&&(0===i?(e.removeChild(r),n.el=null):en(r,i))},Fn._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},Fn.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},Fn.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},Fn._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length||!this._dirtyID)return!0;var e,n,r,i,a,o,u,s=++this._dirtyID;for(a=0,o=t.length;a<o;++a)(n=(e=t[a]).mark).marktype!==r&&(r=n.marktype,i=Ue[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,Rn(e,s),n.items.forEach(function(t){t.dirty=s})),n.zdirty||(e.exit?(i.nested&&n.items.length?(u=n.items[0])._svg&&this._update(i,u._svg,u):e._svg&&(u=e._svg.parentNode)&&u.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==s&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,Rn(e,s)),e._update=s));return!this._dirtyAll},Fn.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this,a=this._svg,o=Ue[e.marktype],u=!1===e.interactive?"none":null,s="g"===o.tag,l=null,c=0;function f(t){var e=i.isDirty(t),n=Pn(t,r,l,o.tag,a);e&&(i._update(o,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;var r,i=0;Pt(n,function(n){r=t.draw(e,n,r),++i}),en(e,1+i)}(i,n,t)),l=n,++c}return(r=Pn(e,t,n,"g",a)).setAttribute("class",nn(e)),s||r.style.setProperty("pointer-events",u),e.clip?r.setAttribute("clip-path",te(i,e,e.group)):r.removeAttribute("clip-path"),o.nested?e.items.length&&f(e.items[0]):Pt(e,f),en(r,c),r};var zn=null,Bn=null,Ln={group:function(t,e,n){var r,i;zn=r=e.childNodes[2],Bn=r.__values__,t.foreground(In,n,this),Bn=e.__values__,zn=e.childNodes[1],t.content(In,n,this),zn=i=e.childNodes[0],t.background(In,n,this);var a=!1===n.mark.interactive?"none":null;if(a!==Bn.events&&(r.style.setProperty("pointer-events",a),i.style.setProperty("pointer-events",a),Bn.events=a),n.strokeForeground&&n.stroke){var o=n.fill;r.style.removeProperty("display"),this.style(i,n),i.style.removeProperty("stroke"),o&&(n.fill=null),Bn=r.__values__,this.style(r,n),o&&(n.fill=o),zn=null}else r.style.setProperty("display","none"),r.style.setProperty("fill","none")},image:function(t,e,n){!1===n.smooth?(qn(e,"image-rendering","optimizeSpeed"),qn(e,"image-rendering","pixelated")):qn(e,"image-rendering",null)},text:function(t,n,r){var i,a,o,u,s=Fe(r);e.isArray(s)?(i=(a=s.map(function(t){return Te(r,t)})).join("\n"))!==Bn.text&&(en(n,0),o=n.ownerDocument,u=De(r),a.forEach(function(t,e){var i=Ze(o,"tspan",On);i.__data__=r,i.textContent=t,e&&(i.setAttribute("x",0),i.setAttribute("dy",u)),n.appendChild(i)}),Bn.text=i):(a=Te(r,s))!==Bn.text&&(n.textContent=a,Bn.text=a),qn(n,"font-family",Ne(r)),qn(n,"font-size",Ce(r)+"px"),qn(n,"font-style",r.fontStyle),qn(n,"font-variant",r.fontVariant),qn(n,"font-weight",r.fontWeight)}};function qn(t,e,n){n!==Bn[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),Bn[e]=n)}function In(t,e,n){e!==Bn[t]&&(null!=e?n?zn.setAttributeNS(n,t,e):zn.setAttribute(t,e):n?zn.removeAttributeNS(n,t):zn.removeAttribute(t),Bn[t]=e)}function Un(){var t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Wn(t){sn.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}Fn._update=function(t,e,n){zn=e,Bn=e.__values__,t.attr(In,n,this);var r=Ln[t.type];r&&r.call(this,t,e,n),zn&&this.style(zn,n)},Fn.style=function(t,e){var n,r,i,a,o;if(null!=e)for(n=0,r=Cn.length;n<r;++n)o=e[i=Cn[n]],"font"===i&&(o=Ne(e)),o!==Bn[i]&&(a=Sn[i],null==o?"fill"===a?t.style.setProperty(a,"none"):t.style.removeProperty(a):(c(o)&&(o=f(o,this._defs.gradient,Un())),t.style.setProperty(a,o+"")),Bn[i]=o)};var Hn,Vn=e.inherits(Wn,sn),Gn=sn.prototype;function $n(t,e,n,r){Hn[r||t]=e}function Yn(t,e,n,r){if(null==t)return"";var i,a,o,u,s,l="";for("bgrect"===n&&!1===e.interactive&&(l+="pointer-events: none; "),"bgfore"===n&&(!1===e.interactive&&(l+="pointer-events: none; "),l+="display: none; "),"image"===n&&!1===t.smooth&&(l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "),"text"===n&&(l+="font-family: "+Ne(t)+"; ",l+="font-size: "+Ce(t)+"px; ",t.fontStyle&&(l+="font-style: "+t.fontStyle+"; "),t.fontVariant&&(l+="font-variant: "+t.fontVariant+"; "),t.fontWeight&&(l+="font-weight: "+t.fontWeight+"; ")),i=0,a=Cn.length;i<a;++i)o=Cn[i],u=Sn[o],null==(s=t[o])?"fill"===u&&(l+="fill: none; "):"transparent"!==s||"fill"!==u&&"stroke"!==u?(c(s)&&(s=f(s,r.gradient,"")),l+=u+": "+s+"; "):l+=u+": none; ";return l?'style="'+l.trim()+'"':null}function Xn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}Vn.resize=function(t,e,n,r){Gn.resize.call(this,t,e,n,r);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in Mn)o[u]=Mn[u];a.head=An("svg",o);var s=this._bgcolor;return"transparent"!==s&&"none"!==s||(s=null),a.bg=s?An("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+En("rect"):"",a.root=An("g",{transform:"translate("+i+")"}),a.foot=En("g")+En("svg"),this},Vn.background=function(){var t=Gn.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},Vn.svg=function(){var t=this._text;return t.head+t.bg+t.defs+t.root+t.body+t.foot},Vn._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},Vn.buildDefs=function(){var t,e,n,r,i,a=this._defs,o="";for(e in a.gradient){for(i=(n=a.gradient[e]).stops,"radial"===n.gradient?(o+=An(r="pattern",{id:l+e,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o+=An("rect",{width:"1",height:"1",fill:"url(#"+e+")"})+En("rect"),o+=En(r),o+=An(r="radialGradient",{id:e,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})):o+=An(r="linearGradient",{id:e,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),t=0;t<i.length;++t)o+=An("stop",{offset:i[t].offset,"stop-color":i[t].color})+En("stop");o+=En(r)}for(e in a.clipping)n=a.clipping[e],o+=An("clipPath",{id:e}),n.path?o+=An("path",{d:n.path})+En("path"):o+=An("rect",{x:0,y:0,width:n.width,height:n.height})+En("rect"),o+=En("clipPath");return o.length>0?An("defs")+o+En("defs"):""},Vn.attributes=function(t,e){return Hn={},t($n,e,this),Hn},Vn.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(function(t){t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},Vn.mark=function(t){var n,r=this,i=Ue[t.marktype],a=i.tag,o=this._defs,u="";function s(s){var l=r.href(s);if(l&&(u+=An("a",l)),n="g"!==a?Yn(s,t,a,o):null,u+=An(a,r.attributes(i.attr,s),n),"text"===a){var c=Fe(s);if(e.isArray(c))for(var f={x:0,dy:De(s)},h=0;h<c.length;++h)u+=An("tspan",h?f:null)+Xn(Te(s,c[h]))+En("tspan");else u+=Xn(Te(s,c))}else if("g"===a){var d=s.strokeForeground,p=s.fill,v=s.stroke;d&&v&&(s.stroke=null),u+=An("path",r.attributes(i.background,s),Yn(s,t,"bgrect",o))+En("path"),u+=An("g",r.attributes(i.content,s))+r.markGroup(s)+En("g"),d&&v?(p&&(s.fill=null),s.stroke=v,u+=An("path",r.attributes(i.foreground,s),Yn(s,t,"bgrect",o))+En("path"),p&&(s.fill=p)):u+=An("path",r.attributes(i.foreground,s),Yn({},t,"bgfore",o))+En("path")}u+=En(a),l&&(u+=En("a"))}return"g"!==a&&!1===t.interactive&&(n='style="pointer-events: none;"'),u+=An("g",{class:nn(t),"clip-path":t.clip?te(r,t,t.group):null},n),i.nested?t.items&&t.items.length&&s(t.items[0]):Pt(t,s),u+En("g")},Vn.markGroup=function(t){var e=this,n="";return Pt(t,function(t){n+=e.mark(t)}),n};var Jn={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Qn={};function Zn(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){var i=t.items,a=t.marktype,o=i.length,u=0;if("group"===a)for(;u<o;++u)Kn(i[u],e,n,r);else for(var s=Ue[a].isect;u<o;++u){var l=i[u];tr(l,e,s)&&r.push(l)}}return r}function Kn(t,e,n,r){n&&n(t.mark)&&tr(t,e,Ue.group.isect)&&r.push(t);var i=t.items,a=i&&i.length;if(a){var o=t.x||0,u=t.y||0;e.translate(-o,-u);for(var s=0;s<a;++s)Zn(i[s],e,n,r);e.translate(o,u)}return r}function tr(t,e,n){var r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Qn.canvas=Qn.png={renderer:gn,headless:gn,handler:fn},Qn.svg={renderer:Dn,headless:Wn,handler:_n},Qn.none={};var er=new o,nr=1e-9;function rr(t,n,r){return t===n||("path"===r?ir(t,n):t instanceof Date&&n instanceof Date?+t===+n:e.isNumber(t)&&e.isNumber(n)?Math.abs(t-n)<=nr:t&&n&&(e.isObject(t)||e.isObject(n))?null!=t&&null!=n&&function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!rr(t[n],e[n],n))return!1;return typeof t===typeof e}(t,n):t==n)}function ir(t,e){return rr(k(t),k(e))}t.Bounds=o,t.CanvasHandler=fn,t.CanvasRenderer=gn,t.Gradient=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}},t.GroupItem=p,t.Handler=an,t.Item=d,t.Marks=Ue,t.RenderType=Jn,t.Renderer=sn,t.ResourceLoader=v,t.SVGHandler=_n,t.SVGRenderer=Dn,t.SVGStringRenderer=Wn,t.Scenegraph=Xe,t.boundClip=function(t){var n=t.clip;if(e.isFunction(n))n(dt(er.clear()));else{if(!n)return;er.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(er)},t.boundContext=dt,t.boundItem=We,t.boundMark=Ve,t.boundStroke=st,t.closeTag=En,t.domChild=tn,t.domClear=en,t.domCreate=Ze,t.domFind=Ke,t.font=je,t.fontFamily=Ne,t.fontSize=Ce,t.intersect=function(t,n,r){var i=[],a=(new o).union(n),u=t.marktype;return u?Zn(t,a,r,i):"group"===u?Kn(t,a,r,i):e.error("Intersect scene must be mark node or group item.")},t.intersectBoxLine=Ct,t.intersectPath=At,t.intersectPoint=Et,t.intersectRule=St,t.lineHeight=De,t.multiLineOffset=function(t){var n=Fe(t);return(e.isArray(n)?n.length-1:0)*De(t)},t.openTag=An,t.pathCurves=x,t.pathEqual=ir,t.pathParse=k,t.pathRectangle=$,t.pathRender=R,t.pathSymbols=B,t.pathTrail=Y,t.point=rn,t.renderModule=function(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Qn[t]=e,this):Qn[t]},t.resetSVGClipId=function(){Kt=1},t.sceneEqual=rr,t.sceneFromJSON=Ye,t.scenePickVisit=zt,t.sceneToJSON=$e,t.sceneVisit=Pt,t.sceneZOrder=Rt,t.textMetrics=ke,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040),n(1171),n(1562),n(2118),n(1080))},1564:function(t,e,n){!function(t,e,n){"use strict";var r=e.geoPath(),i=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function a(t,n){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(o[t]=function(t,n){return function r(){var a=n();return a.type=t,a.path=e.geoPath().projection(a),a.copy=a.copy||function(){var t=r();return i.forEach(function(e){a[e]&&t[e](a[e]())}),t.path.pointRadius(a.path.pointRadius()),t},a}}(t,n),this):o[t]||null}var o={albers:e.geoAlbers,albersusa:e.geoAlbersUsa,azimuthalequalarea:e.geoAzimuthalEqualArea,azimuthalequidistant:e.geoAzimuthalEquidistant,conicconformal:e.geoConicConformal,conicequalarea:e.geoConicEqualArea,conicequidistant:e.geoConicEquidistant,equalEarth:e.geoEqualEarth,equirectangular:e.geoEquirectangular,gnomonic:e.geoGnomonic,identity:e.geoIdentity,mercator:e.geoMercator,mollweide:n.geoMollweide,naturalEarth1:e.geoNaturalEarth1,orthographic:e.geoOrthographic,stereographic:e.geoStereographic,transversemercator:e.geoTransverseMercator};for(var u in o)a(u,o[u]);t.getProjectionPath=function(t){return t&&t.path||r},t.projection=a,t.projectionProperties=i,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1224),n(2124))},1565:function(t,e,n){(function(t){var r=n(19),i=n(1112);!function(e,n,a,o,u){"use strict";var s=/^([A-Za-z]+:)?\/\//,l=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,f="file://";function h(t,e){return d.apply(this,arguments)}function d(){return(d=i(r.mark(function t(e,n){var i,a;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sanitize(e,n);case 2:return i=t.sent,a=i.href,t.abrupt("return",i.localFile?this.file(a):this.http(a,n));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function p(t,e){return v.apply(this,arguments)}function v(){return(v=i(r.mark(function t(e,i){var a,o,u,h,d,p,v;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.extend({},this.options,i),a=this.fileAccess,o={href:null},p=l.test(e.replace(c,"")),null!=e&&"string"===typeof e&&p||n.error("Sanitize failure, invalid URI: "+n.stringValue(e)),v=s.test(e),(d=i.baseURL)&&!v&&(e.startsWith("/")||"/"===d[d.length-1]||(e="/"+e),e=d+e),h=(u=e.startsWith(f))||"file"===i.mode||"http"!==i.mode&&!v&&a,u?e=e.slice(f.length):e.startsWith("//")&&("file"===i.defaultProtocol?(e=e.slice(2),h=!0):e=(i.defaultProtocol||"http")+":"+e),Object.defineProperty(o,"localFile",{value:!!h}),o.href=e,i.target&&(o.target=i.target+""),i.rel&&(o.rel=i.rel+""),"image"===i.context&&i.crossOrigin&&(o.crossOrigin=i.crossOrigin+""),t.abrupt("return",o);case 14:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function g(t){return t?function(e){return new Promise(function(n,r){t.readFile(e,function(t,e){t?r(t):n(e)})})}:m}function m(){return y.apply(this,arguments)}function y(){return(y=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No file system access.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}function b(t){return t?function(){var e=i(r.mark(function e(i,a){var o,u,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.extend({},this.options.http,a),u=a&&a.response,e.next=4,t(i,o);case 4:return s=e.sent,e.abrupt("return",s.ok?n.isFunction(s[u])?s[u]():s.text():n.error(s.status+""+s.statusText));case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}():x}function x(){return _.apply(this,arguments)}function _(){return(_=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No HTTP fetch method available.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}var w={boolean:n.toBoolean,integer:n.toNumber,number:n.toNumber,date:n.toDate,string:n.toString,unknown:n.identity},k=[function(t){return"true"===t||"false"===t||!0===t||!1===t},function(t){return S(t)&&Number.isInteger(+t)},S,function(t){return!Number.isNaN(Date.parse(t))}],A=["boolean","integer","number","date"];function E(t,e){if(!t||!t.length)return"unknown";var n,r,i,a,o=0,u=t.length,s=k.length,l=k.map(function(t,e){return e+1});for(r=0,u=t.length;r<u;++r)for(n=e?t[r][e]:t[r],i=0;i<s;++i)if(l[i]&&null!=(a=n)&&a===a&&!k[i](n)&&(l[i]=0,++o===k.length))return"string";return o=l.reduce(function(t,e){return 0===t?e:t},0)-1,A[o]}function M(t,e){return e.reduce(function(e,n){return e[n]=E(t,n),e},{})}function S(t){return!Number.isNaN(+t)&&!(t instanceof Date)}function C(t){var e=function(e,r){var i={delimiter:t};return O(e,r?n.extend(r,i):i)};return e.responseType="text",e}function O(t,e){return e.header&&(t=e.header.map(n.stringValue).join(e.delimiter)+"\n"+t),a.dsvFormat(e.delimiter).parse(t+"")}function D(e,r){var i,a=r&&r.property?n.field(r.property):n.identity;return!n.isObject(e)||(i=e,"function"===typeof t&&n.isFunction(t.isBuffer)&&t.isBuffer(i))?a(JSON.parse(e)):function(t,e){return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(a(e))}O.responseType="text",D.responseType="json";var F={interior:function(t,e){return t!==e},exterior:function(t,e){return t===e}};function T(t,e){var r,i,a,u;return t=D(t,e),e&&e.feature?(r=o.feature,a=e.feature):e&&e.mesh?(r=o.mesh,a=e.mesh,u=F[e.filter]):n.error("Missing TopoJSON feature or mesh parameter."),(i=(i=t.objects[a])?r(t,i,u):n.error("Invalid TopoJSON object: "+a))&&i.features||[i]}T.responseType="json";var N={dsv:O,csv:C(","),tsv:C("\t"),json:D,topojson:T};function j(t,e){return arguments.length>1?(N[t]=e,this):n.hasOwnProperty(N,t)?N[t]:null}var R=function(t,e){return function(n){return{options:n||{},sanitize:p,load:h,fileAccess:!!e,file:g(e),http:b(t)}}}("undefined"!==typeof fetch&&fetch,null);e.format=N,e.formats=j,e.inferType=E,e.inferTypes=M,e.loader=R,e.read=function(t,e,r){var i=j((e=e||{}).type||"json");return i||n.error("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n){if(t.length){n=n||u.timeParse;var r,i,a,o,s,l,c,f=t.columns||Object.keys(t[0]);for("auto"===e&&(e=M(t,f)),f=Object.keys(e),r=f.map(function(t){var r,i,a=e[t];if(a&&(0===a.indexOf("date:")||0===a.indexOf("utc:")))return("'"===(i=(r=a.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?u.utcParse(i):n(i);if(!w[a])throw Error("Illegal format pattern: "+t+":"+a);return w[a]}),o=0,l=t.length,c=f.length;o<l;++o)for(i=t[o],s=0;s<c;++s)a=f[s],i[a]=r[s](i[a])}}(t,e.parse,r),n.hasOwnProperty(t,"columns")&&delete t.columns,t},e.responseType=function(t){var e=j(t);return e&&e.responseType||"text"},e.typeParsers=w,Object.defineProperty(e,"__esModule",{value:!0})}(e,n(1341),n(2137),n(1342),n(1091))}).call(this,n(47).Buffer)},1566:function(t,e,n){!function(t,e,n){"use strict";function r(t,e,n){";"!==e[e.length-1]&&(e="return("+e+");");var r=Function.apply(null,t.concat(e));return n&&n.functions?r.bind(n.functions):r}function i(t,e){return r(["event"],t,e)}function a(t,e){return r(["item","_"],t,e)}function o(t,e,r){var i,a;for(i in r=r||{},t)a=t[i],r[i]=n.isArray(a)?a.map(function(t){return u(t,e,r)}):u(a,e,r);return r}function u(t,e,r){if(!t||!n.isObject(t))return t;for(var i,a=0,o=s.length;a<o;++a)if(i=s[a],n.hasOwnProperty(t,i.key))return i.parse(t,e,r);return t}var s=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||n.error("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){var r="k:"+t.$key+"_"+!!t.$flat;return e.fn[r]||(e.fn[r]=n.key(t.$key,t.$flat))}},{key:"$expr",parse:function(t,e,i){t.$params&&o(t.$params,e,i);var a="e:"+t.$expr+"_"+t.$name;return e.fn[a]||(e.fn[a]=n.accessor(function(t,e){return r(["datum","_"],t,e)}(t.$expr,e),t.$fields,t.$name))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;var r="f:"+t.$field+"_"+t.$name;return e.fn[r]||(e.fn[r]=n.field(t.$field,t.$name))}},{key:"$encode",parse:function(t,e){var r,i,o=t.$encode,u={};for(r in o)i=o[r],u[r]=n.accessor(a(i.$expr,e),i.$fields),u[r].output=i.$output;return u}},{key:"$compare",parse:function(t,r){var i="c:"+t.$compare+"_"+t.$order,a=n.array(t.$compare).map(function(t){return t&&t.$tupleid?e.tupleid:t});return r.fn[i]||(r.fn[i]=n.compare(a,t.$order))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){var n=t.$subflow;return function(t,r,i){var a=h(n,e.fork()),o=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(i),o}}},{key:"$tupleid",parse:function(){return e.tupleid}}];function l(t){return(t+"").toLowerCase()}function c(t,e){"operator"!==l(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?function(t,e){return r(["_"],t,e)}(t.update,e):null)}function f(t,e){var a=n.isObject(a=t.source)?a.$ref:a,u=e.get(a),s=null,l=t.update,c=void 0;u||n.error("Source not defined: "+t.source),s=t.target&&t.target.$expr?i(t.target.$expr,e):e.get(t.target),l&&l.$expr&&(l.$params&&(c=o(l.$params,e)),l=function(t,e){return r(["_","event"],t,e)}(l.$expr,e)),e.update(t,u,s,l,c)}function h(t,e){var r=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),r.forEach(function(t){c(t,e)}),r.forEach(function(t){!function(t,e){if(t.params){var r=e.get(t.id);r||n.error("Invalid operator id: "+t.id),e.dataflow.connect(r,r.parameters(o(t.params,e),t.react,t.initonly))}}(t,e)}),(t.streams||[]).forEach(function(t){!function(t,e){var r,a=null!=t.filter?i(t.filter,e):void 0,o=null!=t.stream?e.get(t.stream):void 0;t.source?o=e.events(t.source,t.type,a):t.merge&&(o=(r=t.merge.map(e.get.bind(e)))[0].merge.apply(r[0],r.slice(1))),t.between&&(r=t.between.map(e.get.bind(e)),o=o.between(r[0],r[1])),t.filter&&(o=o.filter(a)),null!=t.throttle&&(o=o.throttle(+t.throttle)),null!=t.debounce&&(o=o.debounce(+t.debounce)),null==o&&n.error("Invalid stream definition: "+JSON.stringify(t)),t.consume&&o.consume(!0),e.stream(t,o)}(t,e)}),(t.updates||[]).forEach(function(t){f(t,e)}),e.resolve()}var d={skip:!0};function p(t,e,n){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function v(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.functions=t.functions,this.events=t.events,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}p.prototype=v.prototype={fork:function(){var t=new v(this);return(this.subcontext||(this.subcontext=[])).push(t),t},get:function(t){return this.nodes[t]},set:function(t,e){return this.nodes[t]=e},add:function(t,e){var n,r=this,i=r.dataflow;if(r.set(t.id,e),"collect"===l(t.type)&&(n=t.value)&&(n.$ingest?i.ingest(e,n.$ingest,n.$format):n.$request?i.preload(e,n.$request,n.$format):i.pulse(e,i.changeset().insert(n))),t.root&&(r.root=e),t.parent){var a=r.get(t.parent.$ref);a?(i.connect(a,[e]),e.targets().add(a)):(r.unresolved=r.unresolved||[]).push(function(){a=r.get(t.parent.$ref),i.connect(a,[e]),e.targets().add(a)})}if(t.signal&&(r.signals[t.signal]=e),t.scale&&(r.scales[t.scale]=e),t.data)for(var o in t.data)n=r.data[o]||(r.data[o]={}),t.data[o].forEach(function(t){n[t]=e})},resolve:function(){return(this.unresolved||[]).forEach(function(t){t()}),delete this.unresolved,this},operator:function(t,e){this.add(t,this.dataflow.add(t.value,e))},transform:function(t,e){this.add(t,this.dataflow.add(this.transforms[l(e)]))},stream:function(t,e){this.set(t.id,e)},update:function(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(function(n){var i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(function(n){var r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)})}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map(function(e){return e.getState(t)})),n},setState:function(t){var e=this,r=e.dataflow,i=t.data,a=t.signals;Object.keys(a||{}).forEach(function(t){r.update(e.signals[t],a[t],d)}),Object.keys(i||{}).forEach(function(t){r.pulse(e.data[t].input,r.changeset().remove(n.truthy).insert(i[t]))}),(t.subcontext||[]).forEach(function(t,n){var r=e.subcontext[n];r&&r.setState(t)})}},t.context=function(t,e,n){return new p(t,e,n)},t.expression=r,t.parse=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1040))},2112:function(t,e,n){(function(e){var r=n(19),i=n(15),a=n(16);t.exports=function(t,n){"use strict";var o="6.5.1";function u(t,e,n,r){return new(n||(n=Promise))(function(i,a){function o(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,u)}s((r=r.apply(t,e||[])).next())})}var s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=Object.prototype.hasOwnProperty;function c(t,e){return l.call(t,e)}function f(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);for(var r in e=[],t)c(t,r)&&e.push(r);return e}function h(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function d(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function p(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function v(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function g(t,e){var n=[t];for(var r in e){var i="object"===typeof e[r]?JSON.stringify(e[r],null,2):e[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var m=function(t){function e(e,n,r,i,a){var o=this.constructor,u=t.call(this,g(e,{name:n,index:r,operation:i,tree:a}))||this;return u.name=n,u.index=r,u.operation=i,u.tree=a,Object.setPrototypeOf(u,o.prototype),u.message=g(e,{name:n,index:r,operation:i,tree:a}),u}return s(e,t),e}(Error),y=m,b=h,x={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=w(n,this.path);r&&(r=h(r));var i=k(n,{op:"remove",path:this.from}).removed;return k(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=w(n,this.from);return k(n,{op:"add",path:this.path,value:h(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:S(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},_={add:function(t,e,n){return d(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:x.move,copy:x.copy,test:x.test,_get:x._get};function w(t,e){if(""==e)return t;var n={op:"_get",path:e};return k(t,n),n.value}function k(t,e,n,r,i,a){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===a&&(a=0),n&&("function"==typeof n?n(e,0,t,e.path):E(e,0)),""===e.path){var o={newDocument:t};if("add"===e.op)return o.newDocument=e.value,o;if("replace"===e.op)return o.newDocument=e.value,o.removed=t,o;if("move"===e.op||"copy"===e.op)return o.newDocument=w(t,e.from),"move"===e.op&&(o.removed=t),o;if("test"===e.op){if(o.test=S(t,e.value),!1===o.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}if("remove"===e.op)return o.removed=t,o.newDocument=null,o;if("_get"===e.op)return e.value=t,o;if(n)throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}r||(t=h(t));var u=(e.path||"").split("/"),s=t,l=1,c=u.length,f=void 0,p=void 0,g=void 0;for(g="function"==typeof n?n:E;;){if(p=u[l],i&&"__proto__"==p)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===s[p]?f=u.slice(0,l).join("/"):l==c-1&&(f=e.path),void 0!==f&&g(e,0,t,f)),l++,Array.isArray(s)){if("-"===p)p=s.length;else{if(n&&!d(p))throw new y("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);d(p)&&(p=~~p)}if(l>=c){if(n&&"add"===e.op&&p>s.length)throw new y("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);if(!1===(o=_[e.op].call(e,s,p,t)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}}else if(p&&-1!=p.indexOf("~")&&(p=v(p)),l>=c){if(!1===(o=x[e.op].call(e,s,p,t)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}s=s[p]}}function A(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=h(t));for(var a=new Array(e.length),o=0,u=e.length;o<u;o++)a[o]=k(t,e[o],n,!0,i,o),t=a[o].newDocument;return a.newDocument=t,a}function E(t,e,n,r){if("object"!==typeof t||null===t||Array.isArray(t))throw new y("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!x[t.op])throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!==typeof t.path)throw new y("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new y('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!==typeof t.from)throw new y("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&function t(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return!0}else if("object"===typeof e){var i=f(e),a=i.length;for(n=0;n<a;n++)if(t(e[i[n]]))return!0}return!1}(t.value))throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new y("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new y("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var o=M([{op:"_get",path:t.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new y("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function M(t,e,n){try{if(!Array.isArray(t))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)A(h(e),h(t),n||!0);else{n=n||E;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof y)return i;throw i}}function S(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,a=Array.isArray(t),o=Array.isArray(e);if(a&&o){if((r=t.length)!=e.length)return!1;for(n=r;0!==n--;)if(!S(t[n],e[n]))return!1;return!0}if(a!=o)return!1;var u=Object.keys(t);if((r=u.length)!==Object.keys(e).length)return!1;for(n=r;0!==n--;)if(!e.hasOwnProperty(u[n]))return!1;for(n=r;0!==n--;)if(!S(t[i=u[n]],e[i]))return!1;return!0}return t!==t&&e!==e}var C=Object.freeze({__proto__:null,JsonPatchError:y,deepClone:b,getValueByPointer:w,applyOperation:k,applyPatch:A,applyReducer:function(t,e,n){var r=k(t,e);if(!1===r.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument},validator:E,validate:M,_areEquals:S}),O=new WeakMap,D=function(t){this.observers=new Map,this.obj=t},F=function(t,e){this.callback=t,this.observer=e};function T(t,e){void 0===e&&(e=!1);var n=O.get(t.object);N(n.value,t.object,t.patches,"",e),t.patches.length&&A(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function N(t,e,n,r,i){if(e!==t){"function"===typeof e.toJSON&&(e=e.toJSON());for(var a=f(e),o=f(t),u=!1,s=o.length-1;s>=0;s--){var l=t[v=o[s]];if(!c(e,v)||void 0===e[v]&&void 0!==l&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+p(v),value:h(l)}),n.push({op:"remove",path:r+"/"+p(v)}),u=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}));else{var d=e[v];"object"==typeof l&&null!=l&&"object"==typeof d&&null!=d?N(l,d,n,r+"/"+p(v),i):l!==d&&(i&&n.push({op:"test",path:r+"/"+p(v),value:h(l)}),n.push({op:"replace",path:r+"/"+p(v),value:h(d)}))}}if(u||a.length!=o.length)for(s=0;s<a.length;s++){var v;c(t,v=a[s])||void 0===e[v]||n.push({op:"add",path:r+"/"+p(v),value:h(e[v])})}}}var j=Object.freeze({__proto__:null,unobserve:function(t,e){e.unobserve()},observe:function(t,e){var n,r=function(t){return O.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new D(t),O.set(t,r);if(n)return n;if(n={},r.value=h(t),e){n.callback=e,n.next=null;var a=function(){T(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=t,n.unobserve=function(){T(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new F(e,n)),n},generate:T,compare:function(t,e,n){void 0===n&&(n=!1);var r=[];return N(t,e,r,"",n),r}});Object.assign({},C,j,{JsonPatchError:m,deepClone:h,escapePathComponent:p,unescapePathComponent:v});var R=/("(?:[^\\"]|\\.)*")|[:,]/g,P=function(t,e){var n,r,i;return e=e||{},n=JSON.stringify([1],void 0,void 0===e.indent?2:e.indent).slice(2,-3),r=""===n?1/0:void 0===e.maxLength?80:e.maxLength,i=e.replacer,function t(e,a,o){var u,s,l,c,f,h,d,p,v,g,m,y;if(e&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0===(m=JSON.stringify(e,i)))return m;if(d=r-a.length-o,m.length<=d&&(v=m.replace(R,function(t,e){return e||t+" "})).length<=d)return v;if(null!=i&&(e=JSON.parse(m),i=void 0),"object"===typeof e&&null!==e){if(p=a+n,l=[],s=0,Array.isArray(e))for(g="[",u="]",d=e.length;s<d;s++)l.push(t(e[s],p,s===d-1?0:1)||"null");else for(g="{",u="}",d=(h=Object.keys(e)).length;s<d;s++)c=h[s],f=JSON.stringify(c)+": ",void 0!==(y=t(e[c],p,f.length+(s===d-1?0:1)))&&l.push(f+y);if(l.length>0)return[g,n+l.join(",\n"+p),u].join("\n"+a)}return m}(t,"",0)};function z(t,e){return t(e={exports:{}},e.exports),e.exports}var B,L=Number.MAX_SAFE_INTEGER||9007199254740991,q={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:L,MAX_SAFE_COMPONENT_LENGTH:16},I="object"===typeof e&&Object({NODE_ENV:"production",PUBLIC_URL:"."})&&Object({NODE_ENV:"production",PUBLIC_URL:"."}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",PUBLIC_URL:"."}).NODE_DEBUG)?function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=console).error.apply(t,["SEMVER"].concat(n))}:function(){},U=z(function(t,e){var n=q.MAX_SAFE_COMPONENT_LENGTH,r=(e=t.exports={}).re=[],i=e.src=[],a=e.t={},o=0,u=function(t,e,n){var u=o++;I(u,e),a[t]=u,i[u]=e,r[u]=new RegExp(e,n?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION","(".concat(i[a.NUMERICIDENTIFIER],")\\.")+"(".concat(i[a.NUMERICIDENTIFIER],")\\.")+"(".concat(i[a.NUMERICIDENTIFIER],")")),u("MAINVERSIONLOOSE","(".concat(i[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[a.NUMERICIDENTIFIERLOOSE],")")),u("PRERELEASEIDENTIFIER","(?:".concat(i[a.NUMERICIDENTIFIER],"|").concat(i[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASEIDENTIFIERLOOSE","(?:".concat(i[a.NUMERICIDENTIFIERLOOSE],"|").concat(i[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASE","(?:-(".concat(i[a.PRERELEASEIDENTIFIER],"(?:\\.").concat(i[a.PRERELEASEIDENTIFIER],")*))")),u("PRERELEASELOOSE","(?:-?(".concat(i[a.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(i[a.PRERELEASEIDENTIFIERLOOSE],")*))")),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD","(?:\\+(".concat(i[a.BUILDIDENTIFIER],"(?:\\.").concat(i[a.BUILDIDENTIFIER],")*))")),u("FULLPLAIN","v?".concat(i[a.MAINVERSION]).concat(i[a.PRERELEASE],"?").concat(i[a.BUILD],"?")),u("FULL","^".concat(i[a.FULLPLAIN],"$")),u("LOOSEPLAIN","[v=\\s]*".concat(i[a.MAINVERSIONLOOSE]).concat(i[a.PRERELEASELOOSE],"?").concat(i[a.BUILD],"?")),u("LOOSE","^".concat(i[a.LOOSEPLAIN],"$")),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE","".concat(i[a.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),u("XRANGEIDENTIFIER","".concat(i[a.NUMERICIDENTIFIER],"|x|X|\\*")),u("XRANGEPLAIN","[v=\\s]*(".concat(i[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[a.XRANGEIDENTIFIER],")")+"(?:".concat(i[a.PRERELEASE],")?").concat(i[a.BUILD],"?")+")?)?"),u("XRANGEPLAINLOOSE","[v=\\s]*(".concat(i[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[a.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(i[a.PRERELEASELOOSE],")?").concat(i[a.BUILD],"?")+")?)?"),u("XRANGE","^".concat(i[a.GTLT],"\\s*").concat(i[a.XRANGEPLAIN],"$")),u("XRANGELOOSE","^".concat(i[a.GTLT],"\\s*").concat(i[a.XRANGEPLAINLOOSE],"$")),u("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),u("COERCERTL",i[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM","(\\s*)".concat(i[a.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",u("TILDE","^".concat(i[a.LONETILDE]).concat(i[a.XRANGEPLAIN],"$")),u("TILDELOOSE","^".concat(i[a.LONETILDE]).concat(i[a.XRANGEPLAINLOOSE],"$")),u("LONECARET","(?:\\^)"),u("CARETTRIM","(\\s*)".concat(i[a.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",u("CARET","^".concat(i[a.LONECARET]).concat(i[a.XRANGEPLAIN],"$")),u("CARETLOOSE","^".concat(i[a.LONECARET]).concat(i[a.XRANGEPLAINLOOSE],"$")),u("COMPARATORLOOSE","^".concat(i[a.GTLT],"\\s*(").concat(i[a.LOOSEPLAIN],")$|^$")),u("COMPARATOR","^".concat(i[a.GTLT],"\\s*(").concat(i[a.FULLPLAIN],")$|^$")),u("COMPARATORTRIM","(\\s*)".concat(i[a.GTLT],"\\s*(").concat(i[a.LOOSEPLAIN],"|").concat(i[a.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE","^\\s*(".concat(i[a.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(i[a.XRANGEPLAIN],")")+"\\s*$"),u("HYPHENRANGELOOSE","^\\s*(".concat(i[a.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(i[a.XRANGEPLAINLOOSE],")")+"\\s*$"),u("STAR","(<|>)?=?\\s*\\*")}),W=(U.re,U.src,U.t,U.tildeTrimReplace,U.caretTrimReplace,U.comparatorTrimReplace,/^[0-9]+$/),H=function(t,e){var n=W.test(t),r=W.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},V={compareIdentifiers:H,rcompareIdentifiers:function(t,e){return H(e,t)}},G=q.MAX_LENGTH,$=q.MAX_SAFE_INTEGER,Y=U.re,X=U.t,J=V.compareIdentifiers,Q=function(){function t(e,n){if(i(this,t),n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),e instanceof t){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError("Invalid Version: ".concat(e));if(e.length>G)throw new TypeError("version is longer than ".concat(G," characters"));I("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var r=e.trim().match(n.loose?Y[X.LOOSE]:Y[X.FULL]);if(!r)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>$||this.major<0)throw new TypeError("Invalid major version");if(this.minor>$||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>$||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<$)return e}return t}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}return a(t,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(e){if(I("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if("string"===typeof e&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}},{key:"compareMain",value:function(e){return e instanceof t||(e=new t(e,this.options)),J(this.major,e.major)||J(this.minor,e.minor)||J(this.patch,e.patch)}},{key:"comparePre",value:function(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],i=e.prerelease[n];if(I("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return J(r,i)}while(++n)}},{key:"compareBuild",value:function(e){e instanceof t||(e=new t(e,this.options));var n=0;do{var r=this.build[n],i=e.build[n];if(I("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return J(r,i)}while(++n)}},{key:"inc",value:function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"===typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}]),t}(),Z=q.MAX_LENGTH,K=U.re,tt=U.t,et=function(t,e){if(e&&"object"===typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof Q)return t;if("string"!==typeof t)return null;if(t.length>Z)return null;if(!(e.loose?K[tt.LOOSE]:K[tt.FULL]).test(t))return null;try{return new Q(t,e)}catch(n){return null}},nt=function(t,e){var n=et(t,e);return n?n.version:null},rt=function(t,e){var n=et(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null},it=function(t,e,n,r){"string"===typeof n&&(r=n,n=void 0);try{return new Q(t,n).inc(e,r).version}catch(i){return null}},at=function(t,e,n){return new Q(t,n).compare(new Q(e,n))},ot=function(t,e,n){return 0===at(t,e,n)},ut=function(t,e){if(ot(t,e))return null;var n=et(t),r=et(e),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(var u in n)if(("major"===u||"minor"===u||"patch"===u)&&n[u]!==r[u])return a+u;return o},st=function(t,e){return new Q(t,e).major},lt=function(t,e){return new Q(t,e).minor},ct=function(t,e){return new Q(t,e).patch},ft=function(t,e){var n=et(t,e);return n&&n.prerelease.length?n.prerelease:null},ht=function(t,e,n){return at(e,t,n)},dt=function(t,e){return at(t,e,!0)},pt=function(t,e,n){var r=new Q(t,n),i=new Q(e,n);return r.compare(i)||r.compareBuild(i)},vt=function(t,e){return t.sort(function(t,n){return pt(t,n,e)})},gt=function(t,e){return t.sort(function(t,n){return pt(n,t,e)})},mt=function(t,e,n){return at(t,e,n)>0},yt=function(t,e,n){return at(t,e,n)<0},bt=function(t,e,n){return 0!==at(t,e,n)},xt=function(t,e,n){return at(t,e,n)>=0},_t=function(t,e,n){return at(t,e,n)<=0},wt=function(t,e,n,r){switch(e){case"===":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t===n;case"!==":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return ot(t,n,r);case"!=":return bt(t,n,r);case">":return mt(t,n,r);case">=":return xt(t,n,r);case"<":return yt(t,n,r);case"<=":return _t(t,n,r);default:throw new TypeError("Invalid operator: ".concat(e))}},kt=U.re,At=U.t,Et=function(t,e){if(t instanceof Q)return t;if("number"===typeof t&&(t=String(t)),"string"!==typeof t)return null;var n=null;if((e=e||{}).rtl){for(var r;(r=kt[At.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),kt[At.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;kt[At.COERCERTL].lastIndex=-1}else n=t.match(kt[At.COERCE]);return null===n?null:et("".concat(n[2],".").concat(n[3]||"0",".").concat(n[4]||"0"),e)},Mt=function(){function t(e,n){var r=this;if(i(this,t),n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),e instanceof t)return e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease?e:new t(e.raw,n);if(e instanceof Vt)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(t){return r.parseRange(t.trim())}).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(e));this.format()}return a(t,[{key:"format",value:function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(t){var e=this,n=this.options.loose;t=t.trim();var r=n?St[Ct.HYPHENRANGELOOSE]:St[Ct.HYPHENRANGE];t=t.replace(r,Ut),I("hyphen replace",t),t=t.replace(St[Ct.COMPARATORTRIM],Ot),I("comparator trim",t,St[Ct.COMPARATORTRIM]),t=(t=(t=t.replace(St[Ct.TILDETRIM],Dt)).replace(St[Ct.CARETTRIM],Ft)).split(/\s+/).join(" ");var i=n?St[Ct.COMPARATORLOOSE]:St[Ct.COMPARATOR];return t.split(" ").map(function(t){return Nt(t,e.options)}).join(" ").split(/\s+/).filter(this.options.loose?function(t){return!!t.match(i)}:function(){return!0}).map(function(t){return new Vt(t,e.options)})}},{key:"intersects",value:function(e,n){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(function(t){return Tt(t,n)&&e.set.some(function(e){return Tt(e,n)&&t.every(function(t){return e.every(function(e){return t.intersects(e,n)})})})})}},{key:"test",value:function(t){if(!t)return!1;if("string"===typeof t)try{t=new Q(t,this.options)}catch(n){return!1}for(var e=0;e<this.set.length;e++)if(Wt(this.set[e],t,this.options))return!0;return!1}}]),t}(),St=U.re,Ct=U.t,Ot=U.comparatorTrimReplace,Dt=U.tildeTrimReplace,Ft=U.caretTrimReplace,Tt=function(t,e){for(var n=!0,r=t.slice(),i=r.pop();n&&r.length;)n=r.every(function(t){return i.intersects(t,e)}),i=r.pop();return n},Nt=function(t,e){return I("comp",t,e),t=zt(t,e),I("caret",t),t=Rt(t,e),I("tildes",t),t=Lt(t,e),I("xrange",t),t=It(t,e),I("stars",t),t},jt=function(t){return!t||"x"===t.toLowerCase()||"*"===t},Rt=function(t,e){return t.trim().split(/\s+/).map(function(t){return Pt(t,e)}).join(" ")},Pt=function(t,e){var n=e.loose?St[Ct.TILDELOOSE]:St[Ct.TILDE];return t.replace(n,function(e,n,r,i,a){var o;return I("tilde",t,e,n,r,i,a),jt(n)?o="":jt(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0"):jt(i)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0"):a?(I("replaceTilde pr",a),o=">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(+r+1,".0")):o=">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0"),I("tilde return",o),o})},zt=function(t,e){return t.trim().split(/\s+/).map(function(t){return Bt(t,e)}).join(" ")},Bt=function(t,e){I("caret",t,e);var n=e.loose?St[Ct.CARETLOOSE]:St[Ct.CARET];return t.replace(n,function(e,n,r,i,a){var o;return I("caret",t,e,n,r,i,a),jt(n)?o="":jt(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0"):jt(i)?o="0"===n?">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0"):">=".concat(n,".").concat(r,".0 <").concat(+n+1,".0.0"):a?(I("replaceCaret pr",a),o="0"===n?"0"===r?">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(r,".").concat(+i+1):">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(+r+1,".0"):">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(+n+1,".0.0")):(I("no pr"),o="0"===n?"0"===r?">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(r,".").concat(+i+1):">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0"):">=".concat(n,".").concat(r,".").concat(i," <").concat(+n+1,".0.0")),I("caret return",o),o})},Lt=function(t,e){return I("replaceXRanges",t,e),t.split(/\s+/).map(function(t){return qt(t,e)}).join(" ")},qt=function(t,e){t=t.trim();var n=e.loose?St[Ct.XRANGELOOSE]:St[Ct.XRANGE];return t.replace(n,function(n,r,i,a,o,u){I("xRange",t,n,r,i,a,o,u);var s=jt(i),l=s||jt(a),c=l||jt(o),f=c;return"="===r&&f&&(r=""),u=e.includePrerelease?"-0":"",s?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(l&&(a=0),o=0,">"===r?(r=">=",l?(i=+i+1,a=0,o=0):(a=+a+1,o=0)):"<="===r&&(r="<",l?i=+i+1:a=+a+1),n="".concat(r+i,".").concat(a,".").concat(o).concat(u)):l?n=">=".concat(i,".0.0").concat(u," <").concat(+i+1,".0.0").concat(u):c&&(n=">=".concat(i,".").concat(a,".0").concat(u," <").concat(i,".").concat(+a+1,".0").concat(u)),I("xRange return",n),n})},It=function(t,e){return I("replaceStars",t,e),t.trim().replace(St[Ct.STAR],"")},Ut=function(t,e,n,r,i,a,o,u,s,l,c,f,h){return e=jt(n)?"":jt(r)?">=".concat(n,".0.0"):jt(i)?">=".concat(n,".").concat(r,".0"):">=".concat(e),u=jt(s)?"":jt(l)?"<".concat(+s+1,".0.0"):jt(c)?"<".concat(s,".").concat(+l+1,".0"):f?"<=".concat(s,".").concat(l,".").concat(c,"-").concat(f):"<=".concat(u),"".concat(e," ").concat(u).trim()},Wt=function(t,e,n){for(var r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(var i=0;i<t.length;i++)if(I(t[i].semver),t[i].semver!==Vt.ANY&&t[i].semver.prerelease.length>0){var a=t[i].semver;if(a.major===e.major&&a.minor===e.minor&&a.patch===e.patch)return!0}return!1}return!0},Ht=Symbol("SemVer ANY"),Vt=function(){function t(e,n){if(i(this,t),n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),e instanceof t){if(e.loose===!!n.loose)return e;e=e.value}I("comparator",e,n),this.options=n,this.loose=!!n.loose,this.parse(e),this.semver===Ht?this.value="":this.value=this.operator+this.semver.version,I("comp",this)}return a(t,null,[{key:"ANY",get:function(){return Ht}}]),a(t,[{key:"parse",value:function(t){var e=this.options.loose?Gt[$t.COMPARATORLOOSE]:Gt[$t.COMPARATOR],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new Q(n[2],this.options.loose):this.semver=Ht}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(t){if(I("Comparator.test",t,this.options.loose),this.semver===Ht||t===Ht)return!0;if("string"===typeof t)try{t=new Q(t,this.options)}catch(e){return!1}return wt(t,this.operator,this.semver,this.options)}},{key:"intersects",value:function(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");if(n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new Mt(e.value,n).test(this.value);if(""===e.operator)return""===e.value||new Mt(this.value,n).test(e.semver);var r=(">="===this.operator||">"===this.operator)&&(">="===e.operator||">"===e.operator),i=("<="===this.operator||"<"===this.operator)&&("<="===e.operator||"<"===e.operator),a=this.semver.version===e.semver.version,o=(">="===this.operator||"<="===this.operator)&&(">="===e.operator||"<="===e.operator),u=wt(this.semver,"<",e.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),s=wt(this.semver,">",e.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||i||a&&o||u||s}}]),t}(),Gt=U.re,$t=U.t,Yt=function(t,e,n){try{e=new Mt(e,n)}catch(r){return!1}return e.test(t)},Xt=function(t,e){return new Mt(t,e).set.map(function(t){return t.map(function(t){return t.value}).join(" ").trim().split(" ")})},Jt=function(t,e,n){var r=null,i=null,a=null;try{a=new Mt(e,n)}catch(o){return null}return t.forEach(function(t){a.test(t)&&(r&&-1!==i.compare(t)||(i=new Q(r=t,n)))}),r},Qt=function(t,e,n){var r=null,i=null,a=null;try{a=new Mt(e,n)}catch(o){return null}return t.forEach(function(t){a.test(t)&&(r&&1!==i.compare(t)||(i=new Q(r=t,n)))}),r},Zt=function(t,e){t=new Mt(t,e);var n=new Q("0.0.0");if(t.test(n))return n;if(n=new Q("0.0.0-0"),t.test(n))return n;n=null;for(var r=0;r<t.set.length;++r)t.set[r].forEach(function(t){var e=new Q(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":n&&!mt(n,e)||(n=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(t.operator))}});return n&&t.test(n)?n:null},Kt=function(t,e){try{return new Mt(t,e).range||"*"}catch(n){return null}},te=Vt.ANY,ee=function(t,e,n,r){var i,a,o,u,s;switch(t=new Q(t,r),e=new Mt(e,r),n){case">":i=mt,a=_t,o=yt,u=">",s=">=";break;case"<":i=yt,a=xt,o=mt,u="<",s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Yt(t,e,r))return!1;for(var l=function(n){var l=e.set[n],c=null,f=null;return l.forEach(function(t){t.semver===te&&(t=new Vt(">=0.0.0")),c=c||t,f=f||t,i(t.semver,c.semver,r)?c=t:o(t.semver,f.semver,r)&&(f=t)}),c.operator===u||c.operator===s?{v:!1}:f.operator&&f.operator!==u||!a(t,f.semver)?f.operator===s&&o(t,f.semver)?{v:!1}:void 0:{v:!1}},c=0;c<e.set.length;++c){var f=l(c);if("object"===typeof f)return f.v}return!0},ne=function(t,e,n){return ee(t,e,">",n)},re=function(t,e,n){return ee(t,e,"<",n)},ie=function(t,e,n){return t=new Mt(t,n),e=new Mt(e,n),t.intersects(e)},ae={re:U.re,src:U.src,tokens:U.t,SEMVER_SPEC_VERSION:q.SEMVER_SPEC_VERSION,SemVer:Q,compareIdentifiers:V.compareIdentifiers,rcompareIdentifiers:V.rcompareIdentifiers,parse:et,valid:nt,clean:rt,inc:it,diff:ut,major:st,minor:lt,patch:ct,prerelease:ft,compare:at,rcompare:ht,compareLoose:dt,compareBuild:pt,sort:vt,rsort:gt,gt:mt,lt:yt,eq:ot,neq:bt,gte:xt,lte:_t,cmp:wt,coerce:Et,Comparator:Vt,Range:Mt,satisfies:Yt,toComparators:Xt,maxSatisfying:Jt,minSatisfying:Qt,minVersion:Zt,validRange:Kt,outside:ee,gtr:ne,ltr:re,intersects:ie}.satisfies,oe=(B=z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e[0],version:e[1]}}}))&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B,ue={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},se={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},le={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},bar:{binSpacing:2,fill:"#30a2da",stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ce={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},fe="Benton Gothic Bold, sans-serif",he={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},de={background:"#ffffff",title:{anchor:"start",color:"#000000",font:fe,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:fe,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:fe,titleFontSize:13,titleFontWeight:"normal"},range:{category:he["category-6"],diverging:he["fireandice-6"],heatmap:he["fire-7"],ordinal:he["fire-7"],ramp:he["fire-7"]}},pe={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},ve={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ge={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},me={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:ge["six-groups-cat-1"],diverging:ge["diverging-colors"],heatmap:ge["diverging-colors"],ordinal:ge["six-groups-seq"],ramp:ge["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:null}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}},ye={arc:{fill:"#3366CC"},area:{fill:"#3366CC"},path:{stroke:"#3366CC"},rect:{fill:"#3366CC"},shape:{stroke:"#3366CC"},symbol:{stroke:"#3366CC"},circle:{fill:"#3366CC"},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:"Arial, sans-serif",fontSize:12},"guide-title":{font:"Arial, sans-serif",fontSize:12},"group-title":{font:"Arial, sans-serif",fontSize:12}},title:{font:"Arial, sans-serif",fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},be=Object.freeze({__proto__:null,version:"2.8.2",dark:ue,excel:se,fivethirtyeight:le,ggplot2:ce,latimes:de,quartz:pe,vox:ve,urbaninstitute:me,googlecharts:ye}),xe="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n",_e="vg-tooltip-element",we={offsetX:10,offsetY:10,id:_e,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function ke(t,e,n){return t.fields=e||[],t.fname=n,t}function Ae(t){throw Error(t)}var Ee=Array.isArray;function Me(t){return t===Object(t)}function Se(t){return"string"===typeof t}function Ce(t){return Ee(t)?"["+t.map(Ce)+"]":Me(t)||Se(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var Oe=[],De=(function(t,e){var n=function(t){var e,n,r,i=[],a=null,o=0,u=t.length,s="";function l(){i.push(s+t.substring(e,n)),s="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))s+=t.substring(e,n),s+=t.substring(++n,++n),e=n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r?(e=n+1,a=r):e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&l(),o=e=n+1):"]"===r&&(o||Ae("Access path missing open bracket: "+t),o>0&&l(),o=0,e=n+1):n>e?l():e=n+1}return o&&Ae("Access path missing closing bracket: "+t),a&&Ae("Access path missing closing quote: "+t),n>e&&(n++,l()),i}(t),r="return _["+n.map(Ce).join("][")+"];";ke(Function("_",r),[t=1===n.length?n[0]:t],e||t)}("id"),ke(function(t){return t},Oe,"identity"),ke(function(){return 0},Oe,"zero"),ke(function(){return 1},Oe,"one"),ke(function(){return!0},Oe,"true"),ke(function(){return!1},Oe,"false"),function(t){return"__proto__"!==t});function Fe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=Ne(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;Te(t,n,e[n],r)}return t},{})}function Te(t,e,n,r){var i,a;if(De(e))if(Me(n)&&!Ee(n))for(i in a=Me(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Te(a,i,n[i]):De(i)&&(a[i]=n[i]);else t[e]=n}function Ne(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}var je=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Re(t,e){return JSON.stringify(t,function(t){var e=[];return function(n,r){if("object"!==typeof r||null===r)return r;var i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}var Pe=function(){function t(e){i(this,t),this.options=Object.assign(Object.assign({},we),e);var n=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return xe.toString().replace(_e,t)}(n);var a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}this.el=document.getElementById(n),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",n),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}return a(t,[{key:"tooltipHandler",value:function(t,e,n,r){if(null!=r&&""!==r){this.el.innerHTML=function(t,e,n){if(Ee(t))return"[".concat(t.map(function(t){return e(Se(t)?t:Re(t,n))}).join(", "),"]");if(Me(t)){var r="",i=t,a=i.title,o=je(i,["title"]);a&&(r+="<h2>".concat(e(a),"</h2>"));var u=Object.keys(o);if(u.length>0){r+="<table>";var s=!0,l=!1,c=void 0;try{for(var f,h=u[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value,p=o[d];void 0!==p&&(Me(p)&&(p=Re(p,n)),r+='<tr><td class="key">'.concat(e(d),':</td><td class="value">').concat(e(p),"</td></tr>"))}}catch(v){l=!0,c=v}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}r+="</table>"}return r||"{}"}return e(t)}(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var i=function(t,e,n,r){var i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);var a=t.clientY+r;return a+e.height>window.innerHeight&&(a=+t.clientY-r-e.height),{x:i,y:a}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),a=i.x,o=i.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(a,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),t}();function ze(t,e,n){var r=t.open(e),i=250,a=~~(1e4/i);t.addEventListener("message",function e(n){n.source===r&&(a=0,t.removeEventListener("message",e,!1))},!1),setTimeout(function t(){a<=0||(r.postMessage(n,"*"),setTimeout(t,i),a-=1)},i)}var Be,Le='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function qe(t){return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("//")}function Ie(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++)Ue(t,a[i]);return t}function Ue(e,n){for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];t.writeConfig(e,a,n[a],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});var We=t,He=n,Ve="undefined"!==typeof window?window:void 0;void 0===He&&(null===(Be=null===Ve||void 0===Ve?void 0:Ve.vl)||void 0===Be?void 0:Be.compile)&&(He=Ve.vl);var Ge={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},$e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Ye={vega:"Vega","vega-lite":"Vega-Lite"},Xe={vega:We.version,"vega-lite":He?He.version:"not available"},Je={vega:function(t){return t},"vega-lite":function(t,e){return He.compile(t,{config:e}).spec}},Qe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';function Ze(t,e,n,r){var i="<html><head>".concat(e,'</head><body><pre><code class="json">'),a="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(i+t+a),o.document.title="".concat(Ye[r]," JSON Source")}function Ke(t,e){var n;if(t.$schema){var r=oe(t.$schema);e&&e!==r.library&&console.warn("The given visualization spec is written in ".concat(Ye[r.library],", but mode argument sets ").concat(null!==(n=Ye[e])&&void 0!==n?n:e,"."));var i=r.library;return ae(Xe[i],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(Ye[i]," ").concat(r.version,", but the current version of ").concat(Ye[i]," is v").concat(Xe[i],".")),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!==e&&void 0!==e?e:"vega"}function tn(t,e){var n,i,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(this,void 0,void 0,r.mark(function u(){var s,l,c,f,h;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(u=o.loader,s=u&&"load"in u?o.loader:We.loader(o.loader),!Se(e)){r.next=9;break}return r.t1=JSON,r.next=5,s.load(e);case 5:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=10;break;case 9:r.t0=e;case 10:return l=r.t0,r.next=13,en(null!==(n=l.usermeta&&l.usermeta.embedOptions)&&void 0!==n?n:{},s);case 13:return c=r.sent,r.next=16,en(o,s);case 16:return f=r.sent,h=Object.assign(Object.assign({},Ie(f,c)),{config:Fe(null!==(i=f.config)&&void 0!==i?i:{},null!==(a=c.config)&&void 0!==a?a:{})}),r.next=20,nn(t,l,h,s);case 20:return r.abrupt("return",r.sent);case 21:case"end":return r.stop()}var u},u)}))}function en(t,e){var n;return u(this,void 0,void 0,r.mark(function i(){var a,o;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Se(t.config)){r.next=8;break}return r.t1=JSON,r.next=4,e.load(t.config);case 4:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=9;break;case 8:r.t0=null!==(n=t.config)&&void 0!==n?n:{};case 9:if(a=r.t0,!Se(t.patch)){r.next=18;break}return r.t4=JSON,r.next=14,e.load(t.patch);case 14:r.t5=r.sent,r.t3=r.t4.parse.call(r.t4,r.t5),r.next=19;break;case 18:r.t3=t.patch;case 19:return o=r.t3,r.abrupt("return",Object.assign(Object.assign(Object.assign({},t),o?{patch:o}:{}),a?{config:a}:{}));case 21:case"end":return r.stop()}},i)}))}function nn(t,e){var n,i,a,o,s,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=arguments.length>3?arguments[3]:void 0;return u(this,void 0,void 0,r.mark(function h(){var d,p,v,g,m,y,b,x,_,w,k,E,M,S,C,O,D,F,T,N,j,R,z,B,L,q,I,U,W,H,V,G,$;return r.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if($=function(){j&&document.removeEventListener("click",j),C.finalize()},d=c.theme?Fe(be[c.theme],null!==(n=c.config)&&void 0!==n?n:{}):c.config,X=c.actions,p="boolean"===typeof X?c.actions:Ie({},Ge,null!==(i=c.actions)&&void 0!==i?i:{}),v=Object.assign(Object.assign({},$e),c.i18n),g=null!==(a=c.renderer)&&void 0!==a?a:"canvas",m=null!==(o=c.logLevel)&&void 0!==o?o:We.Warn,y=null!==(s=c.downloadFileName)&&void 0!==s?s:"visualization",!1!==c.defaultStyle&&(b="vega-embed-style",document.getElementById(b)||((x=document.createElement("style")).id=b,x.innerText=void 0===c.defaultStyle||!0===c.defaultStyle?Le.toString():c.defaultStyle,document.head.appendChild(x))),_=Ke(e,c.mode),w=Je[_](e,d),"vega-lite"===_&&w.$schema&&(k=oe(w.$schema),ae(Xe.vega,"^".concat(k.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(k.version,", but current version is v").concat(Xe.vega,"."))),E="string"===typeof t?document.querySelector(t):t){h.next=14;break}throw Error("".concat(t," does not exist"));case 14:return E.classList.add("vega-embed"),p&&E.classList.add("has-actions"),E.innerHTML="",(M=c.patch)&&(w=M instanceof Function?M(w):A(w,M,!0,!1).newDocument),c.formatLocale&&We.formatLocale(c.formatLocale),c.timeFormatLocale&&We.timeFormatLocale(c.timeFormatLocale),S=We.parse(w,"vega-lite"===_?{}:d),C=new We.View(S,{loader:f,logLevel:m,renderer:g}),!1!==c.tooltip&&(Y=c.tooltip,O="function"===typeof Y?c.tooltip:new Pe(!0===c.tooltip?{}:c.tooltip).call,C.tooltip(O)),void 0===(D=c.hover)&&(D="vega"===_),D&&(T=(F="boolean"===typeof D?{}:D).hoverSet,N=F.updateSet,C.hover(T,N)),c&&(null!=c.width&&C.width(c.width),null!=c.height&&C.height(c.height),null!=c.padding&&C.padding(c.padding)),h.next=30,C.initialize(t).runAsync();case 30:if(!1!==p){if(R=E,!1!==c.defaultStyle&&((z=document.createElement("details")).title=v.CLICK_TO_VIEW_ACTIONS,E.append(z),R=z,(B=document.createElement("summary")).innerHTML=Qe,z.append(B),j=function(t){z.contains(t.target)||z.removeAttribute("open")},document.addEventListener("click",j)),L=document.createElement("div"),R.append(L),L.classList.add("vega-actions"),!0===p||!1!==p.export)for(q=function(){var t=U[I];if(!0===p||!0===p.export||p.export[t]){var e=v["".concat(t.toUpperCase(),"_ACTION")],n=document.createElement("a");n.text=e,n.href="#",n.target="_blank",n.download="".concat(y,".").concat(t),n.addEventListener("mousedown",function(e){return u(this,void 0,void 0,r.mark(function n(){var i;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,C.toImageURL(t,c.scaleFactor);case 3:i=n.sent,this.href=i;case 5:case"end":return n.stop()}},n,this)}))}),L.append(n)}},I=0,U=["svg","png"];I<U.length;I++)q();!0!==p&&!1===p.source||((W=document.createElement("a")).text=v.SOURCE_ACTION,W.href="#",W.addEventListener("mousedown",function(t){var n,r;Ze(P(e),null!==(n=c.sourceHeader)&&void 0!==n?n:"",null!==(r=c.sourceFooter)&&void 0!==r?r:"",_),t.preventDefault()}),L.append(W)),"vega-lite"!==_||!0!==p&&!1===p.compiled||((H=document.createElement("a")).text=v.COMPILED_ACTION,H.href="#",H.addEventListener("mousedown",function(t){var e,n;Ze(P(w),null!==(e=c.sourceHeader)&&void 0!==e?e:"",null!==(n=c.sourceFooter)&&void 0!==n?n:"","vega"),t.preventDefault()}),L.append(H)),!0!==p&&!1===p.editor||(V=null!==(l=c.editorUrl)&&void 0!==l?l:"https://vega.github.io/editor/",(G=document.createElement("a")).text=v.EDITOR_ACTION,G.href="#",G.addEventListener("mousedown",function(t){ze(window,V,{config:d,mode:_,renderer:g,spec:P(e)}),t.preventDefault()}),L.append(G))}return h.abrupt("return",{view:C,spec:e,vgSpec:w,finalize:$});case 32:case"end":return h.stop()}var Y,X},h)}))}function rn(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(this,void 0,void 0,r.mark(function i(){var a,o,u,s;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=document.createElement("div")).classList.add("vega-embed-wrapper"),o=document.createElement("div"),a.appendChild(o),u=!0===n.actions||!1===n.actions?n.actions:Object.assign({export:!0,source:!1,compiled:!0,editor:!0},null!==(e=n.actions)&&void 0!==e?e:{}),r.next=7,tn(o,t,Object.assign({actions:u},null!==n&&void 0!==n?n:{}));case 7:return s=r.sent,a.value=s.view,r.abrupt("return",a);case 10:case"end":return r.stop()}},i)}))}function an(t){return t instanceof HTMLElement}var on=function(){return arguments.length>1&&(t.isString(arguments.length<=0?void 0:arguments[0])&&!qe(arguments.length<=0?void 0:arguments[0])||an(arguments.length<=0?void 0:arguments[0])||3===arguments.length)?tn(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):rn(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])};return on.vegaLite=He,on.vl=He,on.container=rn,on.embed=tn,on.vega=We,on.default=tn,on.version=o,on}(n(1561),n(2149))}).call(this,n(52))},2113:function(t,e,n){!function(t){"use strict";var e={},n={},r=34,i=10,a=13;function o(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function u(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function s(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function l(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+s(-e,6):e>9999?"+"+s(e,6):s(e,4))+"-"+s(t.getUTCMonth()+1,2)+"-"+s(t.getUTCDate(),2)+(a?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"."+s(a,3)+"Z":i?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"Z":r||n?"T"+s(n,2)+":"+s(r,2)+"Z":"")}function c(t){var s=new RegExp('["'+t+"\n\r]"),c=t.charCodeAt(0);function f(t,o){var u,s=[],l=t.length,f=0,h=0,d=l<=0,p=!1;function v(){if(d)return n;if(p)return p=!1,e;var o,u,s=f;if(t.charCodeAt(s)===r){for(;f++<l&&t.charCodeAt(f)!==r||t.charCodeAt(++f)===r;);return(o=f)>=l?d=!0:(u=t.charCodeAt(f++))===i?p=!0:u===a&&(p=!0,t.charCodeAt(f)===i&&++f),t.slice(s+1,o-1).replace(/""/g,'"')}for(;f<l;){if((u=t.charCodeAt(o=f++))===i)p=!0;else if(u===a)p=!0,t.charCodeAt(f)===i&&++f;else if(u!==c)continue;return t.slice(s,o)}return d=!0,t.slice(s,l)}for(t.charCodeAt(l-1)===i&&--l,t.charCodeAt(l-1)===a&&--l;(u=v())!==n;){for(var g=[];u!==e&&u!==n;)g.push(u),u=v();o&&null==(g=o(g,h++))||s.push(g)}return s}function h(e,n){return e.map(function(e){return n.map(function(t){return p(e[t])}).join(t)})}function d(e){return e.map(p).join(t)}function p(t){return null==t?"":t instanceof Date?l(t):s.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,i=f(t,function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=o(t);return function(r,i){return e(n(r),i,t)}}(t,e):o(t)});return i.columns=r||[],i},parseRows:f,format:function(e,n){return null==n&&(n=u(e)),[n.map(p).join(t)].concat(h(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=u(t)),h(t,e).join("\n")},formatRows:function(t){return t.map(d).join("\n")},formatRow:d,formatValue:p}}var f=c(","),h=f.parse,d=f.parseRows,p=f.format,v=f.formatBody,g=f.formatRows,m=f.formatRow,y=f.formatValue,b=c("\t"),x=b.parse,_=b.parseRows,w=b.format,k=b.formatBody,A=b.formatRows,E=b.formatRow,M=b.formatValue,S=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();t.autoType=function(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;S&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t},t.csvFormat=p,t.csvFormatBody=v,t.csvFormatRow=m,t.csvFormatRows=g,t.csvFormatValue=y,t.csvParse=h,t.csvParseRows=d,t.dsvFormat=c,t.tsvFormat=w,t.tsvFormatBody=k,t.tsvFormatRow=E,t.tsvFormatRows=A,t.tsvFormatValue=M,t.tsvParse=x,t.tsvParseRows=_,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2114:function(t,e,n){!function(t,e,n,r,i,a){"use strict";function o(t){return t&&t.length?1===t.length?t[0]:(e=t,function(t){for(var n=e.length,r=1,i=String(e[0](t));r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function u(t,e,n){return n||t+(e?"_"+e:"")}var s={values:f({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:f({name:"count",set:"cell.num"}),__count__:f({name:"count",set:"this.missing + this.valid"}),missing:f({name:"missing",set:"this.missing"}),valid:f({name:"valid",set:"this.valid"}),sum:f({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),product:f({name:"product",init:"this.product = 1;",add:"this.product *= v;",rem:"this.product /= v;",set:"this.valid ? this.product : undefined"}),mean:f({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:f({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:f({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:f({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:f({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:f({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:f({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:f({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:f({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:f({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:f({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:f({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:f({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:f({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:f({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:f({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (Number.isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:f({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (Number.isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},l=Object.keys(s);function c(t,e){return s[t](e)}function f(t){return function(n){var r=e.extend({init:"",add:"",rem:"",idx:0},t);return r.out=n||t.name,r}}function h(t,e){return t.idx-e.idx}function d(t,n){var r=n||e.identity,i=function(t,e){var n,r=t.reduce(function t(n,r){function i(e){n[e]||t(n,n[e]=s[e]())}return r.req&&r.req.forEach(i),e&&r.str&&r.str.forEach(i),n},t.reduce(function(t,e){return t[e.name]=e,t},{})),i=[];for(n in r)i.push(r[n]);return i.sort(h)}(t,!0),a="var cell = this.cell; this.valid = 0; this.missing = 0;",o="this.cell = cell; this.init();",u="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",l="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",c="var cell = this.cell;";return i.forEach(function(t){a+=t.init,u+=t.add,l+=t.rem}),t.slice().sort(h).forEach(function(t){c+="t["+e.stringValue(t.out)+"]="+t.set+";"}),c+="return t;",(o=Function("cell",o)).prototype.init=Function(a),o.prototype.add=Function("v","t",u),o.prototype.rem=Function("v","t",l),o.prototype.set=Function("t",c),o.prototype.get=r,o.fields=t.map(function(t){return t.out}),o}function p(t){this._key=t?e.field(t):n.tupleid,this.reset()}var v=p.prototype;function g(t){n.Transform.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}v.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},v.add=function(t){this._add.push(t)},v.rem=function(t){this._rem.push(t)},v.values=function(){if(this._get=null,0===this._rem.length)return this._add;var t,e,n,r=this._add,i=this._rem,a=this._key,o=r.length,u=i.length,s=Array(o-u),l={};for(t=0;t<u;++t)l[a(i[t])]=1;for(t=0,e=0;t<o;++t)l[a(n=r[t])]?l[a(n)]=0:s[e++]=n;return this._rem=[],this._add=s},v.distinct=function(t){for(var n,r=this.values(),i=r.length,a={},o=0;--i>=0;)n=t(r[i])+"",e.hasOwnProperty(a,n)||(a[n]=1,++o);return o},v.extent=function(t){if(this._get!==t||!this._ext){var n=this.values(),r=e.extentIndex(n,t);this._ext=[n[r[0]],n[r[1]]],this._get=t}return this._ext},v.argmin=function(t){return this.extent(t)[0]||{}},v.argmax=function(t){return this.extent(t)[1]||{}},v.min=function(t){var e=this.extent(t)[0];return null!=e?t(e):void 0},v.max=function(t){var e=this.extent(t)[1];return null!=e?t(e):void 0},v.quartile=function(t){return this._get===t&&this._q||(this._q=r.quartiles(this.values(),t),this._get=t),this._q},v.q1=function(t){return this.quartile(t)[0]},v.q2=function(t){return this.quartile(t)[1]},v.q3=function(t){return this.quartile(t)[2]},v.ci=function(t){return this._get===t&&this._ci||(this._ci=r.bootstrapCI(this.values(),1e3,.05,t),this._get=t),this._ci},v.ci0=function(t){return this.ci(t)[0]},v.ci1=function(t){return this.ci(t)[1]},g.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:l},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var m=e.inherits(g,n.Transform);function y(t){n.Transform.call(this,null,t)}m.transform=function(t,e){var n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,function(t){return n.add(t)})):(n.value=n.value||n.init(t),e.visit(e.REM,function(t){return n.rem(t)}),e.visit(e.ADD,function(t){return n.add(t)})),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),n.changes(r)},m.cross=function(){var t=this,e=t.value,n=t._dnames,r=n.map(function(){return{}}),i=n.length;function a(t){var e,a,o,u;for(e in t)for(o=t[e].tuple,a=0;a<i;++a)r[a][u=o[n[a]]]=u}a(t._prev),a(e),function a(o,u,s){var l,c,f=n[s],h=r[s++];for(l in h)u[f]=h[l],c=o?o+"|"+l:l,s<i?a(c,u,s):e[c]||t.cell(c,u)}("",{},0)},m.init=function(t){var n=this._inputs=[],r=this._outputs=[],i={};function a(t){for(var r,a=e.array(e.accessorFields(t)),o=0,u=a.length;o<u;++o)i[r=a[o]]||(i[r]=1,n.push(r))}this._dims=e.array(t.groupby),this._dnames=this._dims.map(function(t){var n=e.accessorName(t);return a(t),r.push(n),n}),this.cellkey=t.key?t.key:o(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var s,l,f,h,p,v,g=t.fields||[null],m=t.ops||["count"],y=t.as||[],b=g.length,x={};for(b!==m.length&&e.error("Unmatched number of fields and aggregate ops."),v=0;v<b;++v)s=g[v],l=m[v],null==s&&"count"!==l&&e.error("Null aggregate field specified."),p=u(l,h=e.accessorName(s),y[v]),r.push(p),"count"!==l?((f=x[h])||(a(s),(f=x[h]=[]).field=s,this._measures.push(f)),"count"!==l&&(this._countOnly=!1),f.push(c(l,p))):this._counts.push(p);return this._measures=this._measures.map(function(t){return d(t,t.field)}),{}},m.cellkey=o(),m.cell=function(t,e){var n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},m.newcell=function(t,e){var n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){var r,i=this._measures,a=i.length;for(n.agg=Array(a),r=0;r<a;++r)n.agg[r]=new i[r](n)}return n.store&&(n.data=new p),n},m.newtuple=function(t,e){var r,i,a=this._dnames,o=this._dims,u={};for(r=0,i=o.length;r<i;++r)u[a[r]]=o[r](t);return e?n.replace(e.tuple,u):n.ingest(u)},m.add=function(t){var e,n,r,i=this.cellkey(t),a=this.cell(i,t);if(a.num+=1,!this._countOnly)for(a.store&&a.data.add(t),n=0,r=(e=a.agg).length;n<r;++n)e[n].add(e[n].get(t),t)},m.rem=function(t){var e,n,r,i=this.cellkey(t),a=this.cell(i,t);if(a.num-=1,!this._countOnly)for(a.store&&a.data.rem(t),n=0,r=(e=a.agg).length;n<r;++n)e[n].rem(e[n].get(t),t)},m.celltuple=function(t){var e,n,r,i=t.tuple,a=this._counts;for(t.store&&t.data.values(),n=0,r=a.length;n<r;++n)i[a[n]]=t.num;if(!this._countOnly)for(n=0,r=(e=t.agg).length;n<r;++n)e[n].set(i);return i},m.changes=function(t){var e,n,r,i,a=this._adds,o=this._mods,u=this._prev,s=this._drop,l=t.add,c=t.rem,f=t.mod;if(u)for(n in u)e=u[n],s&&!e.num||c.push(e.tuple);for(r=0,i=this._alen;r<i;++r)l.push(this.celltuple(a[r])),a[r]=null;for(r=0,i=this._mlen;r<i;++r)(0===(e=o[r]).num&&s?c:f).push(this.celltuple(e)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,t},y.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var b=e.inherits(y,n.Transform);function x(t,n,r){var i=t,a=n||[],o=r||[],u={},s=0;return{add:function(t){o.push(t)},remove:function(t){u[i(t)]=++s},size:function(){return a.length},data:function(t,n){return s&&(a=a.filter(function(t){return!u[i(t)]}),u={},s=0),n&&t&&a.sort(t),o.length&&(a=t?e.merge(t,a,o.sort(t)):a.concat(o),o=[]),a}}}function _(t){n.Transform.call(this,[],t)}function w(t){n.Operator.call(this,null,k,t)}function k(t){return this.value&&!t.modified()?this.value:e.compare(t.fields,t.orders)}function A(t){n.Transform.call(this,null,t)}b.transform=function(t,n){var r,i=!1!==t.interval,a=this._bins(t),o=a.start,u=a.step,s=t.as||["bin0","bin1"],l=s[0],c=s[1];return r=t.modified()?(n=n.reflow(!0)).SOURCE:n.modified(e.accessorFields(t.field))?n.ADD_MOD:n.ADD,n.visit(r,i?function(t){var e=a(t);t[l]=e,t[c]=null==e?null:o+u*(1+(e-o)/u)}:function(t){t[l]=a(t)}),n.modifies(i?s:l)},b._bins=function(t){if(this.value&&!t.modified())return this.value;var n,i,a=t.field,o=r.bin(t),u=o.step,s=o.start,l=s+Math.ceil((o.stop-s)/u)*u;null!=(n=t.anchor)&&(i=n-(s+u*Math.floor((n-s)/u)),s+=i,l+=i);var c=function(t){var e=a(t);return null==e?null:e<s?-1/0:e>l?1/0:(e=Math.max(s,Math.min(+e,l-u)),s+u*Math.floor(1e-14+(e-s)/u))};return c.start=s,c.stop=o.stop,c.step=u,this.value=e.accessor(c,e.accessorFields(a),t.name||"bin_"+e.accessorName(a))},_.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},e.inherits(_,n.Transform).transform=function(t,e){var r=e.fork(e.ALL),i=x(n.tupleid,this.value,r.materialize(r.ADD).add),a=t.sort,o=e.changed()||a&&(t.modified("sort")||e.modified(a.fields));return r.visit(r.REM,i.remove),this.modified(o),this.value=r.source=i.data(n.stableCompare(a),o),e.source&&e.source.root&&(this.value.root=e.source.root),r},e.inherits(w,n.Operator),A.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var E=e.inherits(A,n.Transform);function M(t){n.Transform.call(this,null,t)}E.transform=function(t,e){function n(e){return function(n){for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(u(n),t.case,a)||[],s=0,l=i.length;s<l;++s)o.test(r=i[s])||e(r)}}var r=this._parameterCheck(t,e),i=this._counts,a=this._match,o=this._stop,u=t.field,s=t.as||["text","count"],l=n(function(t){i[t]=1+(i[t]||0)}),c=n(function(t){i[t]-=1});return r?e.visit(e.SOURCE,l):(e.visit(e.ADD,l),e.visit(e.REM,c)),this._finish(e,s)},E._parameterCheck=function(t,e){var n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},E._finish=function(t,e){var r,i,a,o=this._counts,u=this._tuples||(this._tuples={}),s=e[0],l=e[1],c=t.fork(t.NO_SOURCE|t.NO_FIELDS);for(r in o)i=u[r],a=o[r]||0,!i&&a?(u[r]=i=n.ingest({}),i[s]=r,i[l]=a,c.add.push(i)):0===a?(i&&c.rem.push(i),o[r]=null,u[r]=null):i[l]!==a&&(i[l]=a,c.mod.push(i));return c.modifies(e)},M.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},e.inherits(M,n.Transform).transform=function(t,r){var i=r.fork(r.NO_SOURCE),a=this.value,o=t.as||["a","b"],u=o[0],s=o[1];return!a||r.changed(r.ADD_REM)||t.modified("as")||t.modified("filter")?(a&&(i.rem=a),a=r.materialize(r.SOURCE).source,i.add=this.value=function(t,e,r,i){for(var a,o,u=[],s={},l=t.length,c=0;c<l;++c)for(s[e]=o=t[c],a=0;a<l;++a)s[r]=t[a],i(s)&&(u.push(n.ingest(s)),(s={})[e]=o);return u}(a,u,s,t.filter||e.truthy)):i.mod=a,i.source=this.value,i.modifies(o)};var S={kde:r.randomKDE,mixture:r.randomMixture,normal:r.randomNormal,lognormal:r.randomLogNormal,uniform:r.randomUniform},C="distributions",O="function",D="field";function F(t){n.Transform.call(this,null,t)}var T=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],N={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:T},{name:"weights",type:"number",array:!0}]};function j(t,n){return t?t.map(function(t,r){return n[r]||e.accessorName(t)}):null}function R(t,e,n){var r,i,a,o,u,s,l=[],c=function(t){return t(o)};if(null==e)l.push(t.map(n));else for(r={},i=0,a=t.length;i<a;++i)o=t[i],(s=r[u=e.map(c)])||(r[u]=s=[],s.dims=u,l.push(s)),s.push(n(o));return l}function P(t){n.Transform.call(this,null,t)}function z(t){n.Operator.call(this,null,B,t),this.modified(!0)}function B(t){var n=t.expr;return this.value&&!t.modified("expr")?this.value:e.accessor(function(e){return n(e,t)},e.accessorFields(n),e.accessorName(n))}function L(t){n.Transform.call(this,[void 0,void 0],t)}function q(t,e){n.Operator.call(this,t),this.parent=e}F.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:T.concat(N)},{name:"as",type:"string",array:!0,default:["value","density"]}]},e.inherits(F,n.Transform).transform=function(t,i){var a=i.fork(i.NO_SOURCE|i.NO_FIELDS);if(!this.value||i.changed()||t.modified()){var o=function t(n,r){var i=n[O];e.hasOwnProperty(S,i)||e.error("Unknown distribution function: "+i);var a=S[i]();for(var o in n)o===D?a.data((n.from||r()).map(n[o])):o===C?a[o](n[o].map(function(e){return t(e,r)})):typeof a[o]===O&&a[o](n[o]);return a}(t.distribution,function(t){return function(){return t.materialize(t.SOURCE).source}}(i)),u=t.steps||t.minsteps||25,s=t.steps||t.maxsteps||200,l=t.method||"pdf";"pdf"!==l&&"cdf"!==l&&e.error("Invalid density method: "+l),t.extent||o.data||e.error("Missing density extent parameter."),l=o[l];var c=t.as||["value","density"],f=t.extent||e.extent(o.data()),h=r.sampleCurve(l,f,u,s).map(function(t){var e={};return e[c[0]]=t[0],e[c[1]]=t[1],n.ingest(e)});this.value&&(a.rem=this.value),this.value=a.add=a.source=h}return a},P.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},e.inherits(P,n.Transform).transform=function(t,i){if(this.value&&!t.modified()&&!i.changed())return i;for(var a,o=i.materialize(i.SOURCE).source,u=R(i.source,t.groupby,e.identity),s=t.smooth||!1,l=t.field,c=t.step||function(t,n){return e.span(e.extent(t,n))/30}(o,l),f=n.stableCompare(function(t,e){return l(t)-l(e)}),h=t.as||"bin",d=u.length,p=1/0,v=-1/0,g=0;g<d;++g){var m=u[g].sort(f);a=-1;var y=!0,b=!1,x=void 0;try{for(var _,w=r.dotbin(m,c,s,l)[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var k=_.value;k<p&&(p=k),k>v&&(v=k),m[++a][h]=k}}catch(A){b=!0,x=A}finally{try{y||null==w.return||w.return()}finally{if(b)throw x}}}return this.value={start:p,stop:v,step:c},i.reflow(!0).modifies(h)},e.inherits(z,n.Operator),L.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},e.inherits(L,n.Transform).transform=function(t,n){var r,i=this.value,a=t.field,o=i[0],u=i[1];if(((r=n.changed()||n.modified(a.fields)||t.modified("field"))||null==o)&&(o=1/0,u=-1/0),n.visit(r?n.SOURCE:n.ADD,function(t){var e=a(t);null!=e&&((e=+e)<o&&(o=e),e>u&&(u=e))}),!Number.isFinite(o)||!Number.isFinite(u)){var s=e.accessorName(a);s&&(s=' for field "'.concat(s,'"')),n.dataflow.warn("Infinite extent".concat(s,": [").concat(o,", ").concat(u,"]")),o=u=void 0}this.value=[o,u]};var I=e.inherits(q,n.Operator);function U(t){n.Transform.call(this,{},t),this._keys=e.fastmap();var r=this._targets=[];r.active=0,r.forEach=function(t){for(var e=0,n=r.active;e<n;++e)t(r[e],e,r)}}I.connect=function(t){return this.targets().add(t),t.source=this},I.add=function(t){this.value.add.push(t)},I.rem=function(t){this.value.rem.push(t)},I.mod=function(t){this.value.mod.push(t)},I.init=function(t){this.value.init(t,t.NO_SOURCE)},I.evaluate=function(){return this.value};var W=e.inherits(U,n.Transform);function H(t){n.Operator.call(this,null,V,t)}function V(t){return this.value&&!t.modified()?this.value:e.isArray(t.name)?e.array(t.name).map(function(t){return e.field(t)}):e.field(t.name,t.as)}function G(t){n.Transform.call(this,e.fastmap(),t)}function $(t){n.Transform.call(this,[],t)}function Y(t){n.Transform.call(this,[],t)}function X(t){n.Transform.call(this,null,t)}function J(t){n.Transform.call(this,[],t)}W.activate=function(t){this._targets[this._targets.active++]=t},W.subflow=function(t,n,r,i){var a,o,u=this.value,s=e.hasOwnProperty(u,t)&&u[t];return s?s.value.stamp<r.stamp&&(s.init(r),this.activate(s)):(o=i||(o=this._group[t])&&o.tuple,s=(a=r.dataflow).add(new q(r.fork(r.NO_SOURCE),this)).connect(n(a,t,o)),u[t]=s,this.activate(s)),s},W.transform=function(t,e){var r=e.dataflow,i=this,a=t.key,o=t.subflow,u=this._keys,s=t.modified("key");function l(t){return i.subflow(t,o,e)}return this._group=t.group||{},this._targets.active=0,e.visit(e.REM,function(t){var e=n.tupleid(t),r=u.get(e);void 0!==r&&(u.delete(e),l(r).rem(t))}),e.visit(e.ADD,function(t){var e=a(t);u.set(n.tupleid(t),e),l(e).add(t)}),s||e.modified(a.fields)?e.visit(e.MOD,function(t){var e=n.tupleid(t),r=u.get(e),i=a(t);r===i?l(i).mod(t):(u.set(e,i),l(r).rem(t),l(i).add(t))}):e.changed(e.MOD)&&e.visit(e.MOD,function(t){l(u.get(n.tupleid(t))).mod(t)}),s&&e.visit(e.REFLOW,function(t){var e=n.tupleid(t),r=u.get(e),i=a(t);r!==i&&(u.set(e,i),l(r).rem(t),l(i).add(t))}),u.empty>r.cleanThreshold&&r.runAfter(u.clean),e},e.inherits(H,n.Operator),G.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},e.inherits(G,n.Transform).transform=function(t,e){var r=e.dataflow,i=this.value,a=e.fork(),o=a.add,u=a.rem,s=a.mod,l=t.expr,c=!0;function f(e){var r=n.tupleid(e),a=l(e,t),f=i.get(r);a&&f?(i.delete(r),o.push(e)):a||f?c&&a&&!f&&s.push(e):(i.set(r,1),u.push(e))}return e.visit(e.REM,function(t){var e=n.tupleid(t);i.has(e)?i.delete(e):u.push(t)}),e.visit(e.ADD,function(e){l(e,t)?o.push(e):i.set(n.tupleid(e),1)}),e.visit(e.MOD,f),t.modified()&&(c=!1,e.visit(e.REFLOW,f)),i.empty>r.cleanThreshold&&r.runAfter(i.clean),a},$.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},e.inherits($,n.Transform).transform=function(t,e){var r=e.fork(e.NO_SOURCE),i=t.fields,a=j(i,t.as||[]),o=t.index||null,u=a.length;return r.rem=this.value,e.visit(e.SOURCE,function(t){for(var e,s,l,c=i.map(function(e){return e(t)}),f=c.reduce(function(t,e){return Math.max(t,e.length)},0),h=0;h<f;++h){for(s=n.derive(t),e=0;e<u;++e)s[a[e]]=null==(l=c[e][h])?null:l;o&&(s[o]=h),r.add.push(s)}}),this.value=r.source=r.add,o&&r.modifies(o),r.modifies(a)},Y.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},e.inherits(Y,n.Transform).transform=function(t,r){var i=r.fork(r.NO_SOURCE),a=t.fields,o=a.map(e.accessorName),u=t.as||["key","value"],s=u[0],l=u[1],c=a.length;return i.rem=this.value,r.visit(r.SOURCE,function(t){for(var e,r=0;r<c;++r)(e=n.derive(t))[s]=o[r],e[l]=a[r](t),i.add.push(e)}),this.value=i.source=i.add,i.modifies(u)},X.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},e.inherits(X,n.Transform).transform=function(t,e){var n=t.expr,r=t.as,i=t.modified(),a=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(a,function(e){return e[r]=n(e,t)})},e.inherits(J,n.Transform).transform=function(t,e){var r,i,a,o=this.value,u=e.fork(e.ALL),s=t.size-o.length,l=t.generator;if(s>0){for(r=[];--s>=0;)r.push(a=n.ingest(l(t))),o.push(a);u.add=u.add.length?u.materialize(u.ADD).add.concat(r):r}else i=o.slice(0,-s),u.rem=u.rem.length?u.materialize(u.REM).rem.concat(i):i,o=o.slice(-s);return u.source=this.value=o,u};var Q={value:"value",median:i.median,mean:i.mean,min:i.min,max:i.max},Z=[];function K(t){n.Transform.call(this,[],t)}function tt(t){g.call(this,t)}K.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},e.inherits(K,n.Transform).transform=function(t,r){var i,a,o,u,s,l,c,f,h,d,p=r.fork(r.ALL),v=function(t){var n,r=t.method||Q.value;if(null!=Q[r])return r===Q.value?(n=void 0!==t.value?t.value:0,function(){return n}):Q[r];e.error("Unrecognized imputation method: "+r)}(t),g=function(t){var e=t.field;return function(t){return t?e(t):NaN}}(t),m=e.accessorName(t.field),y=e.accessorName(t.key),b=(t.groupby||[]).map(e.accessorName),x=function(t,e,n,r){var i,a,o,u,s,l,c,f,h=function(t){return t(f)},d=[],p=r?r.slice():[],v={},g={};for(p.forEach(function(t,e){v[t]=e+1}),u=0,c=t.length;u<c;++u)l=n(f=t[u]),s=v[l]||(v[l]=p.push(l)),(o=g[a=(i=e?e.map(h):Z)+""])||(o=g[a]=[],d.push(o),o.values=i),o[s-1]=f;return d.domain=p,d}(r.source,t.groupby,t.key,t.keyvals),_=[],w=this.value,k=x.domain.length;for(s=0,f=x.length;s<f;++s)for(o=(i=x[s]).values,a=NaN,c=0;c<k;++c)if(null==i[c]){for(u=x.domain[c],d={_impute:!0},l=0,h=o.length;l<h;++l)d[b[l]]=o[l];d[y]=u,d[m]=Number.isNaN(a)?a=v(i,g):a,_.push(n.ingest(d))}return _.length&&(p.add=p.materialize(p.ADD).add.concat(_)),w.length&&(p.rem=p.materialize(p.REM).rem.concat(w)),this.value=_,p},tt.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:l},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var et=e.inherits(tt,g);function nt(t){n.Transform.call(this,null,t)}function rt(t){n.Operator.call(this,null,it,t)}function it(t){return this.value&&!t.modified()?this.value:e.key(t.fields,t.flat)}function at(t){n.Transform.call(this,[],t),this._pending=null}function ot(t,e,r){r.forEach(n.ingest);var i=e.fork(e.NO_FIELDS&e.NO_SOURCE);return i.rem=t.value,t.value=i.source=i.add=r,t._pending=null,i}function ut(t){n.Transform.call(this,{},t)}function st(t){n.Operator.call(this,null,lt,t)}function lt(t){if(this.value&&!t.modified())return this.value;var e,n,r,i=1/0,a=-1/0,o=t.extents;for(e=0,n=o.length;e<n;++e)(r=o[e])[0]<i&&(i=r[0]),r[1]>a&&(a=r[1]);return[i,a]}function ct(t){n.Operator.call(this,null,ft,t)}function ft(t){return this.value&&!t.modified()?this.value:t.values.reduce(function(t,e){return t.concat(e)},[])}function ht(t){n.Transform.call(this,null,t)}function dt(t){g.call(this,t)}et.transform=function(t,n){var r,i=this,a=t.modified();return i.value&&(a||n.modified(i._inputs,!0))?(r=i.value=a?i.init(t):{},n.visit(n.SOURCE,function(t){i.add(t)})):(r=i.value=i.value||this.init(t),n.visit(n.REM,function(t){i.rem(t)}),n.visit(n.ADD,function(t){i.add(t)})),i.changes(),n.visit(n.SOURCE,function(t){e.extend(t,r[i.cellkey(t)].tuple)}),n.reflow(a).modifies(this._outputs)},et.changes=function(){var t,e,n=this._adds,r=this._mods;for(t=0,e=this._alen;t<e;++t)this.celltuple(n[t]),n[t]=null;for(t=0,e=this._mlen;t<e;++t)this.celltuple(r[t]),r[t]=null;this._alen=this._mlen=0},nt.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},e.inherits(nt,n.Transform).transform=function(t,i){var a=i.fork(i.NO_SOURCE|i.NO_FIELDS);if(!this.value||i.changed()||t.modified()){var o=i.materialize(i.SOURCE).source,u=R(o,t.groupby,t.field),s=(t.groupby||[]).map(e.accessorName),l=t.bandwidth,c=t.cumulative?"cdf":"pdf",f=t.as||["value","density"],h=[],d=t.extent,p=t.steps||t.minsteps||25,v=t.steps||t.maxsteps||200;"pdf"!==c&&"cdf"!==c&&e.error("Invalid density method: "+c),"shared"===t.resolve&&(d||(d=e.extent(o,t.field)),p=v=t.steps||v),u.forEach(function(i){var a=r.randomKDE(i,l)[c],o=t.counts?i.length:1,u=d||e.extent(i);r.sampleCurve(a,u,p,v).forEach(function(t){for(var e={},r=0;r<s.length;++r)e[s[r]]=i.dims[r];e[f[0]]=t[0],e[f[1]]=t[1]*o,h.push(n.ingest(e))})}),this.value&&(a.rem=this.value),this.value=a.add=a.source=h}return a},e.inherits(rt,n.Operator),e.inherits(at,n.Transform).transform=function(t,n){var r=this,i=n.dataflow;return this._pending?ot(this,n,this._pending):function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t)?n.StopPropagation:t.values?ot(this,n,i.parse(t.values,t.format)):t.async?{async:i.request(t.url,t.format).then(function(t){return r._pending=e.array(t.data),function(t){return t.touch(r)}})}:i.request(t.url,t.format).then(function(t){return ot(r,n,e.array(t.data))})},ut.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},e.inherits(ut,n.Transform).transform=function(t,n){var r,i,a=n,o=t.as,u=t.fields,s=t.index,l=t.values,c=null==t.default?null:t.default,f=t.modified(),h=f?n.SOURCE:n.ADD,d=u.length;return l?(i=l.length,d>1&&!o&&e.error('Multi-field lookup requires explicit "as" parameter.'),o&&o.length!==d*i&&e.error('The "as" parameter has too few output field names.'),o=o||l.map(e.accessorName),r=function(t){for(var e,n,r=0,a=0;r<d;++r)if(null==(n=s.get(u[r](t))))for(e=0;e<i;++e,++a)t[o[a]]=c;else for(e=0;e<i;++e,++a)t[o[a]]=l[e](n)}):(o||e.error("Missing output field names."),r=function(t){for(var e,n=0;n<d;++n)e=s.get(u[n](t)),t[o[n]]=null==e?c:e}),f?a=n.reflow(!0):h|=u.some(function(t){return n.modified(t.fields)})?n.MOD:0,n.visit(h,r),a.modifies(o)},e.inherits(st,n.Operator),e.inherits(ct,n.Operator),e.inherits(ht,n.Transform),ht.prototype.transform=function(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)},dt.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:l,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var pt=e.inherits(dt,g);function vt(t,n){var r=t.field,i=t.value,a=("count"===t.op?"__count__":t.op)||"sum",o=e.accessorFields(r).concat(e.accessorFields(i)),u=function(t,e,n){var r={},i=[];return n.visit(n.SOURCE,function(e){var n=t(e);r[n]||(r[n]=1,i.push(n))}),i.sort(function(t,e){return(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0)}),e?i.slice(0,e):i}(r,t.limit||0,n);return n.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:u.map(function(){return a}),fields:u.map(function(t){return function(t,n,r,i){return e.accessor(function(e){return n(e)===t?r(e):NaN},i,t+"")}(t,r,i,o)}),as:u.map(function(t){return t+""}),modified:t.modified.bind(t)}}function gt(t){U.call(this,t)}function mt(t){n.Transform.call(this,null,t)}function yt(t){n.Transform.call(this,null,t)}function bt(t){n.Transform.call(this,null,t)}pt._transform=pt.transform,pt.transform=function(t,e){return this._transform(vt(t,e),e)},e.inherits(gt,U).transform=function(t,r){var i=this,a=t.subflow,o=t.field;return(t.modified("field")||o&&r.modified(e.accessorFields(o)))&&e.error("PreFacet does not support field modification."),this._targets.active=0,r.visit(r.MOD,function(t){var e=i.subflow(n.tupleid(t),a,r,t);o?o(t).forEach(function(t){e.mod(t)}):e.mod(t)}),r.visit(r.ADD,function(t){var e=i.subflow(n.tupleid(t),a,r,t);o?o(t).forEach(function(t){e.add(n.ingest(t))}):e.add(t)}),r.visit(r.REM,function(t){var e=i.subflow(n.tupleid(t),a,r,t);o?o(t).forEach(function(t){e.rem(t)}):e.rem(t)}),r},mt.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},e.inherits(mt,n.Transform).transform=function(t,e){var r,i,a=t.fields,o=j(t.fields,t.as||[]),u=a?function(t,e){return function(t,e,n,r){for(var i=0,a=n.length;i<a;++i)e[r[i]]=n[i](t);return e}(t,e,a,o)}:n.rederive;return this.value?i=this.value:(e=e.addAll(),i=this.value={}),r=e.fork(e.NO_SOURCE),e.visit(e.REM,function(t){var e=n.tupleid(t);r.rem.push(i[e]),i[e]=null}),e.visit(e.ADD,function(t){var e=u(t,n.ingest({}));i[n.tupleid(t)]=e,r.add.push(e)}),e.visit(e.MOD,function(t){r.mod.push(u(t,i[n.tupleid(t)]))}),r},e.inherits(yt,n.Transform).transform=function(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation},bt.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};var xt=e.inherits(bt,n.Transform);function _t(t){n.Transform.call(this,null,t)}function wt(t){n.Transform.call(this,[],t),this.count=0}function kt(t){n.Transform.call(this,null,t)}function At(t){n.Transform.call(this,null,t),this.modified(!0)}function Et(t){n.Transform.call(this,null,t)}xt.transform=function(t,a){var o=a.fork(a.NO_SOURCE|a.NO_FIELDS),u=t.as||["prob","value"];if(this.value&&!t.modified()&&!a.changed())return o.source=this.value,o;var s=R(a.materialize(a.SOURCE).source,t.groupby,t.field),l=(t.groupby||[]).map(e.accessorName),c=[],f=t.step||.01,h=t.probs||i.range(f/2,1-1e-14,f),d=h.length;return s.forEach(function(t){for(var e=r.quantiles(t,h),i=0;i<d;++i){for(var a={},o=0;o<l.length;++o)a[l[o]]=t.dims[o];a[u[0]]=h[i],a[u[1]]=e[i],c.push(n.ingest(a))}}),this.value&&(o.rem=this.value),this.value=o.add=o.source=c,o},e.inherits(_t,n.Transform).transform=function(t,e){var r,i;return this.value?i=this.value:(r=e=e.addAll(),i=this.value={}),t.derive&&(r=e.fork(e.NO_SOURCE),e.visit(e.REM,function(t){var e=n.tupleid(t);r.rem.push(i[e]),i[e]=null}),e.visit(e.ADD,function(t){var e=n.derive(t);i[n.tupleid(t)]=e,r.add.push(e)}),e.visit(e.MOD,function(t){var e,a=i[n.tupleid(t)];for(e in t)a[e]=t[e],r.modifies(e);r.mod.push(a)})),r},wt.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},e.inherits(wt,n.Transform).transform=function(t,e){var i=e.fork(e.NO_SOURCE),a=t.modified("size"),o=t.size,u=this.value,s=this.count,l=0,c=u.reduce(function(t,e){return t[n.tupleid(e)]=1,t},{});function f(t){var e,a;u.length<o?u.push(t):(a=~~((s+1)*r.random()))<u.length&&a>=l&&(e=u[a],c[n.tupleid(e)]&&i.rem.push(e),u[a]=t),++s}if(e.rem.length&&(e.visit(e.REM,function(t){var e=n.tupleid(t);c[e]&&(c[e]=-1,i.rem.push(t)),--s}),u=u.filter(function(t){return-1!==c[n.tupleid(t)]})),(e.rem.length||a)&&u.length<o&&e.source&&(l=s=u.length,e.visit(e.SOURCE,function(t){c[n.tupleid(t)]||f(t)}),l=-1),a&&u.length>o){for(var h=0,d=u.length-o;h<d;++h)c[n.tupleid(u[h])]=-1,i.rem.push(u[h]);u=u.slice(d)}return e.mod.length&&e.visit(e.MOD,function(t){c[n.tupleid(t)]&&i.mod.push(t)}),e.add.length&&e.visit(e.ADD,f),(e.add.length||l<0)&&(i.add=u.filter(function(t){return!c[n.tupleid(t)]})),this.count=s,this.value=i.source=u,i},kt.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},e.inherits(kt,n.Transform).transform=function(t,e){if(!this.value||t.modified()){var r=e.materialize().fork(e.MOD),a=t.as||"data";return r.rem=this.value?e.rem.concat(this.value):e.rem,this.value=i.range(t.start,t.stop,t.step||1).map(function(t){var e={};return e[a]=t,n.ingest(e)}),r.add=e.add.concat(this.value),r}},e.inherits(At,n.Transform).transform=function(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation};var Mt=["unit0","unit1"];Et.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"string",array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Mt}]};var St=e.inherits(Et,n.Transform);function Ct(t){n.Transform.call(this,e.fastmap(),t)}function Ot(t){n.Transform.call(this,null,t)}St.transform=function(t,n){var r=t.field,i=!1!==t.interval,o="utc"===t.timezone,u=this._floor(t,n),s=(o?a.utcInterval:a.timeInterval)(u.unit).offset,l=t.as||Mt,c=l[0],f=l[1],h=u.start||1/0,d=u.stop||-1/0,p=u.step,v=n.ADD;return(t.modified()||n.modified(e.accessorFields(r)))&&(v=(n=n.reflow(!0)).SOURCE,h=1/0,d=-1/0),n.visit(v,function(t){var e,n,a=r(t);null==a?(t[c]=null,i&&(t[f]=null)):(t[c]=e=n=u(a),i&&(t[f]=n=s(e,p)),e<h&&(h=e),n>d&&(d=n))}),u.start=h,u.stop=d,n.modifies(i?l:c)},St._floor=function(t,n){var r="utc"===t.timezone,i=t.units?{units:t.units,step:t.step||1}:a.timeBin({extent:t.extent||e.extent(n.materialize(n.SOURCE).source,t.field),maxbins:t.maxbins}),o=i.units,u=i.step;o=a.timeUnits(o);var s=this.value||{},l=(r?a.utcFloor:a.timeFloor)(o,u);return l.unit=e.peek(o),l.units=o,l.step=u,l.start=s.start,l.stop=s.stop,this.value=l},e.inherits(Ct,n.Transform).transform=function(t,e){var n=e.dataflow,r=t.field,i=this.value,a=!0;function o(t){i.set(r(t),t)}return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,function(t){i.delete(r(t))}),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()},e.inherits(Ot,n.Transform).transform=function(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(n.stableCompare(t.sort)):e.source).map(t.field))};var Dt={row_number:function(){return{next:function(t){return t.index+1}}},rank:function(){var t;return{init:function(){return t=1},next:function(e){var n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){var t;return{init:function(){return t=1},next:function(e){var n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){var t=Dt.rank(),e=t.next;return{init:t.init,next:function(t){return(e(t)-1)/(t.data.length-1)}}},cume_dist:function(){var t;return{init:function(){return t=0},next:function(e){var n=e.index,r=e.data,i=e.compare;if(t<n){for(;n+1<r.length&&!i(r[n],r[n+1]);)++n;t=n}return(1+t)/r.length}}},ntile:function(t,n){(n=+n)>0||e.error("ntile num must be greater than zero.");var r=Dt.cume_dist(),i=r.next;return{init:r.init,next:function(t){return Math.ceil(n*i(t))}}},lag:function(t,e){return e=+e||1,{next:function(n){var r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:function(n){var r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:function(e){return t(e.data[e.i0])}}},last_value:function(t){return{next:function(e){return t(e.data[e.i1-1])}}},nth_value:function(t,n){return(n=+n)>0||e.error("nth_value nth must be greater than zero."),{next:function(e){var r=e.i0+(n-1);return r<e.i1?t(e.data[r]):null}}},prev_value:function(t){var e=null;return{next:function(n){var r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){var e=null,n=-1;return{next:function(r){var i=r.data;return r.index<=n?e:(n=function(t,e,n){for(var r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},Ft=Object.keys(Dt);function Tt(t){var n=e.array(t.ops),r=e.array(t.fields),i=e.array(t.params),a=e.array(t.as),o=this.outputs=[],s=this.windows=[],l={},f={},h=!0,v=[],g=[];function m(t){e.array(e.accessorFields(t)).forEach(function(t){return l[t]=1})}m(t.sort),n.forEach(function(t,n){var l=r[n],d=e.accessorName(l),p=u(t,d,a[n]);if(m(l),o.push(p),e.hasOwnProperty(Dt,t))s.push(function(t,n,r,i){var a=Dt[t](n,r);return{init:a.init||e.zero,update:function(t,e){e[i]=a.next(t)}}}(t,r[n],i[n],p));else{if(null==l&&"count"!==t&&e.error("Null aggregate field specified."),"count"===t)return void v.push(p);h=!1;var y=f[d];y||((y=f[d]=[]).field=l,g.push(y)),y.push(c(t,p))}}),(v.length||g.length)&&(this.cell=function(t,e,n){t=t.map(function(t){return d(t,t.field)});var r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new t[o](r);if(r.store)var u=r.data=new p;return r.add=function(t){if(r.num+=1,!n){u&&u.add(t);for(var e=0;e<i;++e)a[e].add(a[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){u&&u.rem(t);for(var e=0;e<i;++e)a[e].rem(a[e].get(t),t)}},r.set=function(t){var i,o;for(u&&u.values(),i=0,o=e.length;i<o;++i)t[e[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(t)},r.init=function(){r.num=0,u&&u.reset();for(var t=0;t<i;++t)a[t].init()},r}(g,v,h)),this.inputs=Object.keys(l)}var Nt=Tt.prototype;function jt(t){n.Transform.call(this,{},t),this._mlen=0,this._mods=[]}Nt.init=function(){this.windows.forEach(function(t){return t.init()}),this.cell&&this.cell.init()},Nt.update=function(t,e){var n,r=this.cell,i=this.windows,a=t.data,o=i&&i.length;if(r){for(n=t.p0;n<t.i0;++n)r.rem(a[n]);for(n=t.p1;n<t.i1;++n)r.add(a[n]);r.set(e)}for(n=0;n<o;++n)i[n].update(t,e)},jt.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Ft.concat(l)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var Rt=e.inherits(jt,n.Transform);function Pt(t,n,r,a){var o=a.sort,u=o&&!a.ignorePeers,s=a.frame||[null,0],l=t.data(r),c=l.length,f=0,h=u?i.bisector(o):null,d={i0:0,i1:0,p0:0,p1:0,index:0,data:l,compare:o||e.constant(-1)};for(n.init();f<c;++f)zt(d,s,f,c),u&&Bt(d,h),n.update(d,l[f])}function zt(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Bt(t,e){var n=t.i0,r=t.i1-1,i=t.compare,a=t.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(t.i1=e.right(a,a[r]))}Rt.transform=function(t,e){var r,i,a=this,u=a.state,s=t.modified(),l=n.stableCompare(t.sort);this.stamp=e.stamp,u&&!s||(u=a.state=new Tt(t));var c=o(t.groupby);function f(t){return a.group(c(t))}for(s||e.modified(u.inputs)?(a.value={},e.visit(e.SOURCE,function(t){f(t).add(t)})):(e.visit(e.REM,function(t){f(t).remove(t)}),e.visit(e.ADD,function(t){f(t).add(t)})),r=0,i=a._mlen;r<i;++r)Pt(a._mods[r],u,l,t);return a._mlen=0,a._mods=[],e.reflow(s).modifies(u.outputs)},Rt.group=function(t){var e=this.value[t];return e||((e=this.value[t]=x(n.tupleid)).stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e},t.aggregate=g,t.bin=y,t.collect=_,t.compare=w,t.countpattern=A,t.cross=M,t.density=F,t.dotbin=P,t.expression=z,t.extent=L,t.facet=U,t.field=H,t.filter=G,t.flatten=$,t.fold=Y,t.formula=X,t.generate=J,t.impute=K,t.joinaggregate=tt,t.kde=nt,t.key=rt,t.load=at,t.lookup=ut,t.multiextent=st,t.multivalues=ct,t.params=ht,t.pivot=dt,t.prefacet=gt,t.project=mt,t.proxy=yt,t.quantile=bt,t.relay=_t,t.sample=wt,t.sequence=kt,t.sieve=At,t.subflow=q,t.timeunit=Et,t.tupleindex=Ct,t.values=Ot,t.window=jt,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(2115),n(1045),n(2116),n(1053),n(1223))},2115:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4,k=function(t){return"__proto__"!==t};function A(t,e,n,r){var i,u;if(k(e))if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):k(i)&&(u[i]=n[i]);else t[e]=n}function E(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function M(t){return t[t.length-1]}function S(t){return null==t||""===t?null:+t}function C(t){return function(e){return t*Math.exp(e)}}function O(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function F(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function T(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function N(t,e,n,r){var i=n(t[0]),a=n(M(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function j(t,e,n,r,i){var a=r(t[0]),o=r(M(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function R(t){return null!=t?a(t)?t:[t]:[]}function P(t){return"function"===typeof t}var z=Object.prototype.hasOwnProperty;function B(t,e){return z.call(t,e)}var L={};function q(t){return"[object Date]"===Object.prototype.toString.call(t)}function I(t){return"number"===typeof t}var U=1e4;function W(t,e){for(var n="";--e>=0;)n+=t;return n}function H(t){return I(t)?t:q(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=R,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=R(t)).map(function(t,e){return null==t?null:(v.push(e),P(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=R(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)P(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return P(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return P(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return B(r,t)&&r[t]!==L}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===L&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=L),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===L||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=M(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=B,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=q,t.isFunction=P,t.isNumber=I,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?R(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):R(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=M(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.lruCache=function(t){var e,n,r;t=+t||U;var i=function(){e={},n={},r=0},a=function(i,a){return++r>t&&(n=e,e={},r=1),e[i]=a};return i(),{clear:i,has:function(t){return B(e,t)||B(n,t)},get:function(t){return B(e,t)?e[t]:B(n,t)?a(t,n[t]):void 0},set:function(t,n){return B(e,t)?e[t]=n:a(t,n)}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=E(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?W(i,o)+a:"center"===r?W(i,~~(o/2))+a+W(i,Math.ceil(o/2)):a+W(i,o)},t.panLinear=function(t,e){return N(t,e,S,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return N(t,e,O(n),C(n))},t.panPow=function(t,e,n){return N(t,e,T(n),T(1/n))},t.panSymlog=function(t,e,n){return N(t,e,D(n),F(n))},t.peek=M,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=W,t.span=function(t){return t&&M(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||H,null==t||""===t?null:e(t)},t.toNumber=S,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=A,t.zero=d,t.zoomLinear=function(t,e,n){return j(t,e,n,S,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return j(t,e,n,O(r),C(r))},t.zoomPow=function(t,e,n,r){return j(t,e,n,T(r),T(1/r))},t.zoomSymlog=function(t,e,n,r){return j(t,e,n,D(r),F(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2116:function(t,e,n){var r=n(212),i=n(19);!function(t,e){"use strict";var n=i.mark(a);function a(t,e){var r,a,o,u,s,l,c,f,h,d,p,v,g;return i.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=30;break}r=!0,a=!1,o=void 0,n.prev=4,u=t[Symbol.iterator]();case 6:if(r=(s=u.next()).done){n.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){n.next=11;break}return n.next=11,l;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),a=!0,o=n.t0;case 20:n.prev=20,n.prev=21,r||null==u.return||u.return();case 23:if(n.prev=23,!a){n.next=26;break}throw o;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:c=-1,f=!0,h=!1,d=void 0,n.prev=34,p=t[Symbol.iterator]();case 36:if(f=(v=p.next()).done){n.next=44;break}if(g=v.value,!(null!=(g=e(g,++c,t))&&(g=+g)>=g)){n.next=41;break}return n.next=41,g;case 41:f=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),h=!0,d=n.t1;case 50:n.prev=50,n.prev=51,f||null==p.return||p.return();case 53:if(n.prev=53,!h){n.next=56;break}throw d;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function o(t,n,r){var i=Float64Array.from(a(t,r));return i.sort(e.ascending),n.map(function(t){return e.quantileSorted(i,t)})}function u(t,e){return o(t,[.25,.5,.75],e)}function s(t,n){var r=t.length,i=e.deviation(t,n),a=u(t,n),o=(a[2]-a[0])/1.34;return 1.06*(i=Math.min(i,o)||i||Math.abs(a[0])||1)*Math.pow(r,-.2)}t.random=Math.random;var l=Math.sqrt(2*Math.PI),c=Math.SQRT2,f=NaN;function h(e,n){e=e||0,n=null==n?1:n;var r,i,a=0,o=0;if(f===f)a=f,f=NaN;else{do{r=(a=2*t.random()-1)*a+(o=2*t.random()-1)*o}while(0===r||r>1);a*=i=Math.sqrt(-2*Math.log(r)/r),f=o*i}return e+a*n}function d(t,e,n){var r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*l)}function p(t,e,n){var r,i=(t-(e=e||0))/(n=null==n?1:n),a=Math.abs(i);if(a>37)r=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(r=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),r/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):r=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-r:r}function v(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*c*function(t){var e,n=-Math.log((1-t)*(1+t));return n<6.25?e=1.6536545626831027+(e=.24015818242558962+(e=(e=(e=.00018673420803405714+(e=(e=(e=4.2347877827932404e-7+(e=(e=(e=1.0512122733215323e-9+(e=(e=(e=26335093153082323e-28+(e=(e=(e=6637638134358324e-30+(e=20972767875968562e-33+(e=(e=11157877678025181e-33+(e=128584807152564e-32+(e=(e=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?(n=Math.sqrt(n)-3.25,e=3.0838856104922208+(e=1.0052589676941592+(e=.005370914553590064+(e=(e=.002491442096107851+(e=(e=.0009532893797373805+(e=(e=24031110387097894e-21+(e=6828485145957318e-20+(e=(e=12475304481671779e-21+(e=29234449089955446e-22+(e=(e=15027403968909828e-22+(e=1.8239629214389228e-8+(e=(e=9.075656193888539e-8+(e=2.2137376921775787e-9)*n)*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=4.849906401408584+(e=1.0103004648645344+(e=(e=(e=7599527703001776e-20+(e=(e=4526062597223154e-21+(e=(e=2.2900482228026655e-7+(e=(e=2.914795345090108e-8+(e=(e=7.61570120807834e-9+(e=(e=1.5076572693500548e-9+(e=(e=-27109920616438573e-27)*n-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n):e=1/0,e*t}(2*t-1)}function g(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return h(n,r)},pdf:function(t){return d(t,n,r)},cdf:function(t){return p(t,n,r)},icdf:function(t){return v(t,n,r)}};return i.mean(t).stdev(e)}function m(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+h()*e)}function y(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;var r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*l*t)}function b(t,e,n){return p(Math.log(t),e,n)}function x(t,e,n){return Math.exp(v(t,e,n))}function _(e,n){return null==n&&(n=null==e?1:e,e=0),e+(n-e)*t.random()}function w(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function k(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function A(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function E(t,e,n,r){var i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function M(t,e,n,r){t=t.filter(function(t){var r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort(function(t,n){return e(t)-e(n)});var i,a,o,u=t.length,s=new Float64Array(u),l=new Float64Array(u),c=0,f=0,h=0,d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)o=g.value,s[c]=i=+e(o),l[c]=a=+n(o),f+=(i-f)/++c,h+=(a-h)/c}catch(y){p=!0,v=y}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}for(c=0;c<u;++c)s[c]-=f,l[c]-=h;return[s,l,f,h]}function S(t,e,n,r){var i,a,o=-1,u=!0,s=!1,l=void 0;try{for(var c,f=t[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;i=e(h),a=n(h),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}}catch(d){s=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}function C(t,e,n,r,i){var a=0,o=0;return S(t,e,n,function(t,e){var n=e-i(t),u=e-r;a+=n*n,o+=u*u}),1-a/o}function O(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){r+=(t-r)/++u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*t};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}}function D(t,e,n){var i,a,o,u,s=M(t,e,n),l=r(s,4),c=l[0],f=l[1],h=l[2],d=l[3],p=c.length,v=0,g=0,m=0,y=0,b=0;for(i=0;i<p;)a=c[i],o=f[i++],v+=((u=a*a)-v)/i,g+=(u*a-g)/i,m+=(u*u-m)/i,y+=(a*o-y)/i,b+=(u*o-b)/i;var x=m-v*v,_=v*x-g*g,w=(b*v-y*g)/_,k=(y*x-b*g)/_,A=-w*v,E=function(t){return w*(t-=h)*t+k*t+A+d};return{coef:[A-k*h+w*h*h+d,k-2*w*h,w],predict:E,rSquared:C(t,e,n,d,E)}}function F(t,e,n,r){var i,a,o,u,s=Array(t);for(i=0;i<t;++i)s[i]=0;for(i=t-1;i>=0;--i)for(o=e[i],u=1,s[i]+=o,a=1;a<=i;++a)u*=(i+1-a)/a,s[i-a]+=o*Math.pow(n,a)*u;return s[0]+=r,s}var T=2,N=1e-12;function j(t){return(t=1-t*t*t)*t*t}function R(t,e,n){var r=t[e],i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}var P=.1*Math.PI/180;function z(t,e,n){var r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}t.bandwidthNRD=s,t.bin=function(t){var e,n,r,i,a,o,u,s,l=t.maxbins||20,c=t.base||10,f=Math.log(c),h=t.divide||[5,2],d=t.extent[0],p=t.extent[1],v=t.span||p-d||Math.abs(d)||1;if(t.step)e=t.step;else if(t.steps){for(a=v/l,o=0,u=t.steps.length;o<u&&t.steps[o]<a;++o);e=t.steps[Math.max(0,o-1)]}else{for(n=Math.ceil(Math.log(l)/f),r=t.minstep||0,e=Math.max(r,Math.pow(c,Math.round(Math.log(v)/f)-n));Math.ceil(v/e)>l;)e*=c;for(o=0,u=h.length;o<u;++o)(a=e/h[o])>=r&&v/a<=l&&(e=a)}return i=(a=Math.log(e))>=0?0:1+~~(-a/f),s=Math.pow(c,-i-1),(t.nice||void 0===t.nice)&&(d=d<(a=Math.floor(d/e+s)*e)?a-e:a,p=Math.ceil(p/e)*e),{start:d,stop:p===d?d+e:p,step:e}},t.bootstrapCI=function(n,r,i,o){if(!n.length)return[void 0,void 0];var u,s,l,c,f=Float64Array.from(a(n,o)),h=f.length,d=r;for(l=0,c=Array(d);l<d;++l){for(u=0,s=0;s<h;++s)u+=f[~~(t.random()*h)];c[l]=u/h}return c.sort(e.ascending),[e.quantile(c,i/2),e.quantile(c,1-i/2)]},t.cumulativeLogNormal=b,t.cumulativeNormal=p,t.cumulativeUniform=k,t.densityLogNormal=y,t.densityNormal=d,t.densityUniform=w,t.dotbin=function(t,e,n,r){r=r||function(t){return t};for(var i,a=0,o=1,u=t.length,s=new Float64Array(u),l=r(t[0]),c=l,f=l+e;o<u;++o){if((i=r(t[o]))>=f){for(c=(l+c)/2;a<o;++a)s[a]=c;f=i+e,l=i}c=i}for(c=(l+c)/2;a<o;++a)s[a]=c;return n?function(t,e){for(var n,r,i=t.length,a=0,o=1;t[a]===t[o];)++o;for(;o<i;){for(n=o+1;t[o]===t[n];)++n;if(t[o]-t[o-1]<e){for(r=o+(a+n-o-o>>1);r<o;)t[r++]=t[o];for(;r>o;)t[r--]=t[a]}a=o,o=n}return t}(s,e+e/4):s},t.quantileLogNormal=x,t.quantileNormal=v,t.quantileUniform=A,t.quantiles=o,t.quartiles=u,t.randomInteger=function(e,n){null==n&&(n=e,e=0);var r,i,a,o={min:function(t){return arguments.length?(a=i-(r=t||0),o):r},max:function(t){return arguments.length?(a=(i=t||0)-r,o):i},sample:function(){return r+Math.floor(a*t.random())},pdf:function(t){return t===Math.floor(t)&&t>=r&&t<i?1/a:0},cdf:function(t){var e=Math.floor(t);return e<r?0:e>=i?1:(e-r+1)/a},icdf:function(t){return t>=0&&t<=1?r-1+Math.floor(t*a):NaN}};return o.min(e).max(n)},t.randomKDE=function(e,n){var r=g(),i={},a=0;return i.data=function(t){return arguments.length?(e=t,a=t?t.length:0,i.bandwidth(n)):e},i.bandwidth=function(t){return arguments.length?(!(n=t)&&e&&(n=s(e)),i):n},i.sample=function(){return e[~~(t.random()*a)]+n*r.sample()},i.pdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.pdf((t-e[o])/n);return i/n/a},i.cdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.cdf((t-e[o])/n);return i/a},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)},t.randomLCG=function(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}},t.randomLogNormal=function(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return m(n,r)},pdf:function(t){return y(t,n,r)},cdf:function(t){return b(t,n,r)},icdf:function(t){return x(t,n,r)}};return i.mean(t).stdev(e)},t.randomMixture=function(e,n){var r,i={},a=0;function o(t){var e,n=[],r=0;for(e=0;e<a;++e)r+=n[e]=null==t[e]?1:+t[e];for(e=0;e<a;++e)n[e]/=r;return n}return i.weights=function(t){return arguments.length?(r=o(n=t||[]),i):n},i.distributions=function(t){return arguments.length?(t?(a=t.length,e=t):(a=0,e=[]),i.weights(n)):e},i.sample=function(){for(var n=t.random(),i=e[a-1],o=r[0],u=0;u<a-1;o+=r[++u])if(n<o){i=e[u];break}return i.sample()},i.pdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].pdf(t);return n},i.cdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].cdf(t);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(n)},t.randomNormal=g,t.randomUniform=function(t,e){var n,r,i={min:function(t){return arguments.length?(n=t||0,i):n},max:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return _(n,r)},pdf:function(t){return w(t,n,r)},cdf:function(t){return k(t,n,r)},icdf:function(t){return A(t,n,r)}};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)},t.regressionExp=function(t,e,n){var i,a,o,u=M(t,e,n),s=r(u,4),l=s[0],c=(s[1],s[2]),f=s[3],h=0,d=0,p=0,v=0,g=0;S(t,e,n,function(t,e){i=l[g++],a=Math.log(e),h+=(e*a-h)/g,d+=((o=i*e)-d)/g,p+=(o*a-p)/g,v+=(i*o-v)/g});var m=E(d/f,h/f,p/f,v/f),y=r(m,2),b=y[0],x=y[1],_=function(t){return Math.exp(b+x*(t-c))};return{coef:[Math.exp(b-x*c),x],predict:_,rSquared:C(t,e,n,f,_)}},t.regressionLinear=O,t.regressionLoess=function(t,n,i,a){for(var o=M(t,n,i,!0),u=r(o,4),s=u[0],l=u[1],c=u[2],f=u[3],h=s.length,d=Math.max(2,~~(a*h)),p=new Float64Array(h),v=new Float64Array(h),g=new Float64Array(h).fill(1),m=-1;++m<=T;){for(var y=[0,d-1],b=0;b<h;++b){for(var x=s[b],_=y[0],w=y[1],k=x-s[_]>s[w]-x?_:w,A=0,S=0,C=0,O=0,D=0,F=1/Math.abs(s[k]-x||1),P=_;P<=w;++P){var z=s[P],B=l[P],L=j(Math.abs(x-z)*F)*g[P],q=z*L;A+=L,S+=q,C+=B*L,O+=B*q,D+=z*q}var I=E(S/A,C/A,O/A,D/A),U=r(I,2),W=U[0],H=U[1];p[b]=W+H*x,v[b]=Math.abs(l[b]-p[b]),R(s,b+1,y)}if(m===T)break;var V=e.median(v);if(Math.abs(V)<N)break;for(var G,$,Y=0;Y<h;++Y)G=v[Y]/(6*V),g[Y]=G>=1?N:($=1-G*G)*$}return function(t,e,n,r){for(var i,a=t.length,o=[],u=0,s=0,l=[];u<a;++u)i=t[u]+n,l[0]===i?l[1]+=(e[u]-l[1])/++s:(s=0,l[1]+=r,l=[i,e[u]],o.push(l));return l[1]+=r,o}(s,p,c,f)},t.regressionLog=function(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){++u,t=Math.log(t),r+=(t-r)/u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*Math.log(t)};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}},t.regressionPoly=function(t,e,n,i){if(1===i)return O(t,e,n);if(2===i)return D(t,e,n);var a,o,u,s,l,c=M(t,e,n),f=r(c,4),h=f[0],d=f[1],p=f[2],v=f[3],g=h.length,m=[],y=[],b=i+1;for(a=0;a<b;++a){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a)*d[u];for(m.push(s),l=new Float64Array(b),o=0;o<b;++o){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a+o);l[o]=s}y.push(l)}y.push(m);var x=function(t){var e,n,r,i,a,o=t.length-1,u=[];for(e=0;e<o;++e){for(i=e,n=e+1;n<o;++n)Math.abs(t[e][n])>Math.abs(t[e][i])&&(i=n);for(r=e;r<o+1;++r)a=t[r][e],t[r][e]=t[r][i],t[r][i]=a;for(n=e+1;n<o;++n)for(r=o;r>=e;r--)t[r][n]-=t[r][e]*t[e][n]/t[e][e]}for(n=o-1;n>=0;--n){for(a=0,r=n+1;r<o;++r)a+=t[r][n]*u[r];u[n]=(t[o][n]-a)/t[n][n]}return u}(y),_=function(t){t-=p;var e=v+x[0]+x[1]*t+x[2]*t*t;for(a=3;a<b;++a)e+=x[a]*Math.pow(t,a);return e};return{coef:F(b,x,-p,v),predict:_,rSquared:C(t,e,n,v,_)}},t.regressionPow=function(t,e,n){var r=0,i=0,a=0,o=0,u=0,s=0;S(t,e,n,function(t,e){var n=Math.log(t),l=Math.log(e);r+=(n-r)/++s,i+=(l-i)/s,a+=(n*l-a)/s,o+=(n*n-o)/s,u+=(e-u)/s});var l=E(r,i,a,o),c=function(t){return l[0]*Math.pow(t,l[1])};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:C(t,e,n,u,c)}},t.regressionQuad=D,t.sampleCurve=function(t,e,n,r){n=n||25,r=Math.max(n,r||200);var i=function(e){return[e,t(e)]},a=e[0],o=e[1],u=o-a,s=u/r,l=[i(a)],c=[];if(n===r){for(var f=1;f<r;++f)l.push(i(a+f/n*u));return l.push(i(o)),l}c.push(i(o));for(var h=n;--h>0;)c.push(i(a+h/n*u));for(var d=l[0],p=c[c.length-1];p;){var v=i((d[0]+p[0])/2);v[0]-d[0]>=s&&z(d,v,p)>P?c.push(v):(d=p,l.push(p),c.pop()),p=c[c.length-1]}return l},t.sampleLogNormal=m,t.sampleNormal=h,t.sampleUniform=_,t.setRandom=function(e){t.random=e},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053))},2117:function(t,e,n){var r=n(215);!function(t,e,n,i){"use strict";var a="top",o="left",u="right",s="bottom",l="top-left",c="top-right",f="bottom-left",h="bottom-right",d="start",p="middle",v="end",g="x",m="y",y="group",b="axis",x="title",_="frame",w="scope",k="legend",A="row-header",E="row-footer",M="row-title",S="column-header",C="column-footer",O="column-title",D="padding",F="symbol",T="fit",N="fit-x",j="fit-y",R="pad",P="none",z="all",B="each",L="flush",q="column",I="row";function U(t){e.Transform.call(this,null,t)}function W(t,e,n){return e(t.bounds.clear(),t,n)}i.inherits(U,e.Transform).transform=function(t,e){var r,i=e.dataflow,a=t.mark,o=a.marktype,u=n.Marks[o],s=u.bound,l=a.bounds;if(u.nested)a.items.length&&i.dirty(a.items[0]),l=W(a,s),a.items.forEach(function(t){t.bounds.clear().union(l)});else if(o===y||t.modified())switch(e.visit(e.MOD,function(t){i.dirty(t)}),l.clear(),a.items.forEach(function(t){l.union(W(t,s))}),a.role){case b:case k:case x:e.reflow()}else r=e.changed(e.REM),e.visit(e.ADD,function(t){l.union(W(t,s))}),e.visit(e.MOD,function(t){r=r||l.alignsWith(t.bounds),i.dirty(t),l.union(W(t,s))}),r&&(l.clear(),a.items.forEach(function(t){l.union(t.bounds)}));return n.boundClip(a),e.modifies("bounds")};var H=":vega_identifier:";function V(t){e.Transform.call(this,0,t)}function G(t){e.Transform.call(this,null,t)}function $(t){e.Transform.call(this,null,t)}V.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},i.inherits(V,e.Transform).transform=function(t,e){var n=function(t){var e=t._signals[H];return e||(t._signals[H]=e=t.add(0)),e}(e.dataflow),r=n.value,i=t.as;return e.visit(e.ADD,function(t){t[i]||(t[i]=++r)}),n.set(this.value=r),e},i.inherits(G,e.Transform).transform=function(t,e){var r=this.value;r||((r=e.dataflow.scenegraph().mark(t.markdef,function(t){var e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index)).group.context=t.context,t.context.group||(t.context.group=r.group),r.source=this.source,r.clip=t.clip,r.interactive=t.interactive,this.value=r);var i=r.marktype===y?n.GroupItem:n.Item;return e.visit(e.ADD,function(t){i.call(t,r)}),(t.modified("clip")||t.modified("interactive"))&&(r.clip=t.clip,r.interactive=!!t.interactive,r.zdirty=!0,e.reflow()),r.items=e.source,e};var Y=i.inherits($,e.Transform),X={parity:function(t){return t.filter(function(t,e){return e%2?t.opacity=0:1})},greedy:function(t,e){var n;return t.filter(function(t,r){return r&&J(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)})}};function J(t,e,n){return n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}function Q(t,e){for(var n,r=1,i=t.length,a=t[0].bounds;r<i;a=n,++r)if(J(a,n=t[r].bounds,e))return!0}function Z(t){var e=t.bounds;return e.width()>1&&e.height()>1}function K(t){return t.forEach(function(t){return t.opacity=1}),t}function tt(t,e){return t.reflow(e.modified()).modifies("opacity")}function et(t){e.Transform.call(this,null,t)}Y.transform=function(t,e){var r,o,u,l=X[t.method]||X.parity,c=e.materialize(e.SOURCE).source,f=t.separation||0;if(c&&c.length){if(!t.method)return t.modified("method")&&(K(c),e=tt(e,t)),e;if(t.sort&&(c=c.slice().sort(t.sort)),r=K(c=c.filter(Z)),e=tt(e,t),r.length>=3&&Q(r,f)){do{r=l(r,f)}while(r.length>=3&&Q(r,f));r.length<3&&!i.peek(c).opacity&&(r.length>1&&(i.peek(r).opacity=0),i.peek(c).opacity=1)}return t.boundScale&&t.boundTolerance>=0&&(o=function(t,e,r){var i=t.range(),o=new n.Bounds;return e===a||e===s?o.set(i[0],-1/0,i[1],1/0):o.set(-1/0,i[0],1/0,i[1]),o.expand(r||1),function(t){return o.encloses(t.bounds)}}(t.boundScale,t.boundOrient,+t.boundTolerance),c.forEach(function(t){o(t)||(t.opacity=0)})),u=r[0].mark.bounds.clear(),c.forEach(function(t){t.opacity&&u.union(t.bounds)}),e}},i.inherits(et,e.Transform).transform=function(t,e){var n=e.dataflow;if(e.visit(e.ALL,function(t){n.dirty(t)}),e.fields&&e.fields.zindex){var r=e.source&&e.source[0];r&&(r.mark.zdirty=!0)}};var nt=new n.Bounds;function rt(t,e,n){return t[e]===n?0:(t[e]=n,1)}function it(t){var e=t.items[0].datum.orient;return e===o||e===u}function at(t,e,r,i){var l,c,f=e.items[0],h=f.datum,d=h.orient,p=null!=h.translate?h.translate:.5,v=function(t){var e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(h),g=f.range,m=f.offset,y=f.position,b=f.minExtent,x=f.maxExtent,_=h.title&&f.items[v[2]].items[0],w=f.titlePadding,k=f.bounds,A=_&&n.multiLineOffset(_),E=0,M=0;switch(nt.clear().union(k),k.clear(),(l=v[0])>-1&&k.union(f.items[l].bounds),(l=v[1])>-1&&k.union(f.items[l].bounds),d){case a:E=y||0,M=-m,c=Math.max(b,Math.min(x,-k.y1)),k.add(0,-c).add(g,0),_&&ot(t,_,c,w,A,0,-1,k);break;case o:E=-m,M=y||0,c=Math.max(b,Math.min(x,-k.x1)),k.add(-c,0).add(0,g),_&&ot(t,_,c,w,A,1,-1,k);break;case u:E=r+m,M=y||0,c=Math.max(b,Math.min(x,k.x2)),k.add(0,0).add(c,g),_&&ot(t,_,c,w,A,1,1,k);break;case s:E=y||0,M=i+m,c=Math.max(b,Math.min(x,k.y2)),k.add(0,0).add(g,c),_&&ot(t,_,c,w,0,0,1,k);break;default:E=f.x,M=f.y}return n.boundStroke(k.translate(E,M),f),rt(f,"x",E+p)|rt(f,"y",M+p)&&(f.bounds=nt,t.dirty(f),f.bounds=k,t.dirty(f)),f.mark.bounds.clear().union(k)}function ot(t,e,n,r,i,a,o,u){var s=e.bounds;if(e.auto){var l=o*(n+i+r),c=0,f=0;t.dirty(e),a?c=(e.x||0)-(e.x=l):f=(e.y||0)-(e.y=l),e.mark.bounds.clear().union(s.translate(-c,-f)),t.dirty(e)}u.union(s)}function ut(t){return(new n.Bounds).set(0,0,t.width||0,t.height||0)}function st(t){var e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function lt(t,e,n){var r=i.isObject(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function ct(t){return t<0?Math.ceil(-t):0}function ft(t,e,n){var r,i,a,o,u,s,l,c,f,h,d,y=!n.nodirty,b=n.bounds===L?ut:st,x=nt.set(0,0,0,0),_=lt(n.align,q),w=lt(n.align,I),k=lt(n.padding,q),A=lt(n.padding,I),E=n.columns||e.length,M=E<0?1:Math.ceil(e.length/E),S=e.length,C=Array(S),O=Array(E),D=0,F=Array(S),T=Array(M),N=0,j=Array(S),R=Array(S),P=Array(S);for(i=0;i<E;++i)O[i]=0;for(i=0;i<M;++i)T[i]=0;for(i=0;i<S;++i)s=e[i],u=P[i]=b(s),s.x=s.x||0,j[i]=0,s.y=s.y||0,R[i]=0,a=i%E,o=~~(i/E),D=Math.max(D,l=Math.ceil(u.x2)),N=Math.max(N,c=Math.ceil(u.y2)),O[a]=Math.max(O[a],l),T[o]=Math.max(T[o],c),C[i]=k+ct(u.x1),F[i]=A+ct(u.y1),y&&t.dirty(e[i]);for(i=0;i<S;++i)i%E===0&&(C[i]=0),i<E&&(F[i]=0);if(_===B)for(a=1;a<E;++a){for(d=0,i=a;i<S;i+=E)d<C[i]&&(d=C[i]);for(i=a;i<S;i+=E)C[i]=d+O[a-1]}else if(_===z){for(d=0,i=0;i<S;++i)i%E&&d<C[i]&&(d=C[i]);for(i=0;i<S;++i)i%E&&(C[i]=d+D)}else for(_=!1,a=1;a<E;++a)for(i=a;i<S;i+=E)C[i]+=O[a-1];if(w===B)for(o=1;o<M;++o){for(d=0,r=(i=o*E)+E;i<r;++i)d<F[i]&&(d=F[i]);for(i=o*E;i<r;++i)F[i]=d+T[o-1]}else if(w===z){for(d=0,i=E;i<S;++i)d<F[i]&&(d=F[i]);for(i=E;i<S;++i)F[i]=d+N}else for(w=!1,o=1;o<M;++o)for(r=(i=o*E)+E;i<r;++i)F[i]+=T[o-1];for(f=0,i=0;i<S;++i)f=C[i]+(i%E?f:0),j[i]+=f-e[i].x;for(a=0;a<E;++a)for(h=0,i=a;i<S;i+=E)h+=F[i],R[i]+=h-e[i].y;if(_&&lt(n.center,q)&&M>1)for(i=0;i<S;++i)(f=(u=_===z?D:O[i%E])-P[i].x2-e[i].x-j[i])>0&&(j[i]+=f/2);if(w&&lt(n.center,I)&&1!==E)for(i=0;i<S;++i)(h=(u=w===z?N:T[~~(i/E)])-P[i].y2-e[i].y-R[i])>0&&(R[i]+=h/2);for(i=0;i<S;++i)x.union(P[i].translate(j[i],R[i]));switch(f=lt(n.anchor,g),h=lt(n.anchor,m),lt(n.anchor,q)){case v:f-=x.width();break;case p:f-=x.width()/2}switch(lt(n.anchor,I)){case v:h-=x.height();break;case p:h-=x.height()/2}for(f=Math.round(f),h=Math.round(h),x.clear(),i=0;i<S;++i)e[i].mark.bounds.clear();for(i=0;i<S;++i)(s=e[i]).x+=j[i]+=f,s.y+=R[i]+=h,x.union(s.mark.bounds.union(s.bounds.translate(j[i],R[i]))),y&&t.dirty(s);return x}function ht(t,e,n){var i,a,o,u,s,l,c,f=function(t){for(var e,n,i,a,o,u,s,l=t.items,c=l.length,f=0,h={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};f<c;++f)if(s=(u=l[f]).items,u.marktype===y)switch(u.role){case b:case k:case x:break;case A:(e=h.rowheaders).push.apply(e,r(s));break;case E:(n=h.rowfooters).push.apply(n,r(s));break;case S:(i=h.colheaders).push.apply(i,r(s));break;case C:(a=h.colfooters).push.apply(a,r(s));break;case M:h.rowtitle=s[0];break;case O:h.coltitle=s[0];break;default:(o=h.marks).push.apply(o,r(s))}return h}(e),h=f.marks,d=n.bounds===L?dt:pt,p=n.offset,g=n.columns||h.length,m=g<0?1:Math.ceil(h.length/g),_=m*g,w=ft(t,h,n);f.rowheaders&&(l=lt(n.headerBand,I,null),i=mt(t,f.rowheaders,h,0,m,-lt(p,"rowHeader"),vt,0,d,"x1",0,g,1,l)),f.colheaders&&(l=lt(n.headerBand,q,null),a=mt(t,f.colheaders,h,0,g,-lt(p,"columnHeader"),vt,1,d,"y1",0,1,g,l)),f.rowfooters&&(l=lt(n.footerBand,I,null),o=mt(t,f.rowfooters,h,0,m,lt(p,"rowFooter"),gt,0,d,"x2",g-1,g,1,l)),f.colfooters&&(l=lt(n.footerBand,q,null),u=mt(t,f.colfooters,h,0,g,lt(p,"columnFooter"),gt,1,d,"y2",_-g,1,g,l)),f.rowtitle&&(s=lt(n.titleAnchor,I),c=lt(p,"rowTitle"),c=s===v?o+c:i-c,l=lt(n.titleBand,I,.5),yt(t,f.rowtitle,c,0,w,l)),f.coltitle&&(s=lt(n.titleAnchor,q),c=lt(p,"columnTitle"),c=s===v?u+c:a-c,l=lt(n.titleBand,q,.5),yt(t,f.coltitle,c,1,w,l))}function dt(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function pt(t,e){return t.bounds[e]}function vt(t,e){return Math.floor(Math.min(t,e))}function gt(t,e){return Math.ceil(Math.max(t,e))}function mt(t,e,n,r,i,a,o,u,s,l,c,f,h,d){var p,v,g,m,y,b,x,_,w,k=n.length,A=0,E=0;if(!k)return A;for(p=c;p<k;p+=f)n[p]&&(A=o(A,s(n[p],l)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=a,v=0,m=e.length;v<m;++v)t.dirty(e[v]),e[v].mark.bounds.clear();for(p=c,v=0,m=e.length;v<m;++v,p+=f){for(y=(b=e[v]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=h);u?(_=null==d?x.x:Math.round(x.bounds.x1+d*x.bounds.width()),w=A):(_=A,w=null==d?x.y:Math.round(x.bounds.y1+d*x.bounds.height())),y.union(b.bounds.translate(_-(b.x||0),w-(b.y||0))),b.x=_,b.y=w,t.dirty(b),E=o(E,y[l])}return E}function yt(t,e,n,r,i,a){if(e){t.dirty(e);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height()),e.bounds.translate(o-(e.x||0),u-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=u,t.dirty(e)}}function bt(t,e,n,r,i,g,m){var y=function(t,e){var n=t[e]||{};return function(e,r){return null!=n[e]?n[e]:null!=t[e]?t[e]:r}}(n,e),b=function(t,e){var n=-1/0;return t.forEach(function(t){null!=t.offset&&(n=Math.max(n,t.offset))}),n>-1/0?n:e}(t,y("offset",0)),x=y("anchor",d),_=x===v?1:x===p?.5:0,w={align:B,bounds:y("bounds",L),columns:"vertical"===y("direction")?1:t.length,padding:y("margin",8),center:y("center"),nodirty:!0};switch(e){case o:w.anchor={x:Math.floor(r.x1)-b,column:v,y:_*(m||r.height()+2*r.y1),row:x};break;case u:w.anchor={x:Math.ceil(r.x2)+b,y:_*(m||r.height()+2*r.y1),row:x};break;case a:w.anchor={y:Math.floor(i.y1)-b,row:v,x:_*(g||i.width()+2*i.x1),column:x};break;case s:w.anchor={y:Math.ceil(i.y2)+b,x:_*(g||i.width()+2*i.x1),column:x};break;case l:w.anchor={x:b,y:b};break;case c:w.anchor={x:g-b,y:b,column:v};break;case f:w.anchor={x:b,y:m-b,row:v};break;case h:w.anchor={x:g-b,y:m-b,column:v,row:v}}return w}function xt(t,e){var r,i,a=e.items[0],l=a.datum,c=a.orient,f=a.bounds,h=a.x,d=a.y;return a._bounds?a._bounds.clear().union(f):a._bounds=f.clone(),f.clear(),function(t,e,n){var r=e.padding,i=r-n.x,a=r-n.y;if(e.datum.title){var l=e.items[1].items[0],c=l.anchor,f=e.titlePadding||0,h=r-l.x,d=r-l.y;switch(l.orient){case o:i+=Math.ceil(l.bounds.width())+f;break;case u:case s:break;default:a+=l.bounds.height()+f}switch((i||a)&&wt(t,n,i,a),l.orient){case o:d+=_t(e,n,l,c,1,1);break;case u:h+=_t(e,n,l,v,0,0)+f,d+=_t(e,n,l,c,1,1);break;case s:h+=_t(e,n,l,c,0,0),d+=_t(e,n,l,v,-1,0,1)+f;break;default:h+=_t(e,n,l,c,0,0)}(h||d)&&wt(t,l,h,d),(h=Math.round(l.bounds.x1-r))<0&&(wt(t,n,-h,0),wt(t,l,-h,0))}else(i||a)&&wt(t,n,i,a)}(t,a,a.items[0].items[0]),f=function(t,e){return t.items.forEach(function(t){return e.union(t.bounds)}),e.x1=t.padding,e.y1=t.padding,e}(a,f),r=2*a.padding,i=2*a.padding,f.empty()||(r=Math.ceil(f.width()+r),i=Math.ceil(f.height()+i)),l.type===F&&function(t){var e=t.reduce(function(t,e){return t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t},{});t.forEach(function(t){t.width=e[t.column],t.height=t.bounds.y2-t.y})}(a.items[0].items[0].items[0].items),c!==P&&(a.x=h=0,a.y=d=0),a.width=r,a.height=i,n.boundStroke(f.set(h,d,h+r,d+i),a),a.mark.bounds.clear().union(f),a}function _t(t,e,r,i,a,o,u){var s="symbol"!==t.datum.type,l=r.datum.vgrad,c=(!s||!o&&l||u?e:e.items[0]).bounds[a?"y2":"x2"]-t.padding,f=l&&o?c:0,h=l&&o?0:c,p=a<=0?0:n.multiLineOffset(r);return Math.round(i===d?f:i===v?h-p:.5*(c-p))}function wt(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function kt(t){e.Transform.call(this,null,t)}function At(t,e,r){var i,l,c,f,h,p=e.items,g=Math.max(0,e.width||0),m=Math.max(0,e.height||0),F=(new n.Bounds).set(0,0,g,m),z=F.clone(),B=F.clone(),L=[];for(f=0,h=p.length;f<h;++f)switch((l=p[f]).role){case b:(it(l)?z:B).union(at(t,l,g,m));break;case x:i=l;break;case k:L.push(xt(t,l));break;case _:case w:case A:case E:case M:case S:case C:case O:z.union(l.bounds),B.union(l.bounds);break;default:F.union(l.bounds)}if(L.length){var q={};for(var I in L.forEach(function(t){(c=t.orient||u)!==P&&(q[c]||(q[c]=[])).push(t)}),q){var U=q[I];ft(t,U,bt(U,I,r.legends,z,B,g,m))}L.forEach(function(e){var n=e.bounds;if(n.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=n,t.dirty(e)),r.autosize&&r.autosize.type===T)switch(e.orient){case o:case u:F.add(n.x1,0).add(n.x2,0);break;case a:case s:F.add(0,n.y1).add(0,n.y2)}else F.union(n)})}F.union(z).union(B),i&&F.union(function(t,e,n,r,i){var l,c=e.items[0],f=c.frame,h=c.orient,p=c.anchor,g=c.offset,m=c.padding,b=c.items[0].items[0],x=c.items[1]&&c.items[1].items[0],_=h===o||h===u?r:n,w=0,k=0,A=0,E=0,M=0;if(f!==y?h===o?(w=i.y2,_=i.y1):h===u?(w=i.y1,_=i.y2):(w=i.x1,_=i.x2):h===o&&(w=r,_=0),l=p===d?w:p===v?_:(w+_)/2,x&&x.text){switch(h){case a:case s:M=b.bounds.height()+m;break;case o:E=b.bounds.width()+m;break;case u:E=-b.bounds.width()-m}nt.clear().union(x.bounds),nt.translate(E-(x.x||0),M-(x.y||0)),rt(x,"x",E)|rt(x,"y",M)&&(t.dirty(x),x.bounds.clear().union(nt),x.mark.bounds.clear().union(nt),t.dirty(x)),nt.clear().union(x.bounds)}else nt.clear();switch(nt.union(b.bounds),h){case a:k=l,A=i.y1-nt.height()-g;break;case o:k=i.x1-nt.width()-g,A=l;break;case u:k=i.x2+nt.width()+g,A=l;break;case s:k=l,A=i.y2+g;break;default:k=c.x,A=c.y}return rt(c,"x",k)|rt(c,"y",A)&&(nt.translate(k,A),t.dirty(c),c.bounds.clear().union(nt),e.bounds.clear().union(nt),t.dirty(c)),c.bounds}(t,i,g,m,F)),e.clip&&F.set(0,0,e.width||0,e.height||0),function(t,e,n,r){var i=r.autosize||{},a=i.type;if(!(t._autosize<1)&&a){var o=t._width,u=t._height,s=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,Math.ceil(n.x2-s)),f=Math.max(0,e.height||0),h=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.y2-f));if(i.contains===D){var p=t.padding();o-=p.left+p.right,u-=p.top+p.bottom}a===P?(l=0,h=0,s=o,f=u):a===T?(s=Math.max(0,o-l-c),f=Math.max(0,u-h-d)):a===N?(s=Math.max(0,o-l-c),u=f+h+d):a===j?(o=s+l+c,f=Math.max(0,u-h-d)):a===R&&(o=s+l+c,u=f+h+d),t._resizeView(o,u,s,f,[l,h],i.resize)}}(t,e,F,r)}i.inherits(kt,e.Transform).transform=function(t,e){var n=e.dataflow;return t.mark.items.forEach(function(e){t.layout&&ht(n,e,t.layout),At(n,e,t)}),t.modified()&&e.reflow(),e},t.bound=U,t.identifier=V,t.mark=G,t.overlap=$,t.render=et,t.viewlayout=kt,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1563),n(2119))},2118:function(t,e,n){!function(t,e){"use strict";function n(t){return function(){return t}}var r=Math.abs,i=Math.atan2,a=Math.cos,o=Math.max,u=Math.min,s=Math.sin,l=Math.sqrt,c=1e-12,f=Math.PI,h=f/2,d=2*f;function p(t){return t>=1?h:t<=-1?-h:Math.asin(t)}function v(t){return t.innerRadius}function g(t){return t.outerRadius}function m(t){return t.startAngle}function y(t){return t.endAngle}function b(t){return t&&t.padAngle}function x(t,e,n,r,i,a,u){var s=t-n,c=e-r,f=(u?a:-a)/l(s*s+c*c),h=f*c,d=-f*s,p=t+h,v=e+d,g=n+h,m=r+d,y=(p+g)/2,b=(v+m)/2,x=g-p,_=m-v,w=x*x+_*_,k=i-a,A=p*m-g*v,E=(_<0?-1:1)*l(o(0,k*k*w-A*A)),M=(A*_-x*E)/w,S=(-A*x-_*E)/w,C=(A*_+x*E)/w,O=(-A*x+_*E)/w,D=M-y,F=S-b,T=C-y,N=O-b;return D*D+F*F>T*T+N*N&&(M=C,S=O),{cx:M,cy:S,x01:-h,y01:-d,x11:M*(i/k-1),y11:S*(i/k-1)}}function _(t){this._context=t}function w(t){return new _(t)}function k(t){return t[0]}function A(t){return t[1]}function E(){var t=k,r=A,i=n(!0),a=null,o=w,u=null;function s(n){var s,l,c,f=n.length,h=!1;for(null==a&&(u=o(c=e.path())),s=0;s<=f;++s)!(s<f&&i(l=n[s],s,n))===h&&((h=!h)?u.lineStart():u.lineEnd()),h&&u.point(+t(l,s,n),+r(l,s,n));if(c)return u=null,c+""||null}return s.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),s):t},s.y=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),s):r},s.defined=function(t){return arguments.length?(i="function"===typeof t?t:n(!!t),s):i},s.curve=function(t){return arguments.length?(o=t,null!=a&&(u=o(a)),s):o},s.context=function(t){return arguments.length?(null==t?a=u=null:u=o(a=t),s):a},s}function M(){var t=k,r=null,i=n(0),a=A,o=n(!0),u=null,s=w,l=null;function c(n){var c,f,h,d,p,v=n.length,g=!1,m=new Array(v),y=new Array(v);for(null==u&&(l=s(p=e.path())),c=0;c<=v;++c){if(!(c<v&&o(d=n[c],c,n))===g)if(g=!g)f=c,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=c-1;h>=f;--h)l.point(m[h],y[h]);l.lineEnd(),l.areaEnd()}g&&(m[c]=+t(d,c,n),y[c]=+i(d,c,n),l.point(r?+r(d,c,n):m[c],a?+a(d,c,n):y[c]))}if(p)return l=null,p+""||null}function f(){return E().defined(o).curve(s).context(u)}return c.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:n(+t),c):r},c.y=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a=null,c):i},c.y0=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),c):i},c.y1=function(t){return arguments.length?(a=null==t?null:"function"===typeof t?t:n(+t),c):a},c.lineX0=c.lineY0=function(){return f().x(t).y(i)},c.lineY1=function(){return f().x(t).y(a)},c.lineX1=function(){return f().x(r).y(i)},c.defined=function(t){return arguments.length?(o="function"===typeof t?t:n(!!t),c):o},c.curve=function(t){return arguments.length?(s=t,null!=u&&(l=s(u)),c):s},c.context=function(t){return arguments.length?(null==t?u=l=null:l=s(u=t),c):u},c}function S(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function C(t){return t}_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var O=F(w);function D(t){this._curve=t}function F(t){function e(e){return new D(t(e))}return e._curve=t,e}function T(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function N(){return T(E().curve(O))}function j(){var t=M().curve(O),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return T(n())},delete t.lineX0,t.lineEndAngle=function(){return T(r())},delete t.lineX1,t.lineInnerRadius=function(){return T(i())},delete t.lineY0,t.lineOuterRadius=function(){return T(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function R(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var P=Array.prototype.slice;function z(t){return t.source}function B(t){return t.target}function L(t){var r=z,i=B,a=k,o=A,u=null;function s(){var n,s=P.call(arguments),l=r.apply(this,s),c=i.apply(this,s);if(u||(u=n=e.path()),t(u,+a.apply(this,(s[0]=l,s)),+o.apply(this,s),+a.apply(this,(s[0]=c,s)),+o.apply(this,s)),n)return u=null,n+""||null}return s.source=function(t){return arguments.length?(r=t,s):r},s.target=function(t){return arguments.length?(i=t,s):i},s.x=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),s):a},s.y=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),s):o},s.context=function(t){return arguments.length?(u=null==t?null:t,s):u},s}function q(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function I(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function U(t,e,n,r,i){var a=R(e,n),o=R(e,n=(n+i)/2),u=R(r,n),s=R(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],u[0],u[1],s[0],s[1])}var W={draw:function(t,e){var n=Math.sqrt(e/f);t.moveTo(n,0),t.arc(0,0,n,0,d)}},H={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},V=Math.sqrt(1/3),G=2*V,$={draw:function(t,e){var n=Math.sqrt(e/G),r=n*V;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},Y=Math.sin(f/10)/Math.sin(7*f/10),X=Math.sin(d/10)*Y,J=-Math.cos(d/10)*Y,Q={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=X*n,i=J*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=d*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*n,-u*n),t.lineTo(u*r-s*i,s*r+u*i)}t.closePath()}},Z={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},K=Math.sqrt(3),tt={draw:function(t,e){var n=-Math.sqrt(e/(3*K));t.moveTo(0,2*n),t.lineTo(-K*n,-n),t.lineTo(K*n,-n),t.closePath()}},et=-.5,nt=Math.sqrt(3)/2,rt=1/Math.sqrt(12),it=3*(rt/2+1),at={draw:function(t,e){var n=Math.sqrt(e/it),r=n/2,i=n*rt,a=r,o=n*rt+n,u=-a,s=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(u,s),t.lineTo(et*r-nt*i,nt*r+et*i),t.lineTo(et*a-nt*o,nt*a+et*o),t.lineTo(et*u-nt*s,nt*u+et*s),t.lineTo(et*r+nt*i,et*i-nt*r),t.lineTo(et*a+nt*o,et*o-nt*a),t.lineTo(et*u+nt*s,et*s-nt*u),t.closePath()}},ot=[W,H,$,Z,Q,tt,at];function ut(){}function st(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function lt(t){this._context=t}function ct(t){this._context=t}function ft(t){this._context=t}function ht(t,e){this._basis=new lt(t),this._beta=e}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:st(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ht.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,u=e[n]-a,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*t[s]+(1-this._beta)*(i+r*o),this._beta*e[s]+(1-this._beta)*(a+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var dt=function t(e){function n(t){return 1===e?new lt(t):new ht(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function pt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function vt(t,e){this._context=t,this._k=(1-e)/6}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gt=function t(e){function n(t){return new vt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function mt(t,e){this._context=t,this._k=(1-e)/6}mt.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var yt=function t(e){function n(t){return new mt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function bt(t,e){this._context=t,this._k=(1-e)/6}bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var xt=function t(e){function n(t){return new bt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function _t(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>c){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>c){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function wt(t,e){this._context=t,this._alpha=e}wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var kt=function t(e){function n(t){return e?new wt(t,e):new vt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function At(t,e){this._context=t,this._alpha=e}At.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Et=function t(e){function n(t){return e?new At(t,e):new mt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Mt(t,e){this._context=t,this._alpha=e}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function t(e){function n(t){return e?new Mt(t,e):new bt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ct(t){this._context=t}function Ot(t){return t<0?-1:1}function Dt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(Ot(a)+Ot(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Ft(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*e,a-u,o-u*n,a,o)}function Nt(t){this._context=t}function jt(t){this._context=new Rt(t)}function Rt(t){this._context=t}function Pt(t){this._context=t}function zt(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Bt(t,e){this._context=t,this._t=e}function Lt(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],u=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<u;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function qt(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function It(t,e){return t[e]}function Ut(t){var e=t.map(Wt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Wt(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function Ht(t){var e=t.map(Vt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Vt(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}Ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tt(this,this._t0,Ft(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tt(this,Ft(this,n=Dt(this,t,e)),n);break;default:Tt(this,this._t0,n=Dt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(jt.prototype=Object.create(Nt.prototype)).point=function(t,e){Nt.prototype.point.call(this,e,t)},Rt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=zt(t),i=zt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}},t.arc=function(){var t=v,o=g,_=n(0),w=null,k=m,A=y,E=b,M=null;function S(){var n,v,g=+t.apply(this,arguments),m=+o.apply(this,arguments),y=k.apply(this,arguments)-h,b=A.apply(this,arguments)-h,S=r(b-y),C=b>y;if(M||(M=n=e.path()),m<g&&(v=m,m=g,g=v),m>c)if(S>d-c)M.moveTo(m*a(y),m*s(y)),M.arc(0,0,m,y,b,!C),g>c&&(M.moveTo(g*a(b),g*s(b)),M.arc(0,0,g,b,y,C));else{var O,D,F=y,T=b,N=y,j=b,R=S,P=S,z=E.apply(this,arguments)/2,B=z>c&&(w?+w.apply(this,arguments):l(g*g+m*m)),L=u(r(m-g)/2,+_.apply(this,arguments)),q=L,I=L;if(B>c){var U=p(B/g*s(z)),W=p(B/m*s(z));(R-=2*U)>c?(N+=U*=C?1:-1,j-=U):(R=0,N=j=(y+b)/2),(P-=2*W)>c?(F+=W*=C?1:-1,T-=W):(P=0,F=T=(y+b)/2)}var H=m*a(F),V=m*s(F),G=g*a(j),$=g*s(j);if(L>c){var Y,X=m*a(T),J=m*s(T),Q=g*a(N),Z=g*s(N);if(S<f&&(Y=function(t,e,n,r,i,a,o,u){var s=n-t,l=r-e,f=o-i,h=u-a,d=h*s-f*l;if(!(d*d<c))return[t+(d=(f*(e-a)-h*(t-i))/d)*s,e+d*l]}(H,V,Q,Z,X,J,G,$))){var K=H-Y[0],tt=V-Y[1],et=X-Y[0],nt=J-Y[1],rt=1/s(function(t){return t>1?0:t<-1?f:Math.acos(t)}((K*et+tt*nt)/(l(K*K+tt*tt)*l(et*et+nt*nt)))/2),it=l(Y[0]*Y[0]+Y[1]*Y[1]);q=u(L,(g-it)/(rt-1)),I=u(L,(m-it)/(rt+1))}}P>c?I>c?(O=x(Q,Z,H,V,m,I,C),D=x(X,J,G,$,m,I,C),M.moveTo(O.cx+O.x01,O.cy+O.y01),I<L?M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,m,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),!C),M.arc(D.cx,D.cy,I,i(D.y11,D.x11),i(D.y01,D.x01),!C))):(M.moveTo(H,V),M.arc(0,0,m,F,T,!C)):M.moveTo(H,V),g>c&&R>c?q>c?(O=x(G,$,X,J,g,-q,C),D=x(H,V,Q,Z,g,-q,C),M.lineTo(O.cx+O.x01,O.cy+O.y01),q<L?M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,g,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),C),M.arc(D.cx,D.cy,q,i(D.y11,D.x11),i(D.y01,D.x01),!C))):M.arc(0,0,g,j,N,C):M.lineTo(G,$)}else M.moveTo(0,0);if(M.closePath(),n)return M=null,n+""||null}return S.centroid=function(){var e=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,n=(+k.apply(this,arguments)+ +A.apply(this,arguments))/2-f/2;return[a(n)*e,s(n)*e]},S.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),S):t},S.outerRadius=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),S):o},S.cornerRadius=function(t){return arguments.length?(_="function"===typeof t?t:n(+t),S):_},S.padRadius=function(t){return arguments.length?(w=null==t?null:"function"===typeof t?t:n(+t),S):w},S.startAngle=function(t){return arguments.length?(k="function"===typeof t?t:n(+t),S):k},S.endAngle=function(t){return arguments.length?(A="function"===typeof t?t:n(+t),S):A},S.padAngle=function(t){return arguments.length?(E="function"===typeof t?t:n(+t),S):E},S.context=function(t){return arguments.length?(M=null==t?null:t,S):M},S},t.area=M,t.areaRadial=j,t.curveBasis=function(t){return new lt(t)},t.curveBasisClosed=function(t){return new ct(t)},t.curveBasisOpen=function(t){return new ft(t)},t.curveBundle=dt,t.curveCardinal=gt,t.curveCardinalClosed=yt,t.curveCardinalOpen=xt,t.curveCatmullRom=kt,t.curveCatmullRomClosed=Et,t.curveCatmullRomOpen=St,t.curveLinear=w,t.curveLinearClosed=function(t){return new Ct(t)},t.curveMonotoneX=function(t){return new Nt(t)},t.curveMonotoneY=function(t){return new jt(t)},t.curveNatural=function(t){return new Pt(t)},t.curveStep=function(t){return new Bt(t,.5)},t.curveStepAfter=function(t){return new Bt(t,1)},t.curveStepBefore=function(t){return new Bt(t,0)},t.line=E,t.lineRadial=N,t.linkHorizontal=function(){return L(q)},t.linkRadial=function(){var t=L(U);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.linkVertical=function(){return L(I)},t.pie=function(){var t=C,e=S,r=null,i=n(0),a=n(d),o=n(0);function u(n){var u,s,l,c,f,h=n.length,p=0,v=new Array(h),g=new Array(h),m=+i.apply(this,arguments),y=Math.min(d,Math.max(-d,a.apply(this,arguments)-m)),b=Math.min(Math.abs(y)/h,o.apply(this,arguments)),x=b*(y<0?-1:1);for(u=0;u<h;++u)(f=g[v[u]=u]=+t(n[u],u,n))>0&&(p+=f);for(null!=e?v.sort(function(t,n){return e(g[t],g[n])}):null!=r&&v.sort(function(t,e){return r(n[t],n[e])}),u=0,l=p?(y-h*x)/p:0;u<h;++u,m=c)s=v[u],c=m+((f=g[s])>0?f*l:0)+x,g[s]={data:n[s],index:u,value:f,startAngle:m,endAngle:c,padAngle:b};return g}return u.value=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),u):t},u.sortValues=function(t){return arguments.length?(e=t,r=null,u):e},u.sort=function(t){return arguments.length?(r=t,e=null,u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),u):o},u},t.pointRadial=R,t.radialArea=j,t.radialLine=N,t.stack=function(){var t=n([]),e=qt,r=Lt,i=It;function a(n){var a,o,u=t.apply(this,arguments),s=n.length,l=u.length,c=new Array(l);for(a=0;a<l;++a){for(var f,h=u[a],d=c[a]=new Array(s),p=0;p<s;++p)d[p]=f=[0,+i(n[p],h,p,n)],f.data=n[p];d.key=h}for(a=0,o=e(c);a<l;++a)c[o[a]].index=a;return r(c,o),c}return a.keys=function(e){return arguments.length?(t="function"===typeof e?e:n(P.call(e)),a):t},a.value=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a):i},a.order=function(t){return arguments.length?(e=null==t?qt:"function"===typeof t?t:n(P.call(t)),a):e},a.offset=function(t){return arguments.length?(r=null==t?Lt:t,a):r},a},t.stackOffsetDiverging=function(t,e){if((u=t.length)>0)for(var n,r,i,a,o,u,s=0,l=t[e[0]].length;s<l;++s)for(a=o=0,n=0;n<u;++n)(i=(r=t[e[n]][s])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)},t.stackOffsetExpand=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}Lt(t,e)}},t.stackOffsetNone=Lt,t.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,u=0;o<n;++o)u+=t[o][r][1]||0;i[r][1]+=i[r][0]=-u/2}Lt(t,e)}},t.stackOffsetWiggle=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var u=0,s=0,l=0;u<i;++u){for(var c=t[e[u]],f=c[o][1]||0,h=(f-(c[o-1][1]||0))/2,d=0;d<u;++d){var p=t[e[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}s+=f,l+=h*f}n[o-1][1]+=n[o-1][0]=a,s&&(a-=l/s)}n[o-1][1]+=n[o-1][0]=a,Lt(t,e)}},t.stackOrderAppearance=Ut,t.stackOrderAscending=Ht,t.stackOrderDescending=function(t){return Ht(t).reverse()},t.stackOrderInsideOut=function(t){var e,n,r=t.length,i=t.map(Vt),a=Ut(t),o=0,u=0,s=[],l=[];for(e=0;e<r;++e)n=a[e],o<u?(o+=i[n],s.push(n)):(u+=i[n],l.push(n));return l.reverse().concat(s)},t.stackOrderNone=qt,t.stackOrderReverse=function(t){return qt(t).reverse()},t.symbol=function(){var t=n(W),r=n(64),i=null;function a(){var n;if(i||(i=n=e.path()),t.apply(this,arguments).draw(i,+r.apply(this,arguments)),n)return i=null,n+""||null}return a.type=function(e){return arguments.length?(t="function"===typeof e?e:n(e),a):t},a.size=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),a):r},a.context=function(t){return arguments.length?(i=null==t?null:t,a):i},a},t.symbolCircle=W,t.symbolCross=H,t.symbolDiamond=$,t.symbolSquare=Z,t.symbolStar=Q,t.symbolTriangle=tt,t.symbolWye=at,t.symbols=ot,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1080))},2119:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4,k=function(t){return"__proto__"!==t};function A(t,e,n,r){var i,u;if(k(e))if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):k(i)&&(u[i]=n[i]);else t[e]=n}function E(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function M(t){return t[t.length-1]}function S(t){return null==t||""===t?null:+t}function C(t){return function(e){return t*Math.exp(e)}}function O(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function F(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function T(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function N(t,e,n,r){var i=n(t[0]),a=n(M(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function j(t,e,n,r,i){var a=r(t[0]),o=r(M(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function R(t){return null!=t?a(t)?t:[t]:[]}function P(t){return"function"===typeof t}var z=Object.prototype.hasOwnProperty;function B(t,e){return z.call(t,e)}var L={};function q(t){return"[object Date]"===Object.prototype.toString.call(t)}function I(t){return"number"===typeof t}var U=1e4;function W(t,e){for(var n="";--e>=0;)n+=t;return n}function H(t){return I(t)?t:q(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=R,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=R(t)).map(function(t,e){return null==t?null:(v.push(e),P(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=R(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)P(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return P(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return P(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return B(r,t)&&r[t]!==L}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===L&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=L),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===L||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=M(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=B,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=q,t.isFunction=P,t.isNumber=I,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?R(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):R(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=M(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.lruCache=function(t){var e,n,r;t=+t||U;var i=function(){e={},n={},r=0},a=function(i,a){return++r>t&&(n=e,e={},r=1),e[i]=a};return i(),{clear:i,has:function(t){return B(e,t)||B(n,t)},get:function(t){return B(e,t)?e[t]:B(n,t)?a(t,n[t]):void 0},set:function(t,n){return B(e,t)?e[t]=n:a(t,n)}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=E(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?W(i,o)+a:"center"===r?W(i,~~(o/2))+a+W(i,Math.ceil(o/2)):a+W(i,o)},t.panLinear=function(t,e){return N(t,e,S,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return N(t,e,O(n),C(n))},t.panPow=function(t,e,n){return N(t,e,T(n),T(1/n))},t.panSymlog=function(t,e,n){return N(t,e,D(n),F(n))},t.peek=M,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=W,t.span=function(t){return t&&M(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||H,null==t||""===t?null:e(t)},t.toNumber=S,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=A,t.zero=d,t.zoomLinear=function(t,e,n){return j(t,e,n,S,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return j(t,e,n,O(r),C(r))},t.zoomPow=function(t,e,n,r){return j(t,e,n,T(r),T(1/r))},t.zoomSymlog=function(t,e,n,r){return j(t,e,n,D(r),F(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2120:function(t,e,n){var r=n(96);!function(t,e,n,i,a,o,u,s){"use strict";var l,c;function f(t,r,a){var o;return i.isNumber(r)&&(t.bins&&(r=Math.max(r,t.bins.length)),null!=a&&(r=Math.min(r,~~(i.span(t.domain())/a)||1))),i.isObject(r)&&(o=r.step,r=r.interval),i.isString(r)&&(r=t.type===e.Time?n.timeInterval(r):t.type==e.UTC?n.utcInterval(r):i.error("Only time and utc scales accept interval strings."),o&&(r=r.every(o))),r}function h(t,e,n){var r=t.range(),a=Math.floor(r[0]),o=Math.ceil(i.peek(r));if(a>o&&(r=o,o=a,a=r),e=e.filter(function(e){return e=t(e),a<=e&&e<=o}),n>0&&e.length>1){for(var u=[e[0],i.peek(e)];e.length>n&&e.length>=3;)e=e.filter(function(t,e){return!(e%2)});e.length<3&&(e=u)}return e}function d(t,e){return t.bins?h(t,t.bins):t.ticks?t.ticks(e):t.domain()}function p(t,r,i,o,u){var s,l,c=t.type,f=c===e.Time||o===e.Time?n.timeFormat(i):c===e.UTC||o===e.UTC?n.utcFormat(i):t.tickFormat?t.tickFormat(r,i):i?a.format(i):String;if(e.isLogarithmic(c)){var h=function(t){var e,n,r=a.formatSpecifier(t||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return e=a.format(r),n=a.format(".1f")(1)[1],function(t){var r,i,a=e(t),o=a.indexOf(n);if(o<0)return a;for(i=(r=function(t,e){var n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if((n=t.charCodeAt(r))>=48&&n<=57)return r+1}(a,o))<a.length?a.slice(r):"";--r>o;)if("0"!==a[r]){++r;break}return a.slice(0,r)+i}}return a.format(r)}(i);f=u||t.bins?h:(s=f,l=h,function(t){return s(t)?l(t):""})}return f}function v(t){o.Transform.call(this,null,t)}function g(t){o.Transform.call(this,null,t)}function m(){return o.ingest({})}function y(t){return t.exit}function b(t){o.Transform.call(this,null,t)}i.inherits(v,o.Transform).transform=function(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,i=t.scale,a=f(i,null==t.count?t.values?t.values.length:10:t.count,t.minstep),u=t.format||p(i,a,t.formatSpecifier,t.formatType,!!t.values),s=t.values?h(i,t.values,a):d(i,a);return r&&(n.rem=r),r=s.map(function(t,e){return o.ingest({index:e/(s.length-1||1),value:t,label:u(t)})}),t.extra&&r.length&&r.push(o.ingest({index:-1,extra:{value:r[0].value},label:""})),n.source=r,n.add=r,this.value=r,n},i.inherits(g,o.Transform).transform=function(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=t.item||m,u=t.key||o.tupleid,s=this.value;return i.isArray(r.encode)&&(r.encode=null),s&&(t.modified("key")||e.modified(u))&&i.error("DataJoin does not support modified key function or fields."),s||(e=e.addAll(),this.value=s=i.fastmap().test(y),s.lookup=function(t){return s.get(u(t))}),e.visit(e.ADD,function(t){var e=u(t),n=s.get(e);n?n.exit?(s.empty--,r.add.push(n)):r.mod.push(n):(s.set(e,n=a(t)),r.add.push(n)),n.datum=t,n.exit=!1}),e.visit(e.MOD,function(t){var e=u(t),n=s.get(e);n&&(n.datum=t,r.mod.push(n))}),e.visit(e.REM,function(t){var e=u(t),n=s.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++s.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),t.clean&&s.empty>n.cleanThreshold&&n.runAfter(s.clean),r},i.inherits(b,o.Transform).transform=function(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,a=t.encoders,o=e.encode;if(i.isArray(o)){if(!n.changed()&&!o.every(function(t){return a[t]}))return e.StopPropagation;o=o[0],n.encode=null}var u="enter"===o,s=a.update||i.falsy,l=a.enter||i.falsy,c=a.exit||i.falsy,f=(o&&!u?a[o]:s)||i.falsy;if(e.changed(e.ADD)&&(e.visit(e.ADD,function(e){l(e,t),s(e,t)}),n.modifies(l.output),n.modifies(s.output),f!==i.falsy&&f!==s&&(e.visit(e.ADD,function(e){f(e,t)}),n.modifies(f.output))),e.changed(e.REM)&&c!==i.falsy&&(e.visit(e.REM,function(e){c(e,t)}),n.modifies(c.output)),u||f!==i.falsy){var h=e.MOD|(t.modified()?e.REFLOW:0);u?(e.visit(h,function(e){var i=l(e,t)||r;(f(e,t)||i)&&n.mod.push(e)}),n.mod.length&&n.modifies(l.output)):e.visit(h,function(e){(f(e,t)||r)&&n.mod.push(e)}),n.mod.length&&n.modifies(f.output)}return n.changed()?n:e.StopPropagation};var x="symbol",_="discrete",w=(r(l={},e.Quantile,"quantiles"),r(l,e.Quantize,"thresholds"),r(l,e.Threshold,"domain"),l),k=(r(c={},e.Quantile,"quantiles"),r(c,e.Quantize,"domain"),c);function A(t,n){return t.bins?function(t){var e=t.slice(0,-1);return e.max=i.peek(t),e}(t.bins):t.type===e.Log?function(t,e){var n=d(t,e),r=t.base(),i=Math.log(r),a=Math.max(1,r*e/n.length);return n.filter(function(t){var e=t/Math.pow(r,Math.round(Math.log(t)/i));return e*r<r-.5&&(e*=r),e<=a})}(t,n):w[t.type]?function(t){var e=[-1/0].concat(t);return e.max=1/0,e}(t[w[t.type]]()):d(t,n)}function E(t,n,r,i,a,o){var u=k[t.type]&&a!==e.Time&&a!==e.UTC?function(t,n){var r,i=t[k[t.type]](),a=i.length,o=a>1?i[1]-i[0]:i[0];for(r=1;r<a;++r)o=Math.min(o,i[r]-i[r-1]);return e.tickFormat(0,o,30,n)}(t,i):p(t,n,i,a,o);return r===x&&function(t){return w[t.type]||t.bins}(t)?function(t){return function(e,n,r){var i=M(r[n+1],M(r.max,1/0)),a=S(e,t),o=S(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a}}(u):r===_?function(t){return function(e,n){return n?t(e):null}}(u):function(t){return function(e){return t(e)}}(u)}function M(t,e){return null!=t?t:e}function S(t,e){return Number.isFinite(t)?e(t):null}function C(t){o.Transform.call(this,[],t)}i.inherits(C,o.Transform).transform=function(t,n){if(null!=this.value&&!t.modified())return n.StopPropagation;var r,a,u,s,l,c=n.fork(n.NO_SOURCE|n.NO_FIELDS),h=this.value,d=t.type||x,p=t.scale,v=+t.limit,g=f(p,null==t.count?5:t.count,t.minstep),m=!!t.values||d===x,y=t.format||E(p,g,d,t.formatSpecifier,t.formatType,m),b=t.values||A(p,g);return h&&(c.rem=h),d===x?(v&&b.length>v?(n.dataflow.warn("Symbol legend count exceeds limit, filtering items."),h=b.slice(0,v-1),l=!0):h=b,i.isFunction(u=t.size)?(t.values||0!==p(h[0])||(h=h.slice(1)),s=h.reduce(function(e,n){return Math.max(e,u(n,t))},0)):u=i.constant(s=u||8),h=h.map(function(e,n){return o.ingest({index:n,label:y(e,n,h),value:e,offset:s,size:u(e,t)})}),l&&(l=b[h.length],h.push(o.ingest({index:h.length,label:"\u2026".concat(b.length-h.length," entries"),value:l,offset:s,size:u(l,t)})))):"gradient"===d?(r=p.domain(),a=e.scaleFraction(p,r[0],i.peek(r)),b.length<3&&!t.values&&r[0]!==i.peek(r)&&(b=[r[0],i.peek(r)]),h=b.map(function(t,e){return o.ingest({index:e,label:y(t,e,b),value:t,perc:a(t)})})):(u=b.length-1,a=function(t){var n=t.domain(),r=n.length-1,a=+n[0],o=+i.peek(n),u=o-a;if(t.type===e.Threshold){var s=r?u/r:.1;u=(o+=s)-(a-=s)}return function(t){return(t-a)/u}}(p),h=b.map(function(t,e){return o.ingest({index:e,label:y(t,e,b),value:t,perc:e?a(t):0,perc2:e===u?1:a(b[e+1])})})),c.source=h,c.add=h,this.value=h,c};var O=i.fastmap({line:R,"line-radial":function(t,e,n,r){return R(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},arc:P,"arc-radial":function(t,e,n,r){return P(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},curve:z,"curve-radial":function(t,e,n,r){return z(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(t,e,n,r){return"M"+t+","+e+"V"+r+"H"+n},"orthogonal-vertical":function(t,e,n,r){return"M"+t+","+e+"H"+n+"V"+r},"orthogonal-radial":function(t,e,n,r){var i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*i+","+e*a+"A"+e+","+e+" 0 0,"+(s?1:0)+" "+e*o+","+e*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(t,e,n,r){var i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":function(t,e,n,r){var i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":function(t,e,n,r){var i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=(e+r)/2;return"M"+e*i+","+e*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u}});function D(t){return t.source.x}function F(t){return t.source.y}function T(t){return t.target.x}function N(t){return t.target.y}function j(t){o.Transform.call(this,{},t)}function R(t,e,n,r){return"M"+t+","+e+"L"+n+","+r}function P(t,e,n,r){var i=n-t,a=r-e,o=Math.sqrt(i*i+a*a)/2;return"M"+t+","+e+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+n+","+r}function z(t,e,n,r){var i=n-t,a=r-e,o=.2*(i+a),u=.2*(a-i);return"M"+t+","+e+"C"+(t+o)+","+(e+u)+" "+(n+u)+","+(r-o)+" "+n+","+r}function B(t){o.Transform.call(this,null,t)}j.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},i.inherits(j,o.Transform).transform=function(t,e){var n=t.sourceX||D,r=t.sourceY||F,a=t.targetX||T,o=t.targetY||N,u=t.as||"path",s=t.orient||"vertical",l=t.shape||"line",c=O.get(l+"-"+s)||O.get(l);return c||i.error("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,function(t){t[u]=c(n(t),r(t),a(t),o(t))}),e.reflow(t.modified()).modifies(u)},B.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},i.inherits(B,o.Transform).transform=function(t,e){var n,r,a,o=t.as||["startAngle","endAngle"],s=o[0],l=o[1],c=t.field||i.one,f=t.startAngle||0,h=null!=t.endAngle?t.endAngle:2*Math.PI,d=e.source,p=d.map(c),v=p.length,g=f,m=(h-f)/u.sum(p),y=u.range(v);for(t.sort&&y.sort(function(t,e){return p[t]-p[e]}),n=0;n<v;++n)a=p[y[n]],(r=d[y[n]])[s]=g,r[l]=g+=a*m;return this.value=p,e.reflow(t.modified()).modifies(o)};var L=5;function q(t){return e.isContinuous(t)&&t!==e.Sequential}var I=i.toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function U(t){o.Transform.call(this,null,t),this.modified(!0)}function W(t){var n,r=t.type,a="";return r===e.Sequential?e.Sequential+"-"+e.Linear:(function(t){var n=t.type;return e.isContinuous(n)&&n!==e.Time&&n!==e.UTC&&(t.scheme||t.range&&t.range.length&&t.range.every(i.isString))}(t)&&(a=2===(n=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?e.Sequential+"-":3===n?e.Diverging+"-":""),(a+r||e.Linear).toLowerCase())}function H(t,n,r){var a=function(t,e,n){return e?(t.domain(V(t.type,e,n)),e.length):-1}(t,n.domainRaw,r);if(a>-1)return a;var o,u,s=n.domain,l=t.type,c=n.zero||void 0===n.zero&&function(t){var n=t.type;return!t.bins&&(n===e.Linear||n===e.Pow||n===e.Sqrt)}(t);return s?(q(l)&&n.padding&&s[0]!==i.peek(s)&&(s=function(t,n,r,a,o,u){var s=Math.abs(i.peek(r)-r[0]),l=s/(s-2*a),c=t===e.Log?i.zoomLog(n,null,l):t===e.Sqrt?i.zoomPow(n,null,l,.5):t===e.Pow?i.zoomPow(n,null,l,o||1):t===e.Symlog?i.zoomSymlog(n,null,l,u||1):i.zoomLinear(n,null,l);return(n=n.slice())[0]=c[0],n[n.length-1]=c[1],n}(l,s,n.range,n.padding,n.exponent,n.constant)),(c||null!=n.domainMin||null!=n.domainMax||null!=n.domainMid)&&(o=(s=s.slice()).length-1||1,c&&(s[0]>0&&(s[0]=0),s[o]<0&&(s[o]=0)),null!=n.domainMin&&(s[0]=n.domainMin),null!=n.domainMax&&(s[o]=n.domainMax),null!=n.domainMid&&(((u=n.domainMid)<s[0]||u>s[o])&&r.warn("Scale domainMid exceeds domain min or max.",u),s.splice(o,0,u))),t.domain(V(l,s,r)),l===e.Ordinal&&t.unknown(n.domainImplicit?e.scaleImplicit:void 0),n.nice&&t.nice&&t.nice(!0!==n.nice&&f(t,n.nice)||null),s.length):0}function V(t,n,r){return e.isLogarithmic(t)&&Math.abs(n.reduce(function(t,e){return t+(e<0?-1:e>0?1:0)},0))!==n.length&&r.warn("Log scale domain includes zero: "+i.stringValue(n)),n}function G(t,n,r){var a=t.type,o=n.round||!1,u=n.range;if(null!=n.rangeStep)u=function(t,n,r){t!==e.Band&&t!==e.Point&&i.error("Only band and point scales support rangeStep.");var a=(null!=n.paddingOuter?n.paddingOuter:n.padding)||0,o=t===e.Point?1:(null!=n.paddingInner?n.paddingInner:n.padding)||0;return[0,n.rangeStep*e.bandSpace(r,o,a)]}(a,n,r);else if(n.scheme&&(u=function(t,n,r){var a,o,u=n.schemeExtent;return i.isArray(n.scheme)?o=e.interpolateColors(n.scheme,n.interpolate,n.interpolateGamma):(a=n.scheme.toLowerCase(),(o=e.scheme(a))||i.error("Unrecognized scheme name: ".concat(n.scheme))),r=t===e.Threshold?r+1:t===e.BinOrdinal?r-1:t===e.Quantile||t===e.Quantize?+n.schemeCount||L:r,e.isInterpolating(t)?$(o,u,n.reverse):i.isFunction(o)?e.quantizeInterpolator($(o,u),r):t===e.Ordinal?o:o.slice(0,r)}(a,n,r),i.isFunction(u))){if(t.interpolator)return t.interpolator(u);i.error("Scale type ".concat(a," does not support interpolating color schemes."))}if(u&&e.isInterpolating(a))return t.interpolator(e.interpolateColors(Y(u,n.reverse),n.interpolate,n.interpolateGamma));u&&n.interpolate&&t.interpolate?t.interpolate(e.interpolate(n.interpolate,n.interpolateGamma)):i.isFunction(t.round)?t.round(o):i.isFunction(t.rangeRound)&&t.interpolate(o?s.interpolateRound:s.interpolate),u&&t.range(Y(u,n.reverse))}function $(t,n,r){return i.isFunction(t)&&(n||r)?e.interpolateRange(t,Y(n||[0,1],r)):t}function Y(t,e){return e?t.slice().reverse():t}function X(t){o.Transform.call(this,null,t)}i.inherits(U,o.Transform).transform=function(t,n){var r=n.dataflow,a=this.value,o=W(t);for(o in a&&o===a.type||(this.value=a=e.scale(o)()),t)if(!I[o]){if("padding"===o&&q(a.type))continue;i.isFunction(a[o])?a[o](t[o]):r.warn("Unsupported scale property: "+o)}return G(a,t,function(t,n,r){var a=n.bins;if(a&&!i.isArray(a)){var o=t.domain(),s=o[0],l=i.peek(o),c=null==a.start?s:a.start,f=null==a.stop?l:a.stop,h=a.step;h||i.error("Scale bins parameter missing step property."),c<s&&(c=h*Math.ceil(s/h)),f>l&&(f=h*Math.floor(l/h)),a=u.range(c,f+h/2,h)}return a?t.bins=a:t.bins&&delete t.bins,t.type===e.BinOrdinal&&(a?n.domain||n.domainRaw||(t.domain(a),r=a.length):t.bins=t.domain()),r}(a,t,H(a,t,r))),n.fork(n.NO_SOURCE|n.NO_FIELDS)},i.inherits(X,o.Transform).transform=function(t,e){var n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(o.stableCompare(t.sort)),this.modified(n),e};var J=["y0","y1"];function Q(t){o.Transform.call(this,null,t)}function Z(t,e,n,r,i){for(var a,o=(e-t.sum)/2,u=t.length,s=0;s<u;++s)(a=t[s])[r]=o,a[i]=o+=Math.abs(n(a))}function K(t,e,n,r,i){for(var a,o=1/t.sum,u=0,s=t.length,l=0,c=0;l<s;++l)(a=t[l])[r]=u,a[i]=u=o*(c+=Math.abs(n(a)))}function tt(t,e,n,r,i){for(var a,o,u=0,s=0,l=t.length,c=0;c<l;++c)(a=+n(o=t[c]))<0?(o[r]=s,o[i]=s+=a):(o[r]=u,o[i]=u+=a)}Q.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:J}]},i.inherits(Q,o.Transform).transform=function(t,e){var n,r,a,u,s=t.as||J,l=s[0],c=s[1],f=o.stableCompare(t.sort),h=t.field||i.one,d="center"===t.offset?Z:"normalize"===t.offset?K:tt;for(n=function(t,e,n,r){var i,a,o,u,s,l,c,f,h,d=[],p=function(t){return t(s)};if(null==e)d.push(t.slice());else for(i={},a=0,o=t.length;a<o;++a)s=t[a],(c=i[l=e.map(p)])||(i[l]=c=[],d.push(c)),c.push(s);for(l=0,h=0,u=d.length;l<u;++l){for(a=0,f=0,o=(c=d[l]).length;a<o;++a)f+=Math.abs(r(c[a]));c.sum=f,f>h&&(h=f),n&&c.sort(n)}return d.max=h,d}(e.source,t.groupby,f,h),r=0,a=n.length,u=n.max;r<a;++r)d(n[r],u,h,l,c);return e.reflow(t.modified()).modifies(s)},t.axisticks=v,t.datajoin=g,t.encode=b,t.legendentries=C,t.linkpath=j,t.pie=B,t.scale=U,t.sortitems=X,t.stack=Q,t.validTicks=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1172),n(1223),n(1040),n(1169),n(1045),n(1053),n(1079))},2121:function(t,e,n){var r=n(212);!function(t,e,n,i,a,o){"use strict";function u(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function s(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}var l=Symbol("implicit");function c(){var t=new Map,e=[],n=[],r=l;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==l)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;var r=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=u.value,c=l+"";t.has(c)||t.set(c,e.push(l))}}catch(f){a=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return c(e,n).unknown(r)},u.apply(i,arguments),i}function f(){var t,n,i=c().unknown(void 0),a=i.domain,o=i.range,s=0,l=1,h=!1,d=0,p=0,v=.5;function g(){var r=a().length,i=l<s,u=i?l:s,c=i?s:l;t=(c-u)/Math.max(1,r-d+2*p),h&&(t=Math.floor(t)),u+=(c-u-t*(r-d))*v,n=t*(1-d),h&&(u=Math.round(u),n=Math.round(n));var f=e.range(r).map(function(e){return u+t*e});return o(i?f.reverse():f)}return delete i.unknown,i.domain=function(t){return arguments.length?(a(t),g()):a()},i.range=function(t){var e;return arguments.length?(e=r(t,2),s=e[0],l=e[1],s=+s,l=+l,g()):[s,l]},i.rangeRound=function(t){var e;return e=r(t,2),s=e[0],l=e[1],s=+s,l=+l,h=!0,g()},i.bandwidth=function(){return n},i.step=function(){return t},i.round=function(t){return arguments.length?(h=!!t,g()):h},i.padding=function(t){return arguments.length?(d=Math.min(1,p=+t),g()):d},i.paddingInner=function(t){return arguments.length?(d=Math.min(1,t),g()):d},i.paddingOuter=function(t){return arguments.length?(p=+t,g()):p},i.align=function(t){return arguments.length?(v=Math.max(0,Math.min(1,t)),g()):v},i.copy=function(){return f(a(),[s,l]).round(h).paddingInner(d).paddingOuter(p).align(v)},u.apply(g(),arguments)}function h(t){return+t}var d=[0,1];function p(t){return t}function v(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function g(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=v(i,r),a=n(o,a)):(r=v(r,i),a=n(a,o)),function(t){return a(r(t))}}function m(t,n,r){var i=Math.min(t.length,n.length)-1,a=new Array(i),o=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++u<i;)a[u]=v(t[u],t[u+1]),o[u]=r(n[u],n[u+1]);return function(n){var r=e.bisect(t,n,1,i)-1;return o[r](a[r](n))}}function y(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function b(){var t,e,r,i,a,o,u=d,s=d,l=n.interpolate,c=p;function f(){var t=Math.min(u.length,s.length);return c!==p&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(u[0],u[t-1])),i=t>2?m:g,a=o=null,v}function v(e){return isNaN(e=+e)?r:(a||(a=i(u.map(t),s,l)))(t(c(e)))}return v.invert=function(r){return c(e((o||(o=i(s,u.map(t),n.interpolateNumber)))(r)))},v.domain=function(t){return arguments.length?(u=Array.from(t,h),f()):u.slice()},v.range=function(t){return arguments.length?(s=Array.from(t),f()):s.slice()},v.rangeRound=function(t){return s=Array.from(t),l=n.interpolateRound,f()},v.clamp=function(t){return arguments.length?(c=!!t||p,f()):c!==p},v.interpolate=function(t){return arguments.length?(l=t,f()):l},v.unknown=function(t){return arguments.length?(r=t,v):r},function(n,r){return t=n,e=r,f()}}function x(){return b()(p,p)}function _(t,n,r,a){var o,u=e.tickStep(t,n,r);switch((a=i.formatSpecifier(null==a?",f":a)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(n));return null!=a.precision||isNaN(o=i.precisionPrefix(u,s))||(a.precision=o),i.formatPrefix(a,s);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(o=i.precisionRound(u,Math.max(Math.abs(t),Math.abs(n))))||(a.precision=o-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(o=i.precisionFixed(u))||(a.precision=o-2*("%"===a.type))}return i.format(a)}function w(t){var n=t.domain;return t.ticks=function(t){var r=n();return e.ticks(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return _(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(r){null==r&&(r=10);var i,a=n(),o=0,u=a.length-1,s=a[o],l=a[u];return l<s&&(i=s,s=l,l=i,i=o,o=u,u=i),(i=e.tickIncrement(s,l,r))>0?(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,i=e.tickIncrement(s,l,r)):i<0&&(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,i=e.tickIncrement(s,l,r)),i>0?(a[o]=Math.floor(s/i)*i,a[u]=Math.ceil(l/i)*i,n(a)):i<0&&(a[o]=Math.ceil(s*i)/i,a[u]=Math.floor(l*i)/i,n(a)),t},t}function k(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function A(t){return Math.log(t)}function E(t){return Math.exp(t)}function M(t){return-Math.log(-t)}function S(t){return-Math.exp(-t)}function C(t){return isFinite(t)?+("1e"+t):t<0?0:t}function O(t){return function(e){return-t(-e)}}function D(t){var n,r,a=t(A,E),o=a.domain,u=10;function s(){return n=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(u),r=function(t){return 10===t?C:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(u),o()[0]<0?(n=O(n),r=O(r),t(M,S)):t(A,E),a}return a.base=function(t){return arguments.length?(u=+t,s()):u},a.domain=function(t){return arguments.length?(o(t),s()):o()},a.ticks=function(t){var i,a=o(),s=a[0],l=a[a.length-1];(i=l<s)&&(d=s,s=l,l=d);var c,f,h,d=n(s),p=n(l),v=null==t?10:+t,g=[];if(!(u%1)&&p-d<v){if(d=Math.floor(d),p=Math.ceil(p),s>0){for(;d<=p;++d)for(f=1,c=r(d);f<u;++f)if(!((h=c*f)<s)){if(h>l)break;g.push(h)}}else for(;d<=p;++d)for(f=u-1,c=r(d);f>=1;--f)if(!((h=c*f)<s)){if(h>l)break;g.push(h)}2*g.length<v&&(g=e.ticks(s,l,v))}else g=e.ticks(d,p,Math.min(p-d,v)).map(r);return i?g.reverse():g},a.tickFormat=function(t,e){if(null==e&&(e=10===u?".0e":","),"function"!==typeof e&&(e=i.format(e)),t===1/0)return e;null==t&&(t=10);var o=Math.max(1,u*t/a.ticks().length);return function(t){var i=t/r(Math.round(n(t)));return i*u<u-.5&&(i*=u),i<=o?e(t):""}},a.nice=function(){return o(k(o(),{floor:function(t){return r(Math.floor(n(t)))},ceil:function(t){return r(Math.ceil(n(t)))}}))},a}function F(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function T(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function N(t){var e=1,n=t(F(e),T(e));return n.constant=function(n){return arguments.length?t(F(e=+n),T(e)):e},w(n)}function j(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function R(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function P(t){return t<0?-t*t:t*t}function z(t){var e=t(p,p),n=1;function r(){return 1===n?t(p,p):.5===n?t(R,P):t(j(n),j(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},w(e)}function B(){var t=z(b());return t.copy=function(){return y(t,B()).exponent(t.exponent())},u.apply(t,arguments),t}function L(t){return Math.sign(t)*t*t}var q=1e3,I=60*q,U=60*I,W=24*U,H=7*W,V=30*W,G=365*W;function $(t){return new Date(t)}function Y(t){return t instanceof Date?+t:+new Date(+t)}function X(t,n,r,i,a,o,u,s,l){var c=x(),f=c.invert,h=c.domain,d=l(".%L"),p=l(":%S"),v=l("%I:%M"),g=l("%I %p"),m=l("%a %d"),b=l("%b %d"),_=l("%B"),w=l("%Y"),A=[[u,1,q],[u,5,5*q],[u,15,15*q],[u,30,30*q],[o,1,I],[o,5,5*I],[o,15,15*I],[o,30,30*I],[a,1,U],[a,3,3*U],[a,6,6*U],[a,12,12*U],[i,1,W],[i,2,2*W],[r,1,H],[n,1,V],[n,3,3*V],[t,1,G]];function E(e){return(u(e)<e?d:o(e)<e?p:a(e)<e?v:i(e)<e?g:n(e)<e?r(e)<e?m:b:t(e)<e?_:w)(e)}function M(n,r,i){if(null==n&&(n=10),"number"===typeof n){var a,o=Math.abs(i-r)/n,u=e.bisector(function(t){return t[2]}).right(A,o);return u===A.length?(a=e.tickStep(r/G,i/G,n),n=t):u?(a=(u=A[o/A[u-1][2]<A[u][2]/o?u-1:u])[1],n=u[0]):(a=Math.max(e.tickStep(r,i,n),1),n=s),n.every(a)}return n}return c.invert=function(t){return new Date(f(t))},c.domain=function(t){return arguments.length?h(Array.from(t,Y)):h().map($)},c.ticks=function(t){var e,n=h(),r=n[0],i=n[n.length-1],a=i<r;return a&&(e=r,r=i,i=e),e=(e=M(t,r,i))?e.range(r,i+1):[],a?e.reverse():e},c.tickFormat=function(t,e){return null==e?E:l(e)},c.nice=function(t){var e=h();return(t=M(t,e[0],e[e.length-1]))?h(k(e,t)):c},c.copy=function(){return y(c,X(t,n,r,i,a,o,u,s,l))},c}function J(){var t,e,i,a,o,u=0,s=1,l=p,c=!1;function f(e){return isNaN(e=+e)?o:l(0===i?.5:(e=(a(e)-t)*i,c?Math.max(0,Math.min(1,e)):e))}function h(t){return function(e){var n,i,a;return arguments.length?(i=(n=r(e,2))[0],a=n[1],l=t(i,a),f):[l(0),l(1)]}}return f.domain=function(n){var o;return arguments.length?(o=r(n,2),u=o[0],s=o[1],t=a(u=+u),e=a(s=+s),i=t===e?0:1/(e-t),f):[u,s]},f.clamp=function(t){return arguments.length?(c=!!t,f):c},f.interpolator=function(t){return arguments.length?(l=t,f):l},f.range=h(n.interpolate),f.rangeRound=h(n.interpolateRound),f.unknown=function(t){return arguments.length?(o=t,f):o},function(n){return a=n,t=n(u),e=n(s),i=t===e?0:1/(e-t),f}}function Q(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Z(){var t=z(J());return t.copy=function(){return Q(t,Z()).exponent(t.exponent())},s.apply(t,arguments)}function K(){var t,e,i,a,o,u,s,l=0,c=.5,f=1,h=1,d=p,v=!1;function g(t){return isNaN(t=+t)?s:(t=.5+((t=+u(t))-e)*(h*t<h*e?a:o),d(v?Math.max(0,Math.min(1,t)):t))}function m(t){return function(e){var i,a,o,u;return arguments.length?(a=(i=r(e,3))[0],o=i[1],u=i[2],d=n.piecewise(t,[a,o,u]),g):[d(0),d(.5),d(1)]}}return g.domain=function(n){var s;return arguments.length?(s=r(n,3),l=s[0],c=s[1],f=s[2],t=u(l=+l),e=u(c=+c),i=u(f=+f),a=t===e?0:.5/(e-t),o=e===i?0:.5/(i-e),h=e<t?-1:1,g):[l,c,f]},g.clamp=function(t){return arguments.length?(v=!!t,g):v},g.interpolator=function(t){return arguments.length?(d=t,g):d},g.range=m(n.interpolate),g.rangeRound=m(n.interpolateRound),g.unknown=function(t){return arguments.length?(s=t,g):s},function(n){return u=n,t=n(l),e=n(c),i=n(f),a=t===e?0:.5/(e-t),o=e===i?0:.5/(i-e),h=e<t?-1:1,g}}function tt(){var t=z(K());return t.copy=function(){return Q(t,tt()).exponent(t.exponent())},s.apply(t,arguments)}t.scaleBand=f,t.scaleDiverging=function t(){var e=w(K()(p));return e.copy=function(){return Q(e,t())},s.apply(e,arguments)},t.scaleDivergingLog=function t(){var e=D(K()).domain([.1,1,10]);return e.copy=function(){return Q(e,t()).base(e.base())},s.apply(e,arguments)},t.scaleDivergingPow=tt,t.scaleDivergingSqrt=function(){return tt.apply(null,arguments).exponent(.5)},t.scaleDivergingSymlog=function t(){var e=N(K());return e.copy=function(){return Q(e,t()).constant(e.constant())},s.apply(e,arguments)},t.scaleIdentity=function t(e){var n;function r(t){return isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,h),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,h):[0,1],w(r)},t.scaleImplicit=l,t.scaleLinear=function t(){var e=x();return e.copy=function(){return y(e,t())},u.apply(e,arguments),w(e)},t.scaleLog=function t(){var e=D(b()).domain([1,10]);return e.copy=function(){return y(e,t()).base(e.base())},u.apply(e,arguments),e},t.scaleOrdinal=c,t.scalePoint=function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(f.apply(null,arguments).paddingInner(1))},t.scalePow=B,t.scaleQuantile=function t(){var n,r=[],i=[],a=[];function o(){var t=0,n=Math.max(1,i.length);for(a=new Array(n-1);++t<n;)a[t-1]=e.quantile(r,t/n);return s}function s(t){return isNaN(t=+t)?n:i[e.bisect(a,t)]}return s.invertExtent=function(t){var e=i.indexOf(t);return e<0?[NaN,NaN]:[e>0?a[e-1]:r[0],e<a.length?a[e]:r[r.length-1]]},s.domain=function(t){if(!arguments.length)return r.slice();r=[];var n=!0,i=!1,a=void 0;try{for(var u,s=t[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value;null==l||isNaN(l=+l)||r.push(l)}}catch(c){i=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r.sort(e.ascending),o()},s.range=function(t){return arguments.length?(i=Array.from(t),o()):i.slice()},s.unknown=function(t){return arguments.length?(n=t,s):n},s.quantiles=function(){return a.slice()},s.copy=function(){return t().domain(r).range(i).unknown(n)},u.apply(s,arguments)},t.scaleQuantize=function t(){var n,i=0,a=1,o=1,s=[.5],l=[0,1];function c(t){return t<=t?l[e.bisect(s,t,0,o)]:n}function f(){var t=-1;for(s=new Array(o);++t<o;)s[t]=((t+1)*a-(t-o)*i)/(o+1);return c}return c.domain=function(t){var e;return arguments.length?(e=r(t,2),i=e[0],a=e[1],i=+i,a=+a,f()):[i,a]},c.range=function(t){return arguments.length?(o=(l=Array.from(t)).length-1,f()):l.slice()},c.invertExtent=function(t){var e=l.indexOf(t);return e<0?[NaN,NaN]:e<1?[i,s[0]]:e>=o?[s[o-1],a]:[s[e-1],s[e]]},c.unknown=function(t){return arguments.length?(n=t,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return t().domain([i,a]).range(l).unknown(n)},u.apply(w(c),arguments)},t.scaleRadial=function t(){var e,n=x(),r=[0,1],i=!1;function a(t){var r=function(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}(n(t));return isNaN(r)?e:i?Math.round(r):r}return a.invert=function(t){return n.invert(L(t))},a.domain=function(t){return arguments.length?(n.domain(t),a):n.domain()},a.range=function(t){return arguments.length?(n.range((r=Array.from(t,h)).map(L)),a):r.slice()},a.rangeRound=function(t){return a.range(t).round(!0)},a.round=function(t){return arguments.length?(i=!!t,a):i},a.clamp=function(t){return arguments.length?(n.clamp(t),a):n.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t(n.domain(),r).round(i).clamp(n.clamp()).unknown(e)},u.apply(a,arguments),w(a)},t.scaleSequential=function t(){var e=w(J()(p));return e.copy=function(){return Q(e,t())},s.apply(e,arguments)},t.scaleSequentialLog=function t(){var e=D(J()).domain([1,10]);return e.copy=function(){return Q(e,t()).base(e.base())},s.apply(e,arguments)},t.scaleSequentialPow=Z,t.scaleSequentialQuantile=function t(){var n=[],r=p;function i(t){if(!isNaN(t=+t))return r((e.bisect(n,t,1)-1)/(n.length-1))}return i.domain=function(t){if(!arguments.length)return n.slice();n=[];var r=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=u.value;null==l||isNaN(l=+l)||n.push(l)}}catch(c){a=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n.sort(e.ascending),i},i.interpolator=function(t){return arguments.length?(r=t,i):r},i.range=function(){return n.map(function(t,e){return r(e/(n.length-1))})},i.quantiles=function(t){return Array.from({length:t+1},function(r,i){return e.quantile(n,i/t)})},i.copy=function(){return t(r).domain(n)},s.apply(i,arguments)},t.scaleSequentialSqrt=function(){return Z.apply(null,arguments).exponent(.5)},t.scaleSequentialSymlog=function t(){var e=N(J());return e.copy=function(){return Q(e,t()).constant(e.constant())},s.apply(e,arguments)},t.scaleSqrt=function(){return B.apply(null,arguments).exponent(.5)},t.scaleSymlog=function t(){var e=N(b());return e.copy=function(){return y(e,t()).constant(e.constant())},u.apply(e,arguments)},t.scaleThreshold=function t(){var n,r=[.5],i=[0,1],a=1;function o(t){return t<=t?i[e.bisect(r,t,0,a)]:n}return o.domain=function(t){return arguments.length?(r=Array.from(t),a=Math.min(r.length,i.length-1),o):r.slice()},o.range=function(t){return arguments.length?(i=Array.from(t),a=Math.min(r.length,i.length-1),o):i.slice()},o.invertExtent=function(t){var e=i.indexOf(t);return[r[e-1],r[e]]},o.unknown=function(t){return arguments.length?(n=t,o):n},o.copy=function(){return t().domain(r).range(i).unknown(n)},u.apply(o,arguments)},t.scaleTime=function(){return u.apply(X(a.timeYear,a.timeMonth,a.timeWeek,a.timeDay,a.timeHour,a.timeMinute,a.timeSecond,a.timeMillisecond,o.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},t.scaleUtc=function(){return u.apply(X(a.utcYear,a.utcMonth,a.utcWeek,a.utcDay,a.utcHour,a.utcMinute,a.utcSecond,a.utcMillisecond,o.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},t.tickFormat=_,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053),n(1079),n(1169),n(1170),n(1091))},2122:function(t,e,n){var r=n(96);!function(t,e,n,i,a,o,u,s,l){"use strict";function c(){}var f=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function h(){var t=1,e=1,r=u;function i(t,e){return e.map(function(e){return a(t,e)})}function a(n,i){var a=[],u=[];return function(n,r,i){var a,u,s,l,c,h,d=new Array,p=new Array;for(a=u=-1,l=n[0]>=r,f[l<<1].forEach(v);++a<t-1;)s=l,l=n[a+1]>=r,f[s|l<<1].forEach(v);for(f[l<<0].forEach(v);++u<e-1;){for(a=-1,l=n[u*t+t]>=r,c=n[u*t]>=r,f[l<<1|c<<2].forEach(v);++a<t-1;)s=l,l=n[u*t+t+a+1]>=r,h=c,c=n[u*t+a+1]>=r,f[s|l<<1|c<<2|h<<3].forEach(v);f[l|c<<3].forEach(v)}for(a=-1,c=n[u*t]>=r,f[c<<2].forEach(v);++a<t-1;)h=c,c=n[u*t+a+1]>=r,f[c<<2|h<<3].forEach(v);function v(t){var e,n,r=[t[0][0]+a,t[0][1]+u],s=[t[1][0]+a,t[1][1]+u],l=o(r),c=o(s);(e=p[l])?(n=d[c])?(delete p[e.end],delete d[n.start],e===n?(e.ring.push(s),i(e.ring)):d[e.start]=p[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete p[e.end],e.ring.push(s),p[e.end=c]=e):(e=d[c])?(n=p[l])?(delete d[e.start],delete p[n.end],e===n?(e.ring.push(s),i(e.ring)):d[n.start]=p[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=l]=e):d[l]=p[c]={start:l,end:c,ring:[r,s]}}f[c<<3].forEach(v)}(n,i,function(t){r(t,n,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):u.push(t)}),u.forEach(function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==d((e=a[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function u(n,r,i){n.forEach(function(n){var a,o=n[0],u=n[1],s=0|o,l=0|u,c=r[l*t+s];o>0&&o<t&&s===o&&(a=r[l*t+s-1],n[0]=o+(i-a)/(c-a)-.5),u>0&&u<e&&l===u&&(a=r[(l-1)*t+s],n[1]=u+(i-a)/(c-a)-.5)})}return i.contour=a,i.size=function(r){if(!arguments.length)return[t,e];var a=Math.ceil(r[0]),o=Math.ceil(r[1]);return a>0&&o>0||n.error("invalid size"),t=a,e=o,i},i.smooth=function(t){return arguments.length?(r=t?u:c,i):r===u},i}function d(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=p(t,e[r]))return n;return 0}function p(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],c=s[1],f=t[u],h=f[0],d=f[1];if(v(s,f,e))return 0;c>r!==d>r&&n<(h-l)*(r-c)/(d-c)+l&&(i=-i)}return i}function v(t,e,n){var r,i,a,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=n[r],o=e[r],i<=a&&a<=o||o<=a&&a<=i)}function g(t,e,r){return function(a){var o=n.extent(a),u=r?Math.min(o[0],0):o[0],s=o[1],l=s-u,c=e?i.tickStep(u,s,t):l/(t+1);return i.range(c,s,c)}}function m(t){e.Transform.call(this,null,t)}function y(t,e,n,r,i){var a=t.x1||0,o=t.y1||0,u=e*n<0;function s(t){t.forEach(l)}function l(t){u&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-a)*e+r,t[1]=(t[1]-o)*n+i}return function(t){return t.coordinates.forEach(s),t}}function b(t,e,n){var r=t>=0?t:a.bandwidthNRD(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function x(t){return n.isFunction(t)?t:n.constant(+t)}function _(){var t=function(t){return t[0]},e=function(t){return t[1]},r=n.one,a=[-1,-1],o=960,u=500,s=2;function l(n,l){var c=b(a[0],n,t)>>s,f=b(a[1],n,e)>>s,h=c?c+2:0,d=f?f+2:0,p=2*h+(o>>s),v=2*d+(u>>s),g=new Float32Array(p*v),m=new Float32Array(p*v),y=g;n.forEach(function(n){var i=h+(+t(n)>>s),a=d+(+e(n)>>s);i>=0&&i<p&&a>=0&&a<v&&(g[i+a*p]+=+r(n))}),c>0&&f>0?(w(p,v,g,m,c),k(p,v,m,g,f),w(p,v,g,m,c),k(p,v,m,g,f),w(p,v,g,m,c),k(p,v,m,g,f)):c>0?(w(p,v,g,m,c),w(p,v,m,g,c),w(p,v,g,m,c),y=m):f>0&&(k(p,v,g,m,f),k(p,v,m,g,f),k(p,v,g,m,f),y=m);for(var x=l?Math.pow(2,-2*s):1/i.sum(y),_=0,A=p*v;_<A;++_)y[_]*=x;return{values:y,scale:1<<s,width:p,height:v,x1:h,y1:d,x2:h+(o>>s),y2:d+(u>>s)}}return l.x=function(e){return arguments.length?(t=x(e),l):t},l.y=function(t){return arguments.length?(e=x(t),l):e},l.weight=function(t){return arguments.length?(r=x(t),l):r},l.size=function(t){if(!arguments.length)return[o,u];var e=Math.ceil(t[0]),r=Math.ceil(t[1]);return e>=0||e>=0||n.error("invalid size"),o=e,u=r,l},l.cellSize=function(t){return arguments.length?((t=+t)>=1||n.error("invalid cell size"),s=Math.floor(Math.log(t)/Math.LN2),l):1<<s},l.bandwidth=function(t){return arguments.length?(1===(t=n.array(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&n.error("invalid bandwidth"),a=t,l):a},l}function w(t,e,n,r,i){for(var a=1+(i<<1),o=0;o<e;++o)for(var u=0,s=0;u<t+i;++u)u<t&&(s+=n[u+o*t]),u>=i&&(u>=a&&(s-=n[u-a+o*t]),r[u-i+o*t]=s/Math.min(u+1,t-1+a-u,a))}function k(t,e,n,r,i){for(var a=1+(i<<1),o=0;o<t;++o)for(var u=0,s=0;u<e+i;++u)u<e&&(s+=n[o+u*t]),u>=i&&(u>=a&&(s-=n[o+(u-a)*t]),r[o+(u-i)*t]=s/Math.min(u+1,e-1+a-u,a))}function A(t){e.Transform.call(this,null,t)}m.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},n.inherits(m,e.Transform).transform=function(t,a){if(this.value&&!a.changed()&&!t.modified())return a.StopPropagation;var o=a.fork(a.NO_SOURCE|a.NO_FIELDS),u=a.materialize(a.SOURCE).source,s=t.field||n.identity,l=h().smooth(!1!==t.smooth),c=t.thresholds||function(t,e,n){var r=g(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map(function(t){return i.max(e(t).values)}))}(u,s,t),f=null===t.as?null:t.as||"contour",d=[];return u.forEach(function(i){var a=s(i),o=l.size([a.width,a.height])(a.values,n.isArray(c)?c:c(a.values));!function(t,e,r,i){var a=i.scale||e.scale,o=i.translate||e.translate;if(n.isFunction(a)&&(a=a(r,i)),n.isFunction(o)&&(o=o(r,i)),1!==a&&null!=a||o){var u=(n.isNumber(a)?a:a[0])||1,s=(n.isNumber(a)?a:a[1])||1,l=o&&o[0]||0,c=o&&o[1]||0;t.forEach(y(e,u,s,l,c))}}(o,a,i,t),o.forEach(function(t){d.push(e.rederive(i,e.ingest(null!=f?r({},f,t):t)))})}),this.value&&(o.rem=this.value),this.value=o.source=o.add=d,o},A.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var E=n.inherits(A,e.Transform),M=["x","y","weight","size","cellSize","bandwidth"];function S(t,e){return M.forEach(function(n){return null!=e[n]?t[n](e[n]):0}),t}function C(t){e.Transform.call(this,null,t)}E.transform=function(t,i){if(this.value&&!i.changed()&&!t.modified())return i.StopPropagation;var a,o=i.fork(i.NO_SOURCE|i.NO_FIELDS),u=function(t,e){var n,r,i,a,o,u,s=[],l=function(t){return t(a)};if(null==e)s.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(u=n[o=e.map(l)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(a);return s}(i.materialize(i.SOURCE).source,t.groupby),s=(t.groupby||[]).map(n.accessorName),l=S(_(),t),c=t.as||"grid";return a=u.map(function(n){return e.ingest(function(t,e){for(var n=0;n<s.length;++n)t[s[n]]=e[n];return t}(r({},c,l(n,t.counts)),n.dims))}),this.value&&(o.rem=this.value),this.value=o.source=o.add=a,o},C.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},n.inherits(C,e.Transform).transform=function(t,r){if(this.value&&!r.changed()&&!t.modified())return r.StopPropagation;var i,a,o=r.fork(r.NO_SOURCE|r.NO_FIELDS),u=h().smooth(!1!==t.smooth),s=t.values,l=t.thresholds||g(t.count||10,t.nice,!!s),c=t.size;return s||(s=r.materialize(r.SOURCE).source,a=y(i=S(_(),t)(s,!0),i.scale||1,i.scale||1,0,0),c=[i.width,i.height],s=i.values),l=n.isArray(l)?l:l(s),s=u.size(c)(s,l),a&&s.forEach(a),this.value&&(o.rem=this.value),this.value=o.source=o.add=(s||[]).map(e.ingest),o};var O="Feature",D="FeatureCollection";function F(t){e.Transform.call(this,null,t)}function T(t){e.Transform.call(this,null,t)}function N(t){e.Transform.call(this,null,t)}function j(t){e.Transform.call(this,null,t)}function R(t){e.Transform.call(this,[],t),this.generator=u.geoGraticule()}function P(t){e.Transform.call(this,null,t)}function z(t){if(!n.isFunction(t))return!1;var e=n.toSet(n.accessorFields(t));return e.$x||e.$y||e.$value||e.$max}function B(t){e.Transform.call(this,null,t),this.modified(!0)}function L(t,e){var r=function(t){return 1===(t=n.array(t)).length?t[0]:{type:D,features:t.reduce(function(t,e){return t.concat(function(t){return t.type===D?t.features:n.array(t).filter(function(t){return null!=t}).map(function(t){return t.type===O?t:{type:O,geometry:t}})}(e))},[])}}(e.fit);e.extent?t.fitExtent(e.extent,r):e.size&&t.fitSize(e.size,r)}function q(t,e,r){n.isFunction(t[e])&&t[e](r)}F.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},n.inherits(F,e.Transform).transform=function(t,e){var r,i=this._features,a=this._points,o=t.fields,u=o&&o[0],s=o&&o[1],l=t.geojson||!o&&n.identity,c=e.ADD;r=t.modified()||e.changed(e.REM)||e.modified(n.accessorFields(l))||u&&e.modified(n.accessorFields(u))||s&&e.modified(n.accessorFields(s)),this.value&&!r||(c=e.SOURCE,this._features=i=[],this._points=a=[]),l&&e.visit(c,function(t){i.push(l(t))}),u&&s&&(e.visit(c,function(t){var e=u(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&a.push([e,n])}),i=i.concat({type:O,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:D,features:i}},T.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},n.inherits(T,e.Transform).transform=function(t,e){var r=e.fork(e.ALL),i=this.value,a=t.field||n.identity,u=t.as||"path",s=r.SOURCE;!i||t.modified()?(this.value=i=o.getProjectionPath(t.projection),r.materialize().reflow()):s=a===n.identity||e.modified(a.fields)?r.ADD_MOD:r.ADD;var l=function(t,e){var n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(i,t.pointRadius);return r.visit(s,function(t){t[u]=i(a(t))}),i.pointRadius(l),r.modifies(u)},N.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},n.inherits(N,e.Transform).transform=function(t,e){var n,r=t.projection,i=t.fields[0],a=t.fields[1],o=t.as||["x","y"],u=o[0],s=o[1];function l(t){var e=r([i(t),a(t)]);e?(t[u]=e[0],t[s]=e[1]):(t[u]=void 0,t[s]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,l):(n=e.modified(i.fields)||e.modified(a.fields),e.visit(n?e.ADD_MOD:e.ADD,l)),e.modifies(o)},j.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},n.inherits(j,e.Transform).transform=function(t,e){var r=e.fork(e.ALL),i=this.value,a=t.as||"shape",u=r.ADD;return i&&!t.modified()||(this.value=i=function(t,e,n){var r=null==n?function(n){return t(e(n))}:function(r){var i=t.pointRadius(),a=t.pointRadius(n)(e(r));return t.pointRadius(i),a};return r.context=function(e){return t.context(e),r},r}(o.getProjectionPath(t.projection),t.field||n.field("datum"),t.pointRadius),r.materialize().reflow(),u=r.SOURCE),r.visit(u,function(t){t[a]=i}),r.modifies(a)},R.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},n.inherits(R,e.Transform).transform=function(t,r){var i,a=this.value,o=this.generator;if(!a.length||t.modified())for(var u in t)n.isFunction(o[u])&&o[u](t[u]);return i=o(),a.length?r.mod.push(e.replace(a[0],i)):r.add.push(e.ingest(i)),a[0]=i,r},P.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},n.inherits(P,e.Transform).transform=function(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var r=e.materialize(e.SOURCE).source,a="shared"===t.resolve,o=t.field||n.identity,u=function(t,e){var r;return n.isFunction(t)?(r=function(n){return t(n,e)}).dep=z(t):t?r=n.constant(t):(r=function(t){return t.$value/t.$max||0}).dep=!0,r}(t.opacity,t),c=function(t,e){var r;return n.isFunction(t)?(r=function(n){return s.rgb(t(n,e))}).dep=z(t):r=n.constant(s.rgb(t||"#888")),r}(t.color,t),f=t.as||"image",h={$x:0,$y:0,$value:0,$max:a?i.max(r.map(function(t){return i.max(o(t).values)})):0};return r.forEach(function(t){var e=o(t),r=n.extend({},t,h);a||(r.$max=i.max(e.values||[])),t[f]=function(t,e,r,i){for(var a=t.width,o=t.height,u=t.x1||0,s=t.y1||0,c=t.x2||a,f=t.y2||o,h=t.values,d=h?function(t){return h[t]}:n.zero,p=l.canvas(c-u,f-s),v=p.getContext("2d"),g=v.getImageData(0,0,c-u,f-s),m=g.data,y=s,b=0;y<f;++y){e.$y=y-s;for(var x=u,_=y*a;x<c;++x,b+=4){e.$x=x-u,e.$value=d(x+_);var w=r(e);m[b+0]=w.r,m[b+1]=w.g,m[b+2]=w.b,m[b+3]=~~(255*i(e))}}return v.putImageData(g,0,0),p}(e,r,c.dep?c:n.constant(c(r)),u.dep?u:n.constant(u(r)))}),e.reflow(!0).modifies(f)},n.inherits(B,e.Transform).transform=function(t,e){var r=this.value;return!r||t.modified("type")?(this.value=r=function(t){var e=o.projection((t||"mercator").toLowerCase());return e||n.error("Unrecognized projection type: "+t),e()}(t.type),o.projectionProperties.forEach(function(e){null!=t[e]&&q(r,e,t[e])})):o.projectionProperties.forEach(function(e){t.modified(e)&&q(r,e,t[e])}),null!=t.pointRadius&&r.path.pointRadius(t.pointRadius),t.fit&&L(r,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)},t.contour=C,t.geojson=F,t.geopath=T,t.geopoint=N,t.geoshape=j,t.graticule=R,t.heatmap=P,t.isocontour=m,t.kde2d=A,t.projection=B,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1040),n(1053),n(1343),n(1564),n(1224),n(1114),n(1171))},2123:function(t,e,n){!function(t){"use strict";function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function n(t){var n;return 1===t.length&&(n=t,t=function(t,r){return e(n(t),r)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}}var r=n(e),i=r.right,a=r.left;function o(t,e){return[t,e]}function u(t){return null===t?NaN:+t}function s(t,e){var n,r,i=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<i;)isNaN(n=u(t[o]))||(l+=(r=n-s)*(n-(s+=r/++a)));else for(;++o<i;)isNaN(n=u(e(t[o],o,t)))||(l+=(r=n-s)*(n-(s+=r/++a)));if(a>1)return l/(a-1)}function l(t,e){var n=s(t,e);return n?Math.sqrt(n):n}function c(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}var f=Array.prototype,h=f.slice,d=f.map;function p(t){return function(){return t}}function v(t){return t}function g(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}var m=Math.sqrt(50),y=Math.sqrt(10),b=Math.sqrt(2);function x(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=m?10:a>=y?5:a>=b?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=m?10:a>=y?5:a>=b?2:1)}function _(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=m?i*=10:a>=y?i*=5:a>=b&&(i*=2),e<t?-i:i}function w(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function k(t,e,n){if(null==n&&(n=u),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function A(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r}function E(t){if(!(i=t.length))return[];for(var e=-1,n=A(t,M),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r}function M(t){return t.length}t.bisect=i,t.bisectRight=i,t.bisectLeft=a,t.ascending=e,t.bisector=n,t.cross=function(t,e,n){var r,i,a,u,s=t.length,l=e.length,c=new Array(s*l);for(null==n&&(n=o),r=a=0;r<s;++r)for(u=t[r],i=0;i<l;++i,++a)c[a]=n(u,e[i]);return c},t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=l,t.extent=c,t.histogram=function(){var t=v,e=c,n=w;function r(r){var a,o,u=r.length,s=new Array(u);for(a=0;a<u;++a)s[a]=t(r[a],a,r);var l=e(s),c=l[0],f=l[1],h=n(s,c,f);Array.isArray(h)||(h=_(c,f,h),h=g(Math.ceil(c/h)*h,f,h));for(var d=h.length;h[0]<=c;)h.shift(),--d;for(;h[d-1]>f;)h.pop(),--d;var p,v=new Array(d+1);for(a=0;a<=d;++a)(p=v[a]=[]).x0=a>0?h[a-1]:c,p.x1=a<d?h[a]:f;for(a=0;a<u;++a)c<=(o=s[a])&&o<=f&&v[i(h,o,0,d)].push(r[a]);return v}return r.value=function(e){return arguments.length?(t="function"===typeof e?e:p(e),r):t},r.domain=function(t){return arguments.length?(e="function"===typeof t?t:p([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:Array.isArray(t)?p(h.call(t)):p(t),r):n},r},t.thresholdFreedmanDiaconis=function(t,n,r){return t=d.call(t,u).sort(e),Math.ceil((r-n)/(2*(k(t,.75)-k(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*l(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=w,t.max=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r},t.mean=function(t,e){var n,r=t.length,i=r,a=-1,o=0;if(null==e)for(;++a<r;)isNaN(n=u(t[a]))?--i:o+=n;else for(;++a<r;)isNaN(n=u(e(t[a],a,t)))?--i:o+=n;if(i)return o/i},t.median=function(t,n){var r,i=t.length,a=-1,o=[];if(null==n)for(;++a<i;)isNaN(r=u(t[a]))||o.push(r);else for(;++a<i;)isNaN(r=u(n(t[a],a,t)))||o.push(r);return k(o.sort(e),.5)},t.merge=function(t){for(var e,n,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(n=new Array(o);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--o]=r[e];return n},t.min=A,t.pairs=function(t,e){null==e&&(e=o);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return a},t.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},t.quantile=k,t.range=g,t.scan=function(t,n){if(r=t.length){var r,i,a=0,o=0,u=t[o];for(null==n&&(n=e);++a<r;)(n(i=t[a],u)<0||0!==n(u,u))&&(u=i,o=a);return 0===n(u,u)?o:void 0}},t.shuffle=function(t,e,n){for(var r,i,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)i=Math.random()*a--|0,r=t[a+e],t[a+e]=t[i+e],t[i+e]=r;return t},t.sum=function(t,e){var n,r=t.length,i=-1,a=0;if(null==e)for(;++i<r;)(n=+t[i])&&(a+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(a+=n);return a},t.ticks=function(t,e,n){var r,i,a,o,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=x(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a},t.tickIncrement=x,t.tickStep=_,t.transpose=E,t.variance=s,t.zip=function(){return E(arguments)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2124:function(t,e,n){!function(t,e,n){"use strict";var r=Math.abs,i=Math.atan,a=Math.atan2,o=Math.cos,u=Math.exp,s=Math.floor,l=Math.log,c=Math.max,f=Math.min,h=Math.pow,d=Math.round,p=Math.sign||function(t){return t>0?1:t<0?-1:0},v=Math.sin,g=Math.tan,m=1e-6,y=1e-12,b=Math.PI,x=b/2,_=b/4,w=Math.SQRT1_2,k=D(2),A=D(b),E=2*b,M=180/b,S=b/180;function C(t){return t>1?x:t<-1?-x:Math.asin(t)}function O(t){return t>1?0:t<-1?b:Math.acos(t)}function D(t){return t>0?Math.sqrt(t):0}function F(t){return(u(t)-u(-t))/2}function T(t){return(u(t)+u(-t))/2}function N(t){var e=g(t/2),n=2*l(o(t/2))/(e*e);function i(t,e){var r=o(t),i=o(e),a=v(e),u=i*r,s=-((1-u?l((1+u)/2)/(1-u):-.5)+n/(1+u));return[s*i*v(t),s*a]}return i.invert=function(e,i){var u,s=D(e*e+i*i),c=-t/2,f=50;if(!s)return[0,0];do{var h=c/2,d=o(h),p=v(h),y=g(h),b=l(1/d);c-=u=(2/y*b-n*y-s)/(-b/(p*p)+1-n/(2*d*d))}while(r(u)>m&&--f>0);var x=v(c);return[a(e*x,s*o(c)),C(i*x/s)]},i}function j(t,e){var n=o(e),r=function(t){return t?t/Math.sin(t):1}(O(n*o(t/=2)));return[2*n*v(t)*r,v(e)*r]}function R(t){var e=v(t),n=o(t),i=t>=0?1:-1,u=g(i*t),s=(1+e-n)/2;function l(t,r){var l=o(r),c=o(t/=2);return[(1+l)*v(t),(i*r>-a(c,u)-.001?0:10*-i)+s+v(r)*n-(1+l)*e*c]}return l.invert=function(t,l){var c=0,f=0,h=50;do{var d=o(c),p=v(c),g=o(f),y=v(f),b=1+g,x=b*p-t,_=s+y*n-b*e*d-l,w=b*d/2,k=-p*y,A=e*b*p/2,E=n*g+e*d*y,M=k*A-E*w,S=(_*k-x*E)/M/2,C=(x*A-_*w)/M;c-=S,f-=C}while((r(S)>m||r(C)>m)&&--h>0);return i*f>-a(o(c),u)-.001?[2*c,f]:null},l}function P(t,e){var n=g(e/2),r=D(1-n*n),i=1+r*o(t/=2),a=v(t)*r/i,u=n/i,s=a*a,l=u*u;return[4/3*a*(3+s-3*l),4/3*u*(3+3*s-l)]}j.invert=function(t,e){if(!(t*t+4*e*e>b*b+m)){var n=t,i=e,a=25;do{var u,s=v(n),l=v(n/2),c=o(n/2),f=v(i),h=o(i),d=v(2*i),p=f*f,g=h*h,y=l*l,x=1-g*c*c,_=x?O(h*c)*D(u=1/x):u=0,w=2*_*h*l-t,k=_*f-e,A=u*(g*y+_*h*c*p),E=u*(.5*s*d-2*_*f*l),M=.25*u*(d*l-_*f*g*s),S=u*(p*c+_*y*h),C=E*M-S*A;if(!C)break;var F=(k*E-w*S)/C,T=(w*M-k*A)/C;n-=F,i-=T}while((r(F)>m||r(T)>m)&&--a>0);return[n,i]}},P.invert=function(t,e){if(e*=3/8,!(t*=3/8)&&r(e)>1)return null;var n=1+t*t+e*e,i=D((n-D(n*n-4*e*e))/2),u=C(i)/3,s=i?function(t){return l(t+D(t*t-1))}(r(e/i))/3:function(t){return l(t+D(t*t+1))}(r(t))/3,c=o(u),f=T(s),h=f*f-c*c;return[2*p(t)*a(F(s)*c,.25-h),2*p(e)*a(f*v(u),.25+h)]};var z=D(8),B=l(1+k);function L(t,e){var n=r(e);return n<_?[t,l(g(_+e/2))]:[t*o(n)*(2*k-1/v(n)),p(e)*(2*k*(n-_)-l(g(n/2)))]}function q(t){var n=2*b/t;function u(t,i){var u=e.geoAzimuthalEquidistantRaw(t,i);if(r(t)>x){var s=a(u[1],u[0]),l=D(u[0]*u[0]+u[1]*u[1]),c=n*d((s-x)/n)+x,f=a(v(s-=c),2-o(s));s=c+C(b/l*v(f))-f,u[0]=l*o(s),u[1]=l*v(s)}return u}return u.invert=function(t,r){var u=D(t*t+r*r);if(u>x){var s=a(r,t),l=n*d((s-x)/n)+x,c=s>l?-1:1,f=u*o(l-s),h=1/g(c*O((f-b)/D(b*(b-2*f)+u*u)));s=l+2*i((h+c*D(h*h-3))/3),t=u*o(s),r=u*v(s)}return e.geoAzimuthalEquidistantRaw.invert(t,r)},u}function I(t,n){if(arguments.length<2&&(n=t),1===n)return e.geoAzimuthalEqualAreaRaw;if(n===1/0)return U;function r(r,i){var a=e.geoAzimuthalEqualAreaRaw(r/n,i);return a[0]*=t,a}return r.invert=function(r,i){var a=e.geoAzimuthalEqualAreaRaw.invert(r/t,i);return a[0]*=n,a},r}function U(t,e){return[t*o(e)/o(e/=2),2*v(e)]}function W(t,e,n){var i,a,o,u=100;n=void 0===n?0:+n,e=+e;do{(a=t(n))===(o=t(n+m))&&(o=a+m),n-=i=-1*m*(a-e)/(a-o)}while(u-- >0&&r(i)>m);return u<0?NaN:n}function H(t,e,n){return void 0===e&&(e=40),void 0===n&&(n=y),function(i,a,o,u){var s,l,c;o=void 0===o?0:+o,u=void 0===u?0:+u;for(var f=0;f<e;f++){var h=t(o,u),d=h[0]-i,p=h[1]-a;if(r(d)<n&&r(p)<n)break;var v=d*d+p*p;if(v>s)o-=l/=2,u-=c/=2;else{s=v;var g=(o>0?-1:1)*n,m=(u>0?-1:1)*n,y=t(o+g,u),b=t(o,u+m),x=(y[0]-h[0])/g,_=(y[1]-h[1])/g,w=(b[0]-h[0])/m,k=(b[1]-h[1])/m,A=k*x-_*w,E=(r(A)<.5?.5:1)/A;if(o+=l=(p*w-d*k)*E,u+=c=(d*_-p*x)*E,r(l)<n&&r(c)<n)break}}return[o,u]}}function V(){var t=I(1.68,2),e=1.4,n=12;function r(r,i){if(r+i<-e){var a=(r-i+1.6)*(r+i+e)/8;r+=a,i-=.8*a*v(i+b/2)}var u=t(r,i),s=(1-o(r*i))/n;return u[1]<0&&(u[0]*=1+s),u[1]>0&&(u[1]*=1+s/1.5*u[0]*u[0]),u}return r.invert=H(r),r}function G(t,e){var n,i=t*v(e),a=30;do{e-=n=(e+v(e)-i)/(1+o(e))}while(r(n)>m&&--a>0);return e/2}function $(t,e,n){function r(r,i){return[t*r*o(i=G(n,i)),e*v(i)]}return r.invert=function(r,i){return i=C(i/e),[r/(t*o(i)),C((2*i+v(2*i))/n)]},r}L.invert=function(t,e){if((a=r(e))<B)return[t,2*i(u(e))-x];var n,a,s=_,c=25;do{var f=o(s/2),h=g(s/2);s-=n=(z*(s-_)-l(h)-a)/(z-f*f/(2*h))}while(r(n)>y&&--c>0);return[t/(o(s)*(z-1/v(s))),p(e)*s]},U.invert=function(t,e){var n=2*C(e/2);return[t*o(n/2)/o(n),n]};var Y=$(k/x,k,b),X=2.00276,J=1.11072;function Q(t,e){var n=G(b,e);return[X*t/(1/o(e)+J/o(n)),(e+k*v(n))/X]}function Z(t){var n=0,r=e.geoProjectionMutator(t),i=r(n);return i.parallel=function(t){return arguments.length?r(n=t*S):n*M},i}function K(t,e){return[t*o(e),e]}function tt(t){if(!t)return K;var e=1/g(t);function n(n,r){var i=e+t-r,a=i?n*o(r)/i:i;return[i*v(a),e-i*o(a)]}return n.invert=function(n,r){var i=D(n*n+(r=e-r)*r),u=e+t-i;return[i/o(u)*a(n,r),u]},n}function et(t){function e(e,n){var r=x-n,i=r?e*t*v(r)/r:r;return[r*v(i)/t,x-r*o(i)]}return e.invert=function(e,n){var r=e*t,i=x-n,o=D(r*r+i*i),u=a(r,i);return[(o?o/v(o):1)*u/t,x-o]},e}Q.invert=function(t,e){var n,i,a=X*e,u=e<0?-_:_,s=25;do{i=a-k*v(u),u-=n=(v(2*u)+2*u-b*v(i))/(2*o(2*u)+2+b*o(i)*k*o(u))}while(r(n)>m&&--s>0);return i=a-k*v(u),[t*(1/o(i)+J/o(u))/X,i]},K.invert=function(t,e){return[t/o(e),e]};var nt=$(1,4/b,b);function rt(t,e,n,i,u,s){var l,c=o(s);if(r(t)>1||r(s)>1)l=O(n*u+e*i*c);else{var f=v(t/2),h=v(s/2);l=2*C(D(f*f+e*i*h*h))}return r(l)>m?[l,a(i*v(s),e*u-n*i*c)]:[0,0]}function it(t,e,n){return O((t*t+e*e-n*n)/(2*t*e))}function at(t){return t-2*b*s((t+b)/(2*b))}function ot(t,e,n){for(var r,i=[[t[0],t[1],v(t[1]),o(t[1])],[e[0],e[1],v(e[1]),o(e[1])],[n[0],n[1],v(n[1]),o(n[1])]],a=i[2],u=0;u<3;++u,a=r)r=i[u],a.v=rt(r[1]-a[1],a[3],a[2],r[3],r[2],r[0]-a[0]),a.point=[0,0];var s=it(i[0].v[0],i[2].v[0],i[1].v[0]),l=it(i[0].v[0],i[1].v[0],i[2].v[0]),c=b-s;i[2].point[1]=0,i[0].point[0]=-(i[1].point[0]=i[0].v[0]/2);var f=[i[2].point[0]=i[0].point[0]+i[2].v[0]*o(s),2*(i[0].point[1]=i[1].point[1]=i[2].v[0]*v(s))];return function(t,e){var n,r=v(e),a=o(e),u=new Array(3);for(n=0;n<3;++n){var s=i[n];if(u[n]=rt(e-s[1],s[3],s[2],a,r,t-s[0]),!u[n][0])return s.point;u[n][1]=at(u[n][1]-s.v[1])}var h=f.slice();for(n=0;n<3;++n){var d=2==n?0:n+1,p=it(i[n].v[0],u[n][0],u[d][0]);u[n][1]<0&&(p=-p),n?1==n?(p=l-p,h[0]-=u[n][0]*o(p),h[1]-=u[n][0]*v(p)):(p=c-p,h[0]+=u[n][0]*o(p),h[1]+=u[n][0]*v(p)):(h[0]+=u[n][0]*o(p),h[1]-=u[n][0]*v(p))}return h[0]/=3,h[1]/=3,h}}function ut(t){return t[0]*=S,t[1]*=S,t}function st(t,n,r){var i=e.geoCentroid({type:"MultiPoint",coordinates:[t,n,r]}),a=[-i[0],-i[1]],o=e.geoRotation(a),u=ot(ut(o(t)),ut(o(n)),ut(o(r)));u.invert=H(u);var s=e.geoProjection(u).rotate(a),l=s.center;return delete s.rotate,s.center=function(t){return arguments.length?l(o(t)):o.invert(l())},s.clipAngle(90)}function lt(t,e){var n=D(1-v(e));return[2/A*t*n,A*(1-n)]}function ct(t){var e=g(t);function n(t,n){return[t,(t?t/v(t):1)*(v(n)*o(t)-e*o(n))]}return n.invert=e?function(t,n){t&&(n*=v(t)/t);var r=o(t);return[t,2*a(D(r*r+e*e-n*n)-r,e-n)]}:function(t,e){return[t,C(t?e*g(t)/t:e)]},n}lt.invert=function(t,e){var n=(n=e/A-1)*n;return[n>0?t*D(b/n)/2:0,C(1-n)]};var ft=D(3);function ht(t,e){return[ft*t*(2*o(2*e/3)-1)/A,ft*A*v(e/3)]}function dt(t){var e=o(t);function n(t,n){return[t*e,v(n)/e]}return n.invert=function(t,n){return[t/e,C(n*e)]},n}function pt(t){var e=o(t);function n(t,n){return[t*e,(1+e)*g(n/2)]}return n.invert=function(t,n){return[t/e,2*i(n/(1+e))]},n}function vt(t,e){var n=D(8/(3*b));return[n*t*(1-r(e)/b),n*e]}function gt(t,e){var n=D(4-3*v(r(e)));return[2/D(6*b)*t*n,p(e)*D(2*b/3)*(2-n)]}function mt(t,e){var n=D(b*(4+b));return[2/n*t*(1+D(1-4*e*e/(b*b))),4/n*e]}function yt(t,e){var n=(2+x)*v(e);e/=2;for(var i=0,a=1/0;i<10&&r(a)>m;i++){var u=o(e);e-=a=(e+v(e)*(u+2)-n)/(2*u*(1+u))}return[2/D(b*(4+b))*t*(1+o(e)),2*D(b/(4+b))*v(e)]}function bt(t,e){return[t*(1+o(e))/D(2+b),2*e/D(2+b)]}function xt(t,e){for(var n=(1+x)*v(e),i=0,a=1/0;i<10&&r(a)>m;i++)e-=a=(e+v(e)-n)/(1+o(e));return n=D(2+b),[t*(1+o(e))/n,2*e/n]}ht.invert=function(t,e){var n=3*C(e/(ft*A));return[A*t/(ft*(2*o(2*n/3)-1)),n]},vt.invert=function(t,e){var n=D(8/(3*b)),i=e/n;return[t/(n*(1-r(i)/b)),i]},gt.invert=function(t,e){var n=2-r(e)/D(2*b/3);return[t*D(6*b)/(2*n),p(e)*C((4-n*n)/3)]},mt.invert=function(t,e){var n=D(b*(4+b))/2;return[t*n/(1+D(1-e*e*(4+b)/(4*b))),e*n/2]},yt.invert=function(t,e){var n=e*D((4+b)/b)/2,r=C(n),i=o(r);return[t/(2/D(b*(4+b))*(1+i)),C((r+n*(i+2))/(2+x))]},bt.invert=function(t,e){var n=D(2+b),r=e*n/2;return[n*t/(1+o(r)),r]},xt.invert=function(t,e){var n=1+x,r=D(n/2);return[2*t*r/(1+o(e*=r)),C((e+v(e))/n)]};var _t=3+2*k;function wt(t,e){var n=v(t/=2),r=o(t),a=D(o(e)),u=o(e/=2),s=v(e)/(u+k*r*a),c=D(2/(1+s*s)),f=D((k*u+(r+n)*a)/(k*u+(r-n)*a));return[_t*(c*(f-1/f)-2*l(f)),_t*(c*s*(f+1/f)-2*i(s))]}wt.invert=function(t,e){if(!(n=P.invert(t/1.2,1.065*e)))return null;var n,a=n[0],u=n[1],s=20;t/=_t,e/=_t;do{var h=a/2,d=u/2,p=v(h),g=o(h),y=v(d),b=o(d),_=o(u),A=D(_),E=y/(b+k*g*A),M=E*E,S=D(2/(1+M)),C=(k*b+(g+p)*A)/(k*b+(g-p)*A),O=D(C),F=O-1/O,T=O+1/O,N=S*F-2*l(O)-t,j=S*E*T-2*i(E)-e,R=y&&w*A*p*M/y,z=(k*g*b+A)/(2*(b+k*g*A)*(b+k*g*A)*A),B=-.5*E*S*S*S,L=B*R,q=B*z,I=(I=2*b+k*A*(g-p))*I*O,U=(k*g*b*A+_)/I,W=-k*p*y/(A*I),H=F*L-2*U/O+S*(U+U/C),V=F*q-2*W/O+S*(W+W/C),G=E*T*L-2*R/(1+M)+S*T*R+S*E*(U-U/C),$=E*T*q-2*z/(1+M)+S*T*z+S*E*(W-W/C),Y=V*G-$*H;if(!Y)break;var X=(j*V-N*$)/Y,J=(N*G-j*H)/Y;a-=X,u=c(-x,f(x,u-J))}while((r(X)>m||r(J)>m)&&--s>0);return r(r(u)-x)<m?[0,u]:s&&[a,u]};var kt=o(35*S);function At(t,e){var n=g(e/2);return[t*kt*D(1-n*n),(1+kt)*n]}function Et(t,e){var n=e/2,r=o(n);return[2*t/A*o(e)*r*r,A*g(n)]}function Mt(t){var e=1-t,n=i(b,0)[0]-i(-b,0)[0],r=D(2*(i(0,x)[1]-i(0,-x)[1])/n);function i(n,r){var i=o(r),a=v(r);return[i/(e+t*i)*n,e*r+t*a]}function a(t,e){var n=i(t,e);return[n[0]*r,n[1]/r]}function u(t){return a(0,t)[1]}return a.invert=function(n,i){var a=W(u,i);return[n/r*(t+e/o(a)),a]},a}function St(t){return[t[0]/2,C(g(t[1]/2*S))*M]}function Ct(t){return[2*t[0],2*i(v(t[1]*S))*M]}function Ot(t,n){var i=2*b/n,u=t*t;function s(n,s){var l=e.geoAzimuthalEquidistantRaw(n,s),c=l[0],f=l[1],h=c*c+f*f;if(h>u){var p=D(h),g=a(f,c),y=i*d(g/i),_=g-y,w=t*o(_),k=(t*v(_)-_*v(w))/(x-w),A=Dt(_,k),E=(b-t)/Ft(A,w,b);c=p;var M,S=50;do{c-=M=(t+Ft(A,w,c)*E-p)/(A(c)*E)}while(r(M)>m&&--S>0);f=_*v(c),c<x&&(f-=k*(c-x));var C=v(y),O=o(y);l[0]=c*O-f*C,l[1]=c*C+f*O}return l}return s.invert=function(n,s){var l=n*n+s*s;if(l>u){var c=D(l),f=a(s,n),h=i*d(f/i),p=f-h;n=c*o(p),s=c*v(p);for(var g=n-x,m=v(n),_=s/m,w=n<x?1/0:0,k=10;;){var A=t*v(_),E=t*o(_),M=v(E),S=x-E,C=(A-_*M)/S,O=Dt(_,C);if(r(w)<y||!--k)break;_-=w=(_*m-C*g-s)/(m-2*g*(S*(E+_*A*o(E)-M)-A*(A-_*M))/(S*S))}n=(c=t+Ft(O,E,n)*(b-t)/Ft(O,E,b))*o(f=h+_),s=c*v(f)}return e.geoAzimuthalEquidistantRaw.invert(n,s)},s}function Dt(t,e){return function(n){var r=t*o(n);return n<x&&(r-=e),D(1+r*r)}}function Ft(t,e,n){for(var r=(n-e)/50,i=t(e)+t(n),a=1,o=e;a<50;++a)i+=2*t(o+=r);return.5*i*r}function Tt(t,e,n,i,a,u,s,l){function c(r,c){if(!c)return[t*r/b,0];var f=c*c,h=t+f*(e+f*(n+f*i)),d=c*(a-1+f*(u-l+f*s)),p=(h*h+d*d)/(2*d),g=r*C(h/p)/b;return[p*v(g),c*(1+f*l)+p*(1-o(g))]}return arguments.length<8&&(l=0),c.invert=function(c,f){var h,d,p=b*c/t,g=f,y=50;do{var x=g*g,_=t+x*(e+x*(n+x*i)),w=g*(a-1+x*(u-l+x*s)),k=_*_+w*w,A=2*w,E=k/A,M=E*E,S=C(_/E)/b,O=p*S,F=_*_,T=(2*e+x*(4*n+6*x*i))*g,N=a+x*(3*u+5*x*s),j=(2*(_*T+w*(N-1))*A-k*(2*(N-1)))/(A*A),R=o(O),P=v(O),z=E*R,B=E*P,L=p/b*(1/D(1-F/M))*(T*E-_*j)/M,q=B-c,I=g*(1+x*l)+E-z-f,U=j*P+z*L,W=z*S,H=1+j-(j*R-B*L),V=B*S,G=U*V-H*W;if(!G)break;p-=h=(I*U-q*H)/G,g-=d=(q*V-I*W)/G}while((r(h)>m||r(d)>m)&&--y>0);return[p,g]},c}At.invert=function(t,e){var n=e/(1+kt);return[t&&t/(kt*D(1-n*n)),2*i(n)]},Et.invert=function(t,e){var n=i(e/A),r=o(n),a=2*n;return[t*A/2/(o(a)*r*r),a]};var Nt=Tt(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),jt=Tt(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Rt=Tt(5/6*b,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Pt(t,e){var n=t*t,r=e*e;return[t*(1-.162388*r)*(.87-952426e-9*n*n),e*(1+r/12)]}Pt.invert=function(t,e){var n,i=t,a=e,o=50;do{var u=a*a;a-=n=(a*(1+u/12)-e)/(1+u/4)}while(r(n)>m&&--o>0);o=50,t/=1-.162388*u;do{var s=(s=i*i)*s;i-=n=(i*(.87-952426e-9*s)-t)/(.87-.00476213*s)}while(r(n)>m&&--o>0);return[i,a]};var zt=Tt(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Bt(t){var e=t(x,0)[0]-t(-x,0)[0];function n(n,r){var i=n>0?-.5:.5,a=t(n+i*b,r);return a[0]-=i*e,a}return t.invert&&(n.invert=function(n,r){var i=n>0?-.5:.5,a=t.invert(n+i*e,r),o=a[0]-i*b;return o<-b?o+=2*b:o>b&&(o-=2*b),a[0]=o,a}),n}function Lt(t,e){var n=p(t),i=p(e),u=o(e),s=o(t)*u,l=v(t)*u,c=v(i*e);t=r(a(l,c)),e=C(s),r(t-x)>m&&(t%=x);var f=function(t,e){if(e===x)return[0,0];var n,i,a=v(e),u=a*a,s=u*u,l=1+s,c=1+3*s,f=1-s,h=C(1/D(l)),d=f+u*l*h,p=(1-a)/d,g=D(p),y=p*l,_=D(y),w=g*f;if(0===t)return[0,-(w+u*_)];var k,A=o(e),E=1/A,M=2*a*A,S=(-d*A-(-3*u+h*c)*M*(1-a))/(d*d),O=-E*M,F=-E*(u*l*S+p*c*M),T=-2*E*(f*(.5*S/g)-2*u*g*M),N=4*t/b;if(t>.222*b||e<b/4&&t>.175*b){if(n=(w+u*D(y*(1+s)-w*w))/(1+s),t>b/4)return[n,n];var j=n,R=.5*n;n=.5*(R+j),i=50;do{var P=D(y-n*n),z=n*(T+O*P)+F*C(n/_)-N;if(!z)break;z<0?R=n:j=n,n=.5*(R+j)}while(r(j-R)>m&&--i>0)}else{n=m,i=25;do{var B=n*n,L=D(y-B),q=T+O*L,I=n*q+F*C(n/_)-N,U=q+(F-O*B)/L;n-=k=L?I/U:0}while(r(k)>m&&--i>0)}return[n,-w-u*D(y-n*n)]}(t>b/4?x-t:t,e);return t>b/4&&(c=f[0],f[0]=-f[1],f[1]=-c),f[0]*=n,f[1]*=-i,f}function qt(t,e){var n,a,s,l,c,f;if(e<m)return[(l=v(t))-(n=e*(t-l*(a=o(t)))/4)*a,a+n*l,1-e*l*l/2,t-n];if(e>=1-m)return n=(1-e)/4,s=1/(a=T(t)),[(l=((f=u(2*(f=t)))-1)/(f+1))+n*((c=a*F(t))-t)/(a*a),s-n*l*s*(c-t),s+n*l*s*(c+t),2*i(u(t))-x+n*(c-t)/a];var h=[1,0,0,0,0,0,0,0,0],d=[D(e),0,0,0,0,0,0,0,0],p=0;for(a=D(1-e),c=1;r(d[p]/h[p])>m&&p<8;)n=h[p++],d[p]=(n-a)/2,h[p]=(n+a)/2,a=D(n*a),c*=2;s=c*h[p]*t;do{s=(C(l=d[p]*v(a=s)/h[p])+s)/2}while(--p);return[v(s),l=o(s),l/o(s-a),s]}function It(t,e){if(!e)return t;if(1===e)return l(g(t/2+_));for(var n=1,a=D(1-e),o=D(e),u=0;r(o)>m;u++){if(t%b){var s=i(a*g(t)/n);s<0&&(s+=b),t+=s+~~(t/b)*b}else t+=t;o=(n+a)/2,a=D(n*a),o=((n=o)-a)/2}return t/(h(2,u)*n)}function Ut(t,e){var n=(k-1)/(k+1),s=D(1-n*n),c=It(x,s*s),f=l(g(b/4+r(e)/2)),h=u(-1*f)/D(n),d=function(t,e){var n=t*t,r=e+1,i=1-n-e*e;return[.5*((t>=0?x:-x)-a(i,2*t)),-.25*l(i*i+4*n)+.5*l(r*r+n)]}(h*o(-1*t),h*v(-1*t)),m=function(t,e,n){var a=r(t),o=F(r(e));if(a){var u=1/v(a),s=1/(g(a)*g(a)),l=-(s+n*(o*o*u*u)-1+n),c=(-l+D(l*l-(n-1)*s*4))/2;return[It(i(1/D(c)),n)*p(t),It(i(D((c/s-1)/n)),1-n)*p(e)]}return[0,It(i(o),1-n)*p(e)]}(d[0],d[1],s*s);return[-m[1],(e>=0?1:-1)*(.5*c-m[0])]}function Wt(t){var e=v(t),n=o(t),i=Ht(t);function u(t,a){var u=i(t,a);t=u[0],a=u[1];var s=v(a),l=o(a),c=o(t),f=O(e*s+n*l*c),h=v(f),d=r(h)>m?f/h:1;return[d*n*v(t),(r(t)>x?d:-d)*(e*l-n*s*c)]}return i.invert=Ht(-t),u.invert=function(t,n){var r=D(t*t+n*n),u=-v(r),s=o(r),l=r*s,c=-n*u,f=r*e,h=D(l*l+c*c-f*f),d=a(l*f+c*h,c*f-l*h),p=(r>x?-1:1)*a(t*u,r*o(d)*s+n*v(d)*u);return i.invert(p,d)},u}function Ht(t){var e=v(t),n=o(t);return function(t,r){var i=o(r),u=o(t)*i,s=v(t)*i,l=v(r);return[a(s,u*n-l*e),C(l*n+u*e)]}}Lt.invert=function(t,e){r(t)>1&&(t=2*p(t)-t),r(e)>1&&(e=2*p(e)-e);var n=p(t),i=p(e),u=-n*t,s=-i*e,l=s/u<1,c=function(t,e){for(var n=0,i=1,a=.5,u=50;;){var s=a*a,l=D(a),c=C(1/D(1+s)),f=1-s+a*(1+s)*c,h=(1-l)/f,d=D(h),p=h*(1+s),v=d*(1-s),g=D(p-t*t),m=e+v+a*g;if(r(i-n)<y||0===--u||0===m)break;m>0?n=a:i=a,a=.5*(n+i)}if(!u)return null;var x=C(l),_=o(x),w=1/_,k=2*l*_,A=(-f*_-(-3*a+c*(1+3*s))*k*(1-l))/(f*f);return[b/4*(t*(-2*w*(.5*A/d*(1-s)-2*a*d*k)+-w*k*g)+-w*(a*(1+s)*A+h*(1+3*s)*k)*C(t/D(p))),x]}(l?s:u,l?u:s),f=c[0],h=c[1],d=o(h);return l&&(f=-x-f),[n*(a(v(f)*d,-v(h))+b),i*C(o(f)*d)]},Ut.invert=function(t,e){var n=(k-1)/(k+1),r=D(1-n*n),o=function(t,e,n){var r,i,a;return t?(r=qt(t,n),e?(a=(i=qt(e,1-n))[1]*i[1]+n*r[0]*r[0]*i[0]*i[0],[[r[0]*i[2]/a,r[1]*r[2]*i[0]*i[1]/a],[r[1]*i[1]/a,-r[0]*r[2]*i[0]*i[2]/a],[r[2]*i[1]*i[2]/a,-n*r[0]*r[1]*i[0]/a]]):[[r[0],0],[r[1],0],[r[2],0]]):[[0,(i=qt(e,1-n))[0]/i[1]],[1/i[1],0],[i[2]/i[1],0]]}(.5*It(x,r*r)-e,-t,r*r),s=function(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}(o[0],o[1]);return[a(s[1],s[0])/-1,2*i(u(-.5*l(n*s[0]*s[0]+n*s[1]*s[1])))-x]};var Vt=C(1-1/3)*M,Gt=dt(0);function $t(t){var e=Vt*S,n=lt(b,e)[0]-lt(-b,e)[0],i=Gt(0,e)[1],a=lt(0,e)[1],o=A-a,u=E/t,l=4/E,h=i+o*o*4/E;function d(d,p){var v,g=r(p);if(g>e){var m=f(t-1,c(0,s((d+b)/u)));(v=lt(d+=b*(t-1)/t-m*u,g))[0]=v[0]*E/n-E*(t-1)/(2*t)+m*E/t,v[1]=i+4*(v[1]-a)*o/E,p<0&&(v[1]=-v[1])}else v=Gt(d,p);return v[0]*=l,v[1]/=h,v}return d.invert=function(e,d){e/=l;var p=r(d*=h);if(p>i){var v=f(t-1,c(0,s((e+b)/u)));e=(e+b*(t-1)/t-v*u)*n/E;var g=lt.invert(e,.25*(p-i)*E/o+a);return g[0]-=b*(t-1)/t-v*u,d<0&&(g[1]=-g[1]),g}return Gt.invert(e,d)},d}function Yt(t,e){return[t,1&e?90-m:Vt]}function Xt(t,e){return[t,1&e?-90+m:-Vt]}function Jt(t){return[t[0]*(1-m),t[1]]}function Qt(t){var e,n=1+t,i=C(v(1/n)),u=2*D(b/(e=b+4*i*n)),s=.5*u*(n+D(t*(2+t))),l=t*t,c=n*n;function f(f,h){var d,p,g=1-v(h);if(g&&g<2){var m,_=x-h,w=25;do{var k=v(_),A=o(_),E=i+a(k,n-A),M=1+c-2*n*A;_-=m=(_-l*i-n*k+M*E-.5*g*e)/(2*n*k*E)}while(r(m)>y&&--w>0);d=u*D(M),p=f*E/b}else d=u*(t+g),p=f*i/b;return[d*v(p),s-d*o(p)]}return f.invert=function(t,r){var o=t*t+(r-=s)*r,f=(1+c-o/(u*u))/(2*n),h=O(f),d=v(h),p=i+a(d,n-f);return[C(t/D(o))*b/p,C(1-2*(h-l*i-n*d+(1+c-2*n*f)*p)/e)]},f}var Zt=.7109889596207567,Kt=.0528035274542;function te(t,e){return e>-Zt?((t=Y(t,e))[1]+=Kt,t):K(t,e)}function ee(t,e){return r(e)>Zt?((t=Y(t,e))[1]-=e>0?Kt:-Kt,t):K(t,e)}function ne(t,e,n,r){var i=D(4*b/(2*n+(1+t-e/2)*v(2*n)+(t+e)/2*v(4*n)+e/2*v(6*n))),a=D(r*v(n)*D((1+t*o(2*n)+e*o(4*n))/(1+t+e))),u=n*l(1);function s(n){return D(1+t*o(2*n)+e*o(4*n))}function l(r){var i=r*n;return(2*i+(1+t-e/2)*v(2*i)+(t+e)/2*v(4*i)+e/2*v(6*i))/n}function c(t){return s(t)*v(t)}var f=function(t,e){var r=n*W(l,u*v(e)/n,e/b);isNaN(r)&&(r=n*p(e));var c=i*s(r);return[c*a*t/b*o(r),c/a*v(r)]};return f.invert=function(t,e){var r=W(c,e*a/i);return[t*b/(o(r)*i*a*s(r)),C(n*l(r/n)/u)]},0===n&&(i=D(r/b),(f=function(t,e){return[t*i,v(e)/i]}).invert=function(t,e){return[t/i,C(e*i)]}),f}function re(t,e,n,r,i){void 0===r&&(r=1e-8),void 0===i&&(i=20);var a=t(e),o=t(.5*(e+n)),u=t(n);return function t(e,n,r,i,a,o,u,s,l,c,f){if(f.nanEncountered)return NaN;var h,d,p,v,g,m,y,b,x,_;if(d=e(n+.25*(h=r-n)),p=e(r-.25*h),isNaN(d))f.nanEncountered=!0;else{if(!isNaN(p))return _=((m=(v=h*(i+4*d+a)/12)+(g=h*(a+4*p+o)/12))-u)/15,c>l?(f.maxDepthCount++,m+_):Math.abs(_)<s?m+_:(b=t(e,n,y=n+.5*h,i,d,a,v,.5*s,l,c+1,f),isNaN(b)?(f.nanEncountered=!0,NaN):(x=t(e,y,r,a,p,o,g,.5*s,l,c+1,f),isNaN(x)?(f.nanEncountered=!0,NaN):b+x));f.nanEncountered=!0}}(t,e,n,a,o,u,(a+4*o+u)*(n-e)/6,r,i,1,{maxDepthCount:0,nanEncountered:!1})}function ie(t,e,n){function i(n){return t+(1-t)*h(1-h(n,e),1/e)}function a(t){return re(i,0,t,1e-4)}for(var o=1/a(1),u=1e3,s=(1+1e-8)*o,l=[],c=0;c<=u;c++)l.push(a(c/u)*s);function f(t){var e=0,n=u,r=u>>1;do{l[r]>t?n=r:e=r,r=e+n>>1}while(r>e);var i=l[r+1]-l[r];return i&&(i=(t-l[r+1])/i),(r+1+i)/u}var d=2*f(1)/b*o/n,g=function(t,e){var n=f(r(v(e))),a=i(n)*t;return n/=d,[a,e>=0?n:-n]};return g.invert=function(t,e){var n;return r(e*=d)<1&&(n=p(e)*C(a(r(e))*o)),[t/i(r(e)),n]},g}function ae(t,e){return r(t[0]-e[0])<m&&r(t[1]-e[1])<m}function oe(t,e){for(var n,r,i,a=-1,o=t.length,u=t[0],s=[];++a<o;){r=((n=t[a])[0]-u[0])/e,i=(n[1]-u[1])/e;for(var l=0;l<e;++l)s.push([u[0]+l*r,u[1]+l*i]);u=n}return s.push(n),s}function ue(t){var e,r,i,a,o,u,s,l=[],c=t[0].length;for(s=0;s<c;++s)r=(e=t[0][s])[0][0],i=e[0][1],a=e[1][1],o=e[2][0],u=e[2][1],l.push(oe([[r+m,i+m],[r+m,a-m],[o-m,a-m],[o-m,u+m]],30));for(s=t[1].length-1;s>=0;--s)r=(e=t[1][s])[0][0],i=e[0][1],a=e[1][1],o=e[2][0],u=e[2][1],l.push(oe([[o-m,u-m],[o-m,a+m],[r+m,a+m],[r+m,i-m]],30));return{type:"Polygon",coordinates:[n.merge(l)]}}function se(t,n,r){var i,a;function o(e,r){for(var i=r<0?-1:1,a=n[+(r<0)],o=0,u=a.length-1;o<u&&e>a[o][2][0];++o);var s=t(e-a[o][1][0],r);return s[0]+=t(a[o][1][0],i*r>i*a[o][0][1]?a[o][0][1]:r)[0],s}r?o.invert=r(o):t.invert&&(o.invert=function(e,r){for(var i=a[+(r<0)],u=n[+(r<0)],s=0,l=i.length;s<l;++s){var c=i[s];if(c[0][0]<=e&&e<c[1][0]&&c[0][1]<=r&&r<c[1][1]){var f=t.invert(e-t(u[s][1][0],0)[0],r);return f[0]+=u[s][1][0],ae(o(f[0],f[1]),[e,r])?f:null}}});var u=e.geoProjection(o),s=u.stream;return u.stream=function(t){var n=u.rotate(),r=s(t),a=(u.rotate([0,0]),s(t));return u.rotate(n),r.sphere=function(){e.geoStream(i,a)},r},u.lobes=function(e){return arguments.length?(i=ue(e),n=e.map(function(t){return t.map(function(t){return[[t[0][0]*S,t[0][1]*S],[t[1][0]*S,t[1][1]*S],[t[2][0]*S,t[2][1]*S]]})}),a=n.map(function(e){return e.map(function(e){var n,r=t(e[0][0],e[0][1])[0],i=t(e[2][0],e[2][1])[0],a=t(e[1][0],e[0][1])[1],o=t(e[1][0],e[1][1])[1];return a>o&&(n=a,a=o,o=n),[[r,a],[i,o]]})}),u):n.map(function(t){return t.map(function(t){return[[t[0][0]*M,t[0][1]*M],[t[1][0]*M,t[1][1]*M],[t[2][0]*M,t[2][1]*M]]})})},null!=n&&u.lobes(n),u}te.invert=function(t,e){return e>-Zt?Y.invert(t,e-Kt):K.invert(t,e)},ee.invert=function(t,e){return r(e)>Zt?Y.invert(t,e+(e>0?Kt:-Kt)):K.invert(t,e)};var le=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],ce=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],fe=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],he=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],de=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],pe=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function ve(t,e){return[3/E*t*D(b*b/3-e*e),e]}function ge(t){function e(e,n){if(r(r(n)-x)<m)return[0,n<0?-2:2];var i=v(n),a=h((1+i)/(1-i),t/2),u=.5*(a+1/a)+o(e*=t);return[2*v(e)/u,(a-1/a)/u]}return e.invert=function(e,n){var i=r(n);if(r(i-2)<m)return e?null:[0,p(n)*x];if(i>2)return null;var o=(e/=2)*e,u=(n/=2)*n,s=2*n/(1+o+u);return s=h((1+s)/(1-s),1/t),[a(2*e,1-o-u)/t,C((s-1)/(s+1))]},e}ve.invert=function(t,e){return[E/3*t/D(b*b/3-e*e),e]};var me=b/k;function ye(t,e){return[t*(1+D(o(e)))/2,e/(o(e/2)*o(t/6))]}function be(t,e){var n=t*t,r=e*e;return[t*(.975534+r*(-.0143059*n-.119161+-.0547009*r)),e*(1.00384+n*(.0802894+-.02855*r+199025e-9*n)+r*(.0998909+-.0491032*r))]}function xe(t,e){return[v(t)/o(e),g(e)*o(t)]}function _e(t){var e=o(t),n=g(_+t/2);function i(i,a){var o=a-t,u=r(o)<m?i*e:r(u=_+a/2)<m||r(r(u)-x)<m?0:i*o/l(g(u)/n);return[u,o]}return i.invert=function(i,a){var o,u=a+t;return[r(a)<m?i/e:r(o=_+u/2)<m||r(r(o)-x)<m?0:i*l(g(o)/n)/a,u]},i}function we(t,e){return[t,1.25*l(g(_+.4*e))]}function ke(t){var e=t.length-1;function n(n,r){for(var i,a=o(r),u=2/(1+a*o(n)),s=u*a*v(n),l=u*v(r),c=e,f=t[c],h=f[0],d=f[1];--c>=0;)h=(f=t[c])[0]+s*(i=h)-l*d,d=f[1]+s*d+l*i;return[h=s*(i=h)-l*d,d=s*d+l*i]}return n.invert=function(n,u){var s=20,l=n,c=u;do{for(var f,h=e,d=t[h],p=d[0],g=d[1],y=0,b=0;--h>=0;)y=p+l*(f=y)-c*b,b=g+l*b+c*f,p=(d=t[h])[0]+l*(f=p)-c*g,g=d[1]+l*g+c*f;var x,_,w=(y=p+l*(f=y)-c*b)*y+(b=g+l*b+c*f)*b;l-=x=((p=l*(f=p)-c*g-n)*y+(g=l*g+c*f-u)*b)/w,c-=_=(g*y-p*b)/w}while(r(x)+r(_)>m*m&&--s>0);if(s){var k=D(l*l+c*c),A=2*i(.5*k),E=v(A);return[a(l*E,k*o(A)),k?C(c*E/k):0]}},n}ye.invert=function(t,e){var n=r(t),i=r(e),a=m,u=x;i<me?u*=i/me:a+=6*O(me/i);for(var s=0;s<25;s++){var l=v(u),c=D(o(u)),f=v(u/2),h=o(u/2),d=v(a/6),p=o(a/6),g=.5*a*(1+c)-n,y=u/(h*p)-i,b=c?-.25*a*l/c:0,_=.5*(1+c),w=(1+.5*u*f/h)/(h*p),k=u/h*(d/6)/(p*p),A=b*k-w*_,E=(g*k-y*_)/A,M=(y*b-g*w)/A;if(u-=E,a-=M,r(E)<m&&r(M)<m)break}return[t<0?-a:a,e<0?-u:u]},be.invert=function(t,e){var n=p(t)*b,i=e/2,a=50;do{var o=n*n,u=i*i,s=n*i,l=n*(.975534+u*(-.0143059*o-.119161+-.0547009*u))-t,c=i*(1.00384+o*(.0802894+-.02855*u+199025e-9*o)+u*(.0998909+-.0491032*u))-e,f=.975534-u*(.119161+3*o*.0143059+.0547009*u),h=-s*(.238322+.2188036*u+.0286118*o),d=s*(.1605788+7961e-7*o+-.0571*u),v=1.00384+o*(.0802894+199025e-9*o)+u*(3*(.0998909-.02855*o)-.245516*u),g=h*d-v*f,y=(c*h-l*v)/g,x=(l*d-c*f)/g;n-=y,i-=x}while((r(y)>m||r(x)>m)&&--a>0);return a&&[n,i]},xe.invert=function(t,e){var n=t*t,r=e*e+1,i=n+r,a=t?w*D((i-D(i*i-4*n))/n):1/D(r);return[C(t*a),p(e)*O(a)]},we.invert=function(t,e){return[t,2.5*i(u(.8*e))-.625*b]};var Ae=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Ee=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Me=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Se=[[.9245,0],[0,0],[.01943,0]],Ce=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Oe(t,n){var r=e.geoProjection(ke(t)).rotate(n).clipAngle(90),i=e.geoRotation(n),a=r.center;return delete r.rotate,r.center=function(t){return arguments.length?a(i(t)):i.invert(a())},r}var De=D(6),Fe=D(7);function Te(t,e){var n=C(7*v(e)/(3*De));return[De*t*(2*o(2*n/3)-1)/Fe,9*v(n/3)/Fe]}function Ne(t,e){for(var n,i=(1+w)*v(e),a=e,u=0;u<25&&(a-=n=(v(a/2)+v(a)-i)/(.5*o(a/2)+o(a)),!(r(n)<m));u++);return[t*(1+2*o(a)/o(a/2))/(3*k),2*D(3)*v(a/2)/D(2+k)]}function je(t,e){for(var n,i=D(6/(4+b)),a=(1+b/4)*v(e),u=e/2,s=0;s<25&&(u-=n=(u/2+v(u)-a)/(.5+o(u)),!(r(n)<m));s++);return[i*(.5+o(u))*t/1.5,i*u]}function Re(t,e){var n=e*e,r=n*n,i=n*r;return[t*(.84719-.13063*n+i*i*(.05494*n-.04515-.02326*r+.00331*i)),e*(1.01183+r*r*(.01926*n-.02625-.00396*r))]}function Pe(t,e){return[t*(1+o(e))/2,2*(e-g(e/2))]}Te.invert=function(t,e){var n=3*C(e*Fe/9);return[t*Fe/(De*(2*o(2*n/3)-1)),C(3*v(n)*De/7)]},Ne.invert=function(t,e){var n=e*D(2+k)/(2*D(3)),r=2*C(n);return[3*k*t/(1+2*o(r)/o(r/2)),C((n+v(r))/(1+w))]},je.invert=function(t,e){var n=D(6/(4+b)),i=e/n;return r(r(i)-x)<m&&(i=i<0?-x:x),[1.5*t/(n*(.5+o(i))),C((i/2+v(i))/(1+b/4))]},Re.invert=function(t,e){var n,i,a,o,u=e,s=25;do{u-=n=(u*(1.01183+(a=(i=u*u)*i)*a*(.01926*i-.02625-.00396*a))-e)/(1.01183+a*a*(.21186*i-.23625+-.05148*a))}while(r(n)>y&&--s>0);return[t/(.84719-.13063*(i=u*u)+(o=i*(a=i*i))*o*(.05494*i-.04515-.02326*a+.00331*o)),u]},Pe.invert=function(t,e){for(var n=e/2,i=0,a=1/0;i<10&&r(a)>m;++i){var u=o(e/2);e-=a=(e-g(e/2)-n)/(1-.5/(u*u))}return[2*t/(1+o(e)),e]};var ze=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Be(t,e){var n=v(e),i=o(e),a=p(t);if(0===t||r(e)===x)return[0,e];if(0===e)return[t,0];if(r(t)===x)return[t*i,x*n];var u=b/(2*t)-2*t/b,s=2*e/b,l=(1-s*s)/(n-s),c=u*u,f=l*l,h=1+c/f,d=1+f/c,g=(u*n/l-u/2)/h,m=(f*n/c+l/2)/d,y=m*m-(f*n*n/c+l*n-1)/d;return[x*(g+D(g*g+i*i/h)*a),x*(m+D(y<0?0:y)*p(-e*u)*a)]}Be.invert=function(t,e){var n=(t/=x)*t,r=n+(e/=x)*e,i=b*b;return[t?(r-1+D((1-r)*(1-r)+4*n))/(2*t)*x:0,W(function(t){return r*(b*v(t)-2*t)*b+4*t*t*(e-v(t))+2*b*t-i*e},0)]};var Le=1.0148,qe=.23185,Ie=-.14499,Ue=.02406,We=Le,He=5*qe,Ve=7*Ie,Ge=9*Ue;function $e(t,e){var n=e*e;return[t,e*(Le+n*n*(qe+n*(Ie+Ue*n)))]}function Ye(t,e){if(r(e)<m)return[t,0];var n=g(e),i=t*v(e);return[v(i)/n,e+(1-o(i))/n]}function Xe(t,e){var n=Qe(t[1],t[0]),r=Qe(e[1],e[0]),i=function(t,e){return a(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])}(n,r),u=Ze(n)/Ze(r);return Je([1,0,t[0][0],0,1,t[0][1]],Je([u,0,0,0,u,0],Je([o(i),v(i),0,-v(i),o(i),0],[1,0,-e[0][0],0,1,-e[0][1]])))}function Je(t,e){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]}function Qe(t,e){return[t[0]-e[0],t[1]-e[1]]}function Ze(t){return D(t[0]*t[0]+t[1]*t[1])}function Ke(t,n,i){function a(t,e){var r,i=n(t,e),a=i.project([t*M,e*M]);return(r=i.transform)?[r[0]*a[0]+r[1]*a[1]+r[2],-(r[3]*a[0]+r[4]*a[1]+r[5])]:(a[1]=-a[1],a)}!function t(e,n){if(e.edges=function(t){for(var e=t.length,n=[],r=t[e-1],i=0;i<e;++i)n.push([r,r=t[i]]);return n}(e.face),n.face){var r=e.shared=function(t,e){for(var n,r,i=t.length,a=null,o=0;o<i;++o){n=t[o];for(var u=e.length;--u>=0;)if(r=e[u],n[0]===r[0]&&n[1]===r[1]){if(a)return[a,n];a=n}}}(e.face,n.face),i=Xe(r.map(n.project),r.map(e.project));e.transform=n.transform?Je(n.transform,i):i;for(var a=n.edges,o=0,u=a.length;o<u;++o)tn(r[0],a[o][1])&&tn(r[1],a[o][0])&&(a[o]=e),tn(r[0],a[o][0])&&tn(r[1],a[o][1])&&(a[o]=e);for(a=e.edges,o=0,u=a.length;o<u;++o)tn(r[0],a[o][0])&&tn(r[1],a[o][1])&&(a[o]=n),tn(r[0],a[o][1])&&tn(r[1],a[o][0])&&(a[o]=n)}else e.transform=n.transform;return e.children&&e.children.forEach(function(n){t(n,e)}),e}(t,{transform:null}),en(t)&&(a.invert=function(e,r){var i=function t(e,r){var i=e.project.invert,a=e.transform,o=r;if(a&&(a=function(t){var e=1/(t[0]*t[4]-t[1]*t[3]);return[e*t[4],-e*t[1],e*(t[1]*t[5]-t[2]*t[4]),-e*t[3],e*t[0],e*(t[2]*t[3]-t[0]*t[5])]}(a),o=[a[0]*o[0]+a[1]*o[1]+a[2],a[3]*o[0]+a[4]*o[1]+a[5]]),i&&e===function(t){return n(t[0]*S,t[1]*S)}(u=i(o)))return u;for(var u,s=e.children,l=0,c=s&&s.length;l<c;++l)if(u=t(s[l],r))return u}(t,[e,-r]);return i&&(i[0]*=S,i[1]*=S,i)});var o=e.geoProjection(a),u=o.stream;return o.stream=function(n){var i=o.rotate(),a=u(n),s=(o.rotate([0,0]),u(n));return o.rotate(i),a.sphere=function(){s.polygonStart(),s.lineStart(),function t(n,i,a){var o,u,s=i.edges,l=s.length,c={type:"MultiPoint",coordinates:i.face},f=i.face.filter(function(t){return 90!==r(t[1])}),h=e.geoBounds({type:"MultiPoint",coordinates:f}),d=!1,p=-1,v=h[1][0]-h[0][0],g=180===v||360===v?[(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]:e.geoCentroid(c);if(a)for(;++p<l&&s[p]!==a;);++p;for(var y=0;y<l;++y)u=s[(y+p)%l],Array.isArray(u)?(d||(n.point((o=e.geoInterpolate(u[0],g)(m))[0],o[1]),d=!0),n.point((o=e.geoInterpolate(u[1],g)(m))[0],o[1])):(d=!1,u!==a&&t(n,u,i))}(s,t),s.lineEnd(),s.polygonEnd()},a},o.angle(null==i?-30:i*M)}function tn(t,e){return t&&e&&t[0]===e[0]&&t[1]===e[1]}function en(t){return t.project.invert||t.children&&t.children.some(en)}$e.invert=function(t,e){e>1.790857183?e=1.790857183:e<-1.790857183&&(e=-1.790857183);var n,i=e;do{var a=i*i;i-=n=(i*(Le+a*a*(qe+a*(Ie+Ue*a)))-e)/(We+a*a*(He+a*(Ve+Ge*a)))}while(r(n)>m);return[t,i]},Ye.invert=function(t,e){if(r(e)<m)return[t,0];var n,i=t*t+e*e,a=.5*e,u=10;do{var s=g(a),l=1/o(a),c=i-2*e*a+a*a;a-=n=(s*c+2*(a-e))/(2+c*l*l+2*(a-e)*s)}while(r(n)>m&&--u>0);return s=g(a),[(r(e)<r(a+1/s)?C(t*s):p(t)*(O(r(t*s))+x))/v(a),a]};var nn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],rn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(t){return t.map(function(t){return nn[t]})}),an=2/D(3);function on(t,e){var n=lt(t,e);return[n[0]*an,n[1]]}function un(t,e){for(var n=0,r=t.length,i=0;n<r;++n)i+=t[n]*e[n];return i}function sn(t){return[a(t[1],t[0])*M,C(c(-1,f(1,t[2])))*M]}function ln(t){var e=t[0]*S,n=t[1]*S,r=o(n);return[r*o(e),r*v(e),v(n)]}function cn(){}function fn(t,e){return{type:"FeatureCollection",features:t.features.map(function(t){return hn(t,e)})}}function hn(t,e){return{type:"Feature",id:t.id,properties:t.properties,geometry:dn(t.geometry,e)}}function dn(t,n){if(!t)return null;if("GeometryCollection"===t.type)return function(t,e){return{type:"GeometryCollection",geometries:t.geometries.map(function(t){return dn(t,e)})}}(t,n);var r;switch(t.type){case"Point":case"MultiPoint":r=gn;break;case"LineString":case"MultiLineString":r=mn;break;case"Polygon":case"MultiPolygon":case"Sphere":r=yn;break;default:return null}return e.geoStream(t,n(r)),r.result()}on.invert=function(t,e){return lt.invert(t/an,e)};var pn=[],vn=[],gn={point:function(t,e){pn.push([t,e])},result:function(){var t=pn.length?pn.length<2?{type:"Point",coordinates:pn[0]}:{type:"MultiPoint",coordinates:pn}:null;return pn=[],t}},mn={lineStart:cn,point:function(t,e){pn.push([t,e])},lineEnd:function(){pn.length&&(vn.push(pn),pn=[])},result:function(){var t=vn.length?vn.length<2?{type:"LineString",coordinates:vn[0]}:{type:"MultiLineString",coordinates:vn}:null;return vn=[],t}},yn={polygonStart:cn,lineStart:cn,point:function(t,e){pn.push([t,e])},lineEnd:function(){var t=pn.length;if(t){do{pn.push(pn[0].slice())}while(++t<4);vn.push(pn),pn=[]}},polygonEnd:cn,result:function(){if(!vn.length)return null;var t=[],e=[];return vn.forEach(function(n){!function(t){if((e=t.length)<4)return!1;for(var e,n=0,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r<=0}(n)?e.push(n):t.push([n])}),e.forEach(function(e){var n=e[0];t.some(function(t){if(function(t,e){for(var n=e[0],r=e[1],i=!1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],c=s[1],f=t[u],h=f[0],d=f[1];c>r^d>r&&n<(h-l)*(r-c)/(d-c)+l&&(i=!i)}return i}(t[0],n))return t.push(e),!0})||t.push([e])}),vn=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}};function bn(t){var n=t(x,0)[0]-t(-x,0)[0];function i(e,i){var a=r(e)<x,o=t(a?e:e>0?e-b:e+b,i),u=(o[0]-o[1])*w,s=(o[0]+o[1])*w;if(a)return[u,s];var l=n*w,c=u>0^s>0?-1:1;return[c*u-p(s)*l,c*s-p(u)*l]}return t.invert&&(i.invert=function(e,i){var a=(e+i)*w,o=(i-e)*w,u=r(a)<.5*n&&r(o)<.5*n;if(!u){var s=n*w,l=a>0^o>0?-1:1,c=-l*e+(o>0?1:-1)*s,f=-l*i+(a>0?1:-1)*s;a=(-c-f)*w,o=(c-f)*w}var h=t.invert(a,o);return u||(h[0]+=a>0?b:-b),h}),e.geoProjection(i).rotate([-90,-90,45]).clipAngle(179.999)}function xn(){return bn(Ut).scale(111.48)}function _n(t){var e=v(t);function n(n,r){var a=e?g(n*e/2)/e:n/2;if(!r)return[2*a,-t];var u=2*i(a*v(r)),s=1/g(r);return[v(u)*s,r+(1-o(u))*s-t]}return n.invert=function(n,a){if(r(a+=t)<m)return[e?2*i(e*n/2)/e:n,0];var u,s=n*n+a*a,l=0,c=10;do{var f=g(l),h=1/o(l),d=s-2*a*l+l*l;l-=u=(f*d+2*(l-a))/(2+d*h*h+2*(l-a)*f)}while(r(u)>m&&--c>0);var p=n*(f=g(l)),y=g(r(a)<r(l+1/f)?.5*C(p):.5*O(p)+b/4)/v(l);return[e?2*i(e*y)/e:2*y,l]},n}var wn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function kn(t,e){var n,i=f(18,36*r(e)/b),a=s(i),o=i-a,u=(n=wn[a])[0],l=n[1],c=(n=wn[++a])[0],h=n[1],d=(n=wn[f(19,++a)])[0],p=n[1];return[t*(c+o*(d-u)/2+o*o*(d-2*c+u)/2),(e>0?x:-x)*(h+o*(p-l)/2+o*o*(p-2*h+l)/2)]}function An(t,e){var n=function(t){function e(e,n){var r=o(n),i=(t-1)/(t-r*o(e));return[i*r*v(e),i*v(n)]}return e.invert=function(e,n){var r=e*e+n*n,i=D(r),o=(t-D(1-r*(t+1)/(t-1)))/((t-1)/i+i/(t-1));return[a(e*o,i*D(1-o*o)),i?C(n*o/i):0]},e}(t);if(!e)return n;var r=o(e),i=v(e);function u(e,a){var o=n(e,a),u=o[1],s=u*i/(t-1)+r;return[o[0]*r/s,u/s]}return u.invert=function(e,a){var o=(t-1)/(t-1-a*i);return n.invert(o*e,o*a*r)},u}wn.forEach(function(t){t[1]*=1.0144}),kn.invert=function(t,e){var n=e/x,i=90*n,a=f(18,r(i/5)),o=c(0,s(a));do{var u=wn[o][1],l=wn[o+1][1],h=wn[f(19,o+2)][1],d=h-u,p=h-2*l+u,v=2*(r(n)-l)/d,g=p/d,m=v*(1-g*v*(1-2*g*v));if(m>=0||1===o){i=(e>=0?5:-5)*(m+a);var b,_=50;do{m=(a=f(18,r(i)/5))-(o=s(a)),u=wn[o][1],l=wn[o+1][1],h=wn[f(19,o+2)][1],i-=(b=(e>=0?x:-x)*(l+m*(h-u)/2+m*m*(h-2*l+u)/2)-e)*M}while(r(b)>y&&--_>0);break}}while(--o>=0);var w=wn[o][0],k=wn[o+1][0],A=wn[f(19,o+2)][0];return[t/(k+m*(A-w)/2+m*m*(A-2*k+w)/2),i*S]};var En=1e4,Mn=-180,Sn=Mn+1e-4,Cn=180,On=Cn-1e-4,Dn=-90,Fn=Dn+1e-4,Tn=90,Nn=Tn-1e-4;function jn(t){return t.length>0}function Rn(t){return t===Dn||t===Tn?[0,t]:[Mn,(e=t,Math.floor(e*En)/En)];var e}function Pn(t){var e=t[0],n=t[1],r=!1;return e<=Sn?(e=Mn,r=!0):e>=On&&(e=Cn,r=!0),n<=Fn?(n=Dn,r=!0):n>=Nn&&(n=Tn,r=!0),r?[e,n]:t}function zn(t){return t.map(Pn)}function Bn(t,e,n){for(var r=0,i=t.length;r<i;++r){var a=t[r].slice();n.push({index:-1,polygon:e,ring:a});for(var o=0,u=a.length;o<u;++o){var s=a[o],l=s[0],c=s[1];if(l<=Sn||l>=On||c<=Fn||c>=Nn){a[o]=Pn(s);for(var f=o+1;f<u;++f){var h=a[f],d=h[0],p=h[1];if(d>Sn&&d<On&&p>Fn&&p<Nn)break}if(f===o+1)continue;if(o){var v={index:-1,polygon:e,ring:a.slice(0,o+1)};v.ring[v.ring.length-1]=Rn(c),n[n.length-1]=v}else n.pop();if(f>=u)break;n.push({index:-1,polygon:e,ring:a=a.slice(f-1)}),a[0]=Rn(a[0][1]),o=-1,u=a.length}}}}function Ln(t){var e,n,r,i,a,o,u=t.length,s={},l={};for(e=0;e<u;++e)r=(n=t[e]).ring[0],a=n.ring[n.ring.length-1],r[0]!==a[0]||r[1]!==a[1]?(n.index=e,s[r]=l[a]=n):(n.polygon.push(n.ring),t[e]=null);for(e=0;e<u;++e)if(n=t[e]){if(r=n.ring[0],a=n.ring[n.ring.length-1],i=l[r],o=s[a],delete s[r],delete l[a],r[0]===a[0]&&r[1]===a[1]){n.polygon.push(n.ring);continue}i?(delete l[r],delete s[i.ring[0]],i.ring.pop(),t[i.index]=null,n={index:-1,polygon:i.polygon,ring:i.ring.concat(n.ring)},i===o?n.polygon.push(n.ring):(n.index=u++,t.push(s[n.ring[0]]=l[n.ring[n.ring.length-1]]=n))):o?(delete s[a],delete l[o.ring[o.ring.length-1]],n.ring.pop(),n={index:u++,polygon:o.polygon,ring:n.ring.concat(o.ring)},t[o.index]=null,t.push(s[n.ring[0]]=l[n.ring[n.ring.length-1]]=n)):(n.ring.push(n.ring[0]),n.polygon.push(n.ring))}}function qn(t){var e={type:"Feature",geometry:In(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}function In(t){if(null==t)return t;var e,n,r,i;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(In)};break;case"Point":e={type:"Point",coordinates:Pn(t.coordinates)};break;case"MultiPoint":case"LineString":e={type:t.type,coordinates:zn(t.coordinates)};break;case"MultiLineString":e={type:"MultiLineString",coordinates:t.coordinates.map(zn)};break;case"Polygon":var a=[];Bn(t.coordinates,a,n=[]),Ln(n),e={type:"Polygon",coordinates:a};break;case"MultiPolygon":n=[],r=-1,i=t.coordinates.length;for(var o=new Array(i);++r<i;)Bn(t.coordinates[r],o[r]=[],n);Ln(n),e={type:"MultiPolygon",coordinates:o.filter(jn)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function Un(t,e){var n=g(e/2),r=v(_*n);return[t*(.74482-.34588*r*r),1.70711*n]}function Wn(t,n,r){var i=e.geoInterpolate(n,r),a=i(.5),o=e.geoRotation([-a[0],-a[1]])(n),u=i.distance/2,s=-C(v(o[1]*S)/v(u)),l=[-a[0],-a[1],-(o[0]>0?b-s:s)*M],c=e.geoProjection(t(u)).rotate(l),f=e.geoRotation(l),h=c.center;return delete c.rotate,c.center=function(t){return arguments.length?h(f(t)):f.invert(h())},c.clipAngle(90)}function Hn(t){var n=o(t);function r(t,r){var i=e.geoGnomonicRaw(t,r);return i[0]*=n,i}return r.invert=function(t,r){return e.geoGnomonicRaw.invert(t/n,r)},r}function Vn(t,e){return Wn(Hn,t,e)}function Gn(t){if(!(t*=2))return e.geoAzimuthalEquidistantRaw;var n=-t/2,r=-n,i=t*t,u=g(r),s=.5/v(r);function l(e,a){var u=O(o(a)*o(e-n)),s=O(o(a)*o(e-r));return[((u*=u)-(s*=s))/(2*t),(a<0?-1:1)*D(4*i*s-(i-u+s)*(i-u+s))/(2*t)]}return l.invert=function(t,e){var i,l,c=e*e,f=o(D(c+(i=t+n)*i)),h=o(D(c+(i=t+r)*i));return[a(l=f-h,i=(f+h)*u),(e<0?-1:1)*O(D(i*i+l*l)*s)]},l}function $n(t,e){return Wn(Gn,t,e)}function Yn(t,e){if(r(e)<m)return[t,0];var n=r(e/x),i=C(n);if(r(t)<m||r(r(e)-x)<m)return[0,p(e)*b*g(i/2)];var a=o(i),u=r(b/t-t/b)/2,s=u*u,l=a/(n+a-1),c=l*(2/n-1),f=c*c,h=f+s,d=l-f,v=s+l;return[p(t)*b*(u*d+D(s*d*d-h*(l*l-f)))/h,p(e)*b*(c*v-u*D((s+1)*h-v*v))/h]}function Xn(t,e){if(r(e)<m)return[t,0];var n=r(e/x),i=C(n);if(r(t)<m||r(r(e)-x)<m)return[0,p(e)*b*g(i/2)];var a=o(i),u=r(b/t-t/b)/2,s=u*u,l=a*(D(1+s)-u*a)/(1+s*n*n);return[p(t)*b*l,p(e)*b*D(1-l*(2*u+l))]}function Jn(t,e){if(r(e)<m)return[t,0];var n=e/x,i=C(n);if(r(t)<m||r(r(e)-x)<m)return[0,b*g(i/2)];var a=(b/t-t/b)/2,u=n/(1+o(i));return[b*(p(t)*D(a*a+1-u*u)-a),b*u]}function Qn(t,e){if(!e)return[t,0];var n=r(e);if(!t||n===x)return[0,e];var i=n/x,a=i*i,o=(8*i-a*(a+2)-5)/(2*a*(i-1)),u=o*o,s=i*o,l=a+u+2*s,c=i+3*o,f=t/x,h=f+1/f,d=p(r(t)-x)*D(h*h-4),v=d*d,g=(d*(l+u-1)+2*D(l*(a+u*v-1)+(1-a)*(a*(c*c+4*u)+12*s*u+4*u*u)))/(4*l+v);return[p(t)*x*g,p(e)*x*D(1+d*r(g)-g*g)]}function Zn(t,e,n,r){var i=b/3;t=c(t,m),e=c(e,m),t=f(t,x),e=f(e,b-m),n=c(n,0),n=f(n,100-m);var u=(r=c(r,m))/100,s=O((n/100+1)*o(i))/i,l=v(t)/v(s*x),h=e/b,d=D(u*v(t/2)/v(e/2));return function(t,e,n,r,i){function u(a,u){var s=n*v(r*u),l=D(1-s*s),c=D(2/(1+l*o(a*=i)));return[t*l*c*v(a),e*s*c]}return u.invert=function(o,u){var s=o/t,l=u/e,c=D(s*s+l*l),f=2*C(c/2);return[a(o*g(f),t*c)/i,c&&C(u*v(f)/(e*n*c))/r]},u}(d/D(h*l*s),1/(d*D(h*l*s)),l,s,h)}function Kn(){var t=65*S,n=60*S,r=20,i=200,a=e.geoProjectionMutator(Zn),o=a(t,n,r,i);return o.poleline=function(e){return arguments.length?a(t=+e*S,n,r,i):t*M},o.parallels=function(e){return arguments.length?a(t,n=+e*S,r,i):n*M},o.inflation=function(e){return arguments.length?a(t,n,r=+e,i):r},o.ratio=function(e){return arguments.length?a(t,n,r,i=+e):i},o.scale(163.775)}Un.invert=function(t,e){var n=e/1.70711,r=v(_*n);return[t/(.74482-.34588*r*r),2*i(n)]},Yn.invert=function(t,e){if(r(e)<m)return[t,0];if(r(t)<m)return[0,x*v(2*i(e/b))];var n=(t/=b)*t,a=(e/=b)*e,u=n+a,s=u*u,l=-r(e)*(1+u),c=l-2*a+n,f=-2*l+1+2*a+s,h=a/f+(2*c*c*c/(f*f*f)-9*l*c/(f*f))/27,d=(l-c*c/(3*f))/f,g=2*D(-d/3),y=O(3*h/(d*g))/3;return[b*(u-1+D(1+2*(n-a)+s))/(2*t),p(e)*b*(-g*o(y+b/3)-c/(3*f))]},Xn.invert=function(t,e){if(!t)return[0,x*v(2*i(e/b))];var n=r(t/b),o=(1-n*n-(e/=b)*e)/(2*n),u=D(o*o+1);return[p(t)*b*(u-o),p(e)*x*v(2*a(D((1-2*o*n)*(o+u)-n),D(u+o+n)))]},Jn.invert=function(t,e){if(!e)return[t,0];var n=e/b,r=(b*b*(1-n*n)-t*t)/(2*b*t);return[t?b*(p(t)*D(r*r+1)-r):0,x*v(2*i(n))]},Qn.invert=function(t,e){var n;if(!t||!e)return[t,e];e/=b;var i=p(t)*t/x,a=(i*i-1+4*e*e)/r(i),o=a*a,u=2*e,s=50;do{var l=u*u,c=(8*u-l*(l+2)-5)/(2*l*(u-1)),f=(3*u-l*u-10)/(2*l*u),h=c*c,d=u*c,v=u+c,g=v*v,y=u+3*c,_=-2*v*(4*d*h+(1-4*l+3*l*l)*(1+f)+h*(14*l-6-o+(8*l-8-2*o)*f)+d*(12*l-8+(10*l-10-o)*f)),w=D(g*(l+h*o-1)+(1-l)*(l*(y*y+4*h)+h*(12*d+4*h)));u-=n=(a*(g+h-1)+2*w-i*(4*g+o))/(a*(2*c*f+2*v*(1+f))+_/w-8*v*(a*(-1+h+g)+2*w)*(1+f)/(o+4*g))}while(n>m&&--s>0);return[p(t)*(D(a*a+4)+a)*b/4,x*u]};var tr=4*b+3*D(3),er=2*D(2*b*D(3)/tr),nr=$(er*D(3)/b,er,tr/6);function rr(t,e){return[t*D(1-3*e*e/(b*b)),e]}function ir(t,e){var n=o(e),r=o(t)*n,i=1-r,u=o(t=a(v(t)*n,-v(e))),s=v(t);return[s*(n=D(1-r*r))-u*i,-u*n-s*i]}function ar(t,e){var n=j(t,e);return[(n[0]+t/x)/2,(n[1]+e)/2]}rr.invert=function(t,e){return[t/D(1-3*e*e/(b*b)),e]},ir.invert=function(t,e){var n=(t*t+e*e)/-2,r=D(-n*(2+n)),i=e*n+t*r,o=t*n-e*r,u=D(o*o+i*i);return[a(r*i,u*(1+n)),u?-C(r*o/u):0]},ar.invert=function(t,e){var n=t,i=e,a=25;do{var u,s=o(i),l=v(i),c=v(2*i),f=l*l,h=s*s,d=v(n),p=o(n/2),g=v(n/2),y=g*g,b=1-h*p*p,_=b?O(s*p)*D(u=1/b):u=0,w=.5*(2*_*s*g+n/x)-t,k=.5*(_*l+i)-e,A=.5*u*(h*y+_*s*p*f)+.5/x,E=u*(d*c/4-_*l*g),M=.125*u*(c*g-_*l*h*d),S=.5*u*(f*p+_*y*s)+.5,C=E*M-S*A,F=(k*E-w*S)/C,T=(w*M-k*A)/C;n-=F,i-=T}while((r(F)>m||r(T)>m)&&--a>0);return[n,i]},t.geoNaturalEarth=e.geoNaturalEarth1,t.geoNaturalEarthRaw=e.geoNaturalEarth1Raw,t.geoAiry=function(){var t=x,n=e.geoProjectionMutator(N),r=n(t);return r.radius=function(e){return arguments.length?n(t=e*S):t*M},r.scale(179.976).clipAngle(147)},t.geoAiryRaw=N,t.geoAitoff=function(){return e.geoProjection(j).scale(152.63)},t.geoAitoffRaw=j,t.geoArmadillo=function(){var t=20*S,n=t>=0?1:-1,r=g(n*t),i=e.geoProjectionMutator(R),u=i(t),s=u.stream;return u.parallel=function(e){return arguments.length?(r=g((n=(t=e*S)>=0?1:-1)*t),i(t)):t*M},u.stream=function(e){var i=u.rotate(),l=s(e),c=(u.rotate([0,0]),s(e)),f=u.precision();return u.rotate(i),l.sphere=function(){c.polygonStart(),c.lineStart();for(var e=-180*n;n*e<180;e+=90*n)c.point(e,90*n);if(t)for(;n*(e-=3*n*f)>=-180;)c.point(e,n*-a(o(e*S/2),r)*M);c.lineEnd(),c.polygonEnd()},l},u.scale(218.695).center([0,28.0974])},t.geoArmadilloRaw=R,t.geoAugust=function(){return e.geoProjection(P).scale(66.1603)},t.geoAugustRaw=P,t.geoBaker=function(){return e.geoProjection(L).scale(112.314)},t.geoBakerRaw=L,t.geoBerghaus=function(){var t=5,n=e.geoProjectionMutator(q),r=n(t),i=r.stream,u=-o(.01*S),s=v(.01*S);return r.lobes=function(e){return arguments.length?n(t=+e):t},r.stream=function(e){var n=r.rotate(),l=i(e),c=(r.rotate([0,0]),i(e));return r.rotate(n),l.sphere=function(){c.polygonStart(),c.lineStart();for(var e=0,n=360/t,r=2*b/t,i=90-180/t,l=x;e<t;++e,i-=n,l-=r)c.point(a(s*o(l),u)*M,C(s*v(l))*M),i<-90?(c.point(-90,-180-i-.01),c.point(-90,-180-i+.01)):(c.point(90,i+.01),c.point(90,i-.01));c.lineEnd(),c.polygonEnd()},l},r.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},t.geoBerghausRaw=q,t.geoBertin1953=function(){return e.geoProjection(V()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},t.geoBertin1953Raw=V,t.geoBoggs=function(){return e.geoProjection(Q).scale(160.857)},t.geoBoggsRaw=Q,t.geoBonne=function(){return Z(tt).scale(123.082).center([0,26.1441]).parallel(45)},t.geoBonneRaw=tt,t.geoBottomley=function(){var t=.5,n=e.geoProjectionMutator(et),r=n(t);return r.fraction=function(e){return arguments.length?n(t=+e):t},r.scale(158.837)},t.geoBottomleyRaw=et,t.geoBromley=function(){return e.geoProjection(nt).scale(152.63)},t.geoBromleyRaw=nt,t.geoChamberlin=st,t.geoChamberlinRaw=ot,t.geoChamberlinAfrica=function(){return st([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},t.geoCollignon=function(){return e.geoProjection(lt).scale(95.6464).center([0,30])},t.geoCollignonRaw=lt,t.geoCraig=function(){return Z(ct).scale(249.828).clipAngle(90)},t.geoCraigRaw=ct,t.geoCraster=function(){return e.geoProjection(ht).scale(156.19)},t.geoCrasterRaw=ht,t.geoCylindricalEqualArea=function(){return Z(dt).parallel(38.58).scale(195.044)},t.geoCylindricalEqualAreaRaw=dt,t.geoCylindricalStereographic=function(){return Z(pt).scale(124.75)},t.geoCylindricalStereographicRaw=pt,t.geoEckert1=function(){return e.geoProjection(vt).scale(165.664)},t.geoEckert1Raw=vt,t.geoEckert2=function(){return e.geoProjection(gt).scale(165.664)},t.geoEckert2Raw=gt,t.geoEckert3=function(){return e.geoProjection(mt).scale(180.739)},t.geoEckert3Raw=mt,t.geoEckert4=function(){return e.geoProjection(yt).scale(180.739)},t.geoEckert4Raw=yt,t.geoEckert5=function(){return e.geoProjection(bt).scale(173.044)},t.geoEckert5Raw=bt,t.geoEckert6=function(){return e.geoProjection(xt).scale(173.044)},t.geoEckert6Raw=xt,t.geoEisenlohr=function(){return e.geoProjection(wt).scale(62.5271)},t.geoEisenlohrRaw=wt,t.geoFahey=function(){return e.geoProjection(At).scale(137.152)},t.geoFaheyRaw=At,t.geoFoucaut=function(){return e.geoProjection(Et).scale(135.264)},t.geoFoucautRaw=Et,t.geoFoucautSinusoidal=function(){var t=.5,n=e.geoProjectionMutator(Mt),r=n(t);return r.alpha=function(e){return arguments.length?n(t=+e):t},r.scale(168.725)},t.geoFoucautSinusoidalRaw=Mt,t.geoGilbert=function(t){null==t&&(t=e.geoOrthographic);var n=t(),r=e.geoEquirectangular().scale(M).precision(0).clipAngle(null).translate([0,0]);function i(t){return n(St(t))}function a(t){i[t]=function(){return arguments.length?(n[t].apply(n,arguments),i):n[t]()}}return n.invert&&(i.invert=function(t){return Ct(n.invert(t))}),i.stream=function(t){var e=n.stream(t),i=r.stream({point:function(t,n){e.point(t/2,C(g(-n/2*S))*M)},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}});return i.sphere=e.sphere,i},i.rotate=function(t){return arguments.length?(r.rotate(t),i):r.rotate()},i.center=function(t){return arguments.length?(n.center(St(t)),i):Ct(n.center())},a("angle"),a("clipAngle"),a("clipExtent"),a("fitExtent"),a("fitHeight"),a("fitSize"),a("fitWidth"),a("scale"),a("translate"),a("precision"),i.scale(249.5)},t.geoGingery=function(){var t=6,n=30*S,r=o(n),i=v(n),u=e.geoProjectionMutator(Ot),s=u(n,t),l=s.stream,c=-o(.01*S),f=v(.01*S);return s.radius=function(e){return arguments.length?(r=o(n=e*S),i=v(n),u(n,t)):n*M},s.lobes=function(e){return arguments.length?u(n,t=+e):t},s.stream=function(e){var n=s.rotate(),u=l(e),h=(s.rotate([0,0]),l(e));return s.rotate(n),u.sphere=function(){h.polygonStart(),h.lineStart();for(var e=0,n=2*b/t,u=0;e<t;++e,u-=n)h.point(a(f*o(u),c)*M,C(f*v(u))*M),h.point(a(i*o(u-n/2),r)*M,C(i*v(u-n/2))*M);h.lineEnd(),h.polygonEnd()},u},s.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},t.geoGingeryRaw=Ot,t.geoGinzburg4=function(){return e.geoProjection(Nt).scale(149.995)},t.geoGinzburg4Raw=Nt,t.geoGinzburg5=function(){return e.geoProjection(jt).scale(153.93)},t.geoGinzburg5Raw=jt,t.geoGinzburg6=function(){return e.geoProjection(Rt).scale(130.945)},t.geoGinzburg6Raw=Rt,t.geoGinzburg8=function(){return e.geoProjection(Pt).scale(131.747)},t.geoGinzburg8Raw=Pt,t.geoGinzburg9=function(){return e.geoProjection(zt).scale(131.087)},t.geoGinzburg9Raw=zt,t.geoGringorten=function(){return e.geoProjection(Bt(Lt)).scale(239.75)},t.geoGringortenRaw=Lt,t.geoGuyou=function(){return e.geoProjection(Bt(Ut)).scale(151.496)},t.geoGuyouRaw=Ut,t.geoHammer=function(){var t=2,n=e.geoProjectionMutator(I),r=n(t);return r.coefficient=function(e){return arguments.length?n(t=+e):t},r.scale(169.529)},t.geoHammerRaw=I,t.geoHammerRetroazimuthal=function(){var t=0,n=e.geoProjectionMutator(Wt),r=n(t),i=r.rotate,a=r.stream,o=e.geoCircle();return r.parallel=function(e){if(!arguments.length)return t*M;var i=r.rotate();return n(t=e*S).rotate(i)},r.rotate=function(e){return arguments.length?(i.call(r,[e[0],e[1]-t*M]),o.center([-e[0],-e[1]]),r):((e=i.call(r))[1]+=t*M,e)},r.stream=function(t){return(t=a(t)).sphere=function(){t.polygonStart();var e,n=o.radius(89.99)().coordinates[0],r=n.length-1,i=-1;for(t.lineStart();++i<r;)t.point((e=n[i])[0],e[1]);for(t.lineEnd(),r=(n=o.radius(90.01)().coordinates[0]).length-1,t.lineStart();--i>=0;)t.point((e=n[i])[0],e[1]);t.lineEnd(),t.polygonEnd()},t},r.scale(79.4187).parallel(45).clipAngle(179.999)},t.geoHammerRetroazimuthalRaw=Wt,t.geoHealpix=function(){var t=4,r=e.geoProjectionMutator($t),i=r(t),a=i.stream;return i.lobes=function(e){return arguments.length?r(t=+e):t},i.stream=function(r){var o=i.rotate(),u=a(r),s=(i.rotate([0,0]),a(r));return i.rotate(o),u.sphere=function(){e.geoStream(function(t){var e=[].concat(n.range(-180,180+t/2,t).map(Yt),n.range(180,-180-t/2,-t).map(Xt));return{type:"Polygon",coordinates:[180===t?e.map(Jt):e]}}(180/t),s)},u},i.scale(239.75)},t.geoHealpixRaw=$t,t.geoHill=function(){var t=1,n=e.geoProjectionMutator(Qt),r=n(t);return r.ratio=function(e){return arguments.length?n(t=+e):t},r.scale(167.774).center([0,18.67])},t.geoHillRaw=Qt,t.geoHomolosine=function(){return e.geoProjection(ee).scale(152.63)},t.geoHomolosineRaw=ee,t.geoHufnagel=function(){var t=1,n=0,r=45*S,i=2,a=e.geoProjectionMutator(ne),o=a(t,n,r,i);return o.a=function(e){return arguments.length?a(t=+e,n,r,i):t},o.b=function(e){return arguments.length?a(t,n=+e,r,i):n},o.psiMax=function(e){return arguments.length?a(t,n,r=+e*S,i):r*M},o.ratio=function(e){return arguments.length?a(t,n,r,i=+e):i},o.scale(180.739)},t.geoHufnagelRaw=ne,t.geoHyperelliptical=function(){var t=0,n=2.5,r=1.183136,i=e.geoProjectionMutator(ie),a=i(t,n,r);return a.alpha=function(e){return arguments.length?i(t=+e,n,r):t},a.k=function(e){return arguments.length?i(t,n=+e,r):n},a.gamma=function(e){return arguments.length?i(t,n,r=+e):r},a.scale(152.63)},t.geoHyperellipticalRaw=ie,t.geoInterrupt=se,t.geoInterruptedBoggs=function(){return se(Q,le).scale(160.857)},t.geoInterruptedHomolosine=function(){return se(ee,ce).scale(152.63)},t.geoInterruptedMollweide=function(){return se(Y,fe).scale(169.529)},t.geoInterruptedMollweideHemispheres=function(){return se(Y,he).scale(169.529).rotate([20,0])},t.geoInterruptedSinuMollweide=function(){return se(te,de,H).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoInterruptedSinusoidal=function(){return se(K,pe).scale(152.63).rotate([-20,0])},t.geoKavrayskiy7=function(){return e.geoProjection(ve).scale(158.837)},t.geoKavrayskiy7Raw=ve,t.geoLagrange=function(){var t=.5,n=e.geoProjectionMutator(ge),r=n(t);return r.spacing=function(e){return arguments.length?n(t=+e):t},r.scale(124.75)},t.geoLagrangeRaw=ge,t.geoLarrivee=function(){return e.geoProjection(ye).scale(97.2672)},t.geoLarriveeRaw=ye,t.geoLaskowski=function(){return e.geoProjection(be).scale(139.98)},t.geoLaskowskiRaw=be,t.geoLittrow=function(){return e.geoProjection(xe).scale(144.049).clipAngle(89.999)},t.geoLittrowRaw=xe,t.geoLoximuthal=function(){return Z(_e).parallel(40).scale(158.837)},t.geoLoximuthalRaw=_e,t.geoMiller=function(){return e.geoProjection(we).scale(108.318)},t.geoMillerRaw=we,t.geoModifiedStereographic=Oe,t.geoModifiedStereographicRaw=ke,t.geoModifiedStereographicAlaska=function(){return Oe(Ae,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},t.geoModifiedStereographicGs48=function(){return Oe(Ee,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},t.geoModifiedStereographicGs50=function(){return Oe(Me,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},t.geoModifiedStereographicMiller=function(){return Oe(Se,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},t.geoModifiedStereographicLee=function(){return Oe(Ce,[165,10]).scale(250).clipAngle(130).center([-165,-10])},t.geoMollweide=function(){return e.geoProjection(Y).scale(169.529)},t.geoMollweideRaw=Y,t.geoMtFlatPolarParabolic=function(){return e.geoProjection(Te).scale(164.859)},t.geoMtFlatPolarParabolicRaw=Te,t.geoMtFlatPolarQuartic=function(){return e.geoProjection(Ne).scale(188.209)},t.geoMtFlatPolarQuarticRaw=Ne,t.geoMtFlatPolarSinusoidal=function(){return e.geoProjection(je).scale(166.518)},t.geoMtFlatPolarSinusoidalRaw=je,t.geoNaturalEarth2=function(){return e.geoProjection(Re).scale(175.295)},t.geoNaturalEarth2Raw=Re,t.geoNellHammer=function(){return e.geoProjection(Pe).scale(152.63)},t.geoNellHammerRaw=Pe,t.geoInterruptedQuarticAuthalic=function(){return se(I(1/0),ze).rotate([20,0]).scale(152.63)},t.geoNicolosi=function(){return e.geoProjection(Be).scale(127.267)},t.geoNicolosiRaw=Be,t.geoPatterson=function(){return e.geoProjection($e).scale(139.319)},t.geoPattersonRaw=$e,t.geoPolyconic=function(){return e.geoProjection(Ye).scale(103.74)},t.geoPolyconicRaw=Ye,t.geoPolyhedral=Ke,t.geoPolyhedralButterfly=function(t){t=t||function(t){var n=e.geoCentroid({type:"MultiPoint",coordinates:t});return e.geoGnomonic().scale(1).translate([0,0]).rotate([-n[0],-n[1]])};var n=rn.map(function(e){return{face:e,project:t(e)}});return[-1,0,0,1,0,1,4,5].forEach(function(t,e){var r=n[t];r&&(r.children||(r.children=[])).push(n[e])}),Ke(n[0],function(t,e){return n[t<-b/2?e<0?6:4:t<0?e<0?2:0:t<b/2?e<0?3:1:e<0?7:5]}).angle(-30).scale(101.858).center([0,45])},t.geoPolyhedralCollignon=function(t){t=t||function(t){var n=e.geoCentroid({type:"MultiPoint",coordinates:t});return e.geoProjection(on).translate([0,0]).scale(1).rotate(n[1]>0?[-n[0],0]:[180-n[0],180])};var n=rn.map(function(e){return{face:e,project:t(e)}});return[-1,0,0,1,0,1,4,5].forEach(function(t,e){var r=n[t];r&&(r.children||(r.children=[])).push(n[e])}),Ke(n[0],function(t,e){return n[t<-b/2?e<0?6:4:t<0?e<0?2:0:t<b/2?e<0?3:1:e<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},t.geoPolyhedralWaterman=function(t){t=t||function(t){var n=6===t.length?e.geoCentroid({type:"MultiPoint",coordinates:t}):t[0];return e.geoGnomonic().scale(1).translate([0,0]).rotate([-n[0],-n[1]])};var n=rn.map(function(t){for(var e,n=t.map(ln),r=n.length,i=n[r-1],a=[],o=0;o<r;++o)e=n[o],a.push(sn([.9486832980505138*i[0]+.31622776601683794*e[0],.9486832980505138*i[1]+.31622776601683794*e[1],.9486832980505138*i[2]+.31622776601683794*e[2]]),sn([.9486832980505138*e[0]+.31622776601683794*i[0],.9486832980505138*e[1]+.31622776601683794*i[1],.9486832980505138*e[2]+.31622776601683794*i[2]])),i=e;return a}),r=[],i=[-1,0,0,1,0,1,4,5];n.forEach(function(t,e){for(var a,o,u=rn[e],s=u.length,l=r[e]=[],c=0;c<s;++c)n.push([u[c],t[(2*c+2)%(2*s)],t[(2*c+1)%(2*s)]]),i.push(e),l.push((a=ln(t[(2*c+2)%(2*s)]),o=ln(t[(2*c+1)%(2*s)]),[a[1]*o[2]-a[2]*o[1],a[2]*o[0]-a[0]*o[2],a[0]*o[1]-a[1]*o[0]]))});var a=n.map(function(e){return{project:t(e),face:e}});return i.forEach(function(t,e){var n=a[t];n&&(n.children||(n.children=[])).push(a[e])}),Ke(a[0],function(t,e){var n=o(e),i=[n*o(t),n*v(t),v(e)],u=t<-b/2?e<0?6:4:t<0?e<0?2:0:t<b/2?e<0?3:1:e<0?7:5,s=r[u];return a[un(s[0],i)<0?8+3*u:un(s[1],i)<0?8+3*u+1:un(s[2],i)<0?8+3*u+2:u]}).angle(-30).scale(110.625).center([0,45])},t.geoProject=function(t,e){var n,r=e.stream;if(!r)throw new Error("invalid projection");switch(t&&t.type){case"Feature":n=hn;break;case"FeatureCollection":n=fn;break;default:n=dn}return n(t,r)},t.geoGringortenQuincuncial=function(){return bn(Lt).scale(176.423)},t.geoPeirceQuincuncial=xn,t.geoPierceQuincuncial=xn,t.geoQuantize=function(t,e){if(!(0<=(e=+e)&&e<=20))throw new Error("invalid digits");function n(t){var n=t.length,r=2,i=new Array(n);for(i[0]=+t[0].toFixed(e),i[1]=+t[1].toFixed(e);r<n;)i[r]=t[r],++r;return i}function r(t){return t.map(n)}function i(t){for(var e=n(t[0]),r=[e],i=1;i<t.length;i++){var a=n(t[i]);(a.length>2||a[0]!=e[0]||a[1]!=e[1])&&(r.push(a),e=a)}return 1===r.length&&t.length>1&&r.push(n(t[t.length-1])),r}function a(t){return t.map(i)}function o(t){if(null==t)return t;var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(o)};break;case"Point":e={type:"Point",coordinates:n(t.coordinates)};break;case"MultiPoint":e={type:t.type,coordinates:r(t.coordinates)};break;case"LineString":e={type:t.type,coordinates:i(t.coordinates)};break;case"MultiLineString":case"Polygon":e={type:t.type,coordinates:a(t.coordinates)};break;case"MultiPolygon":e={type:"MultiPolygon",coordinates:t.coordinates.map(a)};break;default:return t}return null!=t.bbox&&(e.bbox=t.bbox),e}function u(t){var e={type:"Feature",properties:t.properties,geometry:o(t.geometry)};return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),e}if(null!=t)switch(t.type){case"Feature":return u(t);case"FeatureCollection":var s={type:"FeatureCollection",features:t.features.map(u)};return null!=t.bbox&&(s.bbox=t.bbox),s;default:return o(t)}return t},t.geoQuincuncial=bn,t.geoRectangularPolyconic=function(){return Z(_n).scale(131.215)},t.geoRectangularPolyconicRaw=_n,t.geoRobinson=function(){return e.geoProjection(kn).scale(152.63)},t.geoRobinsonRaw=kn,t.geoSatellite=function(){var t=2,n=0,r=e.geoProjectionMutator(An),i=r(t,n);return i.distance=function(e){return arguments.length?r(t=+e,n):t},i.tilt=function(e){return arguments.length?r(t,n=e*S):n*M},i.scale(432.147).clipAngle(O(1/t)*M-1e-6)},t.geoSatelliteRaw=An,t.geoSinuMollweide=function(){return e.geoProjection(te).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoSinuMollweideRaw=te,t.geoSinusoidal=function(){return e.geoProjection(K).scale(152.63)},t.geoSinusoidalRaw=K,t.geoStitch=function(t){if(null==t)return t;switch(t.type){case"Feature":return qn(t);case"FeatureCollection":var e={type:"FeatureCollection",features:t.features.map(qn)};return null!=t.bbox&&(e.bbox=t.bbox),e;default:return In(t)}},t.geoTimes=function(){return e.geoProjection(Un).scale(146.153)},t.geoTimesRaw=Un,t.geoTwoPointAzimuthal=Vn,t.geoTwoPointAzimuthalRaw=Hn,t.geoTwoPointAzimuthalUsa=function(){return Vn([-158,21.5],[-77,39]).clipAngle(60).scale(400)},t.geoTwoPointEquidistant=$n,t.geoTwoPointEquidistantRaw=Gn,t.geoTwoPointEquidistantUsa=function(){return $n([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},t.geoVanDerGrinten=function(){return e.geoProjection(Yn).scale(79.4183)},t.geoVanDerGrintenRaw=Yn,t.geoVanDerGrinten2=function(){return e.geoProjection(Xn).scale(79.4183)},t.geoVanDerGrinten2Raw=Xn,t.geoVanDerGrinten3=function(){return e.geoProjection(Jn).scale(79.4183)},t.geoVanDerGrinten3Raw=Jn,t.geoVanDerGrinten4=function(){return e.geoProjection(Qn).scale(127.16)},t.geoVanDerGrinten4Raw=Qn,t.geoWagner=Kn,t.geoWagner7=function(){return Kn().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},t.geoWagnerRaw=Zn,t.geoWagner4=function(){return e.geoProjection(nr).scale(176.84)},t.geoWagner4Raw=nr,t.geoWagner6=function(){return e.geoProjection(rr).scale(152.63)},t.geoWagner6Raw=rr,t.geoWiechel=function(){return e.geoProjection(ir).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},t.geoWiechelRaw=ir,t.geoWinkel3=function(){return e.geoProjection(ar).scale(158.837)},t.geoWinkel3Raw=ar,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1224),n(2125))},2125:function(t,e,n){!function(t){"use strict";function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function n(t){var n;return 1===t.length&&(n=t,t=function(t,r){return e(n(t),r)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}}var r=n(e),i=r.right,a=r.left;function o(t,e){return[t,e]}function u(t){return null===t?NaN:+t}function s(t,e){var n,r,i=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<i;)isNaN(n=u(t[o]))||(l+=(r=n-s)*(n-(s+=r/++a)));else for(;++o<i;)isNaN(n=u(e(t[o],o,t)))||(l+=(r=n-s)*(n-(s+=r/++a)));if(a>1)return l/(a-1)}function l(t,e){var n=s(t,e);return n?Math.sqrt(n):n}function c(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}var f=Array.prototype,h=f.slice,d=f.map;function p(t){return function(){return t}}function v(t){return t}function g(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}var m=Math.sqrt(50),y=Math.sqrt(10),b=Math.sqrt(2);function x(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=m?10:a>=y?5:a>=b?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=m?10:a>=y?5:a>=b?2:1)}function _(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=m?i*=10:a>=y?i*=5:a>=b&&(i*=2),e<t?-i:i}function w(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function k(t,e,n){if(null==n&&(n=u),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function A(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r}function E(t){if(!(i=t.length))return[];for(var e=-1,n=A(t,M),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r}function M(t){return t.length}t.bisect=i,t.bisectRight=i,t.bisectLeft=a,t.ascending=e,t.bisector=n,t.cross=function(t,e,n){var r,i,a,u,s=t.length,l=e.length,c=new Array(s*l);for(null==n&&(n=o),r=a=0;r<s;++r)for(u=t[r],i=0;i<l;++i,++a)c[a]=n(u,e[i]);return c},t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=l,t.extent=c,t.histogram=function(){var t=v,e=c,n=w;function r(r){var a,o,u=r.length,s=new Array(u);for(a=0;a<u;++a)s[a]=t(r[a],a,r);var l=e(s),c=l[0],f=l[1],h=n(s,c,f);Array.isArray(h)||(h=_(c,f,h),h=g(Math.ceil(c/h)*h,f,h));for(var d=h.length;h[0]<=c;)h.shift(),--d;for(;h[d-1]>f;)h.pop(),--d;var p,v=new Array(d+1);for(a=0;a<=d;++a)(p=v[a]=[]).x0=a>0?h[a-1]:c,p.x1=a<d?h[a]:f;for(a=0;a<u;++a)c<=(o=s[a])&&o<=f&&v[i(h,o,0,d)].push(r[a]);return v}return r.value=function(e){return arguments.length?(t="function"===typeof e?e:p(e),r):t},r.domain=function(t){return arguments.length?(e="function"===typeof t?t:p([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:Array.isArray(t)?p(h.call(t)):p(t),r):n},r},t.thresholdFreedmanDiaconis=function(t,n,r){return t=d.call(t,u).sort(e),Math.ceil((r-n)/(2*(k(t,.75)-k(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*l(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=w,t.max=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r},t.mean=function(t,e){var n,r=t.length,i=r,a=-1,o=0;if(null==e)for(;++a<r;)isNaN(n=u(t[a]))?--i:o+=n;else for(;++a<r;)isNaN(n=u(e(t[a],a,t)))?--i:o+=n;if(i)return o/i},t.median=function(t,n){var r,i=t.length,a=-1,o=[];if(null==n)for(;++a<i;)isNaN(r=u(t[a]))||o.push(r);else for(;++a<i;)isNaN(r=u(n(t[a],a,t)))||o.push(r);return k(o.sort(e),.5)},t.merge=function(t){for(var e,n,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(n=new Array(o);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--o]=r[e];return n},t.min=A,t.pairs=function(t,e){null==e&&(e=o);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return a},t.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},t.quantile=k,t.range=g,t.scan=function(t,n){if(r=t.length){var r,i,a=0,o=0,u=t[o];for(null==n&&(n=e);++a<r;)(n(i=t[a],u)<0||0!==n(u,u))&&(u=i,o=a);return 0===n(u,u)?o:void 0}},t.shuffle=function(t,e,n){for(var r,i,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)i=Math.random()*a--|0,r=t[a+e],t[a+e]=t[i+e],t[i+e]=r;return t},t.sum=function(t,e){var n,r=t.length,i=-1,a=0;if(null==e)for(;++i<r;)(n=+t[i])&&(a+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(a+=n);return a},t.ticks=function(t,e,n){var r,i,a,o,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=x(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a},t.tickIncrement=x,t.tickStep=_,t.transpose=E,t.variance=s,t.zip=function(){return E(arguments)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2126:function(t,e,n){!function(t,e,n,r){"use strict";var i={center:r.forceCenter,collide:r.forceCollide,nbody:r.forceManyBody,link:r.forceLink,x:r.forceX,y:r.forceY},a="forces",o=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],u=["static","iterations"],s=["x","y","vx","vy"];function l(t){e.Transform.call(this,null,t)}l.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:s}]};var c=n.inherits(l,e.Transform);function f(t,e,r,i){var u,s,l,c,f=n.array(e.forces);for(u=0,s=o.length;u<s;++u)(l=o[u])!==a&&e.modified(l)&&t[l](e[l]);for(u=0,s=f.length;u<s;++u)c=a+u,(l=r||e.modified(a,u)?d(f[u]):i&&h(f[u],i)?t.force(c):null)&&t.force(c,l);for(s=t.numForces||0;u<s;++u)t.force(a+u,null);return t.numForces=f.length,t}function h(t,e){var r,i;for(r in t)if(n.isFunction(i=t[r])&&e.modified(n.accessorFields(i)))return 1;return 0}function d(t){var e,r;for(r in n.hasOwnProperty(i,t.force)||n.error("Unrecognized force: "+t.force),e=i[t.force](),t)n.isFunction(e[r])&&p(e[r],t[r],t);return e}function p(t,e,r){t(n.isFunction(e)?function(t){return e(t,r)}:e)}c.transform=function(t,e){var n,i,a=this.value,s=e.changed(e.ADD_REM),l=t.modified(o),c=t.iterations||300;if(a?(s&&(e.modifies("index"),a.nodes(e.source)),(l||e.changed(e.MOD))&&f(a,t,0,e)):(this.value=a=function(t,e){var n=r.forceSimulation(t),i=!1,a=n.stop,o=n.restart;return n.stopped=function(){return i},n.restart=function(){return i=!1,o()},n.stop=function(){return i=!0,a()},f(n,e,!0).on("end",function(){i=!0})}(e.source,t),a.on("tick",(n=e.dataflow,i=this,function(){n.touch(i).run()})),t.static||(s=!0,a.tick()),e.modifies("index")),l||s||t.modified(u)||e.changed()&&t.restart)if(a.alpha(Math.max(a.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/c)),t.static)for(a.stop();--c>=0;)a.tick();else if(a.stopped()&&a.restart(),!s)return e.StopPropagation;return this.finish(t,e)},c.finish=function(t,e){for(var n,r=e.dataflow,i=this._argops,o=0,u=i.length;o<u;++o)if((n=i[o]).name===a&&"link"===n.op._argval.force)for(var l,c=n.op._argops,f=0,h=c.length;f<h;++f)if("links"===c[f].name&&(l=c[f].op.source)){r.pulse(l,r.changeset().reflow());break}return e.reflow(t.modified()).modifies(s)},t.force=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1040),n(2127))},2127:function(t,e,n){!function(t,e,n,r){"use strict";function i(t){return function(){return t}}function a(){return 1e-6*(Math.random()-.5)}function o(t){return t.x+t.vx}function u(t){return t.y+t.vy}function s(t){return t.index}function l(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function c(t){return t.x}function f(t){return t.y}var h=10,d=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(t,e){var n;function r(){var r,i,a=n.length,o=0,u=0;for(r=0;r<a;++r)o+=(i=n[r]).x,u+=i.y;for(o=o/a-t,u=u/a-e,r=0;r<a;++r)(i=n[r]).x-=o,i.y-=u}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},t.forceCollide=function(t){var n,r,s=1,l=1;function c(){for(var t,i,c,h,d,p,v,g=n.length,m=0;m<l;++m)for(i=e.quadtree(n,o,u).visitAfter(f),t=0;t<g;++t)c=n[t],p=r[c.index],v=p*p,h=c.x+c.vx,d=c.y+c.vy,i.visit(y);function y(t,e,n,r,i){var o=t.data,u=t.r,l=p+u;if(!o)return e>h+l||r<h-l||n>d+l||i<d-l;if(o.index>c.index){var f=h-o.x-o.vx,g=d-o.y-o.vy,m=f*f+g*g;m<l*l&&(0===f&&(m+=(f=a())*f),0===g&&(m+=(g=a())*g),m=(l-(m=Math.sqrt(m)))/m*s,c.vx+=(f*=m)*(l=(u*=u)/(v+u)),c.vy+=(g*=m)*l,o.vx-=f*(l=1-l),o.vy-=g*l)}}}function f(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function h(){if(n){var e,i,a=n.length;for(r=new Array(a),e=0;e<a;++e)i=n[e],r[i.index]=+t(i,e,n)}}return"function"!==typeof t&&(t=i(null==t?1:+t)),c.initialize=function(t){n=t,h()},c.iterations=function(t){return arguments.length?(l=+t,c):l},c.strength=function(t){return arguments.length?(s=+t,c):s},c.radius=function(e){return arguments.length?(t="function"===typeof e?e:i(+e),h(),c):t},c},t.forceLink=function(t){var e,n,r,o,u,c=s,f=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=i(30),d=1;function p(r){for(var i=0,o=t.length;i<d;++i)for(var s,l,c,f,h,p,v,g=0;g<o;++g)l=(s=t[g]).source,f=(c=s.target).x+c.vx-l.x-l.vx||a(),h=c.y+c.vy-l.y-l.vy||a(),f*=p=((p=Math.sqrt(f*f+h*h))-n[g])/p*r*e[g],h*=p,c.vx-=f*(v=u[g]),c.vy-=h*v,l.vx+=f*(v=1-v),l.vy+=h*v}function v(){if(r){var i,a,s=r.length,f=t.length,h=new Map(r.map(function(t,e){return[c(t,e,r),t]}));for(i=0,o=new Array(s);i<f;++i)(a=t[i]).index=i,"object"!==typeof a.source&&(a.source=l(h,a.source)),"object"!==typeof a.target&&(a.target=l(h,a.target)),o[a.source.index]=(o[a.source.index]||0)+1,o[a.target.index]=(o[a.target.index]||0)+1;for(i=0,u=new Array(f);i<f;++i)a=t[i],u[i]=o[a.source.index]/(o[a.source.index]+o[a.target.index]);e=new Array(f),g(),n=new Array(f),m()}}function g(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+f(t[n],n,t)}function m(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+h(t[e],e,t)}return null==t&&(t=[]),p.initialize=function(t){r=t,v()},p.links=function(e){return arguments.length?(t=e,v(),p):t},p.id=function(t){return arguments.length?(c=t,p):c},p.iterations=function(t){return arguments.length?(d=+t,p):d},p.strength=function(t){return arguments.length?(f="function"===typeof t?t:i(+t),g(),p):f},p.distance=function(t){return arguments.length?(h="function"===typeof t?t:i(+t),m(),p):h},p},t.forceManyBody=function(){var t,n,r,o,u=i(-30),s=1,l=1/0,h=.81;function d(i){var a,o=t.length,u=e.quadtree(t,c,f).visitAfter(v);for(r=i,a=0;a<o;++a)n=t[a],u.visit(g)}function p(){if(t){var e,n,r=t.length;for(o=new Array(r),e=0;e<r;++e)n=t[e],o[n.index]=+u(n,e,t)}}function v(t){var e,n,r,i,a,u=0,s=0;if(t.length){for(r=i=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(u+=e.value,s+=n,r+=n*e.x,i+=n*e.y);t.x=r/s,t.y=i/s}else{(e=t).x=e.data.x,e.y=e.data.y;do{u+=o[e.data.index]}while(e=e.next)}t.value=u}function g(t,e,i,u){if(!t.value)return!0;var c=t.x-n.x,f=t.y-n.y,d=u-e,p=c*c+f*f;if(d*d/h<p)return p<l&&(0===c&&(p+=(c=a())*c),0===f&&(p+=(f=a())*f),p<s&&(p=Math.sqrt(s*p)),n.vx+=c*t.value*r/p,n.vy+=f*t.value*r/p),!0;if(!(t.length||p>=l)){(t.data!==n||t.next)&&(0===c&&(p+=(c=a())*c),0===f&&(p+=(f=a())*f),p<s&&(p=Math.sqrt(s*p)));do{t.data!==n&&(d=o[t.data.index]*r/p,n.vx+=c*d,n.vy+=f*d)}while(t=t.next)}}return d.initialize=function(e){t=e,p()},d.strength=function(t){return arguments.length?(u="function"===typeof t?t:i(+t),p(),d):u},d.distanceMin=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.distanceMax=function(t){return arguments.length?(l=t*t,d):Math.sqrt(l)},d.theta=function(t){return arguments.length?(h=t*t,d):Math.sqrt(h)},d},t.forceRadial=function(t,e,n){var r,a,o,u=i(.1);function s(t){for(var i=0,u=r.length;i<u;++i){var s=r[i],l=s.x-e||1e-6,c=s.y-n||1e-6,f=Math.sqrt(l*l+c*c),h=(o[i]-f)*a[i]*t/f;s.vx+=l*h,s.vy+=c*h}}function l(){if(r){var e,n=r.length;for(a=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),a[e]=isNaN(o[e])?0:+u(r[e],e,r)}}return"function"!==typeof t&&(t=i(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,l()},s.strength=function(t){return arguments.length?(u="function"===typeof t?t:i(+t),l(),s):u},s.radius=function(e){return arguments.length?(t="function"===typeof e?e:i(+e),l(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s},t.forceSimulation=function(t){var e,i=1,a=.001,o=1-Math.pow(a,1/300),u=0,s=.6,l=new Map,c=r.timer(p),f=n.dispatch("tick","end");function p(){v(),f.call("tick",e),i<a&&(c.stop(),f.call("end",e))}function v(n){var r,a,c=t.length;void 0===n&&(n=1);for(var f=0;f<n;++f)for(i+=(u-i)*o,l.forEach(function(t){t(i)}),r=0;r<c;++r)null==(a=t[r]).fx?a.x+=a.vx*=s:(a.x=a.fx,a.vx=0),null==a.fy?a.y+=a.vy*=s:(a.y=a.fy,a.vy=0);return e}function g(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=h*Math.sqrt(n),a=n*d;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function m(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),g(),e={tick:v,restart:function(){return c.restart(p),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,g(),l.forEach(m),e):t},alpha:function(t){return arguments.length?(i=+t,e):i},alphaMin:function(t){return arguments.length?(a=+t,e):a},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(u=+t,e):u},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},force:function(t,n){return arguments.length>1?(null==n?l.delete(t):l.set(t,m(n)),e):l.get(t)},find:function(e,n,r){var i,a,o,u,s,l=0,c=t.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(o=(i=e-(u=t[l]).x)*i+(a=n-u.y)*a)<r&&(s=u,r=o);return s},on:function(t,n){return arguments.length>1?(f.on(t,n),e):f.on(t)}}},t.forceX=function(t){var e,n,r,a=i(.1);function o(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function u(){if(e){var i,o=e.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+t(e[i],i,e))?0:+a(e[i],i,e)}}return"function"!==typeof t&&(t=i(null==t?0:+t)),o.initialize=function(t){e=t,u()},o.strength=function(t){return arguments.length?(a="function"===typeof t?t:i(+t),u(),o):a},o.x=function(e){return arguments.length?(t="function"===typeof e?e:i(+e),u(),o):t},o},t.forceY=function(t){var e,n,r,a=i(.1);function o(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function u(){if(e){var i,o=e.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+t(e[i],i,e))?0:+a(e[i],i,e)}}return"function"!==typeof t&&(t=i(null==t?0:+t)),o.initialize=function(t){e=t,u()},o.strength=function(t){return arguments.length?(a="function"===typeof t?t:i(+t),u(),o):a},o.y=function(e){return arguments.length?(t="function"===typeof e?e:i(+e),u(),o):t},o},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1340),n(1113),n(1168))},2128:function(t,e,n){!function(t,e,n,r){"use strict";function i(t,e,n){var r={};return t.each(function(t){var i=t.data;n(i)&&(r[e(i)]=t)}),t.lookup=r,t}function a(t){e.Transform.call(this,null,t)}function o(t){return t.values}function u(){var t,e=[];return t={entries:function(t){return function t(n,r){if(++r>e.length)return n;var i,a=[];for(i in n)a.push({key:i,values:t(n[i],r)});return a}(function t(n,r){if(r>=e.length)return n;for(var i,a,o,u=-1,s=n.length,l=e[r++],c={},f={};++u<s;)(o=c[i=l(a=n[u])+""])?o.push(a):c[i]=[a];for(i in c)f[i]=t(c[i],r);return f}(t,0),0)},key:function(n){return e.push(n),t}}}function s(t){e.Transform.call(this,null,t)}function l(t,e){return t.parent===e.parent?1:2}a.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]},n.inherits(a,e.Transform).transform=function(t,a){a.source||n.error("Nest transform requires an upstream data source.");var s=t.generate,l=t.modified(),c=a.clone(),f=this.value;return(!f||l||a.changed())&&(f&&f.each(function(t){t.children&&e.isTuple(t.data)&&c.rem.push(t.data)}),this.value=f=r.hierarchy({values:n.array(t.keys).reduce(function(t,e){return t.key(e),t},u()).entries(c.source)},o),s&&f.each(function(t){t.children&&(t=e.ingest(t.data),c.add.push(t),c.source.push(t))}),i(f,e.tupleid,e.tupleid)),c.source.root=f,c},n.inherits(s,e.Transform).transform=function(t,r){r.source&&r.source.root||n.error(this.constructor.name+" transform requires a backing tree data source.");var i=this.layout(t.method),a=this.fields,o=r.source.root,u=t.as||a;t.field?o.sum(t.field):o.count(),t.sort&&o.sort(e.stableCompare(t.sort,function(t){return t.data})),function(t,e,n){for(var r,i=0,a=e.length;i<a;++i)(r=e[i])in n&&t[r](n[r])}(i,this.params,t),i.separation&&i.separation(!1!==t.separation?l:n.one);try{this.value=i(o)}catch(s){n.error(s)}return o.each(function(t){!function(t,e,n){for(var r=t.data,i=0,a=e.length-1;i<a;++i)r[n[i]]=t[e[i]];r[n[a]]=t.children?t.children.length:0}(t,a,u)}),r.reflow(t.modified()).modifies(u).modifies("leaf")};var c=["x","y","r","depth","children"];function f(t){s.call(this,t)}f.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:c.length,default:c}]};var h=n.inherits(f,s);h.layout=r.pack,h.params=["radius","size","padding"],h.fields=c;var d=["x0","y0","x1","y1","depth","children"];function p(t){s.call(this,t)}p.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:d.length,default:d}]};var v=n.inherits(p,s);function g(t){e.Transform.call(this,null,t)}v.layout=r.partition,v.params=["size","round","padding"],v.fields=d,g.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},n.inherits(g,e.Transform).transform=function(t,e){e.source||n.error("Stratify transform requires an upstream data source.");var a=this.value,o=t.modified(),u=e.fork(e.ALL).materialize(e.SOURCE),s=!this.value||o||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return u.source=u.source.slice(),s&&(a=u.source.length?i(r.stratify().id(t.key).parentId(t.parentKey)(u.source),t.key,n.truthy):i(r.stratify()([{}]),t.key,t.key)),u.source.root=this.value=a,u};var m={tidy:r.tree,cluster:r.cluster},y=["x","y","depth","children"];function b(t){s.call(this,t)}b.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:y.length,default:y}]};var x=n.inherits(b,s);function _(t){e.Transform.call(this,[],t)}x.layout=function(t){var e=t||"tidy";if(n.hasOwnProperty(m,e))return m[e]();n.error("Unrecognized Tree layout method: "+e)},x.params=["size","nodeSize"],x.fields=y,_.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},n.inherits(_,e.Transform).transform=function(t,r){var i=this.value,a=r.source&&r.source.root,o=r.fork(r.NO_SOURCE),u={};return a||n.error("TreeLinks transform requires a tree data source."),r.changed(r.ADD_REM)?(o.rem=i,r.visit(r.SOURCE,function(t){u[e.tupleid(t)]=1}),a.each(function(t){var n=t.data,r=t.parent&&t.parent.data;r&&u[e.tupleid(n)]&&u[e.tupleid(r)]&&o.add.push(e.ingest({source:r,target:n}))}),this.value=o.add):r.changed(r.MOD)&&(r.visit(r.MOD,function(t){u[e.tupleid(t)]=1}),i.forEach(function(t){(u[e.tupleid(t.source)]||u[e.tupleid(t.target)])&&o.mod.push(t)})),o};var w={binary:r.treemapBinary,dice:r.treemapDice,slice:r.treemapSlice,slicedice:r.treemapSliceDice,squarify:r.treemapSquarify,resquarify:r.treemapResquarify},k=["x0","y0","x1","y1","depth","children"];function A(t){s.call(this,t)}A.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:k.length,default:k}]};var E=n.inherits(A,s);E.layout=function(){var t=r.treemap();return t.ratio=function(e){var n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=function(e){n.hasOwnProperty(w,e)?t.tile(w[e]):n.error("Unrecognized Treemap layout method: "+e)},t},E.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],E.fields=k,t.nest=a,t.pack=f,t.partition=p,t.stratify=g,t.tree=b,t.treelinks=_,t.treemap=A,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1040),n(2129))},2129:function(t,e,n){!function(t){"use strict";function e(t,e){return t.parent===e.parent?1:2}function n(t,e){return t+e.x}function r(t,e){return Math.max(t,e.y)}function i(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function a(t,e){var n,r,i,a,u,c=new l(t),f=+t.value&&(c.value=t.value),h=[c];for(null==e&&(e=o);n=h.pop();)if(f&&(n.value=+n.data.value),(i=e(n.data))&&(u=i.length))for(n.children=new Array(u),a=u-1;a>=0;--a)h.push(r=n.children[a]=new l(i[a])),r.parent=n,r.depth=n.depth+1;return c.eachBefore(s)}function o(t){return t.children}function u(t){t.data=t.data.data}function s(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function l(t){this.data=t,this.depth=this.height=0,this.parent=null}l.prototype=a.prototype={constructor:l,count:function(){return this.eachAfter(i)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return a(this).eachBefore(u)}};var c=Array.prototype.slice;function f(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(c.call(t))).length,a=[];r<i;)e=t[r],n&&p(n,e)?++r:(n=g(a=h(a,e)),r=0);return n}function h(t,e){var n,r;if(v(e,t))return[e];for(n=0;n<t.length;++n)if(d(e,t[n])&&v(m(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(d(m(t[n],t[r]),e)&&d(m(t[n],e),t[r])&&d(m(t[r],e),t[n])&&v(y(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function d(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function p(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function v(t,e){for(var n=0;n<e.length;++n)if(!p(t,e[n]))return!1;return!0}function g(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return m(t[0],t[1]);case 3:return y(t[0],t[1],t[2])}var e}function m(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,u=e.r,s=a-n,l=o-r,c=u-i,f=Math.sqrt(s*s+l*l);return{x:(n+a+s/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+u)/2}}function y(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,u=e.y,s=e.r,l=n.x,c=n.y,f=n.r,h=r-o,d=r-l,p=i-u,v=i-c,g=s-a,m=f-a,y=r*r+i*i-a*a,b=y-o*o-u*u+s*s,x=y-l*l-c*c+f*f,_=d*p-h*v,w=(p*x-v*b)/(2*_)-r,k=(v*g-p*m)/_,A=(d*b-h*x)/(2*_)-i,E=(h*m-d*g)/_,M=k*k+E*E-1,S=2*(a+w*k+A*E),C=w*w+A*A-a*a,O=-(M?(S+Math.sqrt(S*S-4*M*C))/(2*M):C/S);return{x:r+w+k*O,y:i+A+E*O,r:O}}function b(t,e,n){var r,i,a,o,u=t.x-e.x,s=t.y-e.y,l=u*u+s*s;l?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(l+o-i)/(2*l),a=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x-r*u-a*s,n.y=t.y-r*s+a*u):(r=(l+i-o)/(2*l),a=Math.sqrt(Math.max(0,i/l-r*r)),n.x=e.x+r*u-a*s,n.y=e.y+r*s+a*u)):(n.x=e.x+n.r,n.y=e.y)}function x(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function _(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function w(t){this._=t,this.next=null,this.previous=null}function k(t){if(!(i=t.length))return 0;var e,n,r,i,a,o,u,s,l,c,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;b(n,e,r=t[2]),e=new w(e),n=new w(n),r=new w(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(u=3;u<i;++u){b(e._,n._,r=t[u]),r=new w(r),s=n.next,l=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(x(s._,r._)){n=s,e.next=n,n.previous=e,--u;continue t}c+=s._.r,s=s.next}else{if(x(l._,r._)){(e=l).next=n,n.previous=e,--u;continue t}h+=l._.r,l=l.previous}}while(s!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=_(e);(r=r.next)!==n;)(o=_(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=f(e),u=0;u<i;++u)(e=t[u]).x-=r.x,e.y-=r.y;return r.r}function A(t){return null==t?null:E(t)}function E(t){if("function"!==typeof t)throw new Error;return t}function M(){return 0}function S(t){return function(){return t}}function C(t){return Math.sqrt(t.value)}function O(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function D(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,u=t(n)*e||0;if(u)for(i=0;i<o;++i)r[i].r+=u;if(a=k(r),u)for(i=0;i<o;++i)r[i].r-=u;n.r=a+u}}}function F(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function T(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function N(t,e,n,r,i){for(var a,o=t.children,u=-1,s=o.length,l=t.value&&(r-e)/t.value;++u<s;)(a=o[u]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l}var j="$",R={depth:-1},P={};function z(t){return t.id}function B(t){return t.parentId}function L(t,e){return t.parent===e.parent?1:2}function q(t){var e=t.children;return e?e[0]:t.t}function I(t){var e=t.children;return e?e[e.length-1]:t.t}function U(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function W(t,e,n){return t.a.parent===e.parent?t.a:n}function H(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function V(t,e,n,r,i){for(var a,o=t.children,u=-1,s=o.length,l=t.value&&(i-n)/t.value;++u<s;)(a=o[u]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*l}H.prototype=Object.create(l.prototype);var G=(1+Math.sqrt(5))/2;function $(t,e,n,r,i,a){for(var o,u,s,l,c,f,h,d,p,v,g,m=[],y=e.children,b=0,x=0,_=y.length,w=e.value;b<_;){s=i-n,l=a-r;do{c=y[x++].value}while(!c&&x<_);for(f=h=c,g=c*c*(v=Math.max(l/s,s/l)/(w*t)),p=Math.max(h/g,g/f);x<_;++x){if(c+=u=y[x].value,u<f&&(f=u),u>h&&(h=u),g=c*c*v,(d=Math.max(h/g,g/f))>p){c-=u;break}p=d}m.push(o={value:c,dice:s<l,children:y.slice(b,x)}),o.dice?N(o,n,r,i,w?r+=l*c/w:a):V(o,n,r,w?n+=s*c/w:i,a),w-=c,b=x}return m}var Y=function t(e){function n(t,n,r,i,a){$(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(G),X=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,u,s,l,c,f=-1,h=o.length,d=t.value;++f<h;){for(s=(u=o[f]).children,l=u.value=0,c=s.length;l<c;++l)u.value+=s[l].value;u.dice?N(u,n,r,i,r+=(a-r)*u.value/d):V(u,n,r,n+=(i-n)*u.value/d,a),d-=u.value}else t._squarify=o=$(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(G);t.cluster=function(){var t=e,i=1,a=1,o=!1;function u(e){var u,s=0;e.eachAfter(function(e){var i=e.children;i?(e.x=function(t){return t.reduce(n,0)/t.length}(i),e.y=function(t){return 1+t.reduce(r,0)}(i)):(e.x=u?s+=t(e,u):0,e.y=0,u=e)});var l=function(t){for(var e;e=t.children;)t=e[0];return t}(e),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(e),f=l.x-t(l,c)/2,h=c.x+t(c,l)/2;return e.eachAfter(o?function(t){t.x=(t.x-e.x)*i,t.y=(e.y-t.y)*a}:function(t){t.x=(t.x-f)/(h-f)*i,t.y=(1-(e.y?t.y/e.y:1))*a})}return u.separation=function(e){return arguments.length?(t=e,u):t},u.size=function(t){return arguments.length?(o=!1,i=+t[0],a=+t[1],u):o?null:[i,a]},u.nodeSize=function(t){return arguments.length?(o=!0,i=+t[0],a=+t[1],u):o?[i,a]:null},u},t.hierarchy=a,t.pack=function(){var t=null,e=1,n=1,r=M;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(O(t)).eachAfter(D(r,.5)).eachBefore(F(1)):i.eachBefore(O(C)).eachAfter(D(M,1)).eachAfter(D(r,i.r/Math.min(e,n))).eachBefore(F(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=A(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:S(+t),i):r},i},t.packEnclose=f,t.packSiblings=function(t){return k(t),t},t.partition=function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&N(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,u=r.y1-n;o<i&&(i=o=(i+o)/2),u<a&&(a=u=(a+u)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=u}}(e,a)),r&&i.eachBefore(T),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},t.stratify=function(){var t=z,e=B;function n(n){var r,i,a,o,u,c,f,h=n.length,d=new Array(h),p={};for(i=0;i<h;++i)r=n[i],u=d[i]=new l(r),null!=(c=t(r,i,n))&&(c+="")&&(p[f=j+(u.id=c)]=f in p?P:u);for(i=0;i<h;++i)if(u=d[i],null!=(c=e(n[i],i,n))&&(c+="")){if(!(o=p[j+c]))throw new Error("missing: "+c);if(o===P)throw new Error("ambiguous: "+c);o.children?o.children.push(u):o.children=[u],u.parent=o}else{if(a)throw new Error("multiple roots");a=u}if(!a)throw new Error("no root");if(a.parent=R,a.eachBefore(function(t){t.depth=t.parent.depth+1,--h}).eachBefore(s),a.parent=null,h>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=E(e),n):t},n.parentId=function(t){return arguments.length?(e=E(t),n):e},n},t.tree=function(){var t=L,e=1,n=1,r=null;function i(i){var s=function(t){for(var e,n,r,i,a,o=new H(t,0),u=[o];e=u.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)u.push(n=e.children[i]=new H(r[i],i)),n.parent=e;return(o.parent=new H(null,0)).children=[o],o}(i);if(s.eachAfter(a),s.parent.m=-s.z,s.eachBefore(o),r)i.eachBefore(u);else{var l=i,c=i,f=i;i.eachBefore(function(t){t.x<l.x&&(l=t),t.x>c.x&&(c=t),t.depth>f.depth&&(f=t)});var h=l===c?1:t(l,c)/2,d=h-l.x,p=e/(c.x+h+d),v=n/(f.depth||1);i.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*v})}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,u=n,s=a.parent.children[0],l=a.m,c=o.m,f=u.m,h=s.m;u=I(u),a=q(a),u&&a;)s=q(s),(o=I(o)).a=e,(i=u.z+f-a.z-l+t(u._,a._))>0&&(U(W(u,e,r),e,i),l+=i,c+=i),f+=u.m,l+=a.m,h+=s.m,c+=o.m;u&&!I(o)&&(o.t=u,o.m+=f-c),a&&!q(s)&&(s.t=a,s.m+=l-h,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},t.treemap=function(){var t=Y,e=!1,n=1,r=1,i=[0],a=M,o=M,u=M,s=M,l=M;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(T),t}function f(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,f=e.x1-n,h=e.y1-n;f<r&&(r=f=(r+f)/2),h<c&&(c=h=(c+h)/2),e.x0=r,e.y0=c,e.x1=f,e.y1=h,e.children&&(n=i[e.depth+1]=a(e)/2,r+=l(e)-n,c+=o(e)-n,(f-=u(e)-n)<r&&(r=f=(r+f)/2),(h-=s(e)-n)<c&&(c=h=(c+h)/2),t(e,r,c,f,h))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=E(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(a="function"===typeof t?t:S(+t),c):a},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(o="function"===typeof t?t:S(+t),c):o},c.paddingRight=function(t){return arguments.length?(u="function"===typeof t?t:S(+t),c):u},c.paddingBottom=function(t){return arguments.length?(s="function"===typeof t?t:S(+t),c):s},c.paddingLeft=function(t){return arguments.length?(l="function"===typeof t?t:S(+t),c):l},c},t.treemapBinary=function(t,e,n,r,i){var a,o,u=t.children,s=u.length,l=new Array(s+1);for(l[0]=o=a=0;a<s;++a)l[a+1]=o+=u[a].value;!function t(e,n,r,i,a,o,s){if(e>=n-1){var c=u[e];return c.x0=i,c.y0=a,c.x1=o,void(c.y1=s)}for(var f=l[e],h=r/2+f,d=e+1,p=n-1;d<p;){var v=d+p>>>1;l[v]<h?d=v+1:p=v}h-l[d-1]<l[d]-h&&e+1<d&&--d;var g=l[d]-f,m=r-g;if(o-i>s-a){var y=(i*m+o*g)/r;t(e,d,g,i,a,y,s),t(d,n,m,y,a,o,s)}else{var b=(a*m+s*g)/r;t(e,d,g,i,a,o,b),t(d,n,m,i,b,o,s)}}(0,s,t.value,e,n,r,i)},t.treemapDice=N,t.treemapResquarify=X,t.treemapSlice=V,t.treemapSliceDice=function(t,e,n,r,i){(1&t.depth?V:N)(t,e,n,r,i)},t.treemapSquarify=Y,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2130:function(t,e,n){!function(t,e,n,r){"use strict";function i(t,e){var n,r,i,a,o,u,s=[],l=function(t){return t(a)};if(null==e)s.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(u=n[o=e.map(l)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(a);return s}function a(t){n.Transform.call(this,null,t)}a.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},r.inherits(a,n.Transform).transform=function(t,a){var o=a.fork(a.NO_SOURCE|a.NO_FIELDS);if(!this.value||a.changed()||t.modified()){var u=i(a.materialize(a.SOURCE).source,t.groupby),s=(t.groupby||[]).map(r.accessorName),l=s.length,c=t.as||[r.accessorName(t.x),r.accessorName(t.y)],f=[];u.forEach(function(r){e.regressionLoess(r,t.x,t.y,t.bandwidth||.3).forEach(function(t){for(var e={},i=0;i<l;++i)e[s[i]]=r.dims[i];e[c[0]]=t[0],e[c[1]]=t[1],f.push(n.ingest(e))})}),this.value&&(o.rem=this.value),this.value=o.add=o.source=f}return o};var o={linear:e.regressionLinear,log:e.regressionLog,exp:e.regressionExp,pow:e.regressionPow,quad:e.regressionQuad,poly:e.regressionPoly};function u(t){n.Transform.call(this,null,t)}u.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(o)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},r.inherits(u,n.Transform).transform=function(t,a){var u=a.fork(a.NO_SOURCE|a.NO_FIELDS);if(!this.value||a.changed()||t.modified()){var s=i(a.materialize(a.SOURCE).source,t.groupby),l=(t.groupby||[]).map(r.accessorName),c=t.method||"linear",f=t.order||3,h=function(t,e){return"poly"===t?e:"quad"===t?2:1}(c,f),d=t.as||[r.accessorName(t.x),r.accessorName(t.y)],p=o[c],v=[],g=t.extent;r.hasOwnProperty(o,c)||r.error("Invalid regression method: "+c),null!=g&&"log"===c&&g[0]<=0&&(a.dataflow.warn("Ignoring extent with values <= 0 for log regression."),g=null),s.forEach(function(i){if(i.length<=h)a.dataflow.warn("Skipping regression with more parameters than data points.");else{var o=p(i,t.x,t.y,f);if(t.params)v.push(n.ingest({keys:i.dims,coef:o.coef,rSquared:o.rSquared}));else{var u=g||r.extent(i,t.x),s=function(t){for(var e={},r=0;r<l.length;++r)e[l[r]]=i.dims[r];e[d[0]]=t[0],e[d[1]]=t[1],v.push(n.ingest(e))};"linear"===c?u.forEach(function(t){return s([t,o.predict(t)])}):e.sampleCurve(o.predict,u,25,200).forEach(s)}}}),this.value&&(u.rem=this.value),this.value=u.add=u.source=v}return u},t.loess=a,t.regression=u,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(2131),n(1045),n(1040))},2131:function(t,e,n){var r=n(212),i=n(19);!function(t,e){"use strict";var n=i.mark(a);function a(t,e){var r,a,o,u,s,l,c,f,h,d,p,v,g;return i.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=30;break}r=!0,a=!1,o=void 0,n.prev=4,u=t[Symbol.iterator]();case 6:if(r=(s=u.next()).done){n.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){n.next=11;break}return n.next=11,l;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),a=!0,o=n.t0;case 20:n.prev=20,n.prev=21,r||null==u.return||u.return();case 23:if(n.prev=23,!a){n.next=26;break}throw o;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:c=-1,f=!0,h=!1,d=void 0,n.prev=34,p=t[Symbol.iterator]();case 36:if(f=(v=p.next()).done){n.next=44;break}if(g=v.value,!(null!=(g=e(g,++c,t))&&(g=+g)>=g)){n.next=41;break}return n.next=41,g;case 41:f=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),h=!0,d=n.t1;case 50:n.prev=50,n.prev=51,f||null==p.return||p.return();case 53:if(n.prev=53,!h){n.next=56;break}throw d;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function o(t,n,r){var i=Float64Array.from(a(t,r));return i.sort(e.ascending),n.map(function(t){return e.quantileSorted(i,t)})}function u(t,e){return o(t,[.25,.5,.75],e)}function s(t,n){var r=t.length,i=e.deviation(t,n),a=u(t,n),o=(a[2]-a[0])/1.34;return 1.06*(i=Math.min(i,o)||i||Math.abs(a[0])||1)*Math.pow(r,-.2)}t.random=Math.random;var l=Math.sqrt(2*Math.PI),c=Math.SQRT2,f=NaN;function h(e,n){e=e||0,n=null==n?1:n;var r,i,a=0,o=0;if(f===f)a=f,f=NaN;else{do{r=(a=2*t.random()-1)*a+(o=2*t.random()-1)*o}while(0===r||r>1);a*=i=Math.sqrt(-2*Math.log(r)/r),f=o*i}return e+a*n}function d(t,e,n){var r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*l)}function p(t,e,n){var r,i=(t-(e=e||0))/(n=null==n?1:n),a=Math.abs(i);if(a>37)r=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(r=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),r/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):r=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-r:r}function v(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*c*function(t){var e,n=-Math.log((1-t)*(1+t));return n<6.25?e=1.6536545626831027+(e=.24015818242558962+(e=(e=(e=.00018673420803405714+(e=(e=(e=4.2347877827932404e-7+(e=(e=(e=1.0512122733215323e-9+(e=(e=(e=26335093153082323e-28+(e=(e=(e=6637638134358324e-30+(e=20972767875968562e-33+(e=(e=11157877678025181e-33+(e=128584807152564e-32+(e=(e=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?(n=Math.sqrt(n)-3.25,e=3.0838856104922208+(e=1.0052589676941592+(e=.005370914553590064+(e=(e=.002491442096107851+(e=(e=.0009532893797373805+(e=(e=24031110387097894e-21+(e=6828485145957318e-20+(e=(e=12475304481671779e-21+(e=29234449089955446e-22+(e=(e=15027403968909828e-22+(e=1.8239629214389228e-8+(e=(e=9.075656193888539e-8+(e=2.2137376921775787e-9)*n)*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=4.849906401408584+(e=1.0103004648645344+(e=(e=(e=7599527703001776e-20+(e=(e=4526062597223154e-21+(e=(e=2.2900482228026655e-7+(e=(e=2.914795345090108e-8+(e=(e=7.61570120807834e-9+(e=(e=1.5076572693500548e-9+(e=(e=-27109920616438573e-27)*n-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n):e=1/0,e*t}(2*t-1)}function g(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return h(n,r)},pdf:function(t){return d(t,n,r)},cdf:function(t){return p(t,n,r)},icdf:function(t){return v(t,n,r)}};return i.mean(t).stdev(e)}function m(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+h()*e)}function y(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;var r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*l*t)}function b(t,e,n){return p(Math.log(t),e,n)}function x(t,e,n){return Math.exp(v(t,e,n))}function _(e,n){return null==n&&(n=null==e?1:e,e=0),e+(n-e)*t.random()}function w(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function k(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function A(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function E(t,e,n,r){var i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function M(t,e,n,r){t=t.filter(function(t){var r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort(function(t,n){return e(t)-e(n)});var i,a,o,u=t.length,s=new Float64Array(u),l=new Float64Array(u),c=0,f=0,h=0,d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)o=g.value,s[c]=i=+e(o),l[c]=a=+n(o),f+=(i-f)/++c,h+=(a-h)/c}catch(y){p=!0,v=y}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}for(c=0;c<u;++c)s[c]-=f,l[c]-=h;return[s,l,f,h]}function S(t,e,n,r){var i,a,o=-1,u=!0,s=!1,l=void 0;try{for(var c,f=t[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;i=e(h),a=n(h),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}}catch(d){s=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}function C(t,e,n,r,i){var a=0,o=0;return S(t,e,n,function(t,e){var n=e-i(t),u=e-r;a+=n*n,o+=u*u}),1-a/o}function O(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){r+=(t-r)/++u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*t};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}}function D(t,e,n){var i,a,o,u,s=M(t,e,n),l=r(s,4),c=l[0],f=l[1],h=l[2],d=l[3],p=c.length,v=0,g=0,m=0,y=0,b=0;for(i=0;i<p;)a=c[i],o=f[i++],v+=((u=a*a)-v)/i,g+=(u*a-g)/i,m+=(u*u-m)/i,y+=(a*o-y)/i,b+=(u*o-b)/i;var x=m-v*v,_=v*x-g*g,w=(b*v-y*g)/_,k=(y*x-b*g)/_,A=-w*v,E=function(t){return w*(t-=h)*t+k*t+A+d};return{coef:[A-k*h+w*h*h+d,k-2*w*h,w],predict:E,rSquared:C(t,e,n,d,E)}}function F(t,e,n,r){var i,a,o,u,s=Array(t);for(i=0;i<t;++i)s[i]=0;for(i=t-1;i>=0;--i)for(o=e[i],u=1,s[i]+=o,a=1;a<=i;++a)u*=(i+1-a)/a,s[i-a]+=o*Math.pow(n,a)*u;return s[0]+=r,s}var T=2,N=1e-12;function j(t){return(t=1-t*t*t)*t*t}function R(t,e,n){var r=t[e],i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}var P=.1*Math.PI/180;function z(t,e,n){var r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}t.bandwidthNRD=s,t.bin=function(t){var e,n,r,i,a,o,u,s,l=t.maxbins||20,c=t.base||10,f=Math.log(c),h=t.divide||[5,2],d=t.extent[0],p=t.extent[1],v=t.span||p-d||Math.abs(d)||1;if(t.step)e=t.step;else if(t.steps){for(a=v/l,o=0,u=t.steps.length;o<u&&t.steps[o]<a;++o);e=t.steps[Math.max(0,o-1)]}else{for(n=Math.ceil(Math.log(l)/f),r=t.minstep||0,e=Math.max(r,Math.pow(c,Math.round(Math.log(v)/f)-n));Math.ceil(v/e)>l;)e*=c;for(o=0,u=h.length;o<u;++o)(a=e/h[o])>=r&&v/a<=l&&(e=a)}return i=(a=Math.log(e))>=0?0:1+~~(-a/f),s=Math.pow(c,-i-1),(t.nice||void 0===t.nice)&&(d=d<(a=Math.floor(d/e+s)*e)?a-e:a,p=Math.ceil(p/e)*e),{start:d,stop:p===d?d+e:p,step:e}},t.bootstrapCI=function(n,r,i,o){if(!n.length)return[void 0,void 0];var u,s,l,c,f=Float64Array.from(a(n,o)),h=f.length,d=r;for(l=0,c=Array(d);l<d;++l){for(u=0,s=0;s<h;++s)u+=f[~~(t.random()*h)];c[l]=u/h}return c.sort(e.ascending),[e.quantile(c,i/2),e.quantile(c,1-i/2)]},t.cumulativeLogNormal=b,t.cumulativeNormal=p,t.cumulativeUniform=k,t.densityLogNormal=y,t.densityNormal=d,t.densityUniform=w,t.dotbin=function(t,e,n,r){r=r||function(t){return t};for(var i,a=0,o=1,u=t.length,s=new Float64Array(u),l=r(t[0]),c=l,f=l+e;o<u;++o){if((i=r(t[o]))>=f){for(c=(l+c)/2;a<o;++a)s[a]=c;f=i+e,l=i}c=i}for(c=(l+c)/2;a<o;++a)s[a]=c;return n?function(t,e){for(var n,r,i=t.length,a=0,o=1;t[a]===t[o];)++o;for(;o<i;){for(n=o+1;t[o]===t[n];)++n;if(t[o]-t[o-1]<e){for(r=o+(a+n-o-o>>1);r<o;)t[r++]=t[o];for(;r>o;)t[r--]=t[a]}a=o,o=n}return t}(s,e+e/4):s},t.quantileLogNormal=x,t.quantileNormal=v,t.quantileUniform=A,t.quantiles=o,t.quartiles=u,t.randomInteger=function(e,n){null==n&&(n=e,e=0);var r,i,a,o={min:function(t){return arguments.length?(a=i-(r=t||0),o):r},max:function(t){return arguments.length?(a=(i=t||0)-r,o):i},sample:function(){return r+Math.floor(a*t.random())},pdf:function(t){return t===Math.floor(t)&&t>=r&&t<i?1/a:0},cdf:function(t){var e=Math.floor(t);return e<r?0:e>=i?1:(e-r+1)/a},icdf:function(t){return t>=0&&t<=1?r-1+Math.floor(t*a):NaN}};return o.min(e).max(n)},t.randomKDE=function(e,n){var r=g(),i={},a=0;return i.data=function(t){return arguments.length?(e=t,a=t?t.length:0,i.bandwidth(n)):e},i.bandwidth=function(t){return arguments.length?(!(n=t)&&e&&(n=s(e)),i):n},i.sample=function(){return e[~~(t.random()*a)]+n*r.sample()},i.pdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.pdf((t-e[o])/n);return i/n/a},i.cdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.cdf((t-e[o])/n);return i/a},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)},t.randomLCG=function(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}},t.randomLogNormal=function(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return m(n,r)},pdf:function(t){return y(t,n,r)},cdf:function(t){return b(t,n,r)},icdf:function(t){return x(t,n,r)}};return i.mean(t).stdev(e)},t.randomMixture=function(e,n){var r,i={},a=0;function o(t){var e,n=[],r=0;for(e=0;e<a;++e)r+=n[e]=null==t[e]?1:+t[e];for(e=0;e<a;++e)n[e]/=r;return n}return i.weights=function(t){return arguments.length?(r=o(n=t||[]),i):n},i.distributions=function(t){return arguments.length?(t?(a=t.length,e=t):(a=0,e=[]),i.weights(n)):e},i.sample=function(){for(var n=t.random(),i=e[a-1],o=r[0],u=0;u<a-1;o+=r[++u])if(n<o){i=e[u];break}return i.sample()},i.pdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].pdf(t);return n},i.cdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].cdf(t);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(n)},t.randomNormal=g,t.randomUniform=function(t,e){var n,r,i={min:function(t){return arguments.length?(n=t||0,i):n},max:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return _(n,r)},pdf:function(t){return w(t,n,r)},cdf:function(t){return k(t,n,r)},icdf:function(t){return A(t,n,r)}};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)},t.regressionExp=function(t,e,n){var i,a,o,u=M(t,e,n),s=r(u,4),l=s[0],c=(s[1],s[2]),f=s[3],h=0,d=0,p=0,v=0,g=0;S(t,e,n,function(t,e){i=l[g++],a=Math.log(e),h+=(e*a-h)/g,d+=((o=i*e)-d)/g,p+=(o*a-p)/g,v+=(i*o-v)/g});var m=E(d/f,h/f,p/f,v/f),y=r(m,2),b=y[0],x=y[1],_=function(t){return Math.exp(b+x*(t-c))};return{coef:[Math.exp(b-x*c),x],predict:_,rSquared:C(t,e,n,f,_)}},t.regressionLinear=O,t.regressionLoess=function(t,n,i,a){for(var o=M(t,n,i,!0),u=r(o,4),s=u[0],l=u[1],c=u[2],f=u[3],h=s.length,d=Math.max(2,~~(a*h)),p=new Float64Array(h),v=new Float64Array(h),g=new Float64Array(h).fill(1),m=-1;++m<=T;){for(var y=[0,d-1],b=0;b<h;++b){for(var x=s[b],_=y[0],w=y[1],k=x-s[_]>s[w]-x?_:w,A=0,S=0,C=0,O=0,D=0,F=1/Math.abs(s[k]-x||1),P=_;P<=w;++P){var z=s[P],B=l[P],L=j(Math.abs(x-z)*F)*g[P],q=z*L;A+=L,S+=q,C+=B*L,O+=B*q,D+=z*q}var I=E(S/A,C/A,O/A,D/A),U=r(I,2),W=U[0],H=U[1];p[b]=W+H*x,v[b]=Math.abs(l[b]-p[b]),R(s,b+1,y)}if(m===T)break;var V=e.median(v);if(Math.abs(V)<N)break;for(var G,$,Y=0;Y<h;++Y)G=v[Y]/(6*V),g[Y]=G>=1?N:($=1-G*G)*$}return function(t,e,n,r){for(var i,a=t.length,o=[],u=0,s=0,l=[];u<a;++u)i=t[u]+n,l[0]===i?l[1]+=(e[u]-l[1])/++s:(s=0,l[1]+=r,l=[i,e[u]],o.push(l));return l[1]+=r,o}(s,p,c,f)},t.regressionLog=function(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){++u,t=Math.log(t),r+=(t-r)/u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*Math.log(t)};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}},t.regressionPoly=function(t,e,n,i){if(1===i)return O(t,e,n);if(2===i)return D(t,e,n);var a,o,u,s,l,c=M(t,e,n),f=r(c,4),h=f[0],d=f[1],p=f[2],v=f[3],g=h.length,m=[],y=[],b=i+1;for(a=0;a<b;++a){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a)*d[u];for(m.push(s),l=new Float64Array(b),o=0;o<b;++o){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a+o);l[o]=s}y.push(l)}y.push(m);var x=function(t){var e,n,r,i,a,o=t.length-1,u=[];for(e=0;e<o;++e){for(i=e,n=e+1;n<o;++n)Math.abs(t[e][n])>Math.abs(t[e][i])&&(i=n);for(r=e;r<o+1;++r)a=t[r][e],t[r][e]=t[r][i],t[r][i]=a;for(n=e+1;n<o;++n)for(r=o;r>=e;r--)t[r][n]-=t[r][e]*t[e][n]/t[e][e]}for(n=o-1;n>=0;--n){for(a=0,r=n+1;r<o;++r)a+=t[r][n]*u[r];u[n]=(t[o][n]-a)/t[n][n]}return u}(y),_=function(t){t-=p;var e=v+x[0]+x[1]*t+x[2]*t*t;for(a=3;a<b;++a)e+=x[a]*Math.pow(t,a);return e};return{coef:F(b,x,-p,v),predict:_,rSquared:C(t,e,n,v,_)}},t.regressionPow=function(t,e,n){var r=0,i=0,a=0,o=0,u=0,s=0;S(t,e,n,function(t,e){var n=Math.log(t),l=Math.log(e);r+=(n-r)/++s,i+=(l-i)/s,a+=(n*l-a)/s,o+=(n*n-o)/s,u+=(e-u)/s});var l=E(r,i,a,o),c=function(t){return l[0]*Math.pow(t,l[1])};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:C(t,e,n,u,c)}},t.regressionQuad=D,t.sampleCurve=function(t,e,n,r){n=n||25,r=Math.max(n,r||200);var i=function(e){return[e,t(e)]},a=e[0],o=e[1],u=o-a,s=u/r,l=[i(a)],c=[];if(n===r){for(var f=1;f<r;++f)l.push(i(a+f/n*u));return l.push(i(o)),l}c.push(i(o));for(var h=n;--h>0;)c.push(i(a+h/n*u));for(var d=l[0],p=c[c.length-1];p;){var v=i((d[0]+p[0])/2);v[0]-d[0]>=s&&z(d,v,p)>P?c.push(v):(d=p,l.push(p),c.pop()),p=c[c.length-1]}return l},t.sampleLogNormal=m,t.sampleNormal=h,t.sampleUniform=_,t.setRandom=function(e){t.random=e},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053))},2132:function(t,e,n){!function(t,e,n,r){"use strict";function i(t){e.Transform.call(this,null,t)}i.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var a=n.inherits(i,e.Transform),o=[-1e5,-1e5,1e5,1e5];function u(t){for(var e=t[0][0],n=t[0][1],r=t.length-1;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}a.transform=function(t,e){var n=t.as||"path",i=e.source;if(!i||!i.length)return e;var a=t.size;a=a?[0,0,a[0],a[1]]:(a=t.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:o;for(var s=this.value=r.Delaunay.from(i,t.x,t.y).voronoi(a),l=0,c=i.length;l<c;++l){var f=s.cellPolygon(l);i[l][n]=f?u(f):null}return e.reflow(t.modified()).modifies(n)},t.voronoi=i,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1045),n(1040),n(2133))},2133:function(t,e,n){var r=n(19),i=n(212),a=n(15),o=n(16);!function(t){"use strict";var e=r.mark(S),n=Math.pow(2,-52),u=new Uint32Array(512),s=function(){function t(e){a(this,t);var n=e.length>>1;if(n>0&&"number"!==typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return o(t,null,[{key:"from",value:function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,i=e.length,a=new Float64Array(2*i),o=0;o<i;o++){var u=e[o];a[2*o]=n(u),a[2*o+1]=r(u)}return new t(a)}}]),o(t,[{key:"update",value:function(){for(var t=this.coords,e=this._hullPrev,r=this._hullNext,i=this._hullTri,a=this._hullHash,o=t.length>>1,u=1/0,s=1/0,c=-1/0,h=-1/0,v=0;v<o;v++){var g=t[2*v],m=t[2*v+1];g<u&&(u=g),m<s&&(s=m),g>c&&(c=g),m>h&&(h=m),this._ids[v]=v}for(var y,b,x,_=(u+c)/2,w=(s+h)/2,k=1/0,A=0;A<o;A++){var E=l(_,w,t[2*A],t[2*A+1]);E<k&&(y=A,k=E)}var M=t[2*y],S=t[2*y+1];k=1/0;for(var C=0;C<o;C++)if(C!==y){var O=l(M,S,t[2*C],t[2*C+1]);O<k&&O>0&&(b=C,k=O)}for(var D=t[2*b],F=t[2*b+1],T=1/0,N=0;N<o;N++)if(N!==y&&N!==b){var j=d(M,S,D,F,t[2*N],t[2*N+1]);j<T&&(x=N,T=j)}var R=t[2*x],P=t[2*x+1];if(T===1/0){for(var z=0;z<o;z++)this._dists[z]=t[2*z]-t[0]||t[2*z+1]-t[1];p(this._ids,this._dists,0,o-1);for(var B=new Uint32Array(o),L=0,q=0,I=-1/0;q<o;q++){var U=this._ids[q];this._dists[U]>I&&(B[L++]=U,I=this._dists[U])}return this.hull=B.subarray(0,L),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(f(M,S,D,F,R,P)){var W=b,H=D,V=F;b=x,D=R,F=P,x=W,R=H,P=V}var G=function(t,e,n,r,i,a){var o=n-t,u=r-e,s=i-t,l=a-e,c=o*o+u*u,f=s*s+l*l,h=.5/(o*l-u*s);return{x:t+(l*c-u*f)*h,y:e+(o*f-s*c)*h}}(M,S,D,F,R,P);this._cx=G.x,this._cy=G.y;for(var $=0;$<o;$++)this._dists[$]=l(t[2*$],t[2*$+1],G.x,G.y);p(this._ids,this._dists,0,o-1),this._hullStart=y;var Y=3;r[y]=e[x]=b,r[b]=e[y]=x,r[x]=e[b]=y,i[y]=0,i[b]=1,i[x]=2,a.fill(-1),a[this._hashKey(M,S)]=y,a[this._hashKey(D,F)]=b,a[this._hashKey(R,P)]=x,this.trianglesLen=0,this._addTriangle(y,b,x,-1,-1,-1);for(var X,J,Q=0;Q<this._ids.length;Q++){var Z=this._ids[Q],K=t[2*Z],tt=t[2*Z+1];if(!(Q>0&&Math.abs(K-X)<=n&&Math.abs(tt-J)<=n)&&(X=K,J=tt,Z!==y&&Z!==b&&Z!==x)){for(var et=0,nt=0,rt=this._hashKey(K,tt);nt<this._hashSize&&(-1===(et=a[(rt+nt)%this._hashSize])||et===r[et]);nt++);for(var it=et=e[et],at=void 0;at=r[it],!f(K,tt,t[2*it],t[2*it+1],t[2*at],t[2*at+1]);)if((it=at)===et){it=-1;break}if(-1!==it){var ot=this._addTriangle(it,Z,r[it],-1,-1,i[it]);i[Z]=this._legalize(ot+2),i[it]=ot,Y++;for(var ut=r[it];at=r[ut],f(K,tt,t[2*ut],t[2*ut+1],t[2*at],t[2*at+1]);)ot=this._addTriangle(ut,Z,at,i[Z],-1,i[ut]),i[Z]=this._legalize(ot+2),r[ut]=ut,Y--,ut=at;if(it===et)for(;f(K,tt,t[2*(at=e[it])],t[2*at+1],t[2*it],t[2*it+1]);)ot=this._addTriangle(at,Z,it,-1,i[it],i[at]),this._legalize(ot+2),i[at]=ot,r[it]=it,Y--,it=at;this._hullStart=e[Z]=it,r[it]=e[ut]=Z,r[Z]=ut,a[this._hashKey(K,tt)]=Z,a[this._hashKey(t[2*it],t[2*it+1])]=it}}}this.hull=new Uint32Array(Y);for(var st=0,lt=this._hullStart;st<Y;st++)this.hull[st]=lt,lt=r[lt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(t,e){return Math.floor(function(t,e){var n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(t){for(var e=this._triangles,n=this._halfedges,r=this.coords,i=0,a=0;;){var o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1!==o){var l=o-o%3,c=s+(t+1)%3,f=l+(o+2)%3,d=e[a],p=e[t],v=e[c],g=e[f];if(h(r[2*d],r[2*d+1],r[2*p],r[2*p+1],r[2*v],r[2*v+1],r[2*g],r[2*g+1])){e[t]=g,e[o]=d;var m=n[f];if(-1===m){var y=this._hullStart;do{if(this._hullTri[y]===f){this._hullTri[y]=t;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(t,m),this._link(o,n[a]),this._link(a,f);var b=l+(o+1)%3;i<u.length&&(u[i++]=b)}else{if(0===i)break;t=u[--i]}}else{if(0===i)break;t=u[--i]}}return a}},{key:"_link",value:function(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}},{key:"_addTriangle",value:function(t,e,n,r,i,a){var o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}]),t}();function l(t,e,n,r){var i=t-n,a=e-r;return i*i+a*a}function c(t,e,n,r,i,a){var o=(r-e)*(i-t),u=(n-t)*(a-e);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function f(t,e,n,r,i,a){return(c(i,a,t,e,n,r)||c(t,e,n,r,i,a)||c(n,r,i,a,t,e))<0}function h(t,e,n,r,i,a,o,u){var s=t-o,l=e-u,c=n-o,f=r-u,h=i-o,d=a-u,p=c*c+f*f,v=h*h+d*d;return s*(f*v-p*d)-l*(c*v-p*h)+(s*s+l*l)*(c*d-f*h)<0}function d(t,e,n,r,i,a){var o=n-t,u=r-e,s=i-t,l=a-e,c=o*o+u*u,f=s*s+l*l,h=.5/(o*l-u*s),d=(l*c-u*f)*h,p=(o*f-s*c)*h;return d*d+p*p}function p(t,e,n,r){if(r-n<=20)for(var i=n+1;i<=r;i++){for(var a=t[i],o=e[a],u=i-1;u>=n&&e[t[u]]>o;)t[u+1]=t[u--];t[u+1]=a}else{var s=n+1,l=r;v(t,n+r>>1,s),e[t[n]]>e[t[r]]&&v(t,n,r),e[t[s]]>e[t[r]]&&v(t,s,r),e[t[n]]>e[t[s]]&&v(t,n,s);for(var c=t[s],f=e[c];;){do{s++}while(e[t[s]]<f);do{l--}while(e[t[l]]>f);if(l<s)break;v(t,s,l)}t[n+1]=t[l],t[l]=c,r-s+1>=l-n?(p(t,e,s,r),p(t,e,n,l-1)):(p(t,e,n,l-1),p(t,e,s,r))}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t){return t[0]}function m(t){return t[1]}var y=function(){function t(){a(this,t),this._x0=this._y0=this._x1=this._y1=null,this._=""}return o(t,[{key:"moveTo",value:function(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}},{key:"arc",value:function(t,e,n){var r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),t}(),b=function(){function t(){a(this,t),this._=[]}return o(t,[{key:"moveTo",value:function(t,e){this._.push([t,e])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(t,e){this._.push([t,e])}},{key:"value",value:function(){return this._.length?this._:null}}]),t}(),x=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=i(n,4),o=r[0],u=r[1],s=r[2],l=r[3];if(a(this,t),!((s=+s)>=(o=+o))||!((l=+l)>=(u=+u)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=s,this.xmin=o,this.ymax=l,this.ymin=u,this._init()}return o(t,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var t,e,n=this.delaunay,r=n.points,i=n.hull,a=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,a.length/3*2),s=0,l=0,c=a.length;s<c;s+=3,l+=2){var f=2*a[s],h=2*a[s+1],d=2*a[s+2],p=r[f],v=r[f+1],g=r[h],m=r[h+1],y=r[d],b=r[d+1],x=g-p,_=m-v,w=y-p,k=b-v,A=x*x+_*_,E=w*w+k*k,M=2*(x*k-_*w);if(M)if(Math.abs(M)<1e-8)t=(p+y)/2,e=(v+b)/2;else{var S=1/M;t=p+(k*A-_*E)*S,e=v+(x*E-w*A)*S}else t=(p+y)/2-1e8*k,e=(v+b)/2+1e8*w;u[l]=t,u[l+1]=e}var C,O,D,F=i[i.length-1],T=4*F,N=r[2*F],j=r[2*F+1];o.fill(0);for(var R=0;R<i.length;++R)C=T,O=N,D=j,T=4*(F=i[R]),N=r[2*F],j=r[2*F+1],o[C+2]=o[T]=D-j,o[C+3]=o[T+1]=N-O}},{key:"render",value:function(t){var e=null==t?t=new y:void 0,n=this.delaunay,r=n.halfedges,i=n.inedges,a=n.hull,o=this.circumcenters,u=this.vectors;if(a.length<=1)return null;for(var s=0,l=r.length;s<l;++s){var c=r[s];if(!(c<s)){var f=2*Math.floor(s/3),h=2*Math.floor(c/3),d=o[f],p=o[f+1],v=o[h],g=o[h+1];this._renderSegment(d,p,v,g,t)}}for(var m,b=a[a.length-1],x=0;x<a.length;++x){m=b,b=a[x];var _=2*Math.floor(i[b]/3),w=o[_],k=o[_+1],A=4*m,E=this._project(w,k,u[A+2],u[A+3]);E&&this._renderSegment(w,k,E[0],E[1],t)}return e&&e.value()}},{key:"renderBounds",value:function(t){var e=null==t?t=new y:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}},{key:"renderCell",value:function(t,e){var n=null==e?e=new y:void 0,r=this._clip(t);if(null!==r){e.moveTo(r[0],r[1]);for(var i=r.length;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(var a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||e.lineTo(r[a],r[a+1]);return e.closePath(),n&&n.value()}}},{key:"cellPolygons",value:r.mark(function t(){var e,n,i,a;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.delaunay.points,n=0,i=e.length/2;case 2:if(!(n<i)){t.next=10;break}if(!(a=this.cellPolygon(n))){t.next=7;break}return t.next=7,a;case 7:++n,t.next=2;break;case 10:case"end":return t.stop()}},t,this)})},{key:"cellPolygon",value:function(t){var e=new b;return this.renderCell(t,e),e.value()}},{key:"_renderSegment",value:function(t,e,n,r,i){var a,o=this._regioncode(t,e),u=this._regioncode(n,r);0===o&&0===u?(i.moveTo(t,e),i.lineTo(n,r)):(a=this._clipSegment(t,e,n,r,o,u))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}},{key:"contains",value:function(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}},{key:"neighbors",value:r.mark(function t(e){var n,i,a,o,u,s,l,c,f,h,d,p;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this._clip(e))){t.next=42;break}i=!0,a=!1,o=void 0,t.prev=5,u=this.delaunay.neighbors(e)[Symbol.iterator]();case 7:if(i=(s=u.next()).done){t.next=28;break}if(l=s.value,!(c=this._clip(l))){t.next=25;break}f=0,h=n.length;case 12:if(!(f<h)){t.next=25;break}d=0,p=c.length;case 14:if(!(d<p)){t.next=22;break}if(n[f]!=c[d]||n[f+1]!=c[d+1]||n[(f+2)%h]!=c[(d+p-2)%p]||n[(f+3)%h]!=c[(d+p-1)%p]){t.next=19;break}return t.next=18,l;case 18:return t.abrupt("break",25);case 19:d+=2,t.next=14;break;case 22:f+=2,t.next=12;break;case 25:i=!0,t.next=7;break;case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(5),a=!0,o=t.t0;case 34:t.prev=34,t.prev=35,i||null==u.return||u.return();case 37:if(t.prev=37,!a){t.next=40;break}throw o;case 40:return t.finish(37);case 41:return t.finish(34);case 42:case"end":return t.stop()}},t,this,[[5,30,34,42],[35,,37,41]])})},{key:"_cell",value:function(t){var e=this.circumcenters,n=this.delaunay,r=n.inedges,i=n.halfedges,a=n.triangles,o=r[t];if(-1===o)return null;var u=[],s=o;do{var l=Math.floor(s/3);if(u.push(e[2*l],e[2*l+1]),a[s=s%3===2?s-2:s+1]!==t)break;s=i[s]}while(s!==o&&-1!==s);return u}},{key:"_clip",value:function(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var e=this._cell(t);if(null===e)return null;var n=this.vectors,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}},{key:"_clipFinite",value:function(t,e){for(var n,r,a,o,u,s=e.length,l=null,c=e[s-2],f=e[s-1],h=this._regioncode(c,f),d=0;d<s;d+=2)if(n=c,r=f,c=e[d],f=e[d+1],a=h,h=this._regioncode(c,f),0===a&&0===h)o=u,u=0,l?l.push(c,f):l=[c,f];else{var p=void 0,v=void 0,g=void 0,m=void 0,y=void 0;if(0===a){if(null===(p=this._clipSegment(n,r,c,f,a,h)))continue;var b=i(p,4);v=b[0],g=b[1],m=b[2],y=b[3]}else{if(null===(p=this._clipSegment(c,f,n,r,h,a)))continue;var x=i(p,4);m=x[0],y=x[1],v=x[2],g=x[3],o=u,u=this._edgecode(v,g),o&&u&&this._edge(t,o,u,l,l.length),l?l.push(v,g):l=[v,g]}o=u,u=this._edgecode(m,y),o&&u&&this._edge(t,o,u,l,l.length),l?l.push(m,y):l=[m,y]}if(l)o=u,u=this._edgecode(l[0],l[1]),o&&u&&this._edge(t,o,u,l,l.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return l}},{key:"_clipSegment",value:function(t,e,n,r,i,a){for(;;){if(0===i&&0===a)return[t,e,n,r];if(i&a)return null;var o=void 0,u=void 0,s=i||a;8&s?(o=t+(n-t)*(this.ymax-e)/(r-e),u=this.ymax):4&s?(o=t+(n-t)*(this.ymin-e)/(r-e),u=this.ymin):2&s?(u=e+(r-e)*(this.xmax-t)/(n-t),o=this.xmax):(u=e+(r-e)*(this.xmin-t)/(n-t),o=this.xmin),i?(t=o,e=u,i=this._regioncode(t,e)):(n=o,r=u,a=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(t,e,n,r,i,a){var o,u=Array.from(e);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],i,a))&&u.push(o[0],o[1]),u=this._clipFinite(t,u))for(var s,l=0,c=u.length,f=this._edgecode(u[c-2],u[c-1]);l<c;l+=2)s=f,f=this._edgecode(u[l],u[l+1]),s&&f&&(l=this._edge(t,s,f,u,l),c=u.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(t,e,n,r,i){for(;e!==n;){var a=void 0,o=void 0;switch(e){case 5:e=4;continue;case 4:e=6,a=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,a=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,a=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,a=this.xmin,o=this.ymin}r[i]===a&&r[i+1]===o||!this.contains(t,a,o)||(r.splice(i,0,a,o),i+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,l=(u+4)%r.length;(r[u]===r[s]&&r[s]===r[l]||r[u+1]===r[s+1]&&r[s+1]===r[l+1])&&(r.splice(s,2),u-=2)}return i}},{key:"_project",value:function(t,e,n,r){var i,a,o,u=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<u&&(o=this.ymin,a=t+(u=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<u&&(o=this.ymax,a=t+(u=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<u&&(a=this.xmax,o=e+(u=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<u&&(a=this.xmin,o=e+(u=i)*r)}return[a,o]}},{key:"_edgecode",value:function(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}},{key:"_regioncode",value:function(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}]),t}(),_=2*Math.PI;function w(t){return t[0]}function k(t){return t[1]}function A(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}var E=function(){function t(e){a(this,t),this._delaunator=new s(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}return o(t,null,[{key:"from",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k,i=arguments.length>3?arguments[3]:void 0;return new t("length"in e?M(e,n,r,i):Float64Array.from(S(e,n,r,i)))}}]),o(t,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){for(var e=t.triangles,n=t.coords,r=0;r<e.length;r+=3){var i=2*e[r],a=2*e[r+1],o=2*e[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},function(t,e){return e}).sort(function(t,n){return e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]});for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[e[2*n],e[2*n+1],e[2*r],e[2*r+1]],a=1e-8*Math.sqrt(Math.pow(i[3]-i[1],2)+Math.pow(i[2]-i[0],2)),o=0,u=e.length/2;o<u;++o){var l=A(e[2*o],e[2*o+1],a);e[2*o]=l[0],e[2*o+1]=l[1]}this._delaunator=new s(e)}else delete this.collinear;for(var c=this.halfedges=this._delaunator.halfedges,f=this.hull=this._delaunator.hull,h=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),p=this._hullIndex.fill(-1),v=0,g=c.length;v<g;++v){var m=h[v%3===2?v-2:v+1];-1!==c[v]&&-1!==d[m]||(d[m]=v)}for(var y=0,b=f.length;y<b;++y)p[f[y]]=y;f.length<=2&&f.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=f[0],this.triangles[1]=f[1],this.triangles[2]=f[1],d[f[0]]=1,2===f.length&&(d[f[1]]=0))}},{key:"voronoi",value:function(t){return new x(this,t)}},{key:"neighbors",value:r.mark(function t(e){var n,i,a,o,u,s,l,c,f,h,d;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.inedges,i=this.hull,a=this._hullIndex,o=this.halfedges,u=this.triangles,!(s=this.collinear)){t.next=10;break}if(!((l=s.indexOf(e))>0)){t.next=6;break}return t.next=6,s[l-1];case 6:if(!(l<s.length-1)){t.next=9;break}return t.next=9,s[l+1];case 9:return t.abrupt("return");case 10:if(-1!==(c=n[e])){t.next=13;break}return t.abrupt("return");case 13:f=c,h=-1;case 14:return t.next=16,h=u[f];case 16:if(u[f=f%3===2?f-2:f+1]===e){t.next=19;break}return t.abrupt("return");case 19:if(-1!==(f=o[f])){t.next=26;break}if((d=i[(a[e]+1)%i.length])===h){t.next=25;break}return t.next=25,d;case 25:return t.abrupt("return");case 26:if(f!==c){t.next=14;break}case 27:case"end":return t.stop()}},t,this)})},{key:"find",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!==t||(e=+e)!==e)return-1;for(var r,i=n;(r=this._step(n,t,e))>=0&&r!==n&&r!==i;)n=r;return r}},{key:"_step",value:function(t,e,n){var r=this.inedges,i=this.hull,a=this._hullIndex,o=this.halfedges,u=this.triangles,s=this.points;if(-1===r[t]||!s.length)return(t+1)%(s.length>>1);var l=t,c=Math.pow(e-s[2*t],2)+Math.pow(n-s[2*t+1],2),f=r[t],h=f;do{var d=u[h],p=Math.pow(e-s[2*d],2)+Math.pow(n-s[2*d+1],2);if(p<c&&(c=p,l=d),u[h=h%3===2?h-2:h+1]!==t)break;if(-1===(h=o[h])){if((h=i[(a[t]+1)%i.length])!==d&&Math.pow(e-s[2*h],2)+Math.pow(n-s[2*h+1],2)<c)return h;break}}while(h!==f);return l}},{key:"render",value:function(t){for(var e=null==t?t=new y:void 0,n=this.points,r=this.halfedges,i=this.triangles,a=0,o=r.length;a<o;++a){var u=r[a];if(!(u<a)){var s=2*i[a],l=2*i[u];t.moveTo(n[s],n[s+1]),t.lineTo(n[l],n[l+1])}}return this.renderHull(t),e&&e.value()}},{key:"renderPoints",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==t?t=new y:void 0,r=this.points,i=0,a=r.length;i<a;i+=2){var o=r[i],u=r[i+1];t.moveTo(o+e,u),t.arc(o,u,e,0,_)}return n&&n.value()}},{key:"renderHull",value:function(t){var e=null==t?t=new y:void 0,n=this.hull,r=this.points,i=2*n[0],a=n.length;t.moveTo(r[i],r[i+1]);for(var o=1;o<a;++o){var u=2*n[o];t.lineTo(r[u],r[u+1])}return t.closePath(),e&&e.value()}},{key:"hullPolygon",value:function(){var t=new b;return this.renderHull(t),t.value()}},{key:"renderTriangle",value:function(t,e){var n=null==e?e=new y:void 0,r=this.points,i=this.triangles,a=2*i[t*=3],o=2*i[t+1],u=2*i[t+2];return e.moveTo(r[a],r[a+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[u],r[u+1]),e.closePath(),n&&n.value()}},{key:"trianglePolygons",value:r.mark(function t(){var e,n,i;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.triangles,n=0,i=e.length/3;case 2:if(!(n<i)){t.next=8;break}return t.next=5,this.trianglePolygon(n);case 5:++n,t.next=2;break;case 8:case"end":return t.stop()}},t,this)})},{key:"trianglePolygon",value:function(t){var e=new b;return this.renderTriangle(t,e),e.value()}}]),t}();function M(t,e,n,r){for(var i=t.length,a=new Float64Array(2*i),o=0;o<i;++o){var u=t[o];a[2*o]=e.call(r,u,o,t),a[2*o+1]=n.call(r,u,o,t)}return a}function S(t,n,i,a){var o,u,s,l,c,f,h;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=0,u=!0,s=!1,l=void 0,e.prev=4,c=t[Symbol.iterator]();case 6:if(u=(f=c.next()).done){e.next=16;break}return h=f.value,e.next=10,n.call(a,h,o,t);case 10:return e.next=12,i.call(a,h,o,t);case 12:++o;case 13:u=!0,e.next=6;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),s=!0,l=e.t0;case 22:e.prev=22,e.prev=23,u||null==c.return||c.return();case 25:if(e.prev=25,!s){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:case"end":return e.stop()}},e,null,[[4,18,22,30],[23,,25,29]])}t.Delaunay=E,t.Voronoi=x,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2134:function(t,e,n){!function(t,e,n,r,i,a){"use strict";var o=Math.PI/180,u=64,s=2048;function l(){var t,n,r,i,a,o,l,g=[256,256],m=d,y=[],b=Math.random,x={};function _(t,e,n){for(var r,i,a,o,u,s=e.x,l=e.y,c=Math.sqrt(g[0]*g[0]+g[1]*g[1]),h=m(g),d=b()<.5?1:-1,p=-d;(r=h(p+=d))&&(i=~~r[0],a=~~r[1],!(Math.min(Math.abs(i),Math.abs(a))>=c));)if(e.x=s+i,e.y=l+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>g[0]||e.y+e.y1>g[1])&&(!n||!f(e,t,g[0]))&&(!n||(u=n,(o=e).x+o.x1>u[0].x&&o.x+o.x0<u[1].x&&o.y+o.y1>u[0].y&&o.y+o.y0<u[1].y))){for(var v,y=e.sprite,x=e.width>>5,_=g[0]>>5,w=e.x-(x<<4),k=127&w,A=32-k,E=e.y1-e.y0,M=(e.y+e.y0)*_+(w>>5),S=0;S<E;S++){v=0;for(var C=0;C<=x;C++)t[M+C]|=v<<A|(C<x?(v=y[S*x+C])>>>k:0);M+=_}return e.sprite=null,!0}return!1}return x.layout=function(){for(var f=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(u<<5)/e,t.height=s/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(e.canvas()),d=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((g[0]>>5)*g[1]),p=null,v=y.length,m=-1,x=[],w=y.map(function(e){return{text:t(e),font:n(e),style:i(e),weight:a(e),rotate:o(e),size:~~(r(e)+1e-14),padding:l(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:e}}).sort(function(t,e){return e.size-t.size});++m<v;){var k=w[m];k.x=g[0]*(b()+.5)>>1,k.y=g[1]*(b()+.5)>>1,c(f,k,w,m),k.hasText&&_(d,k,p)&&(x.push(k),p?h(p,k):p=[{x:k.x+k.x0,y:k.y+k.y0},{x:k.x+k.x1,y:k.y+k.y1}],k.x-=g[0]>>1,k.y-=g[1]>>1)}return x},x.words=function(t){return arguments.length?(y=t,x):y},x.size=function(t){return arguments.length?(g=[+t[0],+t[1]],x):g},x.font=function(t){return arguments.length?(n=p(t),x):n},x.fontStyle=function(t){return arguments.length?(i=p(t),x):i},x.fontWeight=function(t){return arguments.length?(a=p(t),x):a},x.rotate=function(t){return arguments.length?(o=p(t),x):o},x.text=function(e){return arguments.length?(t=p(e),x):t},x.spiral=function(t){return arguments.length?(m=v[t]||t,x):m},x.fontSize=function(t){return arguments.length?(r=p(t),x):r},x.padding=function(t){return arguments.length?(l=p(t),x):l},x.random=function(t){return arguments.length?(b=t,x):b},x}function c(t,e,n,r){if(!e.sprite){var i=t.context,a=t.ratio;i.clearRect(0,0,(u<<5)/a,s/a);var l,c,f,h,d,p=0,v=0,g=0,m=n.length;for(--r;++r<m;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,l=i.measureText(e.text+"m").width*a,f=e.size<<1,e.rotate){var y=Math.sin(e.rotate*o),b=Math.cos(e.rotate*o),x=l*b,_=l*y,w=f*b,k=f*y;l=Math.max(Math.abs(x+k),Math.abs(x-k))+31>>5<<5,f=~~Math.max(Math.abs(_+w),Math.abs(_-w))}else l=l+31>>5<<5;if(f>g&&(g=f),p+l>=u<<5&&(p=0,v+=g,g=0),v+f>=s)break;i.translate((p+(l>>1))/a,(v+(f>>1))/a),e.rotate&&i.rotate(e.rotate*o),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=l,e.height=f,e.xoff=p,e.yoff=v,e.x1=l>>1,e.y1=f>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=l}for(var A=i.getImageData(0,0,(u<<5)/a,s/a).data,E=[];--r>=0;)if((e=n[r]).hasText){for(c=(l=e.width)>>5,f=e.y1-e.y0,h=0;h<f*c;h++)E[h]=0;if(null==(p=e.xoff))return;v=e.yoff;var M=0,S=-1;for(d=0;d<f;d++){for(h=0;h<l;h++){var C=c*d+(h>>5),O=A[(v+d)*(u<<5)+(p+h)<<2]?1<<31-h%32:0;E[C]|=O,M|=O}M?S=d:(e.y0++,f--,d--,v++)}e.y1=e.y0+S,e.sprite=E.slice(0,(e.y1-e.y0)*c)}}}function f(t,e,n){n>>=5;for(var r,i=t.sprite,a=t.width>>5,o=t.x-(a<<4),u=127&o,s=32-u,l=t.y1-t.y0,c=(t.y+t.y0)*n+(o>>5),f=0;f<l;f++){r=0;for(var h=0;h<=a;h++)if((r<<s|(h<a?(r=i[f*a+h])>>>u:0))&e[c+h])return!0;c+=n}return!1}function h(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function d(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function p(t){return"function"===typeof t?t:function(){return t}}var v={archimedean:d,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}},g=["x","y","font","fontSize","fontStyle","fontWeight","angle"],m=["text","font","rotate","fontSize","fontStyle","fontWeight"];function y(t){n.Transform.call(this,l(),t)}y.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:g}]},r.inherits(y,n.Transform).transform=function(t,e){!t.size||t.size[0]&&t.size[1]||r.error("Wordcloud size dimensions must be non-zero.");var n=t.modified();if(n||e.changed(e.ADD_REM)||m.some(function(n){var i=t[n];return r.isFunction(i)&&e.modified(i.fields)})){var o,u=e.materialize(e.SOURCE).source,s=this.value,l=t.as||g,c=t.fontSize||14;if(r.isFunction(c)?o=t.fontSizeRange:c=r.constant(c),o){var f=c,h=i.scale("sqrt")().domain(r.extent(u,f)).range(o);c=function(t){return h(f(t))}}u.forEach(function(t){t[l[0]]=NaN,t[l[1]]=NaN,t[l[3]]=0});for(var d,p,v=s.words(u).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(c).random(a.random).layout(),y=s.size(),b=y[0]>>1,x=y[1]>>1,_=0,w=v.length;_<w;++_)(p=(d=v[_]).datum)[l[0]]=d.x+b,p[l[1]]=d.y+x,p[l[2]]=d.font,p[l[3]]=d.size,p[l[4]]=d.style,p[l[5]]=d.weight,p[l[6]]=d.rotate;return e.reflow(n).modifies(l)}},t.wordcloud=y,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1171),n(1045),n(1040),n(1172),n(1343))},2135:function(t,e,n){!function(t,e,n,r){"use strict";function i(t){return new Uint8Array(t)}function a(t){return new Uint16Array(t)}function o(t){return new Uint32Array(t)}function u(t,e,n){var r=(e<257?i:e<65537?a:o)(t);return n&&r.set(n),r}function s(t,e,n){var r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd:function(t,e){var n,i=this.bisect(this.range,t.value),a=t.index,o=i[0],u=i[1],s=a.length;for(n=0;n<o;++n)e[a[n]]|=r;for(n=u;n<s;++n)e[a[n]]|=r;return this}}}function l(){var t=o(0),n=[],r=0;return{insert:function(i,a,u){if(!a.length)return[];var s,l,c,f,h,d=r,p=a.length,v=Array(p),g=o(p);for(c=0;c<p;++c)v[c]=i(a[c]),g[c]=c;if(h=g,(f=v).sort.call(h,function(t,e){var n=f[t],r=f[e];return n<r?-1:n>r?1:0}),v=e.permute(f,h),d)s=n,l=t,n=Array(d+p),t=o(d+p),function(t,e,n,r,i,a,o,u,s){var l,c=0,f=0;for(l=0;c<r&&f<o;++l)e[c]<i[f]?(u[l]=e[c],s[l]=n[c++]):(u[l]=i[f],s[l]=a[f++]+t);for(;c<r;++c,++l)u[l]=e[c],s[l]=n[c];for(;f<o;++f,++l)u[l]=i[f],s[l]=a[f]+t}(u,s,l,d,v,g,p,n,t);else{if(u>0)for(c=0;c<p;++c)g[c]+=u;n=v,t=g}return r=d+p,{index:g,value:v}},remove:function(e,i){var a,o,u,s=r;for(o=0;!i[t[o]]&&o<s;++o);for(u=o;o<s;++o)i[a=t[o]]||(t[u]=a,n[u]=n[o],++u);r=s-e},bisect:function(t,i){var a;return i?a=i.length:(i=n,a=r),[e.bisectLeft(i,t[0],0,a),e.bisectRight(i,t[1],0,a)]},reindex:function(e){for(var n=0,i=r;n<i;++n)t[n]=e[t[n]]},index:function(){return t},size:function(){return r}}}function c(t){n.Transform.call(this,function(){var t=8,e=[],n=o(0),r=u(0,t),i=u(0,t);return{data:function(){return e},seen:function(){return n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length)},add:function(t){for(var n,r=0,i=e.length,a=t.length;r<a;++r)(n=t[r])._index=i++,e.push(n)},remove:function(t,n){var a,o,u,s=e.length,l=Array(s-t),c=e;for(o=0;!n[o]&&o<s;++o)l[o]=e[o],c[o]=o;for(u=o;o<s;++o)a=e[o],n[o]?c[o]=-1:(c[o]=u,r[u]=r[o],i[u]=i[o],l[u]=a,a._index=u++),r[o]=0;return e=l,c},size:function(){return e.length},curr:function(){return r},prev:function(){return i},reset:function(t){i[t]=r[t]},all:function(){return t<257?255:t<65537?65535:4294967295},set:function(t,e){r[t]|=e},clear:function(t,e){r[t]&=~e},resize:function(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=u(e,t,r),i=u(e,t))}}}(),t),this._indices=null,this._dims=null}c.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var f=r.inherits(c,n.Transform);function h(t){n.Transform.call(this,null,t)}f.transform=function(t,e){return this._dims?t.modified("fields")||t.fields.some(function(t){return e.modified(t.fields)})?this.reinit(t,e):this.eval(t,e):this.init(t,e)},f.init=function(t,e){for(var n,r,i=t.fields,a=t.query,o=this._indices={},u=this._dims=[],c=a.length,f=0;f<c;++f)r=o[n=i[f].fname]||(o[n]=l()),u.push(s(r,f,a[f]));return this.eval(t,e)},f.reinit=function(t,e){var n,r,i,a,o,u,c,f,h,d=e.materialize().fork(),p=t.fields,v=t.query,g=this._indices,m=this._dims,y=this.value,b=y.curr(),x=y.prev(),_=y.all(),w=d.rem=d.add,k=d.mod,A=v.length,E={};if(x.set(b),e.rem.length&&(o=this.remove(t,e,d)),e.add.length&&y.add(e.add),e.mod.length)for(u={},c=0,f=(a=e.mod).length;c<f;++c)u[a[c]._index]=1;for(c=0;c<A;++c)h=p[c],(!m[c]||t.modified("fields",c)||e.modified(h.fields))&&((n=E[i=h.fname])||(g[i]=r=l(),E[i]=n=r.insert(h,e.source,0)),m[c]=s(r,c,v[c]).onAdd(n,b));for(c=0,f=y.data().length;c<f;++c)o[c]||(x[c]!==b[c]?w.push(c):u[c]&&b[c]!==_&&k.push(c));return y.mask=(1<<A)-1,d},f.eval=function(t,e){var n=e.materialize().fork(),r=this._dims.length,i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},f.insert=function(t,e,n){var r,i,a,o=e.add,u=this.value,s=this._dims,l=this._indices,c=t.fields,f={},h=n.add,d=u.size(),p=d+o.length,v=s.length;u.resize(p,v),u.add(o);var g=u.curr(),m=u.prev(),y=u.all();for(r=0;r<v;++r)a=f[i=c[r].fname]||(f[i]=l[i].insert(c[r],o,d)),s[r].onAdd(a,g);for(;d<p;++d)m[d]=y,g[d]!==y&&h.push(d)},f.modify=function(t,e){var n,r,i,a=e.mod,o=this.value,u=o.curr(),s=o.all(),l=t.mod;for(n=0,r=l.length;n<r;++n)u[i=l[n]._index]!==s&&a.push(i)},f.remove=function(t,e,n){var r,i,a,o,u=this._indices,s=this.value,l=s.curr(),c=s.prev(),f=s.all(),h={},d=n.rem,p=e.rem;for(r=0,i=p.length;r<i;++r)h[a=p[r]._index]=1,c[a]=o=l[a],l[a]=f,o!==f&&d.push(a);for(a in u)u[a].remove(i,h);return this.reindex(e,i,h),h},f.reindex=function(t,e,n){var r=this._indices,i=this.value;t.runAfter(function(){var t=i.remove(e,n);for(var a in r)r[a].reindex(t)})},f.update=function(t,e,n){var r,i,a=this._dims,o=t.query,u=e.stamp,s=a.length,l=0;for(n.filters=0,i=0;i<s;++i)t.modified("query",i)&&(r=i,++l);if(1===l)l=a[r].one,this.incrementOne(a[r],o[r],n.add,n.rem);else for(i=0,l=0;i<s;++i)t.modified("query",i)&&(l|=a[i].one,this.incrementAll(a[i],o[i],u,n.add),n.rem=n.add);return l},f.incrementAll=function(t,e,n,r){var i,a,o,u=this.value,s=u.seen(),l=u.curr(),c=u.prev(),f=t.index(),h=t.bisect(t.range),d=t.bisect(e),p=d[0],v=d[1],g=h[0],m=h[1],y=t.one;if(p<g)for(i=p,a=Math.min(g,v);i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;else if(p>g)for(i=g,a=Math.min(p,m);i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;if(v>m)for(i=Math.max(p,m),a=v;i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;else if(v<m)for(i=Math.max(g,v),a=m;i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;t.range=e.slice()},f.incrementOne=function(t,e,n,r){var i,a,o,u=this.value.curr(),s=t.index(),l=t.bisect(t.range),c=t.bisect(e),f=c[0],h=c[1],d=l[0],p=l[1],v=t.one;if(f<d)for(i=f,a=Math.min(d,h);i<a;++i)u[o=s[i]]^=v,n.push(o);else if(f>d)for(i=d,a=Math.min(f,p);i<a;++i)u[o=s[i]]^=v,r.push(o);if(h>p)for(i=Math.max(f,p),a=h;i<a;++i)u[o=s[i]]^=v,n.push(o);else if(h<p)for(i=Math.max(d,h),a=p;i<a;++i)u[o=s[i]]^=v,r.push(o);t.range=e.slice()},h.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},r.inherits(h,n.Transform).transform=function(t,e){var n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;var a=e.fork(e.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=function(t){return u[t]&n?null:o[t]};return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,function(t){var e=u[t]&n;return!e&&e^s[t]&n?o[t]:null}),a.filter(a.REM,function(t){var e=u[t]&n;return!e||e^e^s[t]&n?null:o[t]})):(a.filter(a.ADD,l),a.filter(a.REM,function(t){return(u[t]&n)===i?o[t]:null})),a.filter(a.SOURCE,function(t){return l(t._index)})},t.crossfilter=c,t.resolvefilter=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053),n(1045),n(1040))},2136:function(t,e,n){var r=n(212),i=n(19);!function(t,e){"use strict";var n=i.mark(a);function a(t,e){var r,a,o,u,s,l,c,f,h,d,p,v,g;return i.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=30;break}r=!0,a=!1,o=void 0,n.prev=4,u=t[Symbol.iterator]();case 6:if(r=(s=u.next()).done){n.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){n.next=11;break}return n.next=11,l;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),a=!0,o=n.t0;case 20:n.prev=20,n.prev=21,r||null==u.return||u.return();case 23:if(n.prev=23,!a){n.next=26;break}throw o;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:c=-1,f=!0,h=!1,d=void 0,n.prev=34,p=t[Symbol.iterator]();case 36:if(f=(v=p.next()).done){n.next=44;break}if(g=v.value,!(null!=(g=e(g,++c,t))&&(g=+g)>=g)){n.next=41;break}return n.next=41,g;case 41:f=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),h=!0,d=n.t1;case 50:n.prev=50,n.prev=51,f||null==p.return||p.return();case 53:if(n.prev=53,!h){n.next=56;break}throw d;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function o(t,n,r){var i=Float64Array.from(a(t,r));return i.sort(e.ascending),n.map(function(t){return e.quantileSorted(i,t)})}function u(t,e){return o(t,[.25,.5,.75],e)}function s(t,n){var r=t.length,i=e.deviation(t,n),a=u(t,n),o=(a[2]-a[0])/1.34;return 1.06*(i=Math.min(i,o)||i||Math.abs(a[0])||1)*Math.pow(r,-.2)}t.random=Math.random;var l=Math.sqrt(2*Math.PI),c=Math.SQRT2,f=NaN;function h(e,n){e=e||0,n=null==n?1:n;var r,i,a=0,o=0;if(f===f)a=f,f=NaN;else{do{r=(a=2*t.random()-1)*a+(o=2*t.random()-1)*o}while(0===r||r>1);a*=i=Math.sqrt(-2*Math.log(r)/r),f=o*i}return e+a*n}function d(t,e,n){var r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*l)}function p(t,e,n){var r,i=(t-(e=e||0))/(n=null==n?1:n),a=Math.abs(i);if(a>37)r=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(r=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),r/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):r=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-r:r}function v(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*c*function(t){var e,n=-Math.log((1-t)*(1+t));return n<6.25?e=1.6536545626831027+(e=.24015818242558962+(e=(e=(e=.00018673420803405714+(e=(e=(e=4.2347877827932404e-7+(e=(e=(e=1.0512122733215323e-9+(e=(e=(e=26335093153082323e-28+(e=(e=(e=6637638134358324e-30+(e=20972767875968562e-33+(e=(e=11157877678025181e-33+(e=128584807152564e-32+(e=(e=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?(n=Math.sqrt(n)-3.25,e=3.0838856104922208+(e=1.0052589676941592+(e=.005370914553590064+(e=(e=.002491442096107851+(e=(e=.0009532893797373805+(e=(e=24031110387097894e-21+(e=6828485145957318e-20+(e=(e=12475304481671779e-21+(e=29234449089955446e-22+(e=(e=15027403968909828e-22+(e=1.8239629214389228e-8+(e=(e=9.075656193888539e-8+(e=2.2137376921775787e-9)*n)*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=4.849906401408584+(e=1.0103004648645344+(e=(e=(e=7599527703001776e-20+(e=(e=4526062597223154e-21+(e=(e=2.2900482228026655e-7+(e=(e=2.914795345090108e-8+(e=(e=7.61570120807834e-9+(e=(e=1.5076572693500548e-9+(e=(e=-27109920616438573e-27)*n-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n):e=1/0,e*t}(2*t-1)}function g(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return h(n,r)},pdf:function(t){return d(t,n,r)},cdf:function(t){return p(t,n,r)},icdf:function(t){return v(t,n,r)}};return i.mean(t).stdev(e)}function m(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+h()*e)}function y(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;var r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*l*t)}function b(t,e,n){return p(Math.log(t),e,n)}function x(t,e,n){return Math.exp(v(t,e,n))}function _(e,n){return null==n&&(n=null==e?1:e,e=0),e+(n-e)*t.random()}function w(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function k(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function A(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function E(t,e,n,r){var i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function M(t,e,n,r){t=t.filter(function(t){var r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort(function(t,n){return e(t)-e(n)});var i,a,o,u=t.length,s=new Float64Array(u),l=new Float64Array(u),c=0,f=0,h=0,d=!0,p=!1,v=void 0;try{for(var g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)o=g.value,s[c]=i=+e(o),l[c]=a=+n(o),f+=(i-f)/++c,h+=(a-h)/c}catch(y){p=!0,v=y}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}for(c=0;c<u;++c)s[c]-=f,l[c]-=h;return[s,l,f,h]}function S(t,e,n,r){var i,a,o=-1,u=!0,s=!1,l=void 0;try{for(var c,f=t[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;i=e(h),a=n(h),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}}catch(d){s=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}function C(t,e,n,r,i){var a=0,o=0;return S(t,e,n,function(t,e){var n=e-i(t),u=e-r;a+=n*n,o+=u*u}),1-a/o}function O(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){r+=(t-r)/++u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*t};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}}function D(t,e,n){var i,a,o,u,s=M(t,e,n),l=r(s,4),c=l[0],f=l[1],h=l[2],d=l[3],p=c.length,v=0,g=0,m=0,y=0,b=0;for(i=0;i<p;)a=c[i],o=f[i++],v+=((u=a*a)-v)/i,g+=(u*a-g)/i,m+=(u*u-m)/i,y+=(a*o-y)/i,b+=(u*o-b)/i;var x=m-v*v,_=v*x-g*g,w=(b*v-y*g)/_,k=(y*x-b*g)/_,A=-w*v,E=function(t){return w*(t-=h)*t+k*t+A+d};return{coef:[A-k*h+w*h*h+d,k-2*w*h,w],predict:E,rSquared:C(t,e,n,d,E)}}function F(t,e,n,r){var i,a,o,u,s=Array(t);for(i=0;i<t;++i)s[i]=0;for(i=t-1;i>=0;--i)for(o=e[i],u=1,s[i]+=o,a=1;a<=i;++a)u*=(i+1-a)/a,s[i-a]+=o*Math.pow(n,a)*u;return s[0]+=r,s}var T=2,N=1e-12;function j(t){return(t=1-t*t*t)*t*t}function R(t,e,n){var r=t[e],i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}var P=.1*Math.PI/180;function z(t,e,n){var r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}t.bandwidthNRD=s,t.bin=function(t){var e,n,r,i,a,o,u,s,l=t.maxbins||20,c=t.base||10,f=Math.log(c),h=t.divide||[5,2],d=t.extent[0],p=t.extent[1],v=t.span||p-d||Math.abs(d)||1;if(t.step)e=t.step;else if(t.steps){for(a=v/l,o=0,u=t.steps.length;o<u&&t.steps[o]<a;++o);e=t.steps[Math.max(0,o-1)]}else{for(n=Math.ceil(Math.log(l)/f),r=t.minstep||0,e=Math.max(r,Math.pow(c,Math.round(Math.log(v)/f)-n));Math.ceil(v/e)>l;)e*=c;for(o=0,u=h.length;o<u;++o)(a=e/h[o])>=r&&v/a<=l&&(e=a)}return i=(a=Math.log(e))>=0?0:1+~~(-a/f),s=Math.pow(c,-i-1),(t.nice||void 0===t.nice)&&(d=d<(a=Math.floor(d/e+s)*e)?a-e:a,p=Math.ceil(p/e)*e),{start:d,stop:p===d?d+e:p,step:e}},t.bootstrapCI=function(n,r,i,o){if(!n.length)return[void 0,void 0];var u,s,l,c,f=Float64Array.from(a(n,o)),h=f.length,d=r;for(l=0,c=Array(d);l<d;++l){for(u=0,s=0;s<h;++s)u+=f[~~(t.random()*h)];c[l]=u/h}return c.sort(e.ascending),[e.quantile(c,i/2),e.quantile(c,1-i/2)]},t.cumulativeLogNormal=b,t.cumulativeNormal=p,t.cumulativeUniform=k,t.densityLogNormal=y,t.densityNormal=d,t.densityUniform=w,t.dotbin=function(t,e,n,r){r=r||function(t){return t};for(var i,a=0,o=1,u=t.length,s=new Float64Array(u),l=r(t[0]),c=l,f=l+e;o<u;++o){if((i=r(t[o]))>=f){for(c=(l+c)/2;a<o;++a)s[a]=c;f=i+e,l=i}c=i}for(c=(l+c)/2;a<o;++a)s[a]=c;return n?function(t,e){for(var n,r,i=t.length,a=0,o=1;t[a]===t[o];)++o;for(;o<i;){for(n=o+1;t[o]===t[n];)++n;if(t[o]-t[o-1]<e){for(r=o+(a+n-o-o>>1);r<o;)t[r++]=t[o];for(;r>o;)t[r--]=t[a]}a=o,o=n}return t}(s,e+e/4):s},t.quantileLogNormal=x,t.quantileNormal=v,t.quantileUniform=A,t.quantiles=o,t.quartiles=u,t.randomInteger=function(e,n){null==n&&(n=e,e=0);var r,i,a,o={min:function(t){return arguments.length?(a=i-(r=t||0),o):r},max:function(t){return arguments.length?(a=(i=t||0)-r,o):i},sample:function(){return r+Math.floor(a*t.random())},pdf:function(t){return t===Math.floor(t)&&t>=r&&t<i?1/a:0},cdf:function(t){var e=Math.floor(t);return e<r?0:e>=i?1:(e-r+1)/a},icdf:function(t){return t>=0&&t<=1?r-1+Math.floor(t*a):NaN}};return o.min(e).max(n)},t.randomKDE=function(e,n){var r=g(),i={},a=0;return i.data=function(t){return arguments.length?(e=t,a=t?t.length:0,i.bandwidth(n)):e},i.bandwidth=function(t){return arguments.length?(!(n=t)&&e&&(n=s(e)),i):n},i.sample=function(){return e[~~(t.random()*a)]+n*r.sample()},i.pdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.pdf((t-e[o])/n);return i/n/a},i.cdf=function(t){for(var i=0,o=0;o<a;++o)i+=r.cdf((t-e[o])/n);return i/a},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)},t.randomLCG=function(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}},t.randomLogNormal=function(t,e){var n,r,i={mean:function(t){return arguments.length?(n=t||0,i):n},stdev:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return m(n,r)},pdf:function(t){return y(t,n,r)},cdf:function(t){return b(t,n,r)},icdf:function(t){return x(t,n,r)}};return i.mean(t).stdev(e)},t.randomMixture=function(e,n){var r,i={},a=0;function o(t){var e,n=[],r=0;for(e=0;e<a;++e)r+=n[e]=null==t[e]?1:+t[e];for(e=0;e<a;++e)n[e]/=r;return n}return i.weights=function(t){return arguments.length?(r=o(n=t||[]),i):n},i.distributions=function(t){return arguments.length?(t?(a=t.length,e=t):(a=0,e=[]),i.weights(n)):e},i.sample=function(){for(var n=t.random(),i=e[a-1],o=r[0],u=0;u<a-1;o+=r[++u])if(n<o){i=e[u];break}return i.sample()},i.pdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].pdf(t);return n},i.cdf=function(t){for(var n=0,i=0;i<a;++i)n+=r[i]*e[i].cdf(t);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(n)},t.randomNormal=g,t.randomUniform=function(t,e){var n,r,i={min:function(t){return arguments.length?(n=t||0,i):n},max:function(t){return arguments.length?(r=null==t?1:t,i):r},sample:function(){return _(n,r)},pdf:function(t){return w(t,n,r)},cdf:function(t){return k(t,n,r)},icdf:function(t){return A(t,n,r)}};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)},t.regressionExp=function(t,e,n){var i,a,o,u=M(t,e,n),s=r(u,4),l=s[0],c=(s[1],s[2]),f=s[3],h=0,d=0,p=0,v=0,g=0;S(t,e,n,function(t,e){i=l[g++],a=Math.log(e),h+=(e*a-h)/g,d+=((o=i*e)-d)/g,p+=(o*a-p)/g,v+=(i*o-v)/g});var m=E(d/f,h/f,p/f,v/f),y=r(m,2),b=y[0],x=y[1],_=function(t){return Math.exp(b+x*(t-c))};return{coef:[Math.exp(b-x*c),x],predict:_,rSquared:C(t,e,n,f,_)}},t.regressionLinear=O,t.regressionLoess=function(t,n,i,a){for(var o=M(t,n,i,!0),u=r(o,4),s=u[0],l=u[1],c=u[2],f=u[3],h=s.length,d=Math.max(2,~~(a*h)),p=new Float64Array(h),v=new Float64Array(h),g=new Float64Array(h).fill(1),m=-1;++m<=T;){for(var y=[0,d-1],b=0;b<h;++b){for(var x=s[b],_=y[0],w=y[1],k=x-s[_]>s[w]-x?_:w,A=0,S=0,C=0,O=0,D=0,F=1/Math.abs(s[k]-x||1),P=_;P<=w;++P){var z=s[P],B=l[P],L=j(Math.abs(x-z)*F)*g[P],q=z*L;A+=L,S+=q,C+=B*L,O+=B*q,D+=z*q}var I=E(S/A,C/A,O/A,D/A),U=r(I,2),W=U[0],H=U[1];p[b]=W+H*x,v[b]=Math.abs(l[b]-p[b]),R(s,b+1,y)}if(m===T)break;var V=e.median(v);if(Math.abs(V)<N)break;for(var G,$,Y=0;Y<h;++Y)G=v[Y]/(6*V),g[Y]=G>=1?N:($=1-G*G)*$}return function(t,e,n,r){for(var i,a=t.length,o=[],u=0,s=0,l=[];u<a;++u)i=t[u]+n,l[0]===i?l[1]+=(e[u]-l[1])/++s:(s=0,l[1]+=r,l=[i,e[u]],o.push(l));return l[1]+=r,o}(s,p,c,f)},t.regressionLog=function(t,e,n){var r=0,i=0,a=0,o=0,u=0;S(t,e,n,function(t,e){++u,t=Math.log(t),r+=(t-r)/u,i+=(e-i)/u,a+=(t*e-a)/u,o+=(t*t-o)/u});var s=E(r,i,a,o),l=function(t){return s[0]+s[1]*Math.log(t)};return{coef:s,predict:l,rSquared:C(t,e,n,i,l)}},t.regressionPoly=function(t,e,n,i){if(1===i)return O(t,e,n);if(2===i)return D(t,e,n);var a,o,u,s,l,c=M(t,e,n),f=r(c,4),h=f[0],d=f[1],p=f[2],v=f[3],g=h.length,m=[],y=[],b=i+1;for(a=0;a<b;++a){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a)*d[u];for(m.push(s),l=new Float64Array(b),o=0;o<b;++o){for(u=0,s=0;u<g;++u)s+=Math.pow(h[u],a+o);l[o]=s}y.push(l)}y.push(m);var x=function(t){var e,n,r,i,a,o=t.length-1,u=[];for(e=0;e<o;++e){for(i=e,n=e+1;n<o;++n)Math.abs(t[e][n])>Math.abs(t[e][i])&&(i=n);for(r=e;r<o+1;++r)a=t[r][e],t[r][e]=t[r][i],t[r][i]=a;for(n=e+1;n<o;++n)for(r=o;r>=e;r--)t[r][n]-=t[r][e]*t[e][n]/t[e][e]}for(n=o-1;n>=0;--n){for(a=0,r=n+1;r<o;++r)a+=t[r][n]*u[r];u[n]=(t[o][n]-a)/t[n][n]}return u}(y),_=function(t){t-=p;var e=v+x[0]+x[1]*t+x[2]*t*t;for(a=3;a<b;++a)e+=x[a]*Math.pow(t,a);return e};return{coef:F(b,x,-p,v),predict:_,rSquared:C(t,e,n,v,_)}},t.regressionPow=function(t,e,n){var r=0,i=0,a=0,o=0,u=0,s=0;S(t,e,n,function(t,e){var n=Math.log(t),l=Math.log(e);r+=(n-r)/++s,i+=(l-i)/s,a+=(n*l-a)/s,o+=(n*n-o)/s,u+=(e-u)/s});var l=E(r,i,a,o),c=function(t){return l[0]*Math.pow(t,l[1])};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:C(t,e,n,u,c)}},t.regressionQuad=D,t.sampleCurve=function(t,e,n,r){n=n||25,r=Math.max(n,r||200);var i=function(e){return[e,t(e)]},a=e[0],o=e[1],u=o-a,s=u/r,l=[i(a)],c=[];if(n===r){for(var f=1;f<r;++f)l.push(i(a+f/n*u));return l.push(i(o)),l}c.push(i(o));for(var h=n;--h>0;)c.push(i(a+h/n*u));for(var d=l[0],p=c[c.length-1];p;){var v=i((d[0]+p[0])/2);v[0]-d[0]>=s&&z(d,v,p)>P?c.push(v):(d=p,l.push(p),c.pop()),p=c[c.length-1]}return l},t.sampleLogNormal=m,t.sampleNormal=h,t.sampleUniform=_,t.setRandom=function(e){t.random=e},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1053))},2137:function(t,e,n){!function(t){"use strict";var e={},n={},r=34,i=10,a=13;function o(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function u(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function s(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function l(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+s(-e,6):e>9999?"+"+s(e,6):s(e,4))+"-"+s(t.getUTCMonth()+1,2)+"-"+s(t.getUTCDate(),2)+(a?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"."+s(a,3)+"Z":i?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"Z":r||n?"T"+s(n,2)+":"+s(r,2)+"Z":"")}function c(t){var s=new RegExp('["'+t+"\n\r]"),c=t.charCodeAt(0);function f(t,o){var u,s=[],l=t.length,f=0,h=0,d=l<=0,p=!1;function v(){if(d)return n;if(p)return p=!1,e;var o,u,s=f;if(t.charCodeAt(s)===r){for(;f++<l&&t.charCodeAt(f)!==r||t.charCodeAt(++f)===r;);return(o=f)>=l?d=!0:(u=t.charCodeAt(f++))===i?p=!0:u===a&&(p=!0,t.charCodeAt(f)===i&&++f),t.slice(s+1,o-1).replace(/""/g,'"')}for(;f<l;){if((u=t.charCodeAt(o=f++))===i)p=!0;else if(u===a)p=!0,t.charCodeAt(f)===i&&++f;else if(u!==c)continue;return t.slice(s,o)}return d=!0,t.slice(s,l)}for(t.charCodeAt(l-1)===i&&--l,t.charCodeAt(l-1)===a&&--l;(u=v())!==n;){for(var g=[];u!==e&&u!==n;)g.push(u),u=v();o&&null==(g=o(g,h++))||s.push(g)}return s}function h(e,n){return e.map(function(e){return n.map(function(t){return p(e[t])}).join(t)})}function d(e){return e.map(p).join(t)}function p(t){return null==t?"":t instanceof Date?l(t):s.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,i=f(t,function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=o(t);return function(r,i){return e(n(r),i,t)}}(t,e):o(t)});return i.columns=r||[],i},parseRows:f,format:function(e,n){return null==n&&(n=u(e)),[n.map(p).join(t)].concat(h(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=u(t)),h(t,e).join("\n")},formatRows:function(t){return t.map(d).join("\n")},formatRow:d,formatValue:p}}var f=c(","),h=f.parse,d=f.parseRows,p=f.format,v=f.formatBody,g=f.formatRows,m=f.formatRow,y=f.formatValue,b=c("\t"),x=b.parse,_=b.parseRows,w=b.format,k=b.formatBody,A=b.formatRows,E=b.formatRow,M=b.formatValue,S=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();t.autoType=function(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;S&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t},t.csvFormat=p,t.csvFormatBody=v,t.csvFormatRow=m,t.csvFormatRows=g,t.csvFormatValue=y,t.csvParse=h,t.csvParseRows=d,t.dsvFormat=c,t.tsvFormat=w,t.tsvFormatBody=k,t.tsvFormatRow=E,t.tsvFormatRows=A,t.tsvFormatValue=M,t.tsvParse=x,t.tsvParseRows=_,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2138:function(t,e,n){!function(t,e,n,r,i,a){"use strict";function o(t){this.clear(),t&&this.union(t)}var u=o.prototype;u.clone=function(){return new o(this)},u.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},u.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},u.equals=function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},u.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},u.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},u.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},u.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},u.scale=function(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},u.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},u.rotate=function(t,e,n){var r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},u.rotatedPoints=function(t,e,n){var r=this.x1,i=this.y1,a=this.x2,o=this.y2,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,c=n-e*s-n*u;return[u*r-s*i+l,s*r+u*i+c,u*r-s*o+l,s*r+u*o+c,u*a-s*i+l,s*a+u*i+c,u*a-s*o+l,s*a+u*o+c]},u.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},u.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},u.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},u.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},u.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},u.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},u.width=function(){return this.x2-this.x1},u.height=function(){return this.y2-this.y1};var s=0,l="p_";function c(t){return t&&t.gradient}function f(t,e,n){var r=t.id,i=t.gradient,a="radial"===i?l:"";return r||(r=t.id="gradient_"+s++,"radial"===i?(t.x1=h(t.x1,.5),t.y1=h(t.y1,.5),t.r1=h(t.r1,0),t.x2=h(t.x2,.5),t.y2=h(t.y2,.5),t.r2=h(t.r2,.5),a=l):(t.x1=h(t.x1,0),t.y1=h(t.y1,0),t.x2=h(t.x2,1),t.y2=h(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+a+r+")"}function h(t,e){return null!=t?t:e}function d(t){this.mark=t,this.bounds=this.bounds||new o}function p(t){d.call(this,t),this.items=this.items||[]}function v(t){this._pending=0,this._loader=t||r.loader()}e.inherits(p,d);var g=v.prototype;function m(t){t._pending+=1}function y(t){t._pending-=1}g.pending=function(){return this._pending},g.sanitizeURL=function(t){var e=this;return m(e),e._loader.sanitize(t,{context:"href"}).then(function(t){return y(e),t}).catch(function(){return y(e),null})},g.loadImage=function(t){var r=this,i=n.image();return m(r),r._loader.sanitize(t,{context:"image"}).then(function(t){var n=t.href;if(!n||!i)throw{url:n};var a=new i,o=e.hasOwnProperty(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(a.crossOrigin=o),a.onload=function(){return y(r)},a.onerror=function(){return y(r)},a.src=n,a}).catch(function(t){return y(r),{complete:!1,width:0,height:0,src:t&&t.url||""}})},g.ready=function(){var t=this;return new Promise(function(e){!function n(r){t.pending()?setTimeout(function(){n(!0)},10):e(r)}(!1)})};var b={basis:{curve:i.curveBasis},"basis-closed":{curve:i.curveBasisClosed},"basis-open":{curve:i.curveBasisOpen},bundle:{curve:i.curveBundle,tension:"beta",value:.85},cardinal:{curve:i.curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:i.curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:i.curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:i.curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:i.curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:i.curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:i.curveLinear},"linear-closed":{curve:i.curveLinearClosed},monotone:{horizontal:i.curveMonotoneY,vertical:i.curveMonotoneX},natural:{curve:i.curveNatural},step:{curve:i.curveStep},"step-after":{curve:i.curveStepAfter},"step-before":{curve:i.curveStepBefore}};function x(t,n,r){var i=e.hasOwnProperty(b,t)&&b[t],a=null;return i&&(a=i.curve||i[n||"vertical"],i.tension&&null!=r&&(a=a[i.tension](r))),a}var _={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},w=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function k(t){var e,n,r,i,a,o,u,s,l,c,f,h=[];for(s=0,c=(e=t.slice().replace(w[0],"###$1").split(w[1]).slice(1)).length;s<c;++s){for(r=(n=e[s]).slice(1).trim().replace(w[2],"$1###$2").split(w[3]),i=[o=n.charAt(0)],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(u=_[o.toLowerCase()],i.length-1>u)for(l=1,f=i.length;l<f;l+=u)h.push([o].concat(i.slice(l,l+u)));else h.push(i)}return h}var A=Math.PI/180,E=1e-14,M=Math.PI/2,S=2*Math.PI,C=Math.sqrt(3)/2,O={},D={},F=[].join;function T(t){var e=F.call(t);if(D[e])return D[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=l*o,f=-s*u,h=s*o,d=l*u,p=Math.cos(i),v=Math.sin(i),g=Math.cos(a),m=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),_=n+p-x*v,w=r+v+x*p,k=n+g,A=r+m,E=k+x*m,M=A-x*g;return D[e]=[c*_+f*w,h*_+d*w,c*E+f*M,h*E+d*M,c*k+f*A,h*k+d*A]}var N=["l",0,0,0,0,0,0,0];function j(t,e,n){var r=N[0]=t[0];if("a"===r||"A"===r)N[1]=e*t[1],N[2]=n*t[2],N[3]=t[3],N[4]=t[4],N[5]=t[5],N[6]=e*t[6],N[7]=n*t[7];else if("h"===r||"H"===r)N[1]=e*t[1];else if("v"===r||"V"===r)N[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)N[i]=(i%2==1?e:n)*t[i];return N}function R(t,e,n,r,i,a){var o,u,s,l,c,f=null,h=0,d=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,m=e.length;g<m;++g){switch(o=e[g],1===i&&1===a||(o=j(o,i,a)),o[0]){case"l":h+=o[1],d+=o[2],t.lineTo(h+n,d+r);break;case"L":h=o[1],d=o[2],t.lineTo(h+n,d+r);break;case"h":h+=o[1],t.lineTo(h+n,d+r);break;case"H":h=o[1],t.lineTo(h+n,d+r);break;case"v":d+=o[1],t.lineTo(h+n,d+r);break;case"V":d=o[1],t.lineTo(h+n,d+r);break;case"m":h+=o[1],d+=o[2],t.moveTo(h+n,d+r);break;case"M":h=o[1],d=o[2],t.moveTo(h+n,d+r);break;case"c":u=h+o[5],s=d+o[6],p=h+o[3],v=d+o[4],t.bezierCurveTo(h+o[1]+n,d+o[2]+r,p+n,v+r,u+n,s+r),h=u,d=s;break;case"C":h=o[5],d=o[6],p=o[3],v=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,h+n,d+r);break;case"s":u=h+o[3],s=d+o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,h+o[1]+n,d+o[2]+r,u+n,s+r),p=h+o[1],v=d+o[2],h=u,d=s;break;case"S":u=o[3],s=o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"q":u=h+o[3],s=d+o[4],p=h+o[1],v=d+o[2],t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"Q":u=o[3],s=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"t":u=h+o[1],s=d+o[2],null===f[0].match(/[QqTt]/)?(p=h,v=d):"t"===f[0]?(p=2*h-l,v=2*d-c):"q"===f[0]&&(p=2*h-p,v=2*d-v),l=p,c=v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),d=s,p=(h=u)+o[1],v=d+o[2];break;case"T":u=o[1],s=o[2],p=2*h-p,v=2*d-v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"a":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+h+n,o[7]+d+r]),h+=o[6],d+=o[7];break;case"A":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),h=o[6],d=o[7];break;case"z":case"Z":t.closePath()}f=o}}function P(t,e,n,r){for(var i=function(t,e,n,r,i,a,o,u,s){var l=F.call(arguments);if(O[l])return O[l];var c=o*A,f=Math.sin(c),h=Math.cos(c),d=h*(u-t)*.5+f*(s-e)*.5,p=h*(s-e)*.5-f*(u-t)*.5,v=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=h/n,m=f/n,y=-f/r,b=h/r,x=g*u+m*s,_=y*u+b*s,w=g*t+m*e,k=y*t+b*e,E=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;E<0&&(E=0);var C=Math.sqrt(E);a==i&&(C=-C);var D=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),N=Math.atan2(_-T,x-D),j=Math.atan2(k-T,w-D)-N;j<0&&1===a?j+=S:j>0&&0===a&&(j-=S);for(var R=Math.ceil(Math.abs(j/(M+.001))),P=[],z=0;z<R;++z){var B=N+z*j/R,L=N+(z+1)*j/R;P[z]=[D,T,B,L,n,r,f,h]}return O[l]=P}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),a=0;a<i.length;++a){var o=T(i[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var z={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,S)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function B(t){return e.hasOwnProperty(z,t)?z[t]:function(t){if(!e.hasOwnProperty(L,t)){var n=k(t);L[t]={draw:function(t,e){R(t,n,0,0,Math.sqrt(e)/2)}}}return L[t]}(t)}var L={},q=.448084975506;function I(t){return t.x}function U(t){return t.y}function W(t){return t.width}function H(t){return t.height}function V(t){return"function"===typeof t?t:function(){return+t}}function G(t,e,n){return Math.max(e,Math.min(t,n))}function $(){var t=I,e=U,n=W,r=H,i=V(0),o=i,u=i,s=i,l=null;function c(c,f,h){var d,p=null!=f?f:+t.call(this,c),v=null!=h?h:+e.call(this,c),g=+n.call(this,c),m=+r.call(this,c),y=Math.min(g,m)/2,b=G(+i.call(this,c),0,y),x=G(+o.call(this,c),0,y),_=G(+u.call(this,c),0,y),w=G(+s.call(this,c),0,y);if(l||(l=d=a.path()),b<=0&&x<=0&&_<=0&&w<=0)l.rect(p,v,g,m);else{var k=p+g,A=v+m;l.moveTo(p+b,v),l.lineTo(k-x,v),l.bezierCurveTo(k-q*x,v,k,v+q*x,k,v+x),l.lineTo(k,A-w),l.bezierCurveTo(k,A-q*w,k-q*w,A,k-w,A),l.lineTo(p+_,A),l.bezierCurveTo(p+q*_,A,p,A-q*_,p,A-_),l.lineTo(p,v+b),l.bezierCurveTo(p,v+q*b,p+q*b,v,p+b,v),l.closePath()}if(d)return l=null,d+""||null}return c.x=function(e){return arguments.length?(t=V(e),c):t},c.y=function(t){return arguments.length?(e=V(t),c):e},c.width=function(t){return arguments.length?(n=V(t),c):n},c.height=function(t){return arguments.length?(r=V(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=V(t),o=null!=e?V(e):i,s=null!=n?V(n):i,u=null!=r?V(r):o,c):i},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}function Y(){var t,e,n,r,i,o,u,s,l=null;function c(t,e,n){var r=n/2;if(i){var a=u-e,c=t-o;if(a||c){var f=Math.sqrt(a*a+c*c),h=(a/=f)*s,d=(c/=f)*s,p=Math.atan2(c,a);l.moveTo(o-h,u-d),l.lineTo(t-a*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+h,u+d),l.arc(o,u,s,p,p+Math.PI)}else l.arc(t,e,r,0,S);l.closePath()}else i=1;o=t,u=e,s=r}function f(o){var u,s,f,h=o.length,d=!1;for(null==l&&(l=f=a.path()),u=0;u<=h;++u)!(u<h&&r(s=o[u],u,o))===d&&(d=!d)&&(i=0),d&&c(+t(s,u,o),+e(s,u,o),+n(s,u,o));if(f)return l=null,f+""||null}return f.x=function(e){return arguments.length?(t=e,f):t},f.y=function(t){return arguments.length?(e=t,f):e},f.size=function(t){return arguments.length?(n=t,f):n},f.defined=function(t){return arguments.length?(r=t,f):r},f.context=function(t){return arguments.length?(l=null==t?null:t,f):l},f}function X(t,e){return null!=t?t:e}var J=function(t){return t.x||0},Q=function(t){return t.y||0},Z=function(t){return!(!1===t.defined)},K=i.arc().startAngle(function(t){return t.startAngle||0}).endAngle(function(t){return t.endAngle||0}).padAngle(function(t){return t.padAngle||0}).innerRadius(function(t){return t.innerRadius||0}).outerRadius(function(t){return t.outerRadius||0}).cornerRadius(function(t){return t.cornerRadius||0}),tt=i.area().x(J).y1(Q).y0(function(t){return(t.y||0)+(t.height||0)}).defined(Z),et=i.area().y(Q).x1(J).x0(function(t){return(t.x||0)+(t.width||0)}).defined(Z),nt=i.line().x(J).y(Q).defined(Z),rt=$().x(J).y(Q).width(function(t){return t.width||0}).height(function(t){return t.height||0}).cornerRadius(function(t){return X(t.cornerRadiusTopLeft,t.cornerRadius)||0},function(t){return X(t.cornerRadiusTopRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomLeft,t.cornerRadius)||0}),it=i.symbol().type(function(t){return B(t.shape||"circle")}).size(function(t){return X(t.size,64)}),at=Y().x(J).y(Q).defined(Z).size(function(t){return t.size||1});function ot(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function ut(t,e,n,r){return rt.context(t)(e,n,r)}function st(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){var r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}var lt,ct,ft,ht=S-1e-8;function dt(t){return lt=t,dt}function pt(){}function vt(t,e){lt.add(t,e)}function gt(t,e){vt(ct=t,ft=e)}function mt(t){vt(t,lt.y1)}function yt(t){vt(lt.x1,t)}function bt(t,e,n,r){var i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function xt(t,e,n,r,i){var a,o=r-t+3*e-3*n,u=t+n-2*e,s=t-e,l=0,c=0;Math.abs(o)>E?(a=u*u+s*o)>=0&&(l=(-u+(a=Math.sqrt(a)))/o,c=(-u-a)/o):l=.5*s/u,0<l&&l<1&&i(_t(l,t,e,n,r)),0<c&&c<1&&i(_t(c,t,e,n,r))}function _t(t,e,n,r,i){var a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*r+u*t*i}dt.beginPath=pt,dt.closePath=pt,dt.moveTo=gt,dt.lineTo=gt,dt.rect=function(t,e,n,r){vt(t+n,e+r),gt(t,e)},dt.quadraticCurveTo=function(t,e,n,r){bt(ct,t,n,mt),bt(ft,e,r,yt),gt(n,r)},dt.bezierCurveTo=function(t,e,n,r,i,a){xt(ct,t,n,i,mt),xt(ft,e,r,a,yt),gt(i,a)},dt.arc=function(t,e,n,r,i,a){if(ct=n*Math.cos(i)+t,ft=n*Math.sin(i)+e,Math.abs(i-r)>ht)vt(t-n,e-n),vt(t+n,e+n);else{var o,u,s=function(r){return vt(n*Math.cos(r)+t,n*Math.sin(r)+e)};if(s(r),s(i),i!==r)if((r%=S)<0&&(r+=S),(i%=S)<0&&(i+=S),i<r&&(a=!a,o=r,r=i,i=o),a)for(i-=S,o=r-r%M,u=0;u<4&&o>i;++u,o-=M)s(o);else for(o=r-r%M+M,u=0;u<4&&o<i;++u,o+=M)s(o)}};var wt=(wt=n.canvas(1,1))?wt.getContext("2d"):null,kt=new o;function At(t){return function(e,n){if(!wt)return!0;t(wt,e),kt.clear().union(e.bounds).intersect(n).round();for(var r=kt.x1,i=kt.y1,a=kt.x2,o=kt.y2,u=i;u<=o;++u)for(var s=r;s<=a;++s)if(wt.isPointInPath(s,u))return!0;return!1}}function Et(t,e){return e.contains(t.x||0,t.y||0)}function Mt(t,e){var n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(kt.set(n,r,n+i,r+a))}function St(t,e){var n=t.x||0,r=t.y||0;return Ct(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function Ct(t,e,n,r,i){var a,o,u,s,l=t.x1,c=t.y1,f=t.x2,h=t.y2,d=r-e,p=i-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(a=-d,o=-(l-e)),1===s&&(a=d,o=f-e),2===s&&(a=-p,o=-(c-n)),3===s&&(a=p,o=h-n),Math.abs(a)<1e-10&&o<0)return!1;if(u=o/a,a<0){if(u>g)return!1;u>v&&(v=u)}else if(a>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function Ot(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Dt(t,e){return null==t?e:t}function Ft(t,e){for(var n=e.length,r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Tt(t,e,r){return c(r)?function(t,e,r){var i,a=r.width(),o=r.height();if("radial"===e.gradient)i=t.createRadialGradient(r.x1+Dt(e.x1,.5)*a,r.y1+Dt(e.y1,.5)*o,Math.max(a,o)*Dt(e.r1,0),r.x1+Dt(e.x2,.5)*a,r.y1+Dt(e.y2,.5)*o,Math.max(a,o)*Dt(e.r2,.5));else{var u=Dt(e.x1,0),s=Dt(e.y1,0),l=Dt(e.x2,1),c=Dt(e.y2,0);if(u!==l&&s!==c&&a!==o){var f=n.canvas(Math.ceil(a),Math.ceil(o)),h=f.getContext("2d");return h.scale(a,o),h.fillStyle=Ft(h.createLinearGradient(u,s,l,c),e.stops),h.fillRect(0,0,a,o),t.createPattern(f,"no-repeat")}i=t.createLinearGradient(r.x1+u*a,r.y1+s*o,r.x1+l*a,r.y1+c*o)}return Ft(i,e.stops)}(t,r,e.bounds):r}function Nt(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Tt(t,e,e.fill),!0)}var jt=[];function Rt(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Tt(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||jt),t.lineDashOffset=e.strokeDashOffset||0),!0)}function Pt(t,e){return t.zindex-e.zindex||t.index-e.index}function zt(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Pt)}function Bt(t,e){var n,r,i=t.items;if(i&&i.length){var a=zt(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}}function Lt(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var a=zt(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function qt(t){return function(e,n,r){Bt(n,function(n){r&&!r.intersects(n.bounds)||Ut(t,e,n,n)})}}function It(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Ut(t,e,n.items[0],n.items)}}function Ut(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Ot(e,n),n.fill&&Nt(e,n,i)&&e.fill(),n.stroke&&Rt(e,n,i)&&e.stroke()))}function Wt(t){return t=t||e.truthy,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Lt(n,function(n){var u=n.bounds;if((!u||u.contains(a,o))&&u)return t(e,n,r,i,a,o)?n:void 0})}}function Ht(t,e){return function(n,r,i,a){var o,u,s=Array.isArray(r)?r[0]:r,l=null==e?s.fill:e,c=s.stroke&&n.isPointInStroke;return c&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!t(n,r)&&(l&&n.isPointInPath(i,a)||c&&n.isPointInStroke(i,a))}}function Vt(t){return Wt(Ht(t))}function Gt(t,e){return"translate("+t+","+e+")"}function $t(t){return"rotate("+t+")"}function Yt(t){return Gt(t.x||0,t.y||0)}function Xt(t){return Gt(t.x||0,t.y||0)+(t.angle?" "+$t(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}function Jt(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=A),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",Xt(n)),t("d",e(null,n))},bound:function(t,n){var r=n.x||0,i=n.y||0;return e(dt(t),n),st(t,n).translate(r,i),n.angle&&t.rotate(n.angle*A,r,i),t},draw:qt(r),pick:Vt(r),isect:n||At(r)}}var Qt=Jt("arc",function(t,e){return K.context(t)(e)});function Zt(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i=Ht(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(dt(t),r),st(t,r[0]))},draw:It(r),pick:function(t,e,n,r,a,o){var u=e.items,s=e.bounds;return!u||!u.length||s&&!s.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,u,n,r)?u[0]:null)},isect:Et,tip:n}}var Kt=Zt("area",function(t,e){var n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?et:tt).curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,u=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<u&&(u=r,n=t[o]);return n});function te(t,e){t.beginPath(),ot(e)?ut(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}var ee=1;function ne(t,n,r){var i=n.clip,a=t._defs,o=n.clip_id||(n.clip_id="clip"+ee++),u=a.clipping[o]||(a.clipping[o]={id:o});return e.isFunction(i)?u.path=i(null):ot(r)?u.path=ut(null,r,0,0):(u.width=r.width||0,u.height=r.height||0),"url(#"+o+")"}function re(t){var e=null!=(e=t.strokeWidth)?e:1;return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function ie(t,e){var n=re(e);t("d",ut(null,e,n,n))}function ae(t,e,n,r){var i=re(e);t.beginPath(),ut(t,e,(n||0)+i,(r||0)+i)}var oe=Ht(ae),ue=Ht(ae,!1),se={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Yt(e))},bound:function(t,e){if(!e.clip&&e.items)for(var n=e.items,r=0,i=n.length;r<i;++r)t.union(n[r].bounds);return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),st(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){var r=this;Bt(e,function(e){var i=e.x||0,a=e.y||0,o=e.strokeForeground,u=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&u&&(ae(t,e,i,a),Ot(t,e),e.fill&&Nt(t,e,u)&&t.fill(),e.stroke&&!o&&Rt(t,e,u)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&te(t,e),n&&n.translate(-i,-a),Bt(e,function(e){r.draw(t,e,n)}),n&&n.translate(i,a),t.restore(),o&&e.stroke&&u&&(ae(t,e,i,a),Ot(t,e),Rt(t,e,u)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;var o=this,u=n*t.pixelRatio,s=r*t.pixelRatio;return Lt(e,function(l){var c,f,h,d,p,v,g,m,y;if((!(m=l.bounds)||m.contains(i,a))&&(d=l.x||0,p=l.y||0,v=d+(l.width||0),g=p+(l.height||0),!(y=l.clip)||!(i<d||i>v||a<d||a>g)))return t.save(),t.translate(d,p),d=i-d,p=a-p,y&&ot(l)&&!oe(t,l,u,s)?(t.restore(),null):(f=l.strokeForeground,(h=!1!==e.interactive)&&f&&l.stroke&&ue(t,l,u,s)?(t.restore(),l):(!(c=Lt(l,function(t){return function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,d,p)?o.pick(t,n,r,d,p):null}))&&h&&(l.fill||!f&&l.stroke)&&oe(t,l,u,s)&&(c=l),t.restore(),c||null))})},isect:Mt,content:function(t,e,n){t("clip-path",e.clip?ne(n,e,e):null)},background:function(t,e){t("class","background"),ie(t,e)},foreground:function(t,e){t("class","foreground"),e.strokeForeground?ie(t,e):t("d","")}};function le(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(function(e){t.image=e,t.image.url=t.url})),n}function ce(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function fe(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function he(t,e){return"center"===t?e/2:"right"===t?e:0}function de(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var pe={type:"image",tag:"image",nested:!1,attr:function(t,e,n){var r=le(e,n),i=e.x||0,a=e.y||0,o=ce(e,r),u=fe(e,r),s=!1===e.aspect?"none":"xMidYMid";i-=he(e.align,o),a-=de(e.baseline,u),!r.src&&r.toDataURL?t("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href"):t("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),t("transform",Gt(i,a)),t("width",o),t("height",u),t("preserveAspectRatio",s)},bound:function(t,e){var n=e.image,r=e.x||0,i=e.y||0,a=ce(e,n),o=fe(e,n);return r-=he(e.align,a),i-=de(e.baseline,o),t.set(r,i,r+a,i+o)},draw:function(t,e,n){var r=this;Bt(e,function(e){if(!n||n.intersects(e.bounds)){var i,a,o,u,s=le(e,r),l=e.x||0,c=e.y||0,f=ce(e,s),h=fe(e,s);l-=he(e.align,f),c-=de(e.baseline,h),!1!==e.aspect&&(a=s.width/s.height,o=e.width/e.height,a===a&&o===o&&a!==o&&(o<a?(c+=(h-(u=f/a))/2,h=u):(l+=(f-(u=h*a))/2,f=u))),(s.complete||s.toDataURL)&&(Ot(t,e),t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,l,c,f,h))}})},pick:Wt(),isect:e.truthy,get:le,xOffset:he,yOffset:de},ve=Zt("line",function(t,e){var n=e[0],r=n.interpolate||"linear";return nt.curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null});function ge(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*A,s=e.pathCache;s&&s.path===n||((e.pathCache=s=k(n)).path=n),u&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(u),R(t,s,0,0,a,o),t.rotate(-u),t.translate(-r,-i)):R(t,s,r,i,a,o)}var me={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",Xt(e)),t("d",e.path)},bound:function(t,e){return ge(dt(t),e)?t.set(0,0,0,0):st(t,e,!0),e.angle&&t.rotate(e.angle*A,e.x||0,e.y||0),t},draw:qt(ge),pick:Vt(ge),isect:At(ge)};function ye(t,e){t.beginPath(),ut(t,e)}var be={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",ut(null,e))},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:qt(ye),pick:Vt(ye),isect:Mt};function xe(t,e,n){var r,i,a,o;return!(!e.stroke||!Rt(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var _e={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Yt(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Bt(e,function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&xe(t,e,r)&&(Ot(t,e),t.stroke())}})},pick:Wt(function(t,e,n,r){return!!t.isPointInStroke&&xe(t,e,1)&&t.isPointInStroke(n,r)}),isect:St},we=Jt("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),ke=Jt("symbol",function(t,e){return it.context(t)(e)},Et),Ae=e.lruCache(),Ee={height:Fe,measureWidth:Oe,estimateWidth:Se,width:Se,canvas:Me};function Me(t){Ee.width=t&&wt?Oe:Se}function Se(t,e){return Ce(je(t,e),Fe(t))}function Ce(t,e){return~~(.8*t.length*e)}function Oe(t,e){return Fe(t)<=0||!(e=je(t,e))?0:De(e,Pe(t))}function De(t,e){var n="(".concat(e,") ").concat(t),r=Ae.get(n);return void 0===r&&(wt.font=e,r=wt.measureText(t).width,Ae.set(n,r)),r}function Fe(t){return null!=t.fontSize?+t.fontSize||0:11}function Te(t){return null!=t.lineHeight?t.lineHeight:Fe(t)+2}function Ne(t){return n=t.lineBreak&&t.text&&!e.isArray(t.text)?t.text.split(t.lineBreak):t.text,e.isArray(n)?n.length>1?n:n[0]:n;var n}function je(t,e){var n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Ee.width===Oe){var e=Pe(t);return function(t){return De(t,e)}}var n=Fe(t);return function(t){return Ce(t,n)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,u=0,s=e.length;if(n-=r(a),o){for(;u<s;)i=u+s>>>1,r(e.slice(i))>n?u=i+1:s=i;return a+e.slice(u)}for(;u<s;)i=1+(u+s>>>1),r(e.slice(0,i))<n?u=i:s=i-1;return e.slice(0,u)+a}(t,n):n}function Re(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Pe(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Fe(t)+"px "+Re(t,e)}function ze(t){var e=t.baseline,n=Fe(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Te(t):"line-bottom"===e?.29*n-.5*Te(t):0)}Me(!0);var Be={left:"start",center:"middle",right:"end"},Le=new o;function qe(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-M,n+=i*Math.cos(e),r+=i*Math.sin(e)),Le.x1=n,Le.y1=r,Le}function Ie(t,n,r){var i,a=Ee.height(n),o=n.align,u=qe(n),s=u.x1,l=u.y1,c=n.dx||0,f=(n.dy||0)+ze(n)-Math.round(.8*a),h=Ne(n);if(e.isArray(h)?(a+=Te(n)*(h.length-1),i=h.reduce(function(t,e){return Math.max(t,Ee.width(n,e))},0)):i=Ee.width(n,h),"center"===o?c-=i/2:"right"===o&&(c-=i),t.set(c+=s,f+=l,c+i,f+a),n.angle&&!r)t.rotate(n.angle*A,s,l);else if(2===r)return t.rotatedPoints(n.angle*A,s,l);return t}var Ue={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+ze(e),a=qe(e),o=a.x1,u=a.y1,s=e.angle||0;t("text-anchor",Be[e.align]||"start"),s?(n=Gt(o,u)+" "+$t(s),(r||i)&&(n+=" "+Gt(r,i))):n=Gt(o+r,u+i),t("transform",n)},bound:Ie,draw:function(t,n,r){Bt(n,function(n){var i,a,o,u,s,l,c,f=null==n.opacity?1:n.opacity;if(!(r&&!r.intersects(n.bounds)||0===f||n.fontSize<=0||null==n.text||0===n.text.length)){if(t.font=Pe(n),t.textAlign=n.align||"left",a=(i=qe(n)).x1,o=i.y1,n.angle&&(t.save(),t.translate(a,o),t.rotate(n.angle*A),a=o=0),a+=n.dx||0,o+=(n.dy||0)+ze(n),l=Ne(n),Ot(t,n),e.isArray(l))for(s=Te(n),u=0;u<l.length;++u)c=je(n,l[u]),n.fill&&Nt(t,n,f)&&t.fillText(c,a,o),n.stroke&&Rt(t,n,f)&&t.strokeText(c,a,o),o+=s;else c=je(n,l),n.fill&&Nt(t,n,f)&&t.fillText(c,a,o),n.stroke&&Rt(t,n,f)&&t.strokeText(c,a,o);n.angle&&t.restore()}})},pick:Wt(function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=qe(e),u=o.x1,s=o.y1,l=Ie(Le,e,1),c=-e.angle*A,f=Math.cos(c),h=Math.sin(c),d=f*i-h*a+(u-f*u+h*s),p=h*i+f*a+(s-h*u-f*s);return l.contains(d,p)}),isect:function(t,e){var n=Ie(Le,t,2);return Ct(e,n[0],n[1],n[2],n[3])||Ct(e,n[0],n[1],n[4],n[5])||Ct(e,n[4],n[5],n[6],n[7])||Ct(e,n[2],n[3],n[6],n[7])}},We=Zt("trail",function(t,e){return at.context(t)(e)},function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}),He={arc:Qt,area:Kt,group:se,image:pe,line:ve,path:me,rect:be,rule:_e,shape:we,symbol:ke,text:Ue,trail:We};function Ve(t,e,n){var r=He[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new o),t,n)}var Ge={mark:null};function $e(t,e,n){var r,i,a,u,s=He[t.marktype],l=s.bound,c=t.items,f=c&&c.length;if(s.nested)return f?a=c[0]:(Ge.mark=t,a=Ge),u=Ve(a,l,n),e=e&&e.union(u)||u;if(e=e||t.bounds&&t.bounds.clear()||new o,f)for(r=0,i=c.length;r<i;++r)e.union(Ve(c[r],l,n));return t.bounds=e}var Ye=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function Xe(t,e){return JSON.stringify(t,Ye,e)}function Je(t){return function t(e){var n,r,i,a=e.marktype,o=e.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=e,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&t(o[r]);return a&&$e(e),e}("string"===typeof t?JSON.parse(t):t)}function Qe(t){arguments.length?this.root=Je(t):(this.root=Ke({marktype:"group",name:"root",role:"frame"}),this.root.items=[new p(this.root)])}var Ze=Qe.prototype;function Ke(t,e){return{bounds:new o,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0}}function tn(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function en(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function nn(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=tn(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function rn(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function an(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function on(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function un(t,e){this._active=null,this._handlers={},this._loader=t||r.loader(),this._tooltip=e||sn}function sn(t,e,n,r){t.element().setAttribute("title",r||"")}Ze.toJSON=function(t){return Xe(this.root,t||0)},Ze.mark=function(t,e,n){var r=Ke(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var ln=un.prototype;function cn(t){this._el=null,this._bgcolor=null,this._loader=new v(t)}ln.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},ln.element=function(){return this._el},ln.canvas=function(){return this._el&&this._el.firstChild},ln.origin=function(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},ln.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},ln.on=function(){},ln.off=function(){},ln._handlerIndex=function(t,e,n){for(var r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},ln.handlers=function(t){var e,n=this._handlers,r=[];if(t)r.push.apply(r,n[this.eventName(t)]);else for(e in n)r.push.apply(r,n[e]);return r},ln.eventName=function(t){var e=t.indexOf(".");return e<0?t:t.slice(0,e)},ln.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(function(e){var n=new MouseEvent(t.type,t),r=tn(null,"a");for(var i in e)r.setAttribute(i,e[i]);r.dispatchEvent(n)}).catch(function(){})},ln.handleTooltip=function(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=He[o.marktype]).tip){for((a=on(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);var r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},ln.getItemBoundingClientRect=function(t){if(e=this.canvas()){for(var e,n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();t.mark&&(t=t.mark.group);)a+=t.x||0,o+=t.y||0;return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}}};var fn=cn.prototype;fn.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},fn.element=function(){return this._el},fn.canvas=function(){return this._el&&this._el.firstChild},fn.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},fn.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},fn.dirty=function(){},fn.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},fn._render=function(){},fn.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then(function(){return e}):Promise.resolve(e)},fn._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(t){t&&i(),n._ready=null})}return r},fn.sanitizeURL=function(t){return this._load("sanitizeURL",t)},fn.loadImage=function(t){return this._load("loadImage",t)};var hn="mouseout";function dn(t,e){un.call(this,t,e),this._down=null,this._touch=null,this._first=!0}var pn=e.inherits(dn,un);function vn(t,e,n){return function(r){var i=this._active,a=this.pickEvent(r);a===i?this.fire(t,r):(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r),this.fire(t,r))}}function gn(t){return function(e){this.fire(t,e),this._active=null}}pn.initialize=function(t,e,n){var r=this._canvas=t&&en(t,"canvas");if(r){var i=this;this.events.forEach(function(t){r.addEventListener(t,function(e){pn[t]?pn[t].call(i,e):i.fire(t,e)})})}return un.prototype.initialize.call(this,t,e,n)},pn.canvas=function(){return this._canvas},pn.context=function(){return this._canvas.getContext("2d")},pn.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],pn.DOMMouseScroll=function(t){this.fire("mousewheel",t)},pn.mousemove=vn("mousemove","mouseover","mouseout"),pn.dragover=vn("dragover","dragenter","dragleave"),pn.mouseout=gn("mouseout"),pn.dragleave=gn("dragleave"),pn.mousedown=function(t){this._down=this._active,this.fire("mousedown",t)},pn.click=function(t){this._down===this._active&&(this.fire("click",t),this._down=null)},pn.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},pn.touchmove=function(t){this.fire("touchmove",t,!0)},pn.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},pn.fire=function(t,e,n){var r,i,a=n?this._touch:this._active,o=this._handlers[t];if(e.vegaType=t,"click"===t&&a&&a.href?this.handleHref(e,a,a.href):"mousemove"!==t&&t!==hn||this.handleTooltip(e,a,t!==hn),o)for(r=0,i=o.length;r<i;++r)o[r].handler.call(this._obj,e,a)},pn.on=function(t,e){var n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(r[n]||(r[n]=[])).push({type:t,handler:e}),this},pn.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pn.pickEvent=function(t){var e=on(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pn.pick=function(t,e,n,r,i){var a=this.context();return He[t.marktype].pick.call(this,a,t,e,n,r,i)};var mn="undefined"!==typeof window&&window.devicePixelRatio||1;function yn(t){cn.call(this,t),this._redraw=!1,this._dirty=new o}var bn=e.inherits(yn,cn),xn=cn.prototype,_n=new o;function wn(t,e,n){return _n.set(0,0,e,n).translate(-t[0],-t[1])}function kn(t,e){un.call(this,t,e);var n=this;n._hrefHandler=En(n,function(t,e){e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=En(n,function(t,e){n.handleTooltip(t,e,t.type!==hn)})}bn.initialize=function(t,e,r,i,a,o){return this._options=o,this._canvas=n.canvas(1,1,o&&o.type),t&&(rn(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),xn.initialize.call(this,t,e,r,i,a)},bn.resize=function(t,e,n,r){return xn.resize.call(this,t,e,n,r),function(t,e,n,r,i,a){var o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,u=t.getContext("2d"),s=o?mn:i;for(var l in t.width=e*s,t.height=n*s,a)u[l]=a[l];o&&1!==s&&(t.style.width=e+"px",t.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context),this._redraw=!0,this},bn.canvas=function(){return this._canvas},bn.context=function(){return this._canvas?this._canvas.getContext("2d"):null},bn.dirty=function(t){var e=function(t,e){if(null==e)return t;for(var n=_n.clear().union(t);null!=e;e=e.mark.group)n.translate(e.x||0,e.y||0);return n}(t.bounds,t.mark.group);this._dirty.union(e)},bn._render=function(t){var e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;return e.save(),this._redraw||a.empty()?(this._redraw=!1,a=wn(n,r,i).expand(1)):a=function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(wn(n,r,i)),n),this.clear(-n[0],-n[1],r,i),this.draw(e,t,a),e.restore(),this._dirty.clear(),this},bn.draw=function(t,n,r){var i=He[n.marktype];n.clip&&function(t,n){var r=n.clip;t.save(),e.isFunction(r)?(t.beginPath(),r(t),t.clip()):te(t,n.group)}(t,n),i.draw.call(this,t,n,r),n.clip&&t.restore()},bn.clear=function(t,e,n,r){var i=this.context();i.clearRect(t,e,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(t,e,n,r))};var An=e.inherits(kn,un);function En(t,e){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,e.call(t._obj,n,r)}}function Mn(t,e,n){var r,i,a="<"+t;if(e)for(r in e)null!=(i=e[r])&&(a+=" "+r+'="'+i+'"');return n&&(a+=" "+n),a+">"}function Sn(t){return"</"+t+">"}An.initialize=function(t,e,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mousemove",this._tooltipHandler),r.removeEventListener(hn,this._tooltipHandler)),this._svg=r=t&&en(t,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mousemove",this._tooltipHandler),r.addEventListener(hn,this._tooltipHandler)),un.prototype.initialize.call(this,t,e,n)},An.canvas=function(){return this._svg},An.on=function(t,e){var n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){var i={type:t,handler:e,listener:En(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},An.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};var Cn={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},On={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Dn=Object.keys(On),Fn=Cn.xmlns;function Tn(t){cn.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Nn=e.inherits(Tn,cn),jn=cn.prototype;function Rn(t,e,n){var r,i,a;if("radial"===e.gradient){var o=nn(t,n++,"pattern",Fn);o.setAttribute("id",l+e.id),o.setAttribute("viewBox","0,0,1,1"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("preserveAspectRatio","xMidYMid slice"),(o=nn(o,0,"rect",Fn)).setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("fill","url("+Hn()+"#"+e.id+")"),(t=nn(t,n++,"radialGradient",Fn)).setAttribute("id",e.id),t.setAttribute("fx",e.x1),t.setAttribute("fy",e.y1),t.setAttribute("fr",e.r1),t.setAttribute("cx",e.x2),t.setAttribute("cy",e.y2),t.setAttribute("r",e.r2)}else(t=nn(t,n++,"linearGradient",Fn)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2);for(r=0,i=e.stops.length;r<i;++r)(a=nn(t,r,"stop",Fn)).setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return rn(t,r),n}function Pn(t,e,n){var r;return(t=nn(t,n,"clipPath",Fn)).setAttribute("id",e.id),e.path?(r=nn(t,0,"path",Fn)).setAttribute("d",e.path):((r=nn(t,0,"rect",Fn)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)),rn(t,1),n+1}function zn(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Bn(t,e,n,r,i){var a,o=t._svg;if(!o&&(o=tn(a=e.ownerDocument,r,Fn),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){var u=tn(a,"path",Fn);o.appendChild(u),u.__data__=t;var s=tn(a,"g",Fn);o.appendChild(s),s.__data__=t;var l=tn(a,"path",Fn);o.appendChild(l),l.__data__=t,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Nn.initialize=function(t,e,n,r){return t&&(this._svg=nn(t,0,"svg",Fn),this._svg.setAttribute("class","marks"),rn(t,1),this._root=nn(this._svg,0,"g",Fn),rn(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),jn.initialize.call(this,t,e,n,r)},Nn.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),jn.background.apply(this,arguments)},Nn.resize=function(t,e,n,r){return jn.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},Nn.canvas=function(){return this._svg},Nn.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in Cn)t[e]=Cn[e];var n=this._bgcolor?Mn("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+Sn("rect"):"";return Mn("svg",t)+n+this._svg.innerHTML+Sn("svg")},Nn._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),rn(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},Nn.updateDefs=function(){var t,e=this._svg,n=this._defs,r=n.el,i=0;for(t in n.gradient)r||(n.el=r=nn(e,0,"defs",Fn)),i=Rn(r,n.gradient[t],i);for(t in n.clipping)r||(n.el=r=nn(e,0,"defs",Fn)),i=Pn(r,n.clipping[t],i);r&&(0===i?(e.removeChild(r),n.el=null):rn(r,i))},Nn._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},Nn.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},Nn.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},Nn._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length||!this._dirtyID)return!0;var e,n,r,i,a,o,u,s=++this._dirtyID;for(a=0,o=t.length;a<o;++a)(n=(e=t[a]).mark).marktype!==r&&(r=n.marktype,i=He[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,zn(e,s),n.items.forEach(function(t){t.dirty=s})),n.zdirty||(e.exit?(i.nested&&n.items.length?(u=n.items[0])._svg&&this._update(i,u._svg,u):e._svg&&(u=e._svg.parentNode)&&u.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==s&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,zn(e,s)),e._update=s));return!this._dirtyAll},Nn.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this,a=this._svg,o=He[e.marktype],u=!1===e.interactive?"none":null,s="g"===o.tag,l=null,c=0;function f(t){var e=i.isDirty(t),n=Bn(t,r,l,o.tag,a);e&&(i._update(o,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;var r,i=0;Bt(n,function(n){r=t.draw(e,n,r),++i}),rn(e,1+i)}(i,n,t)),l=n,++c}return(r=Bn(e,t,n,"g",a)).setAttribute("class",an(e)),s||r.style.setProperty("pointer-events",u),e.clip?r.setAttribute("clip-path",ne(i,e,e.group)):r.removeAttribute("clip-path"),o.nested?e.items.length&&f(e.items[0]):Bt(e,f),rn(r,c),r};var Ln=null,qn=null,In={group:function(t,e,n){var r,i;Ln=r=e.childNodes[2],qn=r.__values__,t.foreground(Wn,n,this),qn=e.__values__,Ln=e.childNodes[1],t.content(Wn,n,this),Ln=i=e.childNodes[0],t.background(Wn,n,this);var a=!1===n.mark.interactive?"none":null;if(a!==qn.events&&(r.style.setProperty("pointer-events",a),i.style.setProperty("pointer-events",a),qn.events=a),n.strokeForeground&&n.stroke){var o=n.fill;r.style.removeProperty("display"),this.style(i,n),i.style.removeProperty("stroke"),o&&(n.fill=null),qn=r.__values__,this.style(r,n),o&&(n.fill=o),Ln=null}else r.style.setProperty("display","none"),r.style.setProperty("fill","none")},image:function(t,e,n){!1===n.smooth?(Un(e,"image-rendering","optimizeSpeed"),Un(e,"image-rendering","pixelated")):Un(e,"image-rendering",null)},text:function(t,n,r){var i,a,o,u,s=Ne(r);e.isArray(s)?(i=(a=s.map(function(t){return je(r,t)})).join("\n"))!==qn.text&&(rn(n,0),o=n.ownerDocument,u=Te(r),a.forEach(function(t,e){var i=tn(o,"tspan",Fn);i.__data__=r,i.textContent=t,e&&(i.setAttribute("x",0),i.setAttribute("dy",u)),n.appendChild(i)}),qn.text=i):(a=je(r,s))!==qn.text&&(n.textContent=a,qn.text=a),Un(n,"font-family",Re(r)),Un(n,"font-size",Fe(r)+"px"),Un(n,"font-style",r.fontStyle),Un(n,"font-variant",r.fontVariant),Un(n,"font-weight",r.fontWeight)}};function Un(t,e,n){n!==qn[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),qn[e]=n)}function Wn(t,e,n){e!==qn[t]&&(null!=e?n?Ln.setAttributeNS(n,t,e):Ln.setAttribute(t,e):n?Ln.removeAttributeNS(n,t):Ln.removeAttribute(t),qn[t]=e)}function Hn(){var t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Vn(t){cn.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}Nn._update=function(t,e,n){Ln=e,qn=e.__values__,t.attr(Wn,n,this);var r=In[t.type];r&&r.call(this,t,e,n),Ln&&this.style(Ln,n)},Nn.style=function(t,e){var n,r,i,a,o;if(null!=e)for(n=0,r=Dn.length;n<r;++n)o=e[i=Dn[n]],"font"===i&&(o=Re(e)),o!==qn[i]&&(a=On[i],null==o?"fill"===a?t.style.setProperty(a,"none"):t.style.removeProperty(a):(c(o)&&(o=f(o,this._defs.gradient,Hn())),t.style.setProperty(a,o+"")),qn[i]=o)};var Gn,$n=e.inherits(Vn,cn),Yn=cn.prototype;function Xn(t,e,n,r){Gn[r||t]=e}function Jn(t,e,n,r){if(null==t)return"";var i,a,o,u,s,l="";for("bgrect"===n&&!1===e.interactive&&(l+="pointer-events: none; "),"bgfore"===n&&(!1===e.interactive&&(l+="pointer-events: none; "),l+="display: none; "),"image"===n&&!1===t.smooth&&(l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "),"text"===n&&(l+="font-family: "+Re(t)+"; ",l+="font-size: "+Fe(t)+"px; ",t.fontStyle&&(l+="font-style: "+t.fontStyle+"; "),t.fontVariant&&(l+="font-variant: "+t.fontVariant+"; "),t.fontWeight&&(l+="font-weight: "+t.fontWeight+"; ")),i=0,a=Dn.length;i<a;++i)o=Dn[i],u=On[o],null==(s=t[o])?"fill"===u&&(l+="fill: none; "):"transparent"!==s||"fill"!==u&&"stroke"!==u?(c(s)&&(s=f(s,r.gradient,"")),l+=u+": "+s+"; "):l+=u+": none; ";return l?'style="'+l.trim()+'"':null}function Qn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}$n.resize=function(t,e,n,r){Yn.resize.call(this,t,e,n,r);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in Cn)o[u]=Cn[u];a.head=Mn("svg",o);var s=this._bgcolor;return"transparent"!==s&&"none"!==s||(s=null),a.bg=s?Mn("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+Sn("rect"):"",a.root=Mn("g",{transform:"translate("+i+")"}),a.foot=Sn("g")+Sn("svg"),this},$n.background=function(){var t=Yn.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},$n.svg=function(){var t=this._text;return t.head+t.bg+t.defs+t.root+t.body+t.foot},$n._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},$n.buildDefs=function(){var t,e,n,r,i,a=this._defs,o="";for(e in a.gradient){for(i=(n=a.gradient[e]).stops,"radial"===n.gradient?(o+=Mn(r="pattern",{id:l+e,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o+=Mn("rect",{width:"1",height:"1",fill:"url(#"+e+")"})+Sn("rect"),o+=Sn(r),o+=Mn(r="radialGradient",{id:e,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})):o+=Mn(r="linearGradient",{id:e,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),t=0;t<i.length;++t)o+=Mn("stop",{offset:i[t].offset,"stop-color":i[t].color})+Sn("stop");o+=Sn(r)}for(e in a.clipping)n=a.clipping[e],o+=Mn("clipPath",{id:e}),n.path?o+=Mn("path",{d:n.path})+Sn("path"):o+=Mn("rect",{x:0,y:0,width:n.width,height:n.height})+Sn("rect"),o+=Sn("clipPath");return o.length>0?Mn("defs")+o+Sn("defs"):""},$n.attributes=function(t,e){return Gn={},t(Xn,e,this),Gn},$n.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(function(t){t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},$n.mark=function(t){var n,r=this,i=He[t.marktype],a=i.tag,o=this._defs,u="";function s(s){var l=r.href(s);if(l&&(u+=Mn("a",l)),n="g"!==a?Jn(s,t,a,o):null,u+=Mn(a,r.attributes(i.attr,s),n),"text"===a){var c=Ne(s);if(e.isArray(c))for(var f={x:0,dy:Te(s)},h=0;h<c.length;++h)u+=Mn("tspan",h?f:null)+Qn(je(s,c[h]))+Sn("tspan");else u+=Qn(je(s,c))}else if("g"===a){var d=s.strokeForeground,p=s.fill,v=s.stroke;d&&v&&(s.stroke=null),u+=Mn("path",r.attributes(i.background,s),Jn(s,t,"bgrect",o))+Sn("path"),u+=Mn("g",r.attributes(i.content,s))+r.markGroup(s)+Sn("g"),d&&v?(p&&(s.fill=null),s.stroke=v,u+=Mn("path",r.attributes(i.foreground,s),Jn(s,t,"bgrect",o))+Sn("path"),p&&(s.fill=p)):u+=Mn("path",r.attributes(i.foreground,s),Jn({},t,"bgfore",o))+Sn("path")}u+=Sn(a),l&&(u+=Sn("a"))}return"g"!==a&&!1===t.interactive&&(n='style="pointer-events: none;"'),u+=Mn("g",{class:an(t),"clip-path":t.clip?ne(r,t,t.group):null},n),i.nested?t.items&&t.items.length&&s(t.items[0]):Bt(t,s),u+Sn("g")},$n.markGroup=function(t){var e=this,n="";return Bt(t,function(t){n+=e.mark(t)}),n};var Zn={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Kn={};function tr(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){var i=t.items,a=t.marktype,o=i.length,u=0;if("group"===a)for(;u<o;++u)er(i[u],e,n,r);else for(var s=He[a].isect;u<o;++u){var l=i[u];nr(l,e,s)&&r.push(l)}}return r}function er(t,e,n,r){n&&n(t.mark)&&nr(t,e,He.group.isect)&&r.push(t);var i=t.items,a=i&&i.length;if(a){var o=t.x||0,u=t.y||0;e.translate(-o,-u);for(var s=0;s<a;++s)tr(i[s],e,n,r);e.translate(o,u)}return r}function nr(t,e,n){var r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Kn.canvas=Kn.png={renderer:yn,headless:yn,handler:dn},Kn.svg={renderer:Tn,headless:Vn,handler:kn},Kn.none={};var rr=new o,ir=1e-9;function ar(t,n,r){return t===n||("path"===r?or(t,n):t instanceof Date&&n instanceof Date?+t===+n:e.isNumber(t)&&e.isNumber(n)?Math.abs(t-n)<=ir:t&&n&&(e.isObject(t)||e.isObject(n))?null!=t&&null!=n&&function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!ar(t[n],e[n],n))return!1;return typeof t===typeof e}(t,n):t==n)}function or(t,e){return ar(k(t),k(e))}t.Bounds=o,t.CanvasHandler=dn,t.CanvasRenderer=yn,t.Gradient=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}},t.GroupItem=p,t.Handler=un,t.Item=d,t.Marks=He,t.RenderType=Zn,t.Renderer=cn,t.ResourceLoader=v,t.SVGHandler=kn,t.SVGRenderer=Tn,t.SVGStringRenderer=Vn,t.Scenegraph=Qe,t.boundClip=function(t){var n=t.clip;if(e.isFunction(n))n(dt(rr.clear()));else{if(!n)return;rr.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(rr)},t.boundContext=dt,t.boundItem=Ve,t.boundMark=$e,t.boundStroke=st,t.closeTag=Sn,t.domChild=nn,t.domClear=rn,t.domCreate=tn,t.domFind=en,t.font=Pe,t.fontFamily=Re,t.fontSize=Fe,t.intersect=function(t,n,r){var i=[],a=(new o).union(n),u=t.marktype;return u?tr(t,a,r,i):"group"===u?er(t,a,r,i):e.error("Intersect scene must be mark node or group item.")},t.intersectBoxLine=Ct,t.intersectPath=At,t.intersectPoint=Et,t.intersectRule=St,t.lineHeight=Te,t.multiLineOffset=function(t){var n=Ne(t);return(e.isArray(n)?n.length-1:0)*Te(t)},t.openTag=Mn,t.pathCurves=x,t.pathEqual=or,t.pathParse=k,t.pathRectangle=$,t.pathRender=R,t.pathSymbols=B,t.pathTrail=Y,t.point=on,t.renderModule=function(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Kn[t]=e,this):Kn[t]},t.resetSVGClipId=function(){ee=1},t.sceneEqual=ar,t.sceneFromJSON=Je,t.scenePickVisit=Lt,t.sceneToJSON=Xe,t.sceneVisit=Bt,t.sceneZOrder=zt,t.textMetrics=Ee,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1341),n(1171),n(1565),n(2139),n(1080))},2139:function(t,e,n){!function(t,e){"use strict";function n(t){return function(){return t}}var r=Math.abs,i=Math.atan2,a=Math.cos,o=Math.max,u=Math.min,s=Math.sin,l=Math.sqrt,c=1e-12,f=Math.PI,h=f/2,d=2*f;function p(t){return t>=1?h:t<=-1?-h:Math.asin(t)}function v(t){return t.innerRadius}function g(t){return t.outerRadius}function m(t){return t.startAngle}function y(t){return t.endAngle}function b(t){return t&&t.padAngle}function x(t,e,n,r,i,a,u){var s=t-n,c=e-r,f=(u?a:-a)/l(s*s+c*c),h=f*c,d=-f*s,p=t+h,v=e+d,g=n+h,m=r+d,y=(p+g)/2,b=(v+m)/2,x=g-p,_=m-v,w=x*x+_*_,k=i-a,A=p*m-g*v,E=(_<0?-1:1)*l(o(0,k*k*w-A*A)),M=(A*_-x*E)/w,S=(-A*x-_*E)/w,C=(A*_+x*E)/w,O=(-A*x+_*E)/w,D=M-y,F=S-b,T=C-y,N=O-b;return D*D+F*F>T*T+N*N&&(M=C,S=O),{cx:M,cy:S,x01:-h,y01:-d,x11:M*(i/k-1),y11:S*(i/k-1)}}function _(t){this._context=t}function w(t){return new _(t)}function k(t){return t[0]}function A(t){return t[1]}function E(){var t=k,r=A,i=n(!0),a=null,o=w,u=null;function s(n){var s,l,c,f=n.length,h=!1;for(null==a&&(u=o(c=e.path())),s=0;s<=f;++s)!(s<f&&i(l=n[s],s,n))===h&&((h=!h)?u.lineStart():u.lineEnd()),h&&u.point(+t(l,s,n),+r(l,s,n));if(c)return u=null,c+""||null}return s.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),s):t},s.y=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),s):r},s.defined=function(t){return arguments.length?(i="function"===typeof t?t:n(!!t),s):i},s.curve=function(t){return arguments.length?(o=t,null!=a&&(u=o(a)),s):o},s.context=function(t){return arguments.length?(null==t?a=u=null:u=o(a=t),s):a},s}function M(){var t=k,r=null,i=n(0),a=A,o=n(!0),u=null,s=w,l=null;function c(n){var c,f,h,d,p,v=n.length,g=!1,m=new Array(v),y=new Array(v);for(null==u&&(l=s(p=e.path())),c=0;c<=v;++c){if(!(c<v&&o(d=n[c],c,n))===g)if(g=!g)f=c,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=c-1;h>=f;--h)l.point(m[h],y[h]);l.lineEnd(),l.areaEnd()}g&&(m[c]=+t(d,c,n),y[c]=+i(d,c,n),l.point(r?+r(d,c,n):m[c],a?+a(d,c,n):y[c]))}if(p)return l=null,p+""||null}function f(){return E().defined(o).curve(s).context(u)}return c.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:n(+t),c):r},c.y=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a=null,c):i},c.y0=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),c):i},c.y1=function(t){return arguments.length?(a=null==t?null:"function"===typeof t?t:n(+t),c):a},c.lineX0=c.lineY0=function(){return f().x(t).y(i)},c.lineY1=function(){return f().x(t).y(a)},c.lineX1=function(){return f().x(r).y(i)},c.defined=function(t){return arguments.length?(o="function"===typeof t?t:n(!!t),c):o},c.curve=function(t){return arguments.length?(s=t,null!=u&&(l=s(u)),c):s},c.context=function(t){return arguments.length?(null==t?u=l=null:l=s(u=t),c):u},c}function S(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function C(t){return t}_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var O=F(w);function D(t){this._curve=t}function F(t){function e(e){return new D(t(e))}return e._curve=t,e}function T(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function N(){return T(E().curve(O))}function j(){var t=M().curve(O),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return T(n())},delete t.lineX0,t.lineEndAngle=function(){return T(r())},delete t.lineX1,t.lineInnerRadius=function(){return T(i())},delete t.lineY0,t.lineOuterRadius=function(){return T(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function R(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var P=Array.prototype.slice;function z(t){return t.source}function B(t){return t.target}function L(t){var r=z,i=B,a=k,o=A,u=null;function s(){var n,s=P.call(arguments),l=r.apply(this,s),c=i.apply(this,s);if(u||(u=n=e.path()),t(u,+a.apply(this,(s[0]=l,s)),+o.apply(this,s),+a.apply(this,(s[0]=c,s)),+o.apply(this,s)),n)return u=null,n+""||null}return s.source=function(t){return arguments.length?(r=t,s):r},s.target=function(t){return arguments.length?(i=t,s):i},s.x=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),s):a},s.y=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),s):o},s.context=function(t){return arguments.length?(u=null==t?null:t,s):u},s}function q(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function I(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function U(t,e,n,r,i){var a=R(e,n),o=R(e,n=(n+i)/2),u=R(r,n),s=R(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],u[0],u[1],s[0],s[1])}var W={draw:function(t,e){var n=Math.sqrt(e/f);t.moveTo(n,0),t.arc(0,0,n,0,d)}},H={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},V=Math.sqrt(1/3),G=2*V,$={draw:function(t,e){var n=Math.sqrt(e/G),r=n*V;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},Y=Math.sin(f/10)/Math.sin(7*f/10),X=Math.sin(d/10)*Y,J=-Math.cos(d/10)*Y,Q={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=X*n,i=J*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=d*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*n,-u*n),t.lineTo(u*r-s*i,s*r+u*i)}t.closePath()}},Z={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},K=Math.sqrt(3),tt={draw:function(t,e){var n=-Math.sqrt(e/(3*K));t.moveTo(0,2*n),t.lineTo(-K*n,-n),t.lineTo(K*n,-n),t.closePath()}},et=-.5,nt=Math.sqrt(3)/2,rt=1/Math.sqrt(12),it=3*(rt/2+1),at={draw:function(t,e){var n=Math.sqrt(e/it),r=n/2,i=n*rt,a=r,o=n*rt+n,u=-a,s=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(u,s),t.lineTo(et*r-nt*i,nt*r+et*i),t.lineTo(et*a-nt*o,nt*a+et*o),t.lineTo(et*u-nt*s,nt*u+et*s),t.lineTo(et*r+nt*i,et*i-nt*r),t.lineTo(et*a+nt*o,et*o-nt*a),t.lineTo(et*u+nt*s,et*s-nt*u),t.closePath()}},ot=[W,H,$,Z,Q,tt,at];function ut(){}function st(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function lt(t){this._context=t}function ct(t){this._context=t}function ft(t){this._context=t}function ht(t,e){this._basis=new lt(t),this._beta=e}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:st(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ht.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,u=e[n]-a,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*t[s]+(1-this._beta)*(i+r*o),this._beta*e[s]+(1-this._beta)*(a+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var dt=function t(e){function n(t){return 1===e?new lt(t):new ht(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function pt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function vt(t,e){this._context=t,this._k=(1-e)/6}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gt=function t(e){function n(t){return new vt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function mt(t,e){this._context=t,this._k=(1-e)/6}mt.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var yt=function t(e){function n(t){return new mt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function bt(t,e){this._context=t,this._k=(1-e)/6}bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var xt=function t(e){function n(t){return new bt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function _t(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>c){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>c){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function wt(t,e){this._context=t,this._alpha=e}wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var kt=function t(e){function n(t){return e?new wt(t,e):new vt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function At(t,e){this._context=t,this._alpha=e}At.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Et=function t(e){function n(t){return e?new At(t,e):new mt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Mt(t,e){this._context=t,this._alpha=e}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function t(e){function n(t){return e?new Mt(t,e):new bt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ct(t){this._context=t}function Ot(t){return t<0?-1:1}function Dt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(Ot(a)+Ot(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Ft(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*e,a-u,o-u*n,a,o)}function Nt(t){this._context=t}function jt(t){this._context=new Rt(t)}function Rt(t){this._context=t}function Pt(t){this._context=t}function zt(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Bt(t,e){this._context=t,this._t=e}function Lt(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],u=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<u;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function qt(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function It(t,e){return t[e]}function Ut(t){var e=t.map(Wt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Wt(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function Ht(t){var e=t.map(Vt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Vt(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}Ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tt(this,this._t0,Ft(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tt(this,Ft(this,n=Dt(this,t,e)),n);break;default:Tt(this,this._t0,n=Dt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(jt.prototype=Object.create(Nt.prototype)).point=function(t,e){Nt.prototype.point.call(this,e,t)},Rt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=zt(t),i=zt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}},t.arc=function(){var t=v,o=g,_=n(0),w=null,k=m,A=y,E=b,M=null;function S(){var n,v,g=+t.apply(this,arguments),m=+o.apply(this,arguments),y=k.apply(this,arguments)-h,b=A.apply(this,arguments)-h,S=r(b-y),C=b>y;if(M||(M=n=e.path()),m<g&&(v=m,m=g,g=v),m>c)if(S>d-c)M.moveTo(m*a(y),m*s(y)),M.arc(0,0,m,y,b,!C),g>c&&(M.moveTo(g*a(b),g*s(b)),M.arc(0,0,g,b,y,C));else{var O,D,F=y,T=b,N=y,j=b,R=S,P=S,z=E.apply(this,arguments)/2,B=z>c&&(w?+w.apply(this,arguments):l(g*g+m*m)),L=u(r(m-g)/2,+_.apply(this,arguments)),q=L,I=L;if(B>c){var U=p(B/g*s(z)),W=p(B/m*s(z));(R-=2*U)>c?(N+=U*=C?1:-1,j-=U):(R=0,N=j=(y+b)/2),(P-=2*W)>c?(F+=W*=C?1:-1,T-=W):(P=0,F=T=(y+b)/2)}var H=m*a(F),V=m*s(F),G=g*a(j),$=g*s(j);if(L>c){var Y,X=m*a(T),J=m*s(T),Q=g*a(N),Z=g*s(N);if(S<f&&(Y=function(t,e,n,r,i,a,o,u){var s=n-t,l=r-e,f=o-i,h=u-a,d=h*s-f*l;if(!(d*d<c))return[t+(d=(f*(e-a)-h*(t-i))/d)*s,e+d*l]}(H,V,Q,Z,X,J,G,$))){var K=H-Y[0],tt=V-Y[1],et=X-Y[0],nt=J-Y[1],rt=1/s(function(t){return t>1?0:t<-1?f:Math.acos(t)}((K*et+tt*nt)/(l(K*K+tt*tt)*l(et*et+nt*nt)))/2),it=l(Y[0]*Y[0]+Y[1]*Y[1]);q=u(L,(g-it)/(rt-1)),I=u(L,(m-it)/(rt+1))}}P>c?I>c?(O=x(Q,Z,H,V,m,I,C),D=x(X,J,G,$,m,I,C),M.moveTo(O.cx+O.x01,O.cy+O.y01),I<L?M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,m,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),!C),M.arc(D.cx,D.cy,I,i(D.y11,D.x11),i(D.y01,D.x01),!C))):(M.moveTo(H,V),M.arc(0,0,m,F,T,!C)):M.moveTo(H,V),g>c&&R>c?q>c?(O=x(G,$,X,J,g,-q,C),D=x(H,V,Q,Z,g,-q,C),M.lineTo(O.cx+O.x01,O.cy+O.y01),q<L?M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,g,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),C),M.arc(D.cx,D.cy,q,i(D.y11,D.x11),i(D.y01,D.x01),!C))):M.arc(0,0,g,j,N,C):M.lineTo(G,$)}else M.moveTo(0,0);if(M.closePath(),n)return M=null,n+""||null}return S.centroid=function(){var e=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,n=(+k.apply(this,arguments)+ +A.apply(this,arguments))/2-f/2;return[a(n)*e,s(n)*e]},S.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),S):t},S.outerRadius=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),S):o},S.cornerRadius=function(t){return arguments.length?(_="function"===typeof t?t:n(+t),S):_},S.padRadius=function(t){return arguments.length?(w=null==t?null:"function"===typeof t?t:n(+t),S):w},S.startAngle=function(t){return arguments.length?(k="function"===typeof t?t:n(+t),S):k},S.endAngle=function(t){return arguments.length?(A="function"===typeof t?t:n(+t),S):A},S.padAngle=function(t){return arguments.length?(E="function"===typeof t?t:n(+t),S):E},S.context=function(t){return arguments.length?(M=null==t?null:t,S):M},S},t.area=M,t.areaRadial=j,t.curveBasis=function(t){return new lt(t)},t.curveBasisClosed=function(t){return new ct(t)},t.curveBasisOpen=function(t){return new ft(t)},t.curveBundle=dt,t.curveCardinal=gt,t.curveCardinalClosed=yt,t.curveCardinalOpen=xt,t.curveCatmullRom=kt,t.curveCatmullRomClosed=Et,t.curveCatmullRomOpen=St,t.curveLinear=w,t.curveLinearClosed=function(t){return new Ct(t)},t.curveMonotoneX=function(t){return new Nt(t)},t.curveMonotoneY=function(t){return new jt(t)},t.curveNatural=function(t){return new Pt(t)},t.curveStep=function(t){return new Bt(t,.5)},t.curveStepAfter=function(t){return new Bt(t,1)},t.curveStepBefore=function(t){return new Bt(t,0)},t.line=E,t.lineRadial=N,t.linkHorizontal=function(){return L(q)},t.linkRadial=function(){var t=L(U);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.linkVertical=function(){return L(I)},t.pie=function(){var t=C,e=S,r=null,i=n(0),a=n(d),o=n(0);function u(n){var u,s,l,c,f,h=n.length,p=0,v=new Array(h),g=new Array(h),m=+i.apply(this,arguments),y=Math.min(d,Math.max(-d,a.apply(this,arguments)-m)),b=Math.min(Math.abs(y)/h,o.apply(this,arguments)),x=b*(y<0?-1:1);for(u=0;u<h;++u)(f=g[v[u]=u]=+t(n[u],u,n))>0&&(p+=f);for(null!=e?v.sort(function(t,n){return e(g[t],g[n])}):null!=r&&v.sort(function(t,e){return r(n[t],n[e])}),u=0,l=p?(y-h*x)/p:0;u<h;++u,m=c)s=v[u],c=m+((f=g[s])>0?f*l:0)+x,g[s]={data:n[s],index:u,value:f,startAngle:m,endAngle:c,padAngle:b};return g}return u.value=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),u):t},u.sortValues=function(t){return arguments.length?(e=t,r=null,u):e},u.sort=function(t){return arguments.length?(r=t,e=null,u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),u):o},u},t.pointRadial=R,t.radialArea=j,t.radialLine=N,t.stack=function(){var t=n([]),e=qt,r=Lt,i=It;function a(n){var a,o,u=t.apply(this,arguments),s=n.length,l=u.length,c=new Array(l);for(a=0;a<l;++a){for(var f,h=u[a],d=c[a]=new Array(s),p=0;p<s;++p)d[p]=f=[0,+i(n[p],h,p,n)],f.data=n[p];d.key=h}for(a=0,o=e(c);a<l;++a)c[o[a]].index=a;return r(c,o),c}return a.keys=function(e){return arguments.length?(t="function"===typeof e?e:n(P.call(e)),a):t},a.value=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a):i},a.order=function(t){return arguments.length?(e=null==t?qt:"function"===typeof t?t:n(P.call(t)),a):e},a.offset=function(t){return arguments.length?(r=null==t?Lt:t,a):r},a},t.stackOffsetDiverging=function(t,e){if((u=t.length)>0)for(var n,r,i,a,o,u,s=0,l=t[e[0]].length;s<l;++s)for(a=o=0,n=0;n<u;++n)(i=(r=t[e[n]][s])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)},t.stackOffsetExpand=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}Lt(t,e)}},t.stackOffsetNone=Lt,t.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,u=0;o<n;++o)u+=t[o][r][1]||0;i[r][1]+=i[r][0]=-u/2}Lt(t,e)}},t.stackOffsetWiggle=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var u=0,s=0,l=0;u<i;++u){for(var c=t[e[u]],f=c[o][1]||0,h=(f-(c[o-1][1]||0))/2,d=0;d<u;++d){var p=t[e[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}s+=f,l+=h*f}n[o-1][1]+=n[o-1][0]=a,s&&(a-=l/s)}n[o-1][1]+=n[o-1][0]=a,Lt(t,e)}},t.stackOrderAppearance=Ut,t.stackOrderAscending=Ht,t.stackOrderDescending=function(t){return Ht(t).reverse()},t.stackOrderInsideOut=function(t){var e,n,r=t.length,i=t.map(Vt),a=Ut(t),o=0,u=0,s=[],l=[];for(e=0;e<r;++e)n=a[e],o<u?(o+=i[n],s.push(n)):(u+=i[n],l.push(n));return l.reverse().concat(s)},t.stackOrderNone=qt,t.stackOrderReverse=function(t){return qt(t).reverse()},t.symbol=function(){var t=n(W),r=n(64),i=null;function a(){var n;if(i||(i=n=e.path()),t.apply(this,arguments).draw(i,+r.apply(this,arguments)),n)return i=null,n+""||null}return a.type=function(e){return arguments.length?(t="function"===typeof e?e:n(e),a):t},a.size=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),a):r},a.context=function(t){return arguments.length?(i=null==t?null:t,a):i},a},t.symbolCircle=W,t.symbolCross=H,t.symbolDiamond=$,t.symbolSquare=Z,t.symbolStar=Q,t.symbolTriangle=tt,t.symbolWye=at,t.symbols=ot,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1080))},2140:function(t,e,n){var r=n(19),i=n(1112);!function(t,e,n,a,o,u,s,l){"use strict";function c(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}var f="default";function h(t){var n=t._signals.cursor;n||(t._signals.cursor=n=t.add({user:f,item:null})),t.on(t.events("view","mousemove"),n,function(t,r){var i=n.value,a=i?e.isString(i)?i:i.user:f,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),t.add(null,function(t){var n=t.cursor,r=this.value;return e.isString(n)||(r=n.item,n=n.user),function(t){"undefined"!==typeof document&&document.body&&(document.body.style.cursor=t)}(n&&n!==f?n:r||n),r},{cursor:n})}function d(t,n){var r=t._runtime.data;return e.hasOwnProperty(r,n)||e.error("Unrecognized data set: "+n),r[n]}function p(t,r){n.isChangeSet(r)||e.error("Second argument to changes must be a changeset.");var i=d(this,t);return i.modified=!0,this.pulse(i.input,r)}function v(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function g(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function m(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function y(t){var e=m(t),n=v(t),r=g(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach(function(e){try{e(n,r)}catch(i){t.error(i)}})}function b(t,n,r){var i,o,u,s=t._renderer,l=s&&s.canvas();return l&&(u=m(t),o=n.changedTouches?n.changedTouches[0]:n,(i=a.point(o,l))[0]-=u[0],i[1]-=u[1]),n.dataflow=t,n.item=r,n.vega=function(t,n,r){var i=n?"group"===n.mark.marktype?n:n.mark.group:null;function a(t){var e,r=i;if(t)for(e=n;e;e=e.mark.group)if(e.mark.name===t){r=e;break}return r&&r.mark&&r.mark.interactive?r:{}}function o(t){if(!t)return r;e.isString(t)&&(t=a(t));for(var n=r.slice();t;)n[0]-=t.x||0,n[1]-=t.y||0,t=t.mark&&t.mark.group;return n}return{view:e.constant(t),item:e.constant(n||{}),group:a,xy:o,x:function(t){return o(t)[0]},y:function(t){return o(t)[1]}}}(t,r,i),n}var x="view",_="timer",w="window",k={trap:!1};function A(t,n,r){var i=t._eventConfig&&t._eventConfig[n];return!(!1===i||e.isObject(i)&&!i[r])||(t.warn("Blocked ".concat(n," ").concat(r," event listener.")),!1)}function E(t){return t.item}function M(t){return t.item.mark.source}function S(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function C(t,e,n){var r=document.createElement(t);for(var i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}var O="vega-bind",D="vega-bind-name",F="vega-bind-radio",T="vega-option-";function N(t,n,r){if(n){var i=r.param,a=r.state;return a||(a=r.state={elements:null,active:!1,set:null,update:function(e){e!==t.signal(i.signal)&&t.runAsync(null,function(){a.source=!0,t.signal(i.signal,e)})}},i.debounce&&(a.update=e.debounce(i.debounce,a.update))),function(t,e,n,r){var i=C("div",{class:O});i.appendChild(C("span",{class:D},n.name||n.signal)),e.appendChild(i);var a=j;switch(n.input){case"checkbox":a=R;break;case"select":a=P;break;case"radio":a=z;break;case"range":a=B}a(t,i,n,r)}(a,n,i,t.signal(i.signal)),a.active||(t.on(t._signals[i.signal],null,function(){a.source?a.source=!1:a.set(t.signal(i.signal))}),a.active=!0),a}}function j(t,e,n,r){var i=C("input");for(var a in n)"signal"!==a&&"element"!==a&&i.setAttribute("input"===a?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",function(){t.update(i.value)}),t.elements=[i],t.set=function(t){i.value=t}}function R(t,e,n,r){var i={type:"checkbox",name:n.signal};r&&(i.checked=!0);var a=C("input",i);e.appendChild(a),a.addEventListener("change",function(){t.update(a.checked)}),t.elements=[a],t.set=function(t){a.checked=!!t||null}}function P(t,e,n,r){var i=C("select",{name:n.signal}),a=n.labels||[];n.options.forEach(function(t,e){var n={value:t};L(t,r)&&(n.selected=!0),i.appendChild(C("option",n,(a[e]||t)+""))}),e.appendChild(i),i.addEventListener("change",function(){t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=function(t){for(var e=0,r=n.options.length;e<r;++e)if(L(n.options[e],t))return void(i.selectedIndex=e)}}function z(t,e,n,r){var i=C("span",{class:F}),a=n.labels||[];e.appendChild(i),t.elements=n.options.map(function(e,o){var u=T+n.signal+"-"+e,s={id:u,type:"radio",name:n.signal,value:e};L(e,r)&&(s.checked=!0);var l=C("input",s);return l.addEventListener("change",function(){t.update(e)}),i.appendChild(l),i.appendChild(C("label",{for:u},(a[o]||e)+"")),l}),t.set=function(e){for(var n=t.elements,r=0,i=n.length;r<i;++r)L(n[r].value,e)&&(n[r].checked=!0)}}function B(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var i=null!=n.max?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,u=n.step||o.tickStep(a,i,100),s=C("input",{type:"range",name:n.signal,min:a,max:i,step:u});s.value=r;var l=C("label",{},+r);function c(){l.textContent=s.value,t.update(+s.value)}e.appendChild(s),e.appendChild(l),s.addEventListener("input",c),s.addEventListener("change",c),t.elements=[s],t.set=function(t){s.value=t,l.textContent=t}}function L(t,e){return t===e||t+""===e+""}function q(t,e,n,r,i,a){return(e=e||new r(t.loader())).initialize(n,v(t),g(t),m(t),i,a).background(t.background())}function I(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function U(t,e){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e)try{e.innerHTML=""}catch(n){e=null,t.error(n)}return e}var W=function(t){return+t||0},H=function(t){return{top:t,bottom:t,left:t,right:t}};function V(t){return e.isObject(t)?{top:W(t.top),bottom:W(t.bottom),left:W(t.left),right:W(t.right)}:H(W(t))}function G(t,e,n,r){return $.apply(this,arguments)}function $(){return($=i(r.mark(function t(n,i,o,u){var s,l;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=a.renderModule(i),(l=s&&s.headless)||e.error("Unrecognized renderer type: "+i),t.next=4,n.runAsync();case 4:return t.abrupt("return",q(n,null,null,l,o,u).renderAsync(n._scenegraph.root));case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)}function Y(){return(Y=i(r.mark(function t(n,i){var o;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n!==a.RenderType.Canvas&&n!==a.RenderType.SVG&&n!==a.RenderType.PNG&&e.error("Unrecognized image type: "+n),t.next=3,G(this,n,i);case 3:return o=t.sent,t.abrupt("return",n===a.RenderType.SVG?X(o.svg(),"image/svg+xml"):o.canvas().toDataURL("image/png"));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function X(t,e){var n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}function J(){return(J=i(r.mark(function t(e,n){var i;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(this,a.RenderType.Canvas,e,n);case 2:return i=t.sent,t.abrupt("return",i.canvas());case 4:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Q(){return(Q=i(r.mark(function t(e){var n;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(this,a.RenderType.SVG,e);case 2:return n=t.sent,t.abrupt("return",n.svg());case 4:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var Z="width",K="height",tt="padding",et={skip:!0};function nt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===tt?r.left+r.right:0)}function rt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===tt?r.top+r.bottom:0)}function it(t,n){return n.modified&&e.isArray(n.input.value)&&t.indexOf("_:vega:_")}function at(t,e){return!("parent"===t||e instanceof n.transforms.proxy)}function ot(t,n,r,i){var a=t.element();a&&a.setAttribute("title",function(t){return null==t?"":e.isArray(t)?ut(t):e.isObject(t)&&!e.isDate(t)?(n=t,Object.keys(n).map(function(t){var r=n[t];return t+": "+(e.isArray(r)?ut(r):st(r))}).join("\n")):t+"";var n}(i))}function ut(t){return"["+t.map(st).join(", ")+"]"}function st(t){return e.isArray(t)?"[\u2026]":e.isObject(t)&&!e.isDate(t)?"{\u2026}":t}function lt(t,r){r=r||{},n.Dataflow.call(this),r.loader&&this.loader(r.loader),r.logger&&this.logger(r.logger),null!=r.logLevel&&this.logLevel(r.logLevel),this._el=null,this._elBind=null,this._renderType=r.renderer||a.RenderType.Canvas,this._scenegraph=new a.Scenegraph;var i=this._scenegraph.root;this._renderer=null,this._tooltip=r.tooltip||ot,this._redraw=!0,this._handler=(new a.CanvasHandler).scene(i),this._preventDefault=!1,this._timers=[],this._eventListeners=[],this._resizeListeners=[],this._eventConfig=function(t){var n=e.extend({defaults:{}},t),r=function(t,n){n.forEach(function(n){e.isArray(t[n])&&(t[n]=e.toSet(t[n]))})};return r(n.defaults,["prevent","allow"]),r(n,["view","window","selector"]),n}(t.eventConfig);var o=function(t,e,r){var i=r||u.functionContext;return s.parse(e,s.context(t,n.transforms,i))}(this,t,r.functions);this._runtime=o,this._signals=o.signals,this._bind=(t.bindings||[]).map(function(t){return{state:null,param:e.extend({},t)}}),o.root&&o.root.set(i),i.source=o.data.root.input,this.pulse(o.data.root.input,this.changeset().insert(i.items)),this._width=this.width(),this._height=this.height(),this._viewWidth=nt(this,this._width),this._viewHeight=rt(this,this._height),this._origin=[0,0],this._resize=0,this._autosize=1,function(t){var e=t._signals,n=e[Z],r=e[K],i=e[tt];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,function(e){t._width=e.size,t._viewWidth=nt(t,e.size),a()},{size:n}),t._resizeHeight=t.add(null,function(e){t._height=e.size,t._viewHeight=rt(t,e.size),a()},{size:r});var o=t.add(null,a,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}(this),function(t){t.add(null,function(e){return t._background=e.bg,t._resize=1,e.bg},{bg:t._signals.background})}(this),h(this),this.description(t.description),r.hover&&this.hover(),r.container&&this.initialize(r.container,r.bind)}var ct=e.inherits(lt,n.Dataflow);function ft(t,n){return e.hasOwnProperty(t._signals,n)?t._signals[n]:e.error("Unrecognized signal name: "+e.stringValue(n))}function ht(t,e){var n=(t._targets||[]).filter(function(t){var n=t._update;return n&&n.handler===e});return n.length?n[0]:null}function dt(t,e,n,r){var i=ht(n,r);return i||((i=I(this,function(){r(e,n.value)})).handler=r,t.on(n,null,i)),t}function pt(t,e,n){var r=ht(e,n);return r&&e._targets.remove(r),t}ct.evaluate=function(){var t=i(r.mark(function t(e,i,a){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.Dataflow.prototype.evaluate.call(this,e,i);case 2:if(!this._redraw&&!this._resize){t.next=14;break}if(t.prev=3,!this._renderer){t.next=8;break}return this._resize&&(this._resize=0,y(this)),t.next=8,this._renderer.renderAsync(this._scenegraph.root);case 8:this._redraw=!1,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.error(t.t0);case 14:return a&&n.asyncCallback(this,a),t.abrupt("return",this);case 16:case"end":return t.stop()}},t,this,[[3,11]])}));return function(e,n,r){return t.apply(this,arguments)}}(),ct.dirty=function(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},ct.description=function(t){if(arguments.length){var e=null!=t?t+"":null;return e!==this._desc&&c(this._el,this._desc=e),this}return this._desc},ct.container=function(){return this._el},ct.scenegraph=function(){return this._scenegraph},ct.origin=function(){return this._origin.slice()},ct.signal=function(t,e,n){var r=ft(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},ct.width=function(t){return arguments.length?this.signal("width",t):this.signal("width")},ct.height=function(t){return arguments.length?this.signal("height",t):this.signal("height")},ct.padding=function(t){return arguments.length?this.signal("padding",V(t)):V(this.signal("padding"))},ct.autosize=function(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},ct.background=function(t){return arguments.length?this.signal("background",t):this.signal("background")},ct.renderer=function(t){return arguments.length?(a.renderModule(t)||e.error("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},ct.tooltip=function(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},ct.loader=function(t){return arguments.length?(t!==this._loader&&(n.Dataflow.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},ct.resize=function(){return this._autosize=1,this.touch(ft(this,"autosize"))},ct._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},ct._resizeView=function(t,e,n,r,i,a){this.runAfter(function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(Z,n,et),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(K,r,et),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),u&&o.run("enter"),a&&o.runAfter(function(t){return t.resize()})},!1,1)},ct.addEventListener=function(t,e,n){var r=e;return n&&!1===n.trap||((r=I(this,e)).raw=e),this._handler.on(t,r),this},ct.removeEventListener=function(t,e){for(var n,r,i=this._handler.handlers(t),a=i.length;--a>=0;)if(r=i[a].type,n=i[a].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},ct.addResizeListener=function(t){var e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},ct.removeResizeListener=function(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},ct.addSignalListener=function(t,e){return dt(this,t,ft(this,t),e)},ct.removeSignalListener=function(t,e){return pt(this,ft(this,t),e)},ct.addDataListener=function(t,e){return dt(this,t,d(this,t).values,e)},ct.removeDataListener=function(t,e){return pt(this,d(this,t).values,e)},ct.preventDefault=function(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},ct.timer=function(t,e){this._timers.push(l.interval(function(e){t({timestamp:Date.now(),elapsed:e})},e))},ct.events=function(t,e,r){var i,a=this,o=new n.EventStream(r),u=function(n,r){a.runAsync(null,function(){t===x&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(a,e)&&n.preventDefault(),o.receive(b(a,n,r))})};if(t===_)A(a,"timer",e)&&a.timer(u,e);else if(t===x)A(a,"view",e)&&a.addEventListener(e,u,k);else if(t===w?A(a,"window",e)&&"undefined"!==typeof window&&(i=[window]):"undefined"!==typeof document&&A(a,"selector",e)&&(i=document.querySelectorAll(t)),i){for(var s=0,l=i.length;s<l;++s)i[s].addEventListener(e,u);a._eventListeners.push({type:e,sources:i,handler:u})}else a.warn("Can not resolve event source: "+t);return o},ct.finalize=function(){var t,e,n,r=this._tooltip,i=this._timers,a=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=a.length;--t>=0;)for(e=(n=a[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},ct.hover=function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",E),M,S(t)),this.on(this.events("view","mouseout",E),M,S(e)),this},ct.data=function(t,r){return arguments.length<2?d(this,t).values.value:p.call(this,t,n.changeset().remove(e.truthy).insert(r))},ct.change=p,ct.insert=function(t,e){return p.call(this,t,n.changeset().insert(e))},ct.remove=function(t,e){return p.call(this,t,n.changeset().remove(e))},ct.scale=function(t){var n=this._runtime.scales;return e.hasOwnProperty(n,t)||e.error("Unrecognized scale or projection: "+t),n[t].value},ct.initialize=function(t,e){var n=this,r=n._renderType,i=n._eventConfig.bind,o=a.renderModule(r);t=n._el=t?U(n,t):null,function(t){var e=t.container();e&&(e.setAttribute("role","figure"),c(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);var u=o.handler||a.CanvasHandler,s=t?o.renderer:o.headless;return n._renderer=s?q(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){var i=new r(t.loader(),I(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,m(t),t);return e&&e.handlers().forEach(function(t){i.on(t.type,t.handler)}),i}(n,n._handler,t,u),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=U(n,e):t.appendChild(C("div",{class:"vega-bindings"})),n._bind.forEach(function(t){t.param.element&&"container"!==i&&(t.element=U(n,t.param.element))}),n._bind.forEach(function(t){N(n,t.element||e,t)})),n},ct.toImageURL=function(t,e){return Y.apply(this,arguments)},ct.toCanvas=function(t,e){return J.apply(this,arguments)},ct.toSVG=function(t){return Q.apply(this,arguments)},ct.getState=function(t){return this._runtime.getState(t||{data:it,signals:at,recurse:!0})},ct.setState=function(t){return this.runAsync(null,function(e){e._trigger=!1,e._runtime.setState(t)},function(t){t._trigger=!0}),this},t.View=lt,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1344),n(1045),n(2141),n(1053),n(1345),n(1566),n(1168))},2141:function(t,e,n){!function(t,e,n,r,i,a){"use strict";function o(t){this.clear(),t&&this.union(t)}var u=o.prototype;u.clone=function(){return new o(this)},u.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},u.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},u.equals=function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},u.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},u.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},u.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},u.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},u.scale=function(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},u.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},u.rotate=function(t,e,n){var r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},u.rotatedPoints=function(t,e,n){var r=this.x1,i=this.y1,a=this.x2,o=this.y2,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,c=n-e*s-n*u;return[u*r-s*i+l,s*r+u*i+c,u*r-s*o+l,s*r+u*o+c,u*a-s*i+l,s*a+u*i+c,u*a-s*o+l,s*a+u*o+c]},u.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},u.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},u.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},u.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},u.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},u.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},u.width=function(){return this.x2-this.x1},u.height=function(){return this.y2-this.y1};var s=0,l="p_";function c(t){return t&&t.gradient}function f(t,e,n){var r=t.id,i=t.gradient,a="radial"===i?l:"";return r||(r=t.id="gradient_"+s++,"radial"===i?(t.x1=h(t.x1,.5),t.y1=h(t.y1,.5),t.r1=h(t.r1,0),t.x2=h(t.x2,.5),t.y2=h(t.y2,.5),t.r2=h(t.r2,.5),a=l):(t.x1=h(t.x1,0),t.y1=h(t.y1,0),t.x2=h(t.x2,1),t.y2=h(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+a+r+")"}function h(t,e){return null!=t?t:e}function d(t){this.mark=t,this.bounds=this.bounds||new o}function p(t){d.call(this,t),this.items=this.items||[]}function v(t){this._pending=0,this._loader=t||r.loader()}e.inherits(p,d);var g=v.prototype;function m(t){t._pending+=1}function y(t){t._pending-=1}g.pending=function(){return this._pending},g.sanitizeURL=function(t){var e=this;return m(e),e._loader.sanitize(t,{context:"href"}).then(function(t){return y(e),t}).catch(function(){return y(e),null})},g.loadImage=function(t){var r=this,i=n.image();return m(r),r._loader.sanitize(t,{context:"image"}).then(function(t){var n=t.href;if(!n||!i)throw{url:n};var a=new i,o=e.hasOwnProperty(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(a.crossOrigin=o),a.onload=function(){return y(r)},a.onerror=function(){return y(r)},a.src=n,a}).catch(function(t){return y(r),{complete:!1,width:0,height:0,src:t&&t.url||""}})},g.ready=function(){var t=this;return new Promise(function(e){!function n(r){t.pending()?setTimeout(function(){n(!0)},10):e(r)}(!1)})};var b={basis:{curve:i.curveBasis},"basis-closed":{curve:i.curveBasisClosed},"basis-open":{curve:i.curveBasisOpen},bundle:{curve:i.curveBundle,tension:"beta",value:.85},cardinal:{curve:i.curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:i.curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:i.curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:i.curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:i.curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:i.curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:i.curveLinear},"linear-closed":{curve:i.curveLinearClosed},monotone:{horizontal:i.curveMonotoneY,vertical:i.curveMonotoneX},natural:{curve:i.curveNatural},step:{curve:i.curveStep},"step-after":{curve:i.curveStepAfter},"step-before":{curve:i.curveStepBefore}};function x(t,n,r){var i=e.hasOwnProperty(b,t)&&b[t],a=null;return i&&(a=i.curve||i[n||"vertical"],i.tension&&null!=r&&(a=a[i.tension](r))),a}var _={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},w=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function k(t){var e,n,r,i,a,o,u,s,l,c,f,h=[];for(s=0,c=(e=t.slice().replace(w[0],"###$1").split(w[1]).slice(1)).length;s<c;++s){for(r=(n=e[s]).slice(1).trim().replace(w[2],"$1###$2").split(w[3]),i=[o=n.charAt(0)],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(u=_[o.toLowerCase()],i.length-1>u)for(l=1,f=i.length;l<f;l+=u)h.push([o].concat(i.slice(l,l+u)));else h.push(i)}return h}var A=Math.PI/180,E=1e-14,M=Math.PI/2,S=2*Math.PI,C=Math.sqrt(3)/2,O={},D={},F=[].join;function T(t){var e=F.call(t);if(D[e])return D[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=l*o,f=-s*u,h=s*o,d=l*u,p=Math.cos(i),v=Math.sin(i),g=Math.cos(a),m=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),_=n+p-x*v,w=r+v+x*p,k=n+g,A=r+m,E=k+x*m,M=A-x*g;return D[e]=[c*_+f*w,h*_+d*w,c*E+f*M,h*E+d*M,c*k+f*A,h*k+d*A]}var N=["l",0,0,0,0,0,0,0];function j(t,e,n){var r=N[0]=t[0];if("a"===r||"A"===r)N[1]=e*t[1],N[2]=n*t[2],N[3]=t[3],N[4]=t[4],N[5]=t[5],N[6]=e*t[6],N[7]=n*t[7];else if("h"===r||"H"===r)N[1]=e*t[1];else if("v"===r||"V"===r)N[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)N[i]=(i%2==1?e:n)*t[i];return N}function R(t,e,n,r,i,a){var o,u,s,l,c,f=null,h=0,d=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var g=0,m=e.length;g<m;++g){switch(o=e[g],1===i&&1===a||(o=j(o,i,a)),o[0]){case"l":h+=o[1],d+=o[2],t.lineTo(h+n,d+r);break;case"L":h=o[1],d=o[2],t.lineTo(h+n,d+r);break;case"h":h+=o[1],t.lineTo(h+n,d+r);break;case"H":h=o[1],t.lineTo(h+n,d+r);break;case"v":d+=o[1],t.lineTo(h+n,d+r);break;case"V":d=o[1],t.lineTo(h+n,d+r);break;case"m":h+=o[1],d+=o[2],t.moveTo(h+n,d+r);break;case"M":h=o[1],d=o[2],t.moveTo(h+n,d+r);break;case"c":u=h+o[5],s=d+o[6],p=h+o[3],v=d+o[4],t.bezierCurveTo(h+o[1]+n,d+o[2]+r,p+n,v+r,u+n,s+r),h=u,d=s;break;case"C":h=o[5],d=o[6],p=o[3],v=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,h+n,d+r);break;case"s":u=h+o[3],s=d+o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,h+o[1]+n,d+o[2]+r,u+n,s+r),p=h+o[1],v=d+o[2],h=u,d=s;break;case"S":u=o[3],s=o[4],p=2*h-p,v=2*d-v,t.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"q":u=h+o[3],s=d+o[4],p=h+o[1],v=d+o[2],t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"Q":u=o[3],s=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),h=u,d=s,p=o[1],v=o[2];break;case"t":u=h+o[1],s=d+o[2],null===f[0].match(/[QqTt]/)?(p=h,v=d):"t"===f[0]?(p=2*h-l,v=2*d-c):"q"===f[0]&&(p=2*h-p,v=2*d-v),l=p,c=v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),d=s,p=(h=u)+o[1],v=d+o[2];break;case"T":u=o[1],s=o[2],p=2*h-p,v=2*d-v,t.quadraticCurveTo(p+n,v+r,u+n,s+r),h=u,d=s;break;case"a":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+h+n,o[7]+d+r]),h+=o[6],d+=o[7];break;case"A":P(t,h+n,d+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),h=o[6],d=o[7];break;case"z":case"Z":t.closePath()}f=o}}function P(t,e,n,r){for(var i=function(t,e,n,r,i,a,o,u,s){var l=F.call(arguments);if(O[l])return O[l];var c=o*A,f=Math.sin(c),h=Math.cos(c),d=h*(u-t)*.5+f*(s-e)*.5,p=h*(s-e)*.5-f*(u-t)*.5,v=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=h/n,m=f/n,y=-f/r,b=h/r,x=g*u+m*s,_=y*u+b*s,w=g*t+m*e,k=y*t+b*e,E=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;E<0&&(E=0);var C=Math.sqrt(E);a==i&&(C=-C);var D=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),N=Math.atan2(_-T,x-D),j=Math.atan2(k-T,w-D)-N;j<0&&1===a?j+=S:j>0&&0===a&&(j-=S);for(var R=Math.ceil(Math.abs(j/(M+.001))),P=[],z=0;z<R;++z){var B=N+z*j/R,L=N+(z+1)*j/R;P[z]=[D,T,B,L,n,r,f,h]}return O[l]=P}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),a=0;a<i.length;++a){var o=T(i[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var z={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,S)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=C*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function B(t){return e.hasOwnProperty(z,t)?z[t]:function(t){if(!e.hasOwnProperty(L,t)){var n=k(t);L[t]={draw:function(t,e){R(t,n,0,0,Math.sqrt(e)/2)}}}return L[t]}(t)}var L={},q=.448084975506;function I(t){return t.x}function U(t){return t.y}function W(t){return t.width}function H(t){return t.height}function V(t){return"function"===typeof t?t:function(){return+t}}function G(t,e,n){return Math.max(e,Math.min(t,n))}function $(){var t=I,e=U,n=W,r=H,i=V(0),o=i,u=i,s=i,l=null;function c(c,f,h){var d,p=null!=f?f:+t.call(this,c),v=null!=h?h:+e.call(this,c),g=+n.call(this,c),m=+r.call(this,c),y=Math.min(g,m)/2,b=G(+i.call(this,c),0,y),x=G(+o.call(this,c),0,y),_=G(+u.call(this,c),0,y),w=G(+s.call(this,c),0,y);if(l||(l=d=a.path()),b<=0&&x<=0&&_<=0&&w<=0)l.rect(p,v,g,m);else{var k=p+g,A=v+m;l.moveTo(p+b,v),l.lineTo(k-x,v),l.bezierCurveTo(k-q*x,v,k,v+q*x,k,v+x),l.lineTo(k,A-w),l.bezierCurveTo(k,A-q*w,k-q*w,A,k-w,A),l.lineTo(p+_,A),l.bezierCurveTo(p+q*_,A,p,A-q*_,p,A-_),l.lineTo(p,v+b),l.bezierCurveTo(p,v+q*b,p+q*b,v,p+b,v),l.closePath()}if(d)return l=null,d+""||null}return c.x=function(e){return arguments.length?(t=V(e),c):t},c.y=function(t){return arguments.length?(e=V(t),c):e},c.width=function(t){return arguments.length?(n=V(t),c):n},c.height=function(t){return arguments.length?(r=V(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=V(t),o=null!=e?V(e):i,s=null!=n?V(n):i,u=null!=r?V(r):o,c):i},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}function Y(){var t,e,n,r,i,o,u,s,l=null;function c(t,e,n){var r=n/2;if(i){var a=u-e,c=t-o;if(a||c){var f=Math.sqrt(a*a+c*c),h=(a/=f)*s,d=(c/=f)*s,p=Math.atan2(c,a);l.moveTo(o-h,u-d),l.lineTo(t-a*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+h,u+d),l.arc(o,u,s,p,p+Math.PI)}else l.arc(t,e,r,0,S);l.closePath()}else i=1;o=t,u=e,s=r}function f(o){var u,s,f,h=o.length,d=!1;for(null==l&&(l=f=a.path()),u=0;u<=h;++u)!(u<h&&r(s=o[u],u,o))===d&&(d=!d)&&(i=0),d&&c(+t(s,u,o),+e(s,u,o),+n(s,u,o));if(f)return l=null,f+""||null}return f.x=function(e){return arguments.length?(t=e,f):t},f.y=function(t){return arguments.length?(e=t,f):e},f.size=function(t){return arguments.length?(n=t,f):n},f.defined=function(t){return arguments.length?(r=t,f):r},f.context=function(t){return arguments.length?(l=null==t?null:t,f):l},f}function X(t,e){return null!=t?t:e}var J=function(t){return t.x||0},Q=function(t){return t.y||0},Z=function(t){return!(!1===t.defined)},K=i.arc().startAngle(function(t){return t.startAngle||0}).endAngle(function(t){return t.endAngle||0}).padAngle(function(t){return t.padAngle||0}).innerRadius(function(t){return t.innerRadius||0}).outerRadius(function(t){return t.outerRadius||0}).cornerRadius(function(t){return t.cornerRadius||0}),tt=i.area().x(J).y1(Q).y0(function(t){return(t.y||0)+(t.height||0)}).defined(Z),et=i.area().y(Q).x1(J).x0(function(t){return(t.x||0)+(t.width||0)}).defined(Z),nt=i.line().x(J).y(Q).defined(Z),rt=$().x(J).y(Q).width(function(t){return t.width||0}).height(function(t){return t.height||0}).cornerRadius(function(t){return X(t.cornerRadiusTopLeft,t.cornerRadius)||0},function(t){return X(t.cornerRadiusTopRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomRight,t.cornerRadius)||0},function(t){return X(t.cornerRadiusBottomLeft,t.cornerRadius)||0}),it=i.symbol().type(function(t){return B(t.shape||"circle")}).size(function(t){return X(t.size,64)}),at=Y().x(J).y(Q).defined(Z).size(function(t){return t.size||1});function ot(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function ut(t,e,n,r){return rt.context(t)(e,n,r)}function st(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){var r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}var lt,ct,ft,ht=S-1e-8;function dt(t){return lt=t,dt}function pt(){}function vt(t,e){lt.add(t,e)}function gt(t,e){vt(ct=t,ft=e)}function mt(t){vt(t,lt.y1)}function yt(t){vt(lt.x1,t)}function bt(t,e,n,r){var i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function xt(t,e,n,r,i){var a,o=r-t+3*e-3*n,u=t+n-2*e,s=t-e,l=0,c=0;Math.abs(o)>E?(a=u*u+s*o)>=0&&(l=(-u+(a=Math.sqrt(a)))/o,c=(-u-a)/o):l=.5*s/u,0<l&&l<1&&i(_t(l,t,e,n,r)),0<c&&c<1&&i(_t(c,t,e,n,r))}function _t(t,e,n,r,i){var a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*r+u*t*i}dt.beginPath=pt,dt.closePath=pt,dt.moveTo=gt,dt.lineTo=gt,dt.rect=function(t,e,n,r){vt(t+n,e+r),gt(t,e)},dt.quadraticCurveTo=function(t,e,n,r){bt(ct,t,n,mt),bt(ft,e,r,yt),gt(n,r)},dt.bezierCurveTo=function(t,e,n,r,i,a){xt(ct,t,n,i,mt),xt(ft,e,r,a,yt),gt(i,a)},dt.arc=function(t,e,n,r,i,a){if(ct=n*Math.cos(i)+t,ft=n*Math.sin(i)+e,Math.abs(i-r)>ht)vt(t-n,e-n),vt(t+n,e+n);else{var o,u,s=function(r){return vt(n*Math.cos(r)+t,n*Math.sin(r)+e)};if(s(r),s(i),i!==r)if((r%=S)<0&&(r+=S),(i%=S)<0&&(i+=S),i<r&&(a=!a,o=r,r=i,i=o),a)for(i-=S,o=r-r%M,u=0;u<4&&o>i;++u,o-=M)s(o);else for(o=r-r%M+M,u=0;u<4&&o<i;++u,o+=M)s(o)}};var wt=(wt=n.canvas(1,1))?wt.getContext("2d"):null,kt=new o;function At(t){return function(e,n){if(!wt)return!0;t(wt,e),kt.clear().union(e.bounds).intersect(n).round();for(var r=kt.x1,i=kt.y1,a=kt.x2,o=kt.y2,u=i;u<=o;++u)for(var s=r;s<=a;++s)if(wt.isPointInPath(s,u))return!0;return!1}}function Et(t,e){return e.contains(t.x||0,t.y||0)}function Mt(t,e){var n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(kt.set(n,r,n+i,r+a))}function St(t,e){var n=t.x||0,r=t.y||0;return Ct(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function Ct(t,e,n,r,i){var a,o,u,s,l=t.x1,c=t.y1,f=t.x2,h=t.y2,d=r-e,p=i-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(a=-d,o=-(l-e)),1===s&&(a=d,o=f-e),2===s&&(a=-p,o=-(c-n)),3===s&&(a=p,o=h-n),Math.abs(a)<1e-10&&o<0)return!1;if(u=o/a,a<0){if(u>g)return!1;u>v&&(v=u)}else if(a>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function Ot(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Dt(t,e){return null==t?e:t}function Ft(t,e){for(var n=e.length,r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Tt(t,e,r){return c(r)?function(t,e,r){var i,a=r.width(),o=r.height();if("radial"===e.gradient)i=t.createRadialGradient(r.x1+Dt(e.x1,.5)*a,r.y1+Dt(e.y1,.5)*o,Math.max(a,o)*Dt(e.r1,0),r.x1+Dt(e.x2,.5)*a,r.y1+Dt(e.y2,.5)*o,Math.max(a,o)*Dt(e.r2,.5));else{var u=Dt(e.x1,0),s=Dt(e.y1,0),l=Dt(e.x2,1),c=Dt(e.y2,0);if(u!==l&&s!==c&&a!==o){var f=n.canvas(Math.ceil(a),Math.ceil(o)),h=f.getContext("2d");return h.scale(a,o),h.fillStyle=Ft(h.createLinearGradient(u,s,l,c),e.stops),h.fillRect(0,0,a,o),t.createPattern(f,"no-repeat")}i=t.createLinearGradient(r.x1+u*a,r.y1+s*o,r.x1+l*a,r.y1+c*o)}return Ft(i,e.stops)}(t,r,e.bounds):r}function Nt(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Tt(t,e,e.fill),!0)}var jt=[];function Rt(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Tt(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||jt),t.lineDashOffset=e.strokeDashOffset||0),!0)}function Pt(t,e){return t.zindex-e.zindex||t.index-e.index}function zt(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Pt)}function Bt(t,e){var n,r,i=t.items;if(i&&i.length){var a=zt(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}}function Lt(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var a=zt(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function qt(t){return function(e,n,r){Bt(n,function(n){r&&!r.intersects(n.bounds)||Ut(t,e,n,n)})}}function It(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Ut(t,e,n.items[0],n.items)}}function Ut(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Ot(e,n),n.fill&&Nt(e,n,i)&&e.fill(),n.stroke&&Rt(e,n,i)&&e.stroke()))}function Wt(t){return t=t||e.truthy,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Lt(n,function(n){var u=n.bounds;if((!u||u.contains(a,o))&&u)return t(e,n,r,i,a,o)?n:void 0})}}function Ht(t,e){return function(n,r,i,a){var o,u,s=Array.isArray(r)?r[0]:r,l=null==e?s.fill:e,c=s.stroke&&n.isPointInStroke;return c&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!t(n,r)&&(l&&n.isPointInPath(i,a)||c&&n.isPointInStroke(i,a))}}function Vt(t){return Wt(Ht(t))}function Gt(t,e){return"translate("+t+","+e+")"}function $t(t){return"rotate("+t+")"}function Yt(t){return Gt(t.x||0,t.y||0)}function Xt(t){return Gt(t.x||0,t.y||0)+(t.angle?" "+$t(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}function Jt(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=A),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",Xt(n)),t("d",e(null,n))},bound:function(t,n){var r=n.x||0,i=n.y||0;return e(dt(t),n),st(t,n).translate(r,i),n.angle&&t.rotate(n.angle*A,r,i),t},draw:qt(r),pick:Vt(r),isect:n||At(r)}}var Qt=Jt("arc",function(t,e){return K.context(t)(e)});function Zt(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i=Ht(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(dt(t),r),st(t,r[0]))},draw:It(r),pick:function(t,e,n,r,a,o){var u=e.items,s=e.bounds;return!u||!u.length||s&&!s.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,u,n,r)?u[0]:null)},isect:Et,tip:n}}var Kt=Zt("area",function(t,e){var n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?et:tt).curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,u=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<u&&(u=r,n=t[o]);return n});function te(t,e){t.beginPath(),ot(e)?ut(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}var ee=1;function ne(t,n,r){var i=n.clip,a=t._defs,o=n.clip_id||(n.clip_id="clip"+ee++),u=a.clipping[o]||(a.clipping[o]={id:o});return e.isFunction(i)?u.path=i(null):ot(r)?u.path=ut(null,r,0,0):(u.width=r.width||0,u.height=r.height||0),"url(#"+o+")"}function re(t){var e=null!=(e=t.strokeWidth)?e:1;return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function ie(t,e){var n=re(e);t("d",ut(null,e,n,n))}function ae(t,e,n,r){var i=re(e);t.beginPath(),ut(t,e,(n||0)+i,(r||0)+i)}var oe=Ht(ae),ue=Ht(ae,!1),se={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Yt(e))},bound:function(t,e){if(!e.clip&&e.items)for(var n=e.items,r=0,i=n.length;r<i;++r)t.union(n[r].bounds);return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),st(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){var r=this;Bt(e,function(e){var i=e.x||0,a=e.y||0,o=e.strokeForeground,u=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&u&&(ae(t,e,i,a),Ot(t,e),e.fill&&Nt(t,e,u)&&t.fill(),e.stroke&&!o&&Rt(t,e,u)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&te(t,e),n&&n.translate(-i,-a),Bt(e,function(e){r.draw(t,e,n)}),n&&n.translate(i,a),t.restore(),o&&e.stroke&&u&&(ae(t,e,i,a),Ot(t,e),Rt(t,e,u)&&t.stroke())})},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;var o=this,u=n*t.pixelRatio,s=r*t.pixelRatio;return Lt(e,function(l){var c,f,h,d,p,v,g,m,y;if((!(m=l.bounds)||m.contains(i,a))&&(d=l.x||0,p=l.y||0,v=d+(l.width||0),g=p+(l.height||0),!(y=l.clip)||!(i<d||i>v||a<d||a>g)))return t.save(),t.translate(d,p),d=i-d,p=a-p,y&&ot(l)&&!oe(t,l,u,s)?(t.restore(),null):(f=l.strokeForeground,(h=!1!==e.interactive)&&f&&l.stroke&&ue(t,l,u,s)?(t.restore(),l):(!(c=Lt(l,function(t){return function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,d,p)?o.pick(t,n,r,d,p):null}))&&h&&(l.fill||!f&&l.stroke)&&oe(t,l,u,s)&&(c=l),t.restore(),c||null))})},isect:Mt,content:function(t,e,n){t("clip-path",e.clip?ne(n,e,e):null)},background:function(t,e){t("class","background"),ie(t,e)},foreground:function(t,e){t("class","foreground"),e.strokeForeground?ie(t,e):t("d","")}};function le(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(function(e){t.image=e,t.image.url=t.url})),n}function ce(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function fe(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function he(t,e){return"center"===t?e/2:"right"===t?e:0}function de(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var pe={type:"image",tag:"image",nested:!1,attr:function(t,e,n){var r=le(e,n),i=e.x||0,a=e.y||0,o=ce(e,r),u=fe(e,r),s=!1===e.aspect?"none":"xMidYMid";i-=he(e.align,o),a-=de(e.baseline,u),!r.src&&r.toDataURL?t("href",r.toDataURL(),"http://www.w3.org/1999/xlink","xlink:href"):t("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),t("transform",Gt(i,a)),t("width",o),t("height",u),t("preserveAspectRatio",s)},bound:function(t,e){var n=e.image,r=e.x||0,i=e.y||0,a=ce(e,n),o=fe(e,n);return r-=he(e.align,a),i-=de(e.baseline,o),t.set(r,i,r+a,i+o)},draw:function(t,e,n){var r=this;Bt(e,function(e){if(!n||n.intersects(e.bounds)){var i,a,o,u,s=le(e,r),l=e.x||0,c=e.y||0,f=ce(e,s),h=fe(e,s);l-=he(e.align,f),c-=de(e.baseline,h),!1!==e.aspect&&(a=s.width/s.height,o=e.width/e.height,a===a&&o===o&&a!==o&&(o<a?(c+=(h-(u=f/a))/2,h=u):(l+=(f-(u=h*a))/2,f=u))),(s.complete||s.toDataURL)&&(Ot(t,e),t.globalAlpha=null!=(i=e.opacity)?i:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,l,c,f,h))}})},pick:Wt(),isect:e.truthy,get:le,xOffset:he,yOffset:de},ve=Zt("line",function(t,e){var n=e[0],r=n.interpolate||"linear";return nt.curve(x(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null});function ge(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*A,s=e.pathCache;s&&s.path===n||((e.pathCache=s=k(n)).path=n),u&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(u),R(t,s,0,0,a,o),t.rotate(-u),t.translate(-r,-i)):R(t,s,r,i,a,o)}var me={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",Xt(e)),t("d",e.path)},bound:function(t,e){return ge(dt(t),e)?t.set(0,0,0,0):st(t,e,!0),e.angle&&t.rotate(e.angle*A,e.x||0,e.y||0),t},draw:qt(ge),pick:Vt(ge),isect:At(ge)};function ye(t,e){t.beginPath(),ut(t,e)}var be={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",ut(null,e))},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:qt(ye),pick:Vt(ye),isect:Mt};function xe(t,e,n){var r,i,a,o;return!(!e.stroke||!Rt(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var _e={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Yt(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return st(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Bt(e,function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&xe(t,e,r)&&(Ot(t,e),t.stroke())}})},pick:Wt(function(t,e,n,r){return!!t.isPointInStroke&&xe(t,e,1)&&t.isPointInStroke(n,r)}),isect:St},we=Jt("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),ke=Jt("symbol",function(t,e){return it.context(t)(e)},Et),Ae=e.lruCache(),Ee={height:Fe,measureWidth:Oe,estimateWidth:Se,width:Se,canvas:Me};function Me(t){Ee.width=t&&wt?Oe:Se}function Se(t,e){return Ce(je(t,e),Fe(t))}function Ce(t,e){return~~(.8*t.length*e)}function Oe(t,e){return Fe(t)<=0||!(e=je(t,e))?0:De(e,Pe(t))}function De(t,e){var n="(".concat(e,") ").concat(t),r=Ae.get(n);return void 0===r&&(wt.font=e,r=wt.measureText(t).width,Ae.set(n,r)),r}function Fe(t){return null!=t.fontSize?+t.fontSize||0:11}function Te(t){return null!=t.lineHeight?t.lineHeight:Fe(t)+2}function Ne(t){return n=t.lineBreak&&t.text&&!e.isArray(t.text)?t.text.split(t.lineBreak):t.text,e.isArray(n)?n.length>1?n:n[0]:n;var n}function je(t,e){var n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Ee.width===Oe){var e=Pe(t);return function(t){return De(t,e)}}var n=Fe(t);return function(t){return Ce(t,n)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,u=0,s=e.length;if(n-=r(a),o){for(;u<s;)i=u+s>>>1,r(e.slice(i))>n?u=i+1:s=i;return a+e.slice(u)}for(;u<s;)i=1+(u+s>>>1),r(e.slice(0,i))<n?u=i:s=i-1;return e.slice(0,u)+a}(t,n):n}function Re(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Pe(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Fe(t)+"px "+Re(t,e)}function ze(t){var e=t.baseline,n=Fe(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Te(t):"line-bottom"===e?.29*n-.5*Te(t):0)}Me(!0);var Be={left:"start",center:"middle",right:"end"},Le=new o;function qe(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-M,n+=i*Math.cos(e),r+=i*Math.sin(e)),Le.x1=n,Le.y1=r,Le}function Ie(t,n,r){var i,a=Ee.height(n),o=n.align,u=qe(n),s=u.x1,l=u.y1,c=n.dx||0,f=(n.dy||0)+ze(n)-Math.round(.8*a),h=Ne(n);if(e.isArray(h)?(a+=Te(n)*(h.length-1),i=h.reduce(function(t,e){return Math.max(t,Ee.width(n,e))},0)):i=Ee.width(n,h),"center"===o?c-=i/2:"right"===o&&(c-=i),t.set(c+=s,f+=l,c+i,f+a),n.angle&&!r)t.rotate(n.angle*A,s,l);else if(2===r)return t.rotatedPoints(n.angle*A,s,l);return t}var Ue={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+ze(e),a=qe(e),o=a.x1,u=a.y1,s=e.angle||0;t("text-anchor",Be[e.align]||"start"),s?(n=Gt(o,u)+" "+$t(s),(r||i)&&(n+=" "+Gt(r,i))):n=Gt(o+r,u+i),t("transform",n)},bound:Ie,draw:function(t,n,r){Bt(n,function(n){var i,a,o,u,s,l,c,f=null==n.opacity?1:n.opacity;if(!(r&&!r.intersects(n.bounds)||0===f||n.fontSize<=0||null==n.text||0===n.text.length)){if(t.font=Pe(n),t.textAlign=n.align||"left",a=(i=qe(n)).x1,o=i.y1,n.angle&&(t.save(),t.translate(a,o),t.rotate(n.angle*A),a=o=0),a+=n.dx||0,o+=(n.dy||0)+ze(n),l=Ne(n),Ot(t,n),e.isArray(l))for(s=Te(n),u=0;u<l.length;++u)c=je(n,l[u]),n.fill&&Nt(t,n,f)&&t.fillText(c,a,o),n.stroke&&Rt(t,n,f)&&t.strokeText(c,a,o),o+=s;else c=je(n,l),n.fill&&Nt(t,n,f)&&t.fillText(c,a,o),n.stroke&&Rt(t,n,f)&&t.strokeText(c,a,o);n.angle&&t.restore()}})},pick:Wt(function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=qe(e),u=o.x1,s=o.y1,l=Ie(Le,e,1),c=-e.angle*A,f=Math.cos(c),h=Math.sin(c),d=f*i-h*a+(u-f*u+h*s),p=h*i+f*a+(s-h*u-f*s);return l.contains(d,p)}),isect:function(t,e){var n=Ie(Le,t,2);return Ct(e,n[0],n[1],n[2],n[3])||Ct(e,n[0],n[1],n[4],n[5])||Ct(e,n[4],n[5],n[6],n[7])||Ct(e,n[2],n[3],n[6],n[7])}},We=Zt("trail",function(t,e){return at.context(t)(e)},function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}),He={arc:Qt,area:Kt,group:se,image:pe,line:ve,path:me,rect:be,rule:_e,shape:we,symbol:ke,text:Ue,trail:We};function Ve(t,e,n){var r=He[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new o),t,n)}var Ge={mark:null};function $e(t,e,n){var r,i,a,u,s=He[t.marktype],l=s.bound,c=t.items,f=c&&c.length;if(s.nested)return f?a=c[0]:(Ge.mark=t,a=Ge),u=Ve(a,l,n),e=e&&e.union(u)||u;if(e=e||t.bounds&&t.bounds.clear()||new o,f)for(r=0,i=c.length;r<i;++r)e.union(Ve(c[r],l,n));return t.bounds=e}var Ye=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function Xe(t,e){return JSON.stringify(t,Ye,e)}function Je(t){return function t(e){var n,r,i,a=e.marktype,o=e.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=e,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&t(o[r]);return a&&$e(e),e}("string"===typeof t?JSON.parse(t):t)}function Qe(t){arguments.length?this.root=Je(t):(this.root=Ke({marktype:"group",name:"root",role:"frame"}),this.root.items=[new p(this.root)])}var Ze=Qe.prototype;function Ke(t,e){return{bounds:new o,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0}}function tn(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function en(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function nn(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=tn(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function rn(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function an(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function on(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function un(t,e){this._active=null,this._handlers={},this._loader=t||r.loader(),this._tooltip=e||sn}function sn(t,e,n,r){t.element().setAttribute("title",r||"")}Ze.toJSON=function(t){return Xe(this.root,t||0)},Ze.mark=function(t,e,n){var r=Ke(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var ln=un.prototype;function cn(t){this._el=null,this._bgcolor=null,this._loader=new v(t)}ln.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},ln.element=function(){return this._el},ln.canvas=function(){return this._el&&this._el.firstChild},ln.origin=function(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},ln.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},ln.on=function(){},ln.off=function(){},ln._handlerIndex=function(t,e,n){for(var r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},ln.handlers=function(t){var e,n=this._handlers,r=[];if(t)r.push.apply(r,n[this.eventName(t)]);else for(e in n)r.push.apply(r,n[e]);return r},ln.eventName=function(t){var e=t.indexOf(".");return e<0?t:t.slice(0,e)},ln.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(function(e){var n=new MouseEvent(t.type,t),r=tn(null,"a");for(var i in e)r.setAttribute(i,e[i]);r.dispatchEvent(n)}).catch(function(){})},ln.handleTooltip=function(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=He[o.marktype]).tip){for((a=on(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);var r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},ln.getItemBoundingClientRect=function(t){if(e=this.canvas()){for(var e,n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();t.mark&&(t=t.mark.group);)a+=t.x||0,o+=t.y||0;return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}}};var fn=cn.prototype;fn.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},fn.element=function(){return this._el},fn.canvas=function(){return this._el&&this._el.firstChild},fn.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},fn.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},fn.dirty=function(){},fn.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},fn._render=function(){},fn.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then(function(){return e}):Promise.resolve(e)},fn._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(t){t&&i(),n._ready=null})}return r},fn.sanitizeURL=function(t){return this._load("sanitizeURL",t)},fn.loadImage=function(t){return this._load("loadImage",t)};var hn="mouseout";function dn(t,e){un.call(this,t,e),this._down=null,this._touch=null,this._first=!0}var pn=e.inherits(dn,un);function vn(t,e,n){return function(r){var i=this._active,a=this.pickEvent(r);a===i?this.fire(t,r):(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r),this.fire(t,r))}}function gn(t){return function(e){this.fire(t,e),this._active=null}}pn.initialize=function(t,e,n){var r=this._canvas=t&&en(t,"canvas");if(r){var i=this;this.events.forEach(function(t){r.addEventListener(t,function(e){pn[t]?pn[t].call(i,e):i.fire(t,e)})})}return un.prototype.initialize.call(this,t,e,n)},pn.canvas=function(){return this._canvas},pn.context=function(){return this._canvas.getContext("2d")},pn.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],pn.DOMMouseScroll=function(t){this.fire("mousewheel",t)},pn.mousemove=vn("mousemove","mouseover","mouseout"),pn.dragover=vn("dragover","dragenter","dragleave"),pn.mouseout=gn("mouseout"),pn.dragleave=gn("dragleave"),pn.mousedown=function(t){this._down=this._active,this.fire("mousedown",t)},pn.click=function(t){this._down===this._active&&(this.fire("click",t),this._down=null)},pn.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},pn.touchmove=function(t){this.fire("touchmove",t,!0)},pn.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},pn.fire=function(t,e,n){var r,i,a=n?this._touch:this._active,o=this._handlers[t];if(e.vegaType=t,"click"===t&&a&&a.href?this.handleHref(e,a,a.href):"mousemove"!==t&&t!==hn||this.handleTooltip(e,a,t!==hn),o)for(r=0,i=o.length;r<i;++r)o[r].handler.call(this._obj,e,a)},pn.on=function(t,e){var n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(r[n]||(r[n]=[])).push({type:t,handler:e}),this},pn.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pn.pickEvent=function(t){var e=on(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pn.pick=function(t,e,n,r,i){var a=this.context();return He[t.marktype].pick.call(this,a,t,e,n,r,i)};var mn="undefined"!==typeof window&&window.devicePixelRatio||1;function yn(t){cn.call(this,t),this._redraw=!1,this._dirty=new o}var bn=e.inherits(yn,cn),xn=cn.prototype,_n=new o;function wn(t,e,n){return _n.set(0,0,e,n).translate(-t[0],-t[1])}function kn(t,e){un.call(this,t,e);var n=this;n._hrefHandler=En(n,function(t,e){e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=En(n,function(t,e){n.handleTooltip(t,e,t.type!==hn)})}bn.initialize=function(t,e,r,i,a,o){return this._options=o,this._canvas=n.canvas(1,1,o&&o.type),t&&(rn(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),xn.initialize.call(this,t,e,r,i,a)},bn.resize=function(t,e,n,r){return xn.resize.call(this,t,e,n,r),function(t,e,n,r,i,a){var o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,u=t.getContext("2d"),s=o?mn:i;for(var l in t.width=e*s,t.height=n*s,a)u[l]=a[l];o&&1!==s&&(t.style.width=e+"px",t.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context),this._redraw=!0,this},bn.canvas=function(){return this._canvas},bn.context=function(){return this._canvas?this._canvas.getContext("2d"):null},bn.dirty=function(t){var e=function(t,e){if(null==e)return t;for(var n=_n.clear().union(t);null!=e;e=e.mark.group)n.translate(e.x||0,e.y||0);return n}(t.bounds,t.mark.group);this._dirty.union(e)},bn._render=function(t){var e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;return e.save(),this._redraw||a.empty()?(this._redraw=!1,a=wn(n,r,i).expand(1)):a=function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(wn(n,r,i)),n),this.clear(-n[0],-n[1],r,i),this.draw(e,t,a),e.restore(),this._dirty.clear(),this},bn.draw=function(t,n,r){var i=He[n.marktype];n.clip&&function(t,n){var r=n.clip;t.save(),e.isFunction(r)?(t.beginPath(),r(t),t.clip()):te(t,n.group)}(t,n),i.draw.call(this,t,n,r),n.clip&&t.restore()},bn.clear=function(t,e,n,r){var i=this.context();i.clearRect(t,e,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(t,e,n,r))};var An=e.inherits(kn,un);function En(t,e){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,e.call(t._obj,n,r)}}function Mn(t,e,n){var r,i,a="<"+t;if(e)for(r in e)null!=(i=e[r])&&(a+=" "+r+'="'+i+'"');return n&&(a+=" "+n),a+">"}function Sn(t){return"</"+t+">"}An.initialize=function(t,e,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mousemove",this._tooltipHandler),r.removeEventListener(hn,this._tooltipHandler)),this._svg=r=t&&en(t,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mousemove",this._tooltipHandler),r.addEventListener(hn,this._tooltipHandler)),un.prototype.initialize.call(this,t,e,n)},An.canvas=function(){return this._svg},An.on=function(t,e){var n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){var i={type:t,handler:e,listener:En(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},An.off=function(t,e){var n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};var Cn={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},On={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Dn=Object.keys(On),Fn=Cn.xmlns;function Tn(t){cn.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Nn=e.inherits(Tn,cn),jn=cn.prototype;function Rn(t,e,n){var r,i,a;if("radial"===e.gradient){var o=nn(t,n++,"pattern",Fn);o.setAttribute("id",l+e.id),o.setAttribute("viewBox","0,0,1,1"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("preserveAspectRatio","xMidYMid slice"),(o=nn(o,0,"rect",Fn)).setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("fill","url("+Hn()+"#"+e.id+")"),(t=nn(t,n++,"radialGradient",Fn)).setAttribute("id",e.id),t.setAttribute("fx",e.x1),t.setAttribute("fy",e.y1),t.setAttribute("fr",e.r1),t.setAttribute("cx",e.x2),t.setAttribute("cy",e.y2),t.setAttribute("r",e.r2)}else(t=nn(t,n++,"linearGradient",Fn)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2);for(r=0,i=e.stops.length;r<i;++r)(a=nn(t,r,"stop",Fn)).setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return rn(t,r),n}function Pn(t,e,n){var r;return(t=nn(t,n,"clipPath",Fn)).setAttribute("id",e.id),e.path?(r=nn(t,0,"path",Fn)).setAttribute("d",e.path):((r=nn(t,0,"rect",Fn)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)),rn(t,1),n+1}function zn(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Bn(t,e,n,r,i){var a,o=t._svg;if(!o&&(o=tn(a=e.ownerDocument,r,Fn),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){var u=tn(a,"path",Fn);o.appendChild(u),u.__data__=t;var s=tn(a,"g",Fn);o.appendChild(s),s.__data__=t;var l=tn(a,"path",Fn);o.appendChild(l),l.__data__=t,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Nn.initialize=function(t,e,n,r){return t&&(this._svg=nn(t,0,"svg",Fn),this._svg.setAttribute("class","marks"),rn(t,1),this._root=nn(this._svg,0,"g",Fn),rn(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),jn.initialize.call(this,t,e,n,r)},Nn.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),jn.background.apply(this,arguments)},Nn.resize=function(t,e,n,r){return jn.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},Nn.canvas=function(){return this._svg},Nn.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in Cn)t[e]=Cn[e];var n=this._bgcolor?Mn("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+Sn("rect"):"";return Mn("svg",t)+n+this._svg.innerHTML+Sn("svg")},Nn._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),rn(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},Nn.updateDefs=function(){var t,e=this._svg,n=this._defs,r=n.el,i=0;for(t in n.gradient)r||(n.el=r=nn(e,0,"defs",Fn)),i=Rn(r,n.gradient[t],i);for(t in n.clipping)r||(n.el=r=nn(e,0,"defs",Fn)),i=Pn(r,n.clipping[t],i);r&&(0===i?(e.removeChild(r),n.el=null):rn(r,i))},Nn._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},Nn.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},Nn.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},Nn._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length||!this._dirtyID)return!0;var e,n,r,i,a,o,u,s=++this._dirtyID;for(a=0,o=t.length;a<o;++a)(n=(e=t[a]).mark).marktype!==r&&(r=n.marktype,i=He[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,zn(e,s),n.items.forEach(function(t){t.dirty=s})),n.zdirty||(e.exit?(i.nested&&n.items.length?(u=n.items[0])._svg&&this._update(i,u._svg,u):e._svg&&(u=e._svg.parentNode)&&u.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==s&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,zn(e,s)),e._update=s));return!this._dirtyAll},Nn.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this,a=this._svg,o=He[e.marktype],u=!1===e.interactive?"none":null,s="g"===o.tag,l=null,c=0;function f(t){var e=i.isDirty(t),n=Bn(t,r,l,o.tag,a);e&&(i._update(o,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;var r,i=0;Bt(n,function(n){r=t.draw(e,n,r),++i}),rn(e,1+i)}(i,n,t)),l=n,++c}return(r=Bn(e,t,n,"g",a)).setAttribute("class",an(e)),s||r.style.setProperty("pointer-events",u),e.clip?r.setAttribute("clip-path",ne(i,e,e.group)):r.removeAttribute("clip-path"),o.nested?e.items.length&&f(e.items[0]):Bt(e,f),rn(r,c),r};var Ln=null,qn=null,In={group:function(t,e,n){var r,i;Ln=r=e.childNodes[2],qn=r.__values__,t.foreground(Wn,n,this),qn=e.__values__,Ln=e.childNodes[1],t.content(Wn,n,this),Ln=i=e.childNodes[0],t.background(Wn,n,this);var a=!1===n.mark.interactive?"none":null;if(a!==qn.events&&(r.style.setProperty("pointer-events",a),i.style.setProperty("pointer-events",a),qn.events=a),n.strokeForeground&&n.stroke){var o=n.fill;r.style.removeProperty("display"),this.style(i,n),i.style.removeProperty("stroke"),o&&(n.fill=null),qn=r.__values__,this.style(r,n),o&&(n.fill=o),Ln=null}else r.style.setProperty("display","none"),r.style.setProperty("fill","none")},image:function(t,e,n){!1===n.smooth?(Un(e,"image-rendering","optimizeSpeed"),Un(e,"image-rendering","pixelated")):Un(e,"image-rendering",null)},text:function(t,n,r){var i,a,o,u,s=Ne(r);e.isArray(s)?(i=(a=s.map(function(t){return je(r,t)})).join("\n"))!==qn.text&&(rn(n,0),o=n.ownerDocument,u=Te(r),a.forEach(function(t,e){var i=tn(o,"tspan",Fn);i.__data__=r,i.textContent=t,e&&(i.setAttribute("x",0),i.setAttribute("dy",u)),n.appendChild(i)}),qn.text=i):(a=je(r,s))!==qn.text&&(n.textContent=a,qn.text=a),Un(n,"font-family",Re(r)),Un(n,"font-size",Fe(r)+"px"),Un(n,"font-style",r.fontStyle),Un(n,"font-variant",r.fontVariant),Un(n,"font-weight",r.fontWeight)}};function Un(t,e,n){n!==qn[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),qn[e]=n)}function Wn(t,e,n){e!==qn[t]&&(null!=e?n?Ln.setAttributeNS(n,t,e):Ln.setAttribute(t,e):n?Ln.removeAttributeNS(n,t):Ln.removeAttribute(t),qn[t]=e)}function Hn(){var t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Vn(t){cn.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}Nn._update=function(t,e,n){Ln=e,qn=e.__values__,t.attr(Wn,n,this);var r=In[t.type];r&&r.call(this,t,e,n),Ln&&this.style(Ln,n)},Nn.style=function(t,e){var n,r,i,a,o;if(null!=e)for(n=0,r=Dn.length;n<r;++n)o=e[i=Dn[n]],"font"===i&&(o=Re(e)),o!==qn[i]&&(a=On[i],null==o?"fill"===a?t.style.setProperty(a,"none"):t.style.removeProperty(a):(c(o)&&(o=f(o,this._defs.gradient,Hn())),t.style.setProperty(a,o+"")),qn[i]=o)};var Gn,$n=e.inherits(Vn,cn),Yn=cn.prototype;function Xn(t,e,n,r){Gn[r||t]=e}function Jn(t,e,n,r){if(null==t)return"";var i,a,o,u,s,l="";for("bgrect"===n&&!1===e.interactive&&(l+="pointer-events: none; "),"bgfore"===n&&(!1===e.interactive&&(l+="pointer-events: none; "),l+="display: none; "),"image"===n&&!1===t.smooth&&(l+="image-rendering: optimizeSpeed; image-rendering: pixelated; "),"text"===n&&(l+="font-family: "+Re(t)+"; ",l+="font-size: "+Fe(t)+"px; ",t.fontStyle&&(l+="font-style: "+t.fontStyle+"; "),t.fontVariant&&(l+="font-variant: "+t.fontVariant+"; "),t.fontWeight&&(l+="font-weight: "+t.fontWeight+"; ")),i=0,a=Dn.length;i<a;++i)o=Dn[i],u=On[o],null==(s=t[o])?"fill"===u&&(l+="fill: none; "):"transparent"!==s||"fill"!==u&&"stroke"!==u?(c(s)&&(s=f(s,r.gradient,"")),l+=u+": "+s+"; "):l+=u+": none; ";return l?'style="'+l.trim()+'"':null}function Qn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}$n.resize=function(t,e,n,r){Yn.resize.call(this,t,e,n,r);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in Cn)o[u]=Cn[u];a.head=Mn("svg",o);var s=this._bgcolor;return"transparent"!==s&&"none"!==s||(s=null),a.bg=s?Mn("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+Sn("rect"):"",a.root=Mn("g",{transform:"translate("+i+")"}),a.foot=Sn("g")+Sn("svg"),this},$n.background=function(){var t=Yn.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},$n.svg=function(){var t=this._text;return t.head+t.bg+t.defs+t.root+t.body+t.foot},$n._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},$n.buildDefs=function(){var t,e,n,r,i,a=this._defs,o="";for(e in a.gradient){for(i=(n=a.gradient[e]).stops,"radial"===n.gradient?(o+=Mn(r="pattern",{id:l+e,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o+=Mn("rect",{width:"1",height:"1",fill:"url(#"+e+")"})+Sn("rect"),o+=Sn(r),o+=Mn(r="radialGradient",{id:e,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})):o+=Mn(r="linearGradient",{id:e,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),t=0;t<i.length;++t)o+=Mn("stop",{offset:i[t].offset,"stop-color":i[t].color})+Sn("stop");o+=Sn(r)}for(e in a.clipping)n=a.clipping[e],o+=Mn("clipPath",{id:e}),n.path?o+=Mn("path",{d:n.path})+Sn("path"):o+=Mn("rect",{x:0,y:0,width:n.width,height:n.height})+Sn("rect"),o+=Sn("clipPath");return o.length>0?Mn("defs")+o+Sn("defs"):""},$n.attributes=function(t,e){return Gn={},t(Xn,e,this),Gn},$n.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(function(t){t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},$n.mark=function(t){var n,r=this,i=He[t.marktype],a=i.tag,o=this._defs,u="";function s(s){var l=r.href(s);if(l&&(u+=Mn("a",l)),n="g"!==a?Jn(s,t,a,o):null,u+=Mn(a,r.attributes(i.attr,s),n),"text"===a){var c=Ne(s);if(e.isArray(c))for(var f={x:0,dy:Te(s)},h=0;h<c.length;++h)u+=Mn("tspan",h?f:null)+Qn(je(s,c[h]))+Sn("tspan");else u+=Qn(je(s,c))}else if("g"===a){var d=s.strokeForeground,p=s.fill,v=s.stroke;d&&v&&(s.stroke=null),u+=Mn("path",r.attributes(i.background,s),Jn(s,t,"bgrect",o))+Sn("path"),u+=Mn("g",r.attributes(i.content,s))+r.markGroup(s)+Sn("g"),d&&v?(p&&(s.fill=null),s.stroke=v,u+=Mn("path",r.attributes(i.foreground,s),Jn(s,t,"bgrect",o))+Sn("path"),p&&(s.fill=p)):u+=Mn("path",r.attributes(i.foreground,s),Jn({},t,"bgfore",o))+Sn("path")}u+=Sn(a),l&&(u+=Sn("a"))}return"g"!==a&&!1===t.interactive&&(n='style="pointer-events: none;"'),u+=Mn("g",{class:an(t),"clip-path":t.clip?ne(r,t,t.group):null},n),i.nested?t.items&&t.items.length&&s(t.items[0]):Bt(t,s),u+Sn("g")},$n.markGroup=function(t){var e=this,n="";return Bt(t,function(t){n+=e.mark(t)}),n};var Zn={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Kn={};function tr(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){var i=t.items,a=t.marktype,o=i.length,u=0;if("group"===a)for(;u<o;++u)er(i[u],e,n,r);else for(var s=He[a].isect;u<o;++u){var l=i[u];nr(l,e,s)&&r.push(l)}}return r}function er(t,e,n,r){n&&n(t.mark)&&nr(t,e,He.group.isect)&&r.push(t);var i=t.items,a=i&&i.length;if(a){var o=t.x||0,u=t.y||0;e.translate(-o,-u);for(var s=0;s<a;++s)tr(i[s],e,n,r);e.translate(o,u)}return r}function nr(t,e,n){var r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Kn.canvas=Kn.png={renderer:yn,headless:yn,handler:dn},Kn.svg={renderer:Tn,headless:Vn,handler:kn},Kn.none={};var rr=new o,ir=1e-9;function ar(t,n,r){return t===n||("path"===r?or(t,n):t instanceof Date&&n instanceof Date?+t===+n:e.isNumber(t)&&e.isNumber(n)?Math.abs(t-n)<=ir:t&&n&&(e.isObject(t)||e.isObject(n))?null!=t&&null!=n&&function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!ar(t[n],e[n],n))return!1;return typeof t===typeof e}(t,n):t==n)}function or(t,e){return ar(k(t),k(e))}t.Bounds=o,t.CanvasHandler=dn,t.CanvasRenderer=yn,t.Gradient=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}},t.GroupItem=p,t.Handler=un,t.Item=d,t.Marks=He,t.RenderType=Zn,t.Renderer=cn,t.ResourceLoader=v,t.SVGHandler=kn,t.SVGRenderer=Tn,t.SVGStringRenderer=Vn,t.Scenegraph=Qe,t.boundClip=function(t){var n=t.clip;if(e.isFunction(n))n(dt(rr.clear()));else{if(!n)return;rr.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(rr)},t.boundContext=dt,t.boundItem=Ve,t.boundMark=$e,t.boundStroke=st,t.closeTag=Sn,t.domChild=nn,t.domClear=rn,t.domCreate=tn,t.domFind=en,t.font=Pe,t.fontFamily=Re,t.fontSize=Fe,t.intersect=function(t,n,r){var i=[],a=(new o).union(n),u=t.marktype;return u?tr(t,a,r,i):"group"===u?er(t,a,r,i):e.error("Intersect scene must be mark node or group item.")},t.intersectBoxLine=Ct,t.intersectPath=At,t.intersectPoint=Et,t.intersectRule=St,t.lineHeight=Te,t.multiLineOffset=function(t){var n=Ne(t);return(e.isArray(n)?n.length-1:0)*Te(t)},t.openTag=Mn,t.pathCurves=x,t.pathEqual=or,t.pathParse=k,t.pathRectangle=$,t.pathRender=R,t.pathSymbols=B,t.pathTrail=Y,t.point=on,t.renderModule=function(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Kn[t]=e,this):Kn[t]},t.resetSVGClipId=function(){ee=1},t.sceneEqual=ar,t.sceneFromJSON=Je,t.scenePickVisit=Lt,t.sceneToJSON=Xe,t.sceneVisit=Bt,t.sceneZOrder=zt,t.textMetrics=Ee,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1344),n(1171),n(2142),n(2144),n(1080))},2142:function(t,e,n){(function(t){var r=n(19),i=n(1112);!function(e,n,a,o,u){"use strict";var s=/^([A-Za-z]+:)?\/\//,l=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,f="file://";function h(t,e){return d.apply(this,arguments)}function d(){return(d=i(r.mark(function t(e,n){var i,a;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sanitize(e,n);case 2:return i=t.sent,a=i.href,t.abrupt("return",i.localFile?this.file(a):this.http(a,n));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function p(t,e){return v.apply(this,arguments)}function v(){return(v=i(r.mark(function t(e,i){var a,o,u,h,d,p,v;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.extend({},this.options,i),a=this.fileAccess,o={href:null},p=l.test(e.replace(c,"")),null!=e&&"string"===typeof e&&p||n.error("Sanitize failure, invalid URI: "+n.stringValue(e)),v=s.test(e),(d=i.baseURL)&&!v&&(e.startsWith("/")||"/"===d[d.length-1]||(e="/"+e),e=d+e),h=(u=e.startsWith(f))||"file"===i.mode||"http"!==i.mode&&!v&&a,u?e=e.slice(f.length):e.startsWith("//")&&("file"===i.defaultProtocol?(e=e.slice(2),h=!0):e=(i.defaultProtocol||"http")+":"+e),Object.defineProperty(o,"localFile",{value:!!h}),o.href=e,i.target&&(o.target=i.target+""),i.rel&&(o.rel=i.rel+""),"image"===i.context&&i.crossOrigin&&(o.crossOrigin=i.crossOrigin+""),t.abrupt("return",o);case 14:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function g(t){return t?function(e){return new Promise(function(n,r){t.readFile(e,function(t,e){t?r(t):n(e)})})}:m}function m(){return y.apply(this,arguments)}function y(){return(y=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No file system access.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}function b(t){return t?function(){var e=i(r.mark(function e(i,a){var o,u,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.extend({},this.options.http,a),u=a&&a.response,e.next=4,t(i,o);case 4:return s=e.sent,e.abrupt("return",s.ok?n.isFunction(s[u])?s[u]():s.text():n.error(s.status+""+s.statusText));case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}():x}function x(){return _.apply(this,arguments)}function _(){return(_=i(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.error("No HTTP fetch method available.");case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}var w={boolean:n.toBoolean,integer:n.toNumber,number:n.toNumber,date:n.toDate,string:n.toString,unknown:n.identity},k=[function(t){return"true"===t||"false"===t||!0===t||!1===t},function(t){return S(t)&&Number.isInteger(+t)},S,function(t){return!Number.isNaN(Date.parse(t))}],A=["boolean","integer","number","date"];function E(t,e){if(!t||!t.length)return"unknown";var n,r,i,a,o=0,u=t.length,s=k.length,l=k.map(function(t,e){return e+1});for(r=0,u=t.length;r<u;++r)for(n=e?t[r][e]:t[r],i=0;i<s;++i)if(l[i]&&null!=(a=n)&&a===a&&!k[i](n)&&(l[i]=0,++o===k.length))return"string";return o=l.reduce(function(t,e){return 0===t?e:t},0)-1,A[o]}function M(t,e){return e.reduce(function(e,n){return e[n]=E(t,n),e},{})}function S(t){return!Number.isNaN(+t)&&!(t instanceof Date)}function C(t){var e=function(e,r){var i={delimiter:t};return O(e,r?n.extend(r,i):i)};return e.responseType="text",e}function O(t,e){return e.header&&(t=e.header.map(n.stringValue).join(e.delimiter)+"\n"+t),a.dsvFormat(e.delimiter).parse(t+"")}function D(e,r){var i,a=r&&r.property?n.field(r.property):n.identity;return!n.isObject(e)||(i=e,"function"===typeof t&&n.isFunction(t.isBuffer)&&t.isBuffer(i))?a(JSON.parse(e)):function(t,e){return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(a(e))}O.responseType="text",D.responseType="json";var F={interior:function(t,e){return t!==e},exterior:function(t,e){return t===e}};function T(t,e){var r,i,a,u;return t=D(t,e),e&&e.feature?(r=o.feature,a=e.feature):e&&e.mesh?(r=o.mesh,a=e.mesh,u=F[e.filter]):n.error("Missing TopoJSON feature or mesh parameter."),(i=(i=t.objects[a])?r(t,i,u):n.error("Invalid TopoJSON object: "+a))&&i.features||[i]}T.responseType="json";var N={dsv:O,csv:C(","),tsv:C("\t"),json:D,topojson:T};function j(t,e){return arguments.length>1?(N[t]=e,this):n.hasOwnProperty(N,t)?N[t]:null}var R=function(t,e){return function(n){return{options:n||{},sanitize:p,load:h,fileAccess:!!e,file:g(e),http:b(t)}}}("undefined"!==typeof fetch&&fetch,null);e.format=N,e.formats=j,e.inferType=E,e.inferTypes=M,e.loader=R,e.read=function(t,e,r){var i=j((e=e||{}).type||"json");return i||n.error("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n){if(t.length){n=n||u.timeParse;var r,i,a,o,s,l,c,f=t.columns||Object.keys(t[0]);for("auto"===e&&(e=M(t,f)),f=Object.keys(e),r=f.map(function(t){var r,i,a=e[t];if(a&&(0===a.indexOf("date:")||0===a.indexOf("utc:")))return("'"===(i=(r=a.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?u.utcParse(i):n(i);if(!w[a])throw Error("Illegal format pattern: "+t+":"+a);return w[a]}),o=0,l=t.length,c=f.length;o<l;++o)for(i=t[o],s=0;s<c;++s)a=f[s],i[a]=r[s](i[a])}}(t,e.parse,r),n.hasOwnProperty(t,"columns")&&delete t.columns,t},e.responseType=function(t){var e=j(t);return e&&e.responseType||"text"},e.typeParsers=w,Object.defineProperty(e,"__esModule",{value:!0})}(e,n(1344),n(2143),n(1342),n(1091))}).call(this,n(47).Buffer)},2143:function(t,e,n){!function(t){"use strict";var e={},n={},r=34,i=10,a=13;function o(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function u(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function s(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function l(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+s(-e,6):e>9999?"+"+s(e,6):s(e,4))+"-"+s(t.getUTCMonth()+1,2)+"-"+s(t.getUTCDate(),2)+(a?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"."+s(a,3)+"Z":i?"T"+s(n,2)+":"+s(r,2)+":"+s(i,2)+"Z":r||n?"T"+s(n,2)+":"+s(r,2)+"Z":"")}function c(t){var s=new RegExp('["'+t+"\n\r]"),c=t.charCodeAt(0);function f(t,o){var u,s=[],l=t.length,f=0,h=0,d=l<=0,p=!1;function v(){if(d)return n;if(p)return p=!1,e;var o,u,s=f;if(t.charCodeAt(s)===r){for(;f++<l&&t.charCodeAt(f)!==r||t.charCodeAt(++f)===r;);return(o=f)>=l?d=!0:(u=t.charCodeAt(f++))===i?p=!0:u===a&&(p=!0,t.charCodeAt(f)===i&&++f),t.slice(s+1,o-1).replace(/""/g,'"')}for(;f<l;){if((u=t.charCodeAt(o=f++))===i)p=!0;else if(u===a)p=!0,t.charCodeAt(f)===i&&++f;else if(u!==c)continue;return t.slice(s,o)}return d=!0,t.slice(s,l)}for(t.charCodeAt(l-1)===i&&--l,t.charCodeAt(l-1)===a&&--l;(u=v())!==n;){for(var g=[];u!==e&&u!==n;)g.push(u),u=v();o&&null==(g=o(g,h++))||s.push(g)}return s}function h(e,n){return e.map(function(e){return n.map(function(t){return p(e[t])}).join(t)})}function d(e){return e.map(p).join(t)}function p(t){return null==t?"":t instanceof Date?l(t):s.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,i=f(t,function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=o(t);return function(r,i){return e(n(r),i,t)}}(t,e):o(t)});return i.columns=r||[],i},parseRows:f,format:function(e,n){return null==n&&(n=u(e)),[n.map(p).join(t)].concat(h(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=u(t)),h(t,e).join("\n")},formatRows:function(t){return t.map(d).join("\n")},formatRow:d,formatValue:p}}var f=c(","),h=f.parse,d=f.parseRows,p=f.format,v=f.formatBody,g=f.formatRows,m=f.formatRow,y=f.formatValue,b=c("\t"),x=b.parse,_=b.parseRows,w=b.format,k=b.formatBody,A=b.formatRows,E=b.formatRow,M=b.formatValue,S=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();t.autoType=function(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;S&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t},t.csvFormat=p,t.csvFormatBody=v,t.csvFormatRow=m,t.csvFormatRows=g,t.csvFormatValue=y,t.csvParse=h,t.csvParseRows=d,t.dsvFormat=c,t.tsvFormat=w,t.tsvFormatBody=k,t.tsvFormatRow=E,t.tsvFormatRows=A,t.tsvFormatValue=M,t.tsvParse=x,t.tsvParseRows=_,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2144:function(t,e,n){!function(t,e){"use strict";function n(t){return function(){return t}}var r=Math.abs,i=Math.atan2,a=Math.cos,o=Math.max,u=Math.min,s=Math.sin,l=Math.sqrt,c=1e-12,f=Math.PI,h=f/2,d=2*f;function p(t){return t>=1?h:t<=-1?-h:Math.asin(t)}function v(t){return t.innerRadius}function g(t){return t.outerRadius}function m(t){return t.startAngle}function y(t){return t.endAngle}function b(t){return t&&t.padAngle}function x(t,e,n,r,i,a,u){var s=t-n,c=e-r,f=(u?a:-a)/l(s*s+c*c),h=f*c,d=-f*s,p=t+h,v=e+d,g=n+h,m=r+d,y=(p+g)/2,b=(v+m)/2,x=g-p,_=m-v,w=x*x+_*_,k=i-a,A=p*m-g*v,E=(_<0?-1:1)*l(o(0,k*k*w-A*A)),M=(A*_-x*E)/w,S=(-A*x-_*E)/w,C=(A*_+x*E)/w,O=(-A*x+_*E)/w,D=M-y,F=S-b,T=C-y,N=O-b;return D*D+F*F>T*T+N*N&&(M=C,S=O),{cx:M,cy:S,x01:-h,y01:-d,x11:M*(i/k-1),y11:S*(i/k-1)}}function _(t){this._context=t}function w(t){return new _(t)}function k(t){return t[0]}function A(t){return t[1]}function E(){var t=k,r=A,i=n(!0),a=null,o=w,u=null;function s(n){var s,l,c,f=n.length,h=!1;for(null==a&&(u=o(c=e.path())),s=0;s<=f;++s)!(s<f&&i(l=n[s],s,n))===h&&((h=!h)?u.lineStart():u.lineEnd()),h&&u.point(+t(l,s,n),+r(l,s,n));if(c)return u=null,c+""||null}return s.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),s):t},s.y=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),s):r},s.defined=function(t){return arguments.length?(i="function"===typeof t?t:n(!!t),s):i},s.curve=function(t){return arguments.length?(o=t,null!=a&&(u=o(a)),s):o},s.context=function(t){return arguments.length?(null==t?a=u=null:u=o(a=t),s):a},s}function M(){var t=k,r=null,i=n(0),a=A,o=n(!0),u=null,s=w,l=null;function c(n){var c,f,h,d,p,v=n.length,g=!1,m=new Array(v),y=new Array(v);for(null==u&&(l=s(p=e.path())),c=0;c<=v;++c){if(!(c<v&&o(d=n[c],c,n))===g)if(g=!g)f=c,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=c-1;h>=f;--h)l.point(m[h],y[h]);l.lineEnd(),l.areaEnd()}g&&(m[c]=+t(d,c,n),y[c]=+i(d,c,n),l.point(r?+r(d,c,n):m[c],a?+a(d,c,n):y[c]))}if(p)return l=null,p+""||null}function f(){return E().defined(o).curve(s).context(u)}return c.x=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:n(+t),c):r},c.y=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a=null,c):i},c.y0=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),c):i},c.y1=function(t){return arguments.length?(a=null==t?null:"function"===typeof t?t:n(+t),c):a},c.lineX0=c.lineY0=function(){return f().x(t).y(i)},c.lineY1=function(){return f().x(t).y(a)},c.lineX1=function(){return f().x(r).y(i)},c.defined=function(t){return arguments.length?(o="function"===typeof t?t:n(!!t),c):o},c.curve=function(t){return arguments.length?(s=t,null!=u&&(l=s(u)),c):s},c.context=function(t){return arguments.length?(null==t?u=l=null:l=s(u=t),c):u},c}function S(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function C(t){return t}_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var O=F(w);function D(t){this._curve=t}function F(t){function e(e){return new D(t(e))}return e._curve=t,e}function T(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function N(){return T(E().curve(O))}function j(){var t=M().curve(O),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return T(n())},delete t.lineX0,t.lineEndAngle=function(){return T(r())},delete t.lineX1,t.lineInnerRadius=function(){return T(i())},delete t.lineY0,t.lineOuterRadius=function(){return T(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(F(t)):e()._curve},t}function R(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var P=Array.prototype.slice;function z(t){return t.source}function B(t){return t.target}function L(t){var r=z,i=B,a=k,o=A,u=null;function s(){var n,s=P.call(arguments),l=r.apply(this,s),c=i.apply(this,s);if(u||(u=n=e.path()),t(u,+a.apply(this,(s[0]=l,s)),+o.apply(this,s),+a.apply(this,(s[0]=c,s)),+o.apply(this,s)),n)return u=null,n+""||null}return s.source=function(t){return arguments.length?(r=t,s):r},s.target=function(t){return arguments.length?(i=t,s):i},s.x=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),s):a},s.y=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),s):o},s.context=function(t){return arguments.length?(u=null==t?null:t,s):u},s}function q(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function I(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function U(t,e,n,r,i){var a=R(e,n),o=R(e,n=(n+i)/2),u=R(r,n),s=R(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],u[0],u[1],s[0],s[1])}var W={draw:function(t,e){var n=Math.sqrt(e/f);t.moveTo(n,0),t.arc(0,0,n,0,d)}},H={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},V=Math.sqrt(1/3),G=2*V,$={draw:function(t,e){var n=Math.sqrt(e/G),r=n*V;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},Y=Math.sin(f/10)/Math.sin(7*f/10),X=Math.sin(d/10)*Y,J=-Math.cos(d/10)*Y,Q={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=X*n,i=J*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=d*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*n,-u*n),t.lineTo(u*r-s*i,s*r+u*i)}t.closePath()}},Z={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},K=Math.sqrt(3),tt={draw:function(t,e){var n=-Math.sqrt(e/(3*K));t.moveTo(0,2*n),t.lineTo(-K*n,-n),t.lineTo(K*n,-n),t.closePath()}},et=-.5,nt=Math.sqrt(3)/2,rt=1/Math.sqrt(12),it=3*(rt/2+1),at={draw:function(t,e){var n=Math.sqrt(e/it),r=n/2,i=n*rt,a=r,o=n*rt+n,u=-a,s=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(u,s),t.lineTo(et*r-nt*i,nt*r+et*i),t.lineTo(et*a-nt*o,nt*a+et*o),t.lineTo(et*u-nt*s,nt*u+et*s),t.lineTo(et*r+nt*i,et*i-nt*r),t.lineTo(et*a+nt*o,et*o-nt*a),t.lineTo(et*u+nt*s,et*s-nt*u),t.closePath()}},ot=[W,H,$,Z,Q,tt,at];function ut(){}function st(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function lt(t){this._context=t}function ct(t){this._context=t}function ft(t){this._context=t}function ht(t,e){this._basis=new lt(t),this._beta=e}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:st(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ht.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,u=e[n]-a,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*t[s]+(1-this._beta)*(i+r*o),this._beta*e[s]+(1-this._beta)*(a+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var dt=function t(e){function n(t){return 1===e?new lt(t):new ht(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function pt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function vt(t,e){this._context=t,this._k=(1-e)/6}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gt=function t(e){function n(t){return new vt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function mt(t,e){this._context=t,this._k=(1-e)/6}mt.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var yt=function t(e){function n(t){return new mt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function bt(t,e){this._context=t,this._k=(1-e)/6}bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var xt=function t(e){function n(t){return new bt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function _t(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>c){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>c){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function wt(t,e){this._context=t,this._alpha=e}wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var kt=function t(e){function n(t){return e?new wt(t,e):new vt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function At(t,e){this._context=t,this._alpha=e}At.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Et=function t(e){function n(t){return e?new At(t,e):new mt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Mt(t,e){this._context=t,this._alpha=e}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function t(e){function n(t){return e?new Mt(t,e):new bt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ct(t){this._context=t}function Ot(t){return t<0?-1:1}function Dt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(Ot(a)+Ot(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Ft(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*e,a-u,o-u*n,a,o)}function Nt(t){this._context=t}function jt(t){this._context=new Rt(t)}function Rt(t){this._context=t}function Pt(t){this._context=t}function zt(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Bt(t,e){this._context=t,this._t=e}function Lt(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],u=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<u;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function qt(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function It(t,e){return t[e]}function Ut(t){var e=t.map(Wt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Wt(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function Ht(t){var e=t.map(Vt);return qt(t).sort(function(t,n){return e[t]-e[n]})}function Vt(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}Ct.prototype={areaStart:ut,areaEnd:ut,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tt(this,this._t0,Ft(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tt(this,Ft(this,n=Dt(this,t,e)),n);break;default:Tt(this,this._t0,n=Dt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(jt.prototype=Object.create(Nt.prototype)).point=function(t,e){Nt.prototype.point.call(this,e,t)},Rt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=zt(t),i=zt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}},t.arc=function(){var t=v,o=g,_=n(0),w=null,k=m,A=y,E=b,M=null;function S(){var n,v,g=+t.apply(this,arguments),m=+o.apply(this,arguments),y=k.apply(this,arguments)-h,b=A.apply(this,arguments)-h,S=r(b-y),C=b>y;if(M||(M=n=e.path()),m<g&&(v=m,m=g,g=v),m>c)if(S>d-c)M.moveTo(m*a(y),m*s(y)),M.arc(0,0,m,y,b,!C),g>c&&(M.moveTo(g*a(b),g*s(b)),M.arc(0,0,g,b,y,C));else{var O,D,F=y,T=b,N=y,j=b,R=S,P=S,z=E.apply(this,arguments)/2,B=z>c&&(w?+w.apply(this,arguments):l(g*g+m*m)),L=u(r(m-g)/2,+_.apply(this,arguments)),q=L,I=L;if(B>c){var U=p(B/g*s(z)),W=p(B/m*s(z));(R-=2*U)>c?(N+=U*=C?1:-1,j-=U):(R=0,N=j=(y+b)/2),(P-=2*W)>c?(F+=W*=C?1:-1,T-=W):(P=0,F=T=(y+b)/2)}var H=m*a(F),V=m*s(F),G=g*a(j),$=g*s(j);if(L>c){var Y,X=m*a(T),J=m*s(T),Q=g*a(N),Z=g*s(N);if(S<f&&(Y=function(t,e,n,r,i,a,o,u){var s=n-t,l=r-e,f=o-i,h=u-a,d=h*s-f*l;if(!(d*d<c))return[t+(d=(f*(e-a)-h*(t-i))/d)*s,e+d*l]}(H,V,Q,Z,X,J,G,$))){var K=H-Y[0],tt=V-Y[1],et=X-Y[0],nt=J-Y[1],rt=1/s(function(t){return t>1?0:t<-1?f:Math.acos(t)}((K*et+tt*nt)/(l(K*K+tt*tt)*l(et*et+nt*nt)))/2),it=l(Y[0]*Y[0]+Y[1]*Y[1]);q=u(L,(g-it)/(rt-1)),I=u(L,(m-it)/(rt+1))}}P>c?I>c?(O=x(Q,Z,H,V,m,I,C),D=x(X,J,G,$,m,I,C),M.moveTo(O.cx+O.x01,O.cy+O.y01),I<L?M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,I,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,m,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),!C),M.arc(D.cx,D.cy,I,i(D.y11,D.x11),i(D.y01,D.x01),!C))):(M.moveTo(H,V),M.arc(0,0,m,F,T,!C)):M.moveTo(H,V),g>c&&R>c?q>c?(O=x(G,$,X,J,g,-q,C),D=x(H,V,Q,Z,g,-q,C),M.lineTo(O.cx+O.x01,O.cy+O.y01),q<L?M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(D.y01,D.x01),!C):(M.arc(O.cx,O.cy,q,i(O.y01,O.x01),i(O.y11,O.x11),!C),M.arc(0,0,g,i(O.cy+O.y11,O.cx+O.x11),i(D.cy+D.y11,D.cx+D.x11),C),M.arc(D.cx,D.cy,q,i(D.y11,D.x11),i(D.y01,D.x01),!C))):M.arc(0,0,g,j,N,C):M.lineTo(G,$)}else M.moveTo(0,0);if(M.closePath(),n)return M=null,n+""||null}return S.centroid=function(){var e=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,n=(+k.apply(this,arguments)+ +A.apply(this,arguments))/2-f/2;return[a(n)*e,s(n)*e]},S.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),S):t},S.outerRadius=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),S):o},S.cornerRadius=function(t){return arguments.length?(_="function"===typeof t?t:n(+t),S):_},S.padRadius=function(t){return arguments.length?(w=null==t?null:"function"===typeof t?t:n(+t),S):w},S.startAngle=function(t){return arguments.length?(k="function"===typeof t?t:n(+t),S):k},S.endAngle=function(t){return arguments.length?(A="function"===typeof t?t:n(+t),S):A},S.padAngle=function(t){return arguments.length?(E="function"===typeof t?t:n(+t),S):E},S.context=function(t){return arguments.length?(M=null==t?null:t,S):M},S},t.area=M,t.areaRadial=j,t.curveBasis=function(t){return new lt(t)},t.curveBasisClosed=function(t){return new ct(t)},t.curveBasisOpen=function(t){return new ft(t)},t.curveBundle=dt,t.curveCardinal=gt,t.curveCardinalClosed=yt,t.curveCardinalOpen=xt,t.curveCatmullRom=kt,t.curveCatmullRomClosed=Et,t.curveCatmullRomOpen=St,t.curveLinear=w,t.curveLinearClosed=function(t){return new Ct(t)},t.curveMonotoneX=function(t){return new Nt(t)},t.curveMonotoneY=function(t){return new jt(t)},t.curveNatural=function(t){return new Pt(t)},t.curveStep=function(t){return new Bt(t,.5)},t.curveStepAfter=function(t){return new Bt(t,1)},t.curveStepBefore=function(t){return new Bt(t,0)},t.line=E,t.lineRadial=N,t.linkHorizontal=function(){return L(q)},t.linkRadial=function(){var t=L(U);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.linkVertical=function(){return L(I)},t.pie=function(){var t=C,e=S,r=null,i=n(0),a=n(d),o=n(0);function u(n){var u,s,l,c,f,h=n.length,p=0,v=new Array(h),g=new Array(h),m=+i.apply(this,arguments),y=Math.min(d,Math.max(-d,a.apply(this,arguments)-m)),b=Math.min(Math.abs(y)/h,o.apply(this,arguments)),x=b*(y<0?-1:1);for(u=0;u<h;++u)(f=g[v[u]=u]=+t(n[u],u,n))>0&&(p+=f);for(null!=e?v.sort(function(t,n){return e(g[t],g[n])}):null!=r&&v.sort(function(t,e){return r(n[t],n[e])}),u=0,l=p?(y-h*x)/p:0;u<h;++u,m=c)s=v[u],c=m+((f=g[s])>0?f*l:0)+x,g[s]={data:n[s],index:u,value:f,startAngle:m,endAngle:c,padAngle:b};return g}return u.value=function(e){return arguments.length?(t="function"===typeof e?e:n(+e),u):t},u.sortValues=function(t){return arguments.length?(e=t,r=null,u):e},u.sort=function(t){return arguments.length?(r=t,e=null,u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:n(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:n(+t),u):o},u},t.pointRadial=R,t.radialArea=j,t.radialLine=N,t.stack=function(){var t=n([]),e=qt,r=Lt,i=It;function a(n){var a,o,u=t.apply(this,arguments),s=n.length,l=u.length,c=new Array(l);for(a=0;a<l;++a){for(var f,h=u[a],d=c[a]=new Array(s),p=0;p<s;++p)d[p]=f=[0,+i(n[p],h,p,n)],f.data=n[p];d.key=h}for(a=0,o=e(c);a<l;++a)c[o[a]].index=a;return r(c,o),c}return a.keys=function(e){return arguments.length?(t="function"===typeof e?e:n(P.call(e)),a):t},a.value=function(t){return arguments.length?(i="function"===typeof t?t:n(+t),a):i},a.order=function(t){return arguments.length?(e=null==t?qt:"function"===typeof t?t:n(P.call(t)),a):e},a.offset=function(t){return arguments.length?(r=null==t?Lt:t,a):r},a},t.stackOffsetDiverging=function(t,e){if((u=t.length)>0)for(var n,r,i,a,o,u,s=0,l=t[e[0]].length;s<l;++s)for(a=o=0,n=0;n<u;++n)(i=(r=t[e[n]][s])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)},t.stackOffsetExpand=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}Lt(t,e)}},t.stackOffsetNone=Lt,t.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,u=0;o<n;++o)u+=t[o][r][1]||0;i[r][1]+=i[r][0]=-u/2}Lt(t,e)}},t.stackOffsetWiggle=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var u=0,s=0,l=0;u<i;++u){for(var c=t[e[u]],f=c[o][1]||0,h=(f-(c[o-1][1]||0))/2,d=0;d<u;++d){var p=t[e[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}s+=f,l+=h*f}n[o-1][1]+=n[o-1][0]=a,s&&(a-=l/s)}n[o-1][1]+=n[o-1][0]=a,Lt(t,e)}},t.stackOrderAppearance=Ut,t.stackOrderAscending=Ht,t.stackOrderDescending=function(t){return Ht(t).reverse()},t.stackOrderInsideOut=function(t){var e,n,r=t.length,i=t.map(Vt),a=Ut(t),o=0,u=0,s=[],l=[];for(e=0;e<r;++e)n=a[e],o<u?(o+=i[n],s.push(n)):(u+=i[n],l.push(n));return l.reverse().concat(s)},t.stackOrderNone=qt,t.stackOrderReverse=function(t){return qt(t).reverse()},t.symbol=function(){var t=n(W),r=n(64),i=null;function a(){var n;if(i||(i=n=e.path()),t.apply(this,arguments).draw(i,+r.apply(this,arguments)),n)return i=null,n+""||null}return a.type=function(e){return arguments.length?(t="function"===typeof e?e:n(e),a):t},a.size=function(t){return arguments.length?(r="function"===typeof t?t:n(+t),a):r},a.context=function(t){return arguments.length?(i=null==t?null:t,a):i},a},t.symbolCircle=W,t.symbolCross=H,t.symbolDiamond=$,t.symbolSquare=Z,t.symbolStar=Q,t.symbolTriangle=tt,t.symbolWye=at,t.symbols=ot,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1080))},2145:function(t,e,n){var r=n(96);!function(t,e,n){"use strict";var i="intersect",a="union",o="vlMulti",u="or",s="and",l="E",c="R",f="R-E",h="R-LE",d="R-RE",p="index:unit";function v(t,n){for(var r,i,a=n.fields,o=n.values,u=a.length,s=0;s<u;++s)if((i=a[s]).getter=e.field.getter||e.field(i.field),r=i.getter(t),e.isDate(r)&&(r=e.toNumber(r)),e.isDate(o[s])&&(o[s]=e.toNumber(o[s])),e.isDate(o[s][0])&&(o[s]=o[s].map(e.toNumber)),i.type===l){if(e.isArray(o[s])?o[s].indexOf(r)<0:r!==o[s])return!1}else if(i.type===c){if(!e.inrange(r,o[s]))return!1}else if(i.type===d){if(!e.inrange(r,o[s],!0,!1))return!1}else if(i.type===f){if(!e.inrange(r,o[s],!1,!1))return!1}else if(i.type===h&&!e.inrange(r,o[s],!1,!0))return!1;return!0}var g={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(function(t){return e.indexOf(t)>=0}):e},R_union:function(t,n){var r=e.toNumber(n[0]),i=e.toNumber(n[1]);return r>i&&(r=n[1],i=n[0]),t.length?(t[0]>r&&(t[0]=r),t[1]<i&&(t[1]=i),t):[r,i]},R_intersect:function(t,n){var r=e.toNumber(n[0]),i=e.toNumber(n[1]);return r>i&&(r=n[1],i=n[0]),t.length?i<t[0]||t[1]<r?[]:(t[0]<r&&(t[0]=r),t[1]>i&&(t[1]=i),t):[r,i]}},m=":",y="@";t.selectionResolve=function(t,n,i){for(var l,c,f,h,d,p,v,m,y,b,x,_=this.context.data[t],w=_?_.values.value:[],k={},A={},E={},M=w.length,S=0;S<M;++S){for(h=(l=w[S]).unit,c=l.fields,f=l.values,b=0,x=c.length;b<x;++b)d=c[b],v=(p=k[d.field]||(k[d.field]={}))[h]||(p[h]=[]),E[d.field]=m=d.type.charAt(0),y=g[m+"_union"],p[h]=y(v,e.array(f[b]));i&&(v=A[h]||(A[h]=[])).push(e.array(f).reduce(function(t,e,n){return t[c[n].field]=e,t},{}))}return n=n||a,Object.keys(k).forEach(function(t){k[t]=Object.keys(k[t]).map(function(e){return k[t][e]}).reduce(function(e,r){return void 0===e?r:g[E[t]+"_"+n](e,r)})}),w=Object.keys(A),i&&w.length&&(k[o]=n===a?r({},u,w.reduce(function(t,e){return t.push.apply(t,A[e]),t},[])):r({},s,w.map(function(t){return r({},u,A[t])}))),k},t.selectionTest=function(t,e,n){for(var r,a,o,u,s,l=this.context.data[t],c=l?l.values.value:[],f=l?l[p]&&l[p].value:void 0,h=n===i,d=c.length,g=0;g<d;++g)if(r=c[g],f&&h){if(-1===(o=(a=a||{})[u=r.unit]||0))continue;if(s=v(e,r),a[u]=s?-1:++o,s&&1===f.size)return!0;if(!s&&o===f.get(u).count)return!1}else if(h^(s=v(e,r)))return s;return d&&h},t.selectionVisitor=function(t,r,a,o){r[0].type!==n.Literal&&e.error("First argument to selection functions must be a string literal.");var u=r[0].value,s=r.length>=2&&e.peek(r).value,l=y+"unit",c=m+u;s!==i||e.hasOwnProperty(o,l)||(o[l]=a.getData(u).indataRef(a,"unit")),e.hasOwnProperty(o,c)||(o[c]=a.getData(u).tuplesRef())},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1040),n(1346))},2146:function(t,e,n){var r=n(96);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}!function(t,e,n,a,o,u,s){"use strict";function l(t){return e.isObject(t)?t:{type:t||"pad"}}var c=function(t){return+t||0},f=function(t){return{top:t,bottom:t,left:t,right:t}};function h(t){return e.isObject(t)?t.signal?t:{top:c(t.top),bottom:c(t.bottom),left:c(t.left),right:c(t.right)}:f(c(t))}var d="outer",p=["value","update","init","react","bind"];function v(t,n){e.error(t+' for "outer" push: '+e.stringValue(n))}function g(t,e){var n=t.name;if(t.push===d)e.signals[n]||v("No prior signal definition",n),p.forEach(function(e){void 0!==t[e]&&v("Invalid property ",e)});else{var r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function m(t,r,i){var o,u,s={};try{t=e.isString(t)?t:e.stringValue(t)+"",o=n.parse(t)}catch(l){e.error("Expression parse error: "+t)}return o.visit(function(t){if(t.type===n.CallExpression){var e=t.callee.name,i=a.codegenParams.visitors[e];i&&i(e,t.arguments,r,s)}}),(u=a.codeGenerator(o)).globals.forEach(function(t){var n=a.SignalPrefix+t;!e.hasOwnProperty(s,n)&&r.getSignal(t)&&(s[n]=r.signalRef(t))}),{$expr:i?i+"return("+u.code+");":u.code,$fields:u.fields,$params:s}}function y(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function b(t,e,n,r){return new y(t,e,n,r)}function x(t,e){return b("operator",t,e)}function _(t){var e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function w(t,e){return e?{$field:t,$name:e}:{$field:t}}var k=w("key");function A(t,e){return{$compare:t,$order:e}}var E="descending";function M(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}var S="scope",C="view";function O(t){return t&&t.signal}function D(t){if(O(t))return!0;if(e.isObject(t))for(var n in t)if(D(t[n]))return!0;return!1}function F(t,e){return null!=t?t:e}function T(t){return t&&t.signal||t}var N="timer";function j(t,n){return(t.merge?R:t.stream?P:t.type?z:e.error("Invalid stream specification: "+e.stringValue(t)))(t,n)}function R(t,e){var n=B({merge:t.merge.map(function(t){return j(t,e)})},t,e);return e.addStream(n).id}function P(t,e){var n=B({stream:j(t.stream,e)},t,e);return e.addStream(n).id}function z(t,e){var n,r,i;return t.type===N?(n=e.event(N,t.throttle),t={between:t.between,filter:t.filter}):n=e.event((i=t.source)===S?C:i||C,t.type),r=B({stream:n},t,e),1===Object.keys(r).length?n:e.addStream(r).id}function B(t,n,r){var i=n.between;return i&&(2!==i.length&&e.error('Stream "between" parameter must have 2 entries: '+e.stringValue(n)),t.between=[j(i[0],r),j(i[1],r)]),i=n.filter?[].concat(n.filter):[],(n.marktype||n.markname||n.markrole)&&i.push(function(t,e,n){var r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(n.marktype,n.markname,n.markrole)),n.source===S&&i.push("inScope(event.item)"),i.length&&(t.filter=m("("+i.join(")&&(")+")").$expr),null!=(i=n.throttle)&&(t.throttle=+i),null!=(i=n.debounce)&&(t.debounce=+i),n.consume&&(t.consume=!0),t}var L="var datum=event.item&&event.item.datum;";function q(t,n,r){var i=t.events,a=t.update,u=t.encode,s=[],l={target:r};i||e.error("Signal update missing events specification."),e.isString(i)&&(i=o.selector(i,n.isSubscope()?S:C)),i=e.array(i).filter(function(t){return t.signal||t.scale?(s.push(t),0):1}),s.length>1&&(s=[I(s)]),i.length&&s.push(i.length>1?{merge:i}:i[0]),null!=u&&(a&&e.error("Signal encode and update are mutually exclusive."),a="encode(item(),"+e.stringValue(u)+")"),l.update=e.isString(a)?m(a,n,L):null!=a.expr?m(a.expr,n,L):null!=a.value?a.value:null!=a.signal?{$expr:"_.value",$params:{value:n.signalRef(a.signal)}}:e.error("Invalid signal update specification."),t.force&&(l.options={force:!0}),s.forEach(function(t){n.addUpdate(e.extend(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):j(t,e)}}(t,n),l))})}function I(t){return{signal:"["+t.map(function(t){return t.scale?'scale("'+t.scale+'")':t.signal})+"]"}}function U(t,n){var r=n.getSignal(t.name),i=t.update;t.init&&(i?e.error("Signals can not include both init and update expressions."):(i=t.init,r.initonly=!0)),i&&(i=m(i,n),r.update=i.$expr,r.params=i.$params),t.on&&t.on.forEach(function(t){q(t,n,r.id)})}function W(t){return function(e,n,r){return b(t,n,e||void 0,r)}}var H=W("aggregate"),V=W("axisticks"),G=W("bound"),$=W("collect"),Y=W("compare"),X=W("datajoin"),J=W("encode"),Q=W("expression"),Z=W("facet"),K=W("field"),tt=W("key"),et=W("legendentries"),nt=W("load"),rt=W("mark"),it=W("multiextent"),at=W("multivalues"),ot=W("overlap"),ut=W("params"),st=W("prefacet"),lt=W("projection"),ct=W("proxy"),ft=W("relay"),ht=W("render"),dt=W("scale"),pt=W("sieve"),vt=W("sortitems"),gt=W("viewlayout"),mt=W("values"),yt=0,bt={min:"min",max:"max",count:"sum"};function xt(t,n){var r,i,a=n.getScale(t.name).params;for(r in a.domain=At(t.domain,t,n),null!=t.range&&(a.range=function t(n,r,i){var a=n.range,o=r.config.range;if(a.signal)return r.signalRef(a.signal);if(e.isString(a)){if(o&&e.hasOwnProperty(o,a))return n=e.extend({},n,{range:o[a]}),t(n,r,i);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=u.isDiscrete(n.type)?[0,{signal:"height"}]:[{signal:"height"},0]:e.error("Unrecognized scale range value: "+e.stringValue(a))}else{if(a.scheme)return i.scheme=e.isArray(a.scheme)?wt(a.scheme,r):_t(a.scheme,r),a.extent&&(i.schemeExtent=wt(a.extent,r)),void(a.count&&(i.schemeCount=_t(a.count,r)));if(a.step)return void(i.rangeStep=_t(a.step,r));if(u.isDiscrete(n.type)&&!e.isArray(a))return At(a,n,r);e.isArray(a)||e.error("Unsupported range type: "+e.stringValue(a))}return a.map(function(t){return(e.isArray(t)?wt:_t)(t,r)})}(t,n,a)),null!=t.interpolate&&function(t,e){e.interpolate=_t(t.type||t),null!=t.gamma&&(e.interpolateGamma=_t(t.gamma))}(t.interpolate,a),null!=t.nice&&(a.nice=(i=t.nice,e.isObject(i)?{interval:_t(i.interval),step:_t(i.step)}:_t(i))),null!=t.bins&&(a.bins=function(t,n){return t.signal||e.isArray(t)?wt(t,n):n.objectProperty(t)}(t.bins,n)),t)e.hasOwnProperty(a,r)||"name"===r||(a[r]=_t(t[r],n))}function _t(t,n){return e.isObject(t)?t.signal?n.signalRef(t.signal):e.error("Unsupported object: "+e.stringValue(t)):t}function wt(t,e){return t.signal?e.signalRef(t.signal):t.map(function(t){return _t(t,e)})}function kt(t){e.error("Can not find data set: "+e.stringValue(t))}function At(t,n,r){if(t)return t.signal?r.signalRef(t.signal):(e.isArray(t)?Et:t.fields?St:Mt)(t,n,r);null==n.domainMin&&null==n.domainMax||e.error("No scale domain defined for domainMin/domainMax to override.")}function Et(t,e,n){return t.map(function(t){return _t(t,n)})}function Mt(t,e,n){var r=n.getData(t.data);return r||kt(t.data),u.isDiscrete(e.type)?r.valuesRef(n,t.field,Ot(t.sort,!1)):u.isQuantile(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function St(t,n,r){var i=t.data,a=t.fields.reduce(function(t,n){return n=e.isString(n)?{data:i,field:n}:e.isArray(n)||n.signal?function(t,n){var r="_:vega:_"+yt++,i=$({});if(e.isArray(t))i.value={$ingest:t};else if(t.signal){var a="setdata("+e.stringValue(r)+","+t.signal+")";i.params.input=n.signalRef(a)}return n.addDataPipeline(r,[i,pt({})]),{data:r,field:"data"}}(n,r):n,t.push(n),t},[]);return(u.isDiscrete(n.type)?Ct:u.isQuantile(n.type)?Dt:Ft)(t,r,a)}function Ct(t,e,n){var r,i,a,o,u,s=Ot(t.sort,!0);return r=n.map(function(t){var n=e.getData(t.data);return n||kt(t.data),n.countsRef(e,t.field,s)}),i={groupby:k,pulse:r},s&&(a=s.op||"count",u=s.field?M(a,s.field):"count",i.ops=[bt[a]],i.fields=[e.fieldRef(u)],i.as=[u]),a=e.add(H(i)),o=e.add($({pulse:_(a)})),u=e.add(mt({field:k,sort:e.sortRef(s),pulse:_(o)})),_(u)}function Ot(t,n){return t&&(t.field||t.op?t.field||"count"===t.op?n&&t.field&&t.op&&!bt[t.op]&&e.error("Multiple domain scales can not be sorted using "+t.op):e.error("No field provided for sort aggregate op: "+t.op):e.isObject(t)?t.field="key":t={field:"key"}),t}function Dt(t,e,n){var r=n.map(function(t){var n=e.getData(t.data);return n||kt(t.data),n.domainRef(e,t.field)});return _(e.add(at({values:r})))}function Ft(t,e,n){var r=n.map(function(t){var n=e.getData(t.data);return n||kt(t.data),n.extentRef(e,t.field)});return _(e.add(it({extents:r})))}function Tt(t,n,r){return e.isArray(t)?t.map(function(t){return Tt(t,n,r)}):e.isObject(t)?t.signal?r.signalRef(t.signal):"fit"===n?t:e.error("Unsupported parameter object: "+e.stringValue(t)):t}var Nt="top",jt="left",Rt="right",Pt="bottom",zt="vertical",Bt="start",Lt="end",qt="index",It="label",Ut="offset",Wt="perc",Ht="perc2",Vt="size",Gt="value",$t="guide-label",Yt="guide-title",Xt="group-title",Jt="group-subtitle",Qt="symbol",Zt="gradient",Kt="discrete",te=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],ee={name:1,style:1,interactive:1},ne={value:0},re={value:1},ie=e.toSet(["rule"]),ae=e.toSet(["group","image","rect"]);function oe(t,n,r,i){var a=m(t,n);return a.$fields.forEach(function(t){i[t]=1}),e.extend(r,a.$params),a.$expr}function ue(t,n,r,i){return function t(n,r,i,a){var o,u,s;if(n.signal)o="datum",s=oe(n.signal,r,i,a);else if(n.group||n.parent){for(u=Math.max(1,n.level||1),o="item";u-- >0;)o+=".mark.group";n.parent?(s=n.parent,o+=".datum"):s=n.group}else n.datum?(o="datum",s=n.datum):e.error("Invalid field reference: "+e.stringValue(n));return n.signal||(e.isString(s)?(a[s]=1,s=e.splitAccessPath(s).map(e.stringValue).join("][")):s=t(s,r,i,a)),o+"["+s+"]"}(e.isObject(t)?t:{datum:t},n,r,i)}function se(t,n,r,i){return e.isObject(t)?"("+fe(0,t,n,r,i)+")":t}function le(t,n,r,i,a){var o,u,s,l=ce(t.scale,r,i,a);return null!=t.range?(u=l+".range()",n=0===(o=+t.range)?u+"[0]":"($="+u+","+(1===o?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"):(void 0!==n&&(n=l+"("+n+")"),t.band&&(s=function(t,n){if(!e.isString(t))return-1;var r=n.scaleType(t);return"band"===r||"point"===r?1:0}(t.scale,r))&&(u=l+".bandwidth",o=t.band.signal?u+"()*"+se(t.band,r,i,a):u+"()"+(1===(o=+t.band)?"":"*"+o),s<0&&(o="("+u+"?"+o+":0)"),n=(n?n+"+":"")+o,t.extra&&(n="(datum.extra?"+l+"(datum.extra.value):"+n+")")),null==n&&(n="0")),n}function ce(t,n,r,i){var o;if(e.isString(t))o=a.ScalePrefix+t,e.hasOwnProperty(r,o)||(r[o]=n.scaleRef(t)),o=e.stringValue(o);else{for(o in n.scales)r[a.ScalePrefix+o]=n.scaleRef(o);o=e.stringValue(a.ScalePrefix)+"+"+(t.signal?"("+oe(t.signal,n,r,i)+")":ue(t,n,r,i))}return"_["+o+"]"}function fe(t,n,r,i,a){if(null!=n.gradient)return function(t,n,r,i){return"this.gradient("+ce(t.gradient,n,r,i)+","+e.stringValue(t.start)+","+e.stringValue(t.stop)+","+e.stringValue(t.count)+")"}(n,r,i,a);var o=n.signal?oe(n.signal,r,i,a):n.color?function(t,e,n,r){function i(t,i,a,o){return"this."+t+"("+[fe(0,i,e,n,r),fe(0,a,e,n,r),fe(0,o,e,n,r)].join(",")+").toString()"}return t.c?i("hcl",t.h,t.c,t.l):t.h||t.s?i("hsl",t.h,t.s,t.l):t.l||t.a?i("lab",t.l,t.a,t.b):t.r||t.g||t.b?i("rgb",t.r,t.g,t.b):null}(n.color,r,i,a):null!=n.field?ue(n.field,r,i,a):void 0!==n.value?e.stringValue(n.value):void 0;return null!=n.scale&&(o=le(n,o,r,i,a)),void 0===o&&(o=null),null!=n.exponent&&(o="Math.pow("+o+","+se(n.exponent,r,i,a)+")"),null!=n.mult&&(o+="*"+se(n.mult,r,i,a)),null!=n.offset&&(o+="+"+se(n.offset,r,i,a)),n.round&&(o="Math.round("+o+")"),o}function he(t,n,r){var i=t+"["+e.stringValue(n)+"]";return"$=".concat(r,";if(").concat(i,"!==$)").concat(i,"=$,m=1;")}function de(t,n,r,i,a){var o="";return n.forEach(function(t){var e=fe(0,t,r,i,a);o+=t.test?oe(t.test,r,i,a)+"?"+e+":":e}),":"===e.peek(o)&&(o+="null"),he("o",t,o)}function pe(t,n,r,i){var a,o,u={},s="var o=item,datum=o.datum,m=0,$;";for(a in t)o=t[a],e.isArray(o)?s+=de(a,o,i,r,u):s+=he("o",a,fe(0,o,i,r,u));return s+=function(t,e){var n="";return ie[e]?n:(t.x2&&(t.x?(ae[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(ae[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;"),n)}(t,n),{$expr:s+="return m;",$fields:Object.keys(u),$output:Object.keys(t)}}var ve="mark",ge="frame",me="scope",ye="axis",be="axis-domain",xe="axis-grid",_e="axis-label",we="axis-tick",ke="axis-title",Ae="legend",Ee="legend-band",Me="legend-entry",Se="legend-gradient",Ce="legend-label",Oe="legend-symbol",De="legend-title",Fe="title",Te="title-text",Ne="title-subtitle";function je(t){return e.isObject(t)&&!e.isArray(t)?e.extend({},t):{value:t}}function Re(t,n,r,i){return null!=r?(e.isObject(r)&&!e.isArray(r)?t.update[n]=r:t[i||"enter"][n]={value:r},1):0}function Pe(t,e,n){for(var r in e)Re(t,r,e[r]);for(var i in n)Re(t,i,n[i],"update")}function ze(t,n,r){for(var i in n)r&&e.hasOwnProperty(r,i)||(t[i]=e.extend(t[i]||{},n[i]));return t}function Be(t,n,r,i,a,o){var u,s;for(s in(o=o||{}).encoders={$encode:u={}},t=function(t,n,r,i,a){var o,u,s,l={},c={};for(u in u="lineBreak","text"!==n||null==a[u]||qe(u,t)||Le(l,u,a[u]),"legend"!=r&&0!==String(r).indexOf("axis")||(r=null),s=r===ge?a.group:r===ve?e.extend({},a.mark,a[n]):null)qe(u,t)||("fill"===u||"stroke"===u)&&(qe("fill",t)||qe("stroke",t))||Le(l,u,s[u]);for(u in e.array(i).forEach(function(e){var n=a.style&&a.style[e];for(var r in n)qe(r,t)||Le(l,r,n[r])}),t=e.extend({},t),l)(s=l[u]).signal?(o=o||{})[u]=s:c[u]=s;return t.enter=e.extend(c,t.enter),o&&(t.update=e.extend(o,t.update)),t}(t,n,r,i,a.config))u[s]=pe(t[s],n,o,a);return o}function Le(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}function qe(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}function Ie(t,e,n,r,i,a,o){return{type:t,name:o?o.name:void 0,role:e,style:o&&o.style||n,key:r,from:i,interactive:!(!o||!o.interactive),encode:ze(a,o,ee)}}function Ue(t,e){var n=function(n,r){return F(t[n],F(e[n],r))};return n.isVertical=function(n){return zt===F(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection))},n.gradientLength=function(){return F(t.gradientLength,e.gradientLength||e.gradientWidth)},n.gradientThickness=function(){return F(t.gradientThickness,e.gradientThickness||e.gradientHeight)},n.entryColumns=function(){return F(t.columns,F(e.columns,+n.isVertical(!0)))},n}function We(t,e){var n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function He(t,e,n){return'item.anchor === "'.concat(Bt,'" ? ').concat(t,' : item.anchor === "').concat(Lt,'" ? ').concat(e," : ").concat(n)}var Ve=He(e.stringValue(jt),e.stringValue(Rt),e.stringValue("center"));function Ge(t,n){return n?t?e.isObject(t)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t,{offset:Ge(t.offset,n)}):{value:t,offset:n}:n:t}var $e="group",Ye="rect",Xe="rule",Je="symbol",Qe="text";function Ze(t,n,r,i){var a,o,u,s,l,c,f=Ue(t,r),h=f.isVertical(),d=f.gradientThickness(),p=f.gradientLength();return h?(u=[0,1],s=[0,0],l=d,c=p):(u=[0,0],s=[1,0],l=p,c=d),Pe(a={enter:o={opacity:ne,x:ne,y:ne,width:je(l),height:je(c)},update:e.extend({},o,{opacity:re,fill:{gradient:n,start:u,stop:s}}),exit:{opacity:ne}},{stroke:f("gradientStrokeColor"),strokeWidth:f("gradientStrokeWidth")},{opacity:f("gradientOpacity")}),Ie(Ye,Se,null,void 0,void 0,a,i)}function Ke(t,n,r,i,a){var o,u,s,l,c,f,h=Ue(t,r),d=h.isVertical(),p=h.gradientThickness(),v=h.gradientLength(),g="";return d?(s="y",c="y2",l="x",f="width",g="1-"):(s="x",c="x2",l="y",f="height"),(u={opacity:ne,fill:{scale:n,field:Gt}})[s]={signal:g+"datum."+Wt,mult:v},u[l]=ne,u[c]={signal:g+"datum."+Ht,mult:v},u[f]=je(p),Pe(o={enter:u,update:e.extend({},u,{opacity:re}),exit:{opacity:ne}},{stroke:h("gradientStrokeColor"),strokeWidth:h("gradientStrokeWidth")},{opacity:h("gradientOpacity")}),Ie(Ye,Ee,null,Gt,a,o,i)}var tn="datum.".concat(Wt,'<=0?"').concat(jt,'":datum.').concat(Wt,'>=1?"').concat(Rt,'":"').concat("center",'"'),en="datum.".concat(Wt,'<=0?"').concat(Pt,'":datum.').concat(Wt,'>=1?"').concat(Nt,'":"').concat("middle",'"');function nn(t,e,n,r){var i,a,o,u,s,l=Ue(t,e),c=l.isVertical(),f=je(l.gradientThickness()),h=l.gradientLength(),d=l("labelOverlap"),p=l("labelSeparation"),v="";return Pe(i={enter:a={opacity:ne},update:o={opacity:re,text:{field:It}},exit:{opacity:ne}},{fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:F(t.labelLimit,e.gradientLabelLimit)}),c?(a.align={value:"left"},a.baseline=o.baseline={signal:en},u="y",s="x",v="1-"):(a.align=o.align={signal:tn},a.baseline={value:"top"},u="x",s="y"),a[u]=o[u]={signal:v+"datum."+Wt,mult:h},a[s]=o[s]=f,f.offset=F(t.labelOffset,e.gradientLabelOffset)||0,t=Ie(Qe,Ce,$t,Gt,r,i,n),d&&(t.overlap={separation:p,method:d,order:"datum."+qt}),t}function rn(t,e,n,r,i,a,o,u){return{type:$e,name:n,role:t,style:e,from:r,interactive:i||!1,encode:a,marks:o,layout:u}}function an(t,e,n,r,i){var a,o,u,s,l,c,f,h=Ue(t,e),d=n.entries,p=!(!d||!d.interactive),v=d?d.name:void 0,g=h("clipHeight"),m=h("symbolOffset"),y={data:"value"},b={},x="(".concat(i,") ? datum.").concat(Ut," : datum.").concat(Vt),_=g?je(g):{field:Vt},w="datum.".concat(qt),k="max(1, ".concat(i,")");_.mult=.5,b={enter:a={opacity:ne,x:{signal:x,mult:.5,offset:m},y:_},update:o={opacity:re,x:a.x,y:a.y},exit:{opacity:ne}};var A=null,E=null;return t.fill||(A=e.symbolBaseFillColor,E=e.symbolBaseStrokeColor),Pe(b,{fill:h("symbolFillColor",A),shape:h("symbolType"),size:h("symbolSize"),stroke:h("symbolStrokeColor",E),strokeDash:h("symbolDash"),strokeDashOffset:h("symbolDashOffset"),strokeWidth:h("symbolStrokeWidth")},{opacity:h("symbolOpacity")}),te.forEach(function(e){t[e]&&(o[e]=a[e]={scale:t[e],field:Gt})}),s=Ie(Je,Oe,null,Gt,y,b,n.symbols),g&&(s.clip=!0),(u=je(m)).offset=h("labelOffset"),Pe(b={enter:a={opacity:ne,x:{signal:x,offset:u},y:_},update:o={opacity:re,text:{field:It},x:a.x,y:a.y},exit:{opacity:ne}},{align:h("labelAlign"),baseline:h("labelBaseline"),fill:h("labelColor"),fillOpacity:h("labelOpacity"),font:h("labelFont"),fontSize:h("labelFontSize"),fontStyle:h("labelFontStyle"),fontWeight:h("labelFontWeight"),limit:h("labelLimit")}),l=Ie(Qe,Ce,$t,Gt,y,b,n.labels),b={enter:{noBound:{value:!g},width:ne,height:g?je(g):ne,opacity:ne},exit:{opacity:ne},update:o={opacity:re,row:{signal:null},column:{signal:null}}},h.isVertical(!0)?(c="ceil(item.mark.items.length / ".concat(k,")"),o.row.signal="".concat(w,"%").concat(c),o.column.signal="floor(".concat(w," / ").concat(c,")"),f={field:["row",w]}):(o.row.signal="floor(".concat(w," / ").concat(k,")"),o.column.signal="".concat(w," % ").concat(k),f={field:w}),o.column.signal="(".concat(i,")?").concat(o.column.signal,":").concat(w),(t=rn(me,null,v,r={facet:{data:r,name:"value",groupby:qt}},p,ze(b,d,ee),[s,l])).sort=f,t}var on='item.orient === "left"',un='item.orient === "right"',sn="(".concat(on," || ").concat(un,")"),ln="datum.vgrad && ".concat(sn),cn=He('"top"','"bottom"','"middle"'),fn=He('"right"','"left"','"center"'),hn="datum.vgrad && ".concat(un," ? (").concat(fn,") : (").concat(sn," && !(datum.vgrad && ").concat(on,')) ? "left" : ').concat(Ve),dn="item._anchor || (".concat(sn,' ? "middle" : "start")'),pn="".concat(ln," ? (").concat(on," ? -90 : 90) : 0"),vn="".concat(sn," ? (datum.vgrad ? (").concat(un,' ? "bottom" : "top") : ').concat(cn,') : "top"');function gn(t,n){var r;return e.isObject(t)&&(t.signal?r=t.signal:t.path?r="pathShape("+mn(t.path)+")":t.sphere&&(r="geoShape("+mn(t.sphere)+', {type: "Sphere"})')),r?n.signalRef(r):!!t}function mn(t){return e.isObject(t)&&t.signal?t.signal:e.stringValue(t)}function yn(t){var e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===$e?me:e||ve:e}function bn(t){return{marktype:t.type,name:t.name||void 0,role:t.role||yn(t),zindex:+t.zindex||void 0}}function xn(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function _n(t,n){var r=s.definition(t.type);r||e.error("Unrecognized transform type: "+e.stringValue(t.type));var i=b(r.type.toLowerCase(),null,wn(r,t,n));return t.signal&&n.addSignal(t.signal,n.proxy(i)),i.metadata=r.metadata||{},i}function wn(t,e,n){var r,i,a,o={};for(i=0,a=t.params.length;i<a;++i)o[(r=t.params[i]).name]=kn(r,e,n);return o}function kn(t,n,r){var i=t.type,a=n[t.name];return"index"===i?function(t,n,r){return e.isString(n.from)||e.error('Lookup "from" parameter must be a string literal.'),r.getData(n.from).lookupRef(r,n.key)}(0,n,r):void 0!==a?"param"===i?function(t,n,r){var i=n[t.name];return t.array?(e.isArray(i)||e.error("Expected an array of sub-parameters. Instead: "+e.stringValue(i)),i.map(function(e){return En(t,e,r)})):En(t,i,r)}(t,n,r):"projection"===i?r.projectionRef(n[t.name]):t.array&&!O(a)?a.map(function(e){return An(t,e,r)}):An(t,a,r):void(t.required&&e.error("Missing required "+e.stringValue(n.type)+" parameter: "+e.stringValue(t.name)))}function An(t,n,r){var i=t.type;if(O(n))return Mn(i)?e.error("Expression references can not be signals."):Sn(i)?r.fieldRef(n):Cn(i)?r.compareRef(n):r.signalRef(n.signal);var a,o=t.expr||Sn(i);return o&&(a=n)&&a.expr?r.exprRef(n.expr,n.as):o&&function(t){return t&&t.field}(n)?w(n.field,n.as):Mn(i)?m(n,r):function(t){return"data"===t}(i)?_(r.getData(n).values):Sn(i)?w(n):Cn(i)?r.compareRef(n):n}function En(t,n,r){var i,a,o,u,s;for(u=0,s=t.params.length;u<s;++u){for(o in(a=t.params[u]).key)if(a.key[o]!==n[o]){a=null;break}if(a)break}return a||e.error("Unsupported parameter: "+e.stringValue(n)),i=e.extend(wn(a,n,r),a.key),_(r.add(ut(i)))}function Mn(t){return"expr"===t}function Sn(t){return"field"===t}function Cn(t){return"compare"===t}function On(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:_(e.getData(t.data).output)}function Dn(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}Dn.fromEntries=function(t,e){var n=e.length,r=1,i=e[0],a=e[n-1],o=e[n-2],u=null;for(i&&"load"===i.type&&(i=e[1]),t.add(e[0]);r<n;++r)e[r].params.pulse=_(e[r-1]),t.add(e[r]),"aggregate"===e[r].type&&(u=e[r]);return new Dn(t,i,o,a,u)};var Fn=Dn.prototype;function Tn(t){return e.isString(t)?t:null}function Nn(t,e,n){var r,i=M(n.op,n.field);if(e.ops){for(var a=0,o=e.as.length;a<o;++a)if(e.as[a]===i)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((r=n.op.signal)?t.signalRef(r):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(i))}function jn(t,n,r,i,a,o,u){var s,l,c=n[r]||(n[r]={}),f=function(t){return e.isObject(t)?(t.order===E?"-":"+")+M(t.op,t.field):""}(o),h=Tn(a);if(null!=h&&(t=n.scope,s=c[h+=f?"|"+f:""]),!s){var d=o?{field:k,pulse:n.countsRef(t,a,o)}:{field:t.fieldRef(a),pulse:_(n.output)};f&&(d.sort=t.sortRef(o)),l=t.add(b(i,void 0,d)),u&&(n.index[a]=l),s=_(l),null!=h&&(c[h]=s)}return s}function Rn(t,e,n){var r,i=t.remove,a=t.insert,o=t.toggle,u=t.modify,s=t.values,l=e.add(x());r=m("if("+t.trigger+',modify("'+n+'",'+[a,i,o,u,s].map(function(t){return null==t?"null":t}).join(",")+"),0)",e),l.update=r.$expr,l.params=r.$params}function Pn(t,n){var r,i,a,o,u,s,l,c,f,h,d,p,v,g,m=yn(t),y=t.type===$e,b=t.from&&t.from.facet,x=t.layout||m===me||m===ge,k=m===ve||x||b,A=t.overlap;a=function(t,n,r){var i,a,o,u,s;return t?(i=t.facet)&&(n||e.error("Only group marks can be faceted."),null!=i.field?u=s=On(i,r):(t.data?s=_(r.getData(t.data).aggregate):((o=_n(e.extend({type:"aggregate",groupby:e.array(i.groupby)},i.aggregate),r)).params.key=r.keyRef(i.groupby),o.params.pulse=On(i,r),u=s=_(r.add(o))),a=r.keyRef(i.groupby,!0))):u=_(r.add($(null,[{}]))),u||(u=On(t,r)),{key:a,pulse:u,parent:s}}(t.from,y,n),h=_(i=n.add(X({key:a.key||(t.key?w(t.key):void 0),pulse:a.pulse,clean:!y}))),i=o=n.add($({pulse:h})),i=n.add(rt({markdef:bn(t),interactive:xn(t.interactive,n),clip:gn(t.clip,n),context:{$context:!0},groups:n.lookup(),parent:n.signals.parent?n.signalRef("parent"):null,index:n.markpath(),pulse:_(i)})),d=_(i),(i=u=n.add(J(Be(t.encode,t.type,m,t.style,n,{mod:!1,pulse:d})))).params.parent=n.encode(),t.transform&&t.transform.forEach(function(t){var r=_n(t,n),a=r.metadata;(a.generates||a.changes)&&e.error("Mark transforms should not generate new data."),a.nomod||(u.params.mod=!0),r.params.pulse=_(i),n.add(i=r)}),t.sort&&(i=n.add(vt({sort:n.compareRef(t.sort),pulse:_(i)}))),p=_(i),(b||x)&&(v=_(x=n.add(gt({layout:n.objectProperty(t.layout),legends:n.legends,mark:d,pulse:p})))),g=_(s=n.add(G({mark:d,pulse:v||p}))),y&&(k&&((r=n.operators).pop(),x&&r.pop()),n.pushState(p,v||g,h),b?function(t,n,r){var i,a,o,u,s=t.from.facet,l=s.name,c=On(s,n);s.name||e.error("Facet must have a name: "+e.stringValue(s)),s.data||e.error("Facet must reference a data set: "+e.stringValue(s)),s.field?u=n.add(st({field:n.fieldRef(s.field),pulse:c})):s.groupby?u=n.add(Z({key:n.keyRef(s.groupby),group:_(n.proxy(r.parent)),pulse:c})):e.error("Facet must specify groupby or field: "+e.stringValue(s)),a=(i=n.fork()).add($()),o=i.add(pt({pulse:_(a)})),i.addData(l,new Dn(i,a,a,o)),i.addSignal("parent",null),u.params.subflow={$subflow:Yn(t,i).toRuntime()}}(t,n,a):k?function(t,e,n){var r=e.add(st({pulse:n.pulse})),i=e.fork();i.add(pt()),i.addSignal("parent",null),r.params.subflow={$subflow:Yn(t,i).toRuntime()}}(t,n,a):Yn(t,n),n.popState(),k&&(x&&r.push(x),r.push(s))),A&&(g=function(t,e,n){var r,i=t.method,a=t.bound,o=t.separation,u={separation:O(o)?n.signalRef(o.signal):o,method:O(i)?n.signalRef(i.signal):i,pulse:e};return t.order&&(u.sort=n.compareRef({field:t.order})),a&&(r=a.tolerance,u.boundTolerance=O(r)?n.signalRef(r.signal):+r,u.boundScale=n.scaleRef(a.scale),u.boundOrient=a.orient),_(n.add(ot(u)))}(A,g,n)),l=n.add(ht({pulse:g})),c=n.add(pt({pulse:_(l)},void 0,n.parent())),null!=t.name&&(f=t.name,n.addData(f,new Dn(n,o,l,c)),t.on&&t.on.forEach(function(t){(t.insert||t.remove||t.toggle)&&e.error("Marks only support modify triggers."),Rn(t,n,f)}))}function zn(t,n){var r,i,a,o,s,l,c,f,h,d=n.config.legend,p=t.encode||{},v=p.legend||{},g=v.name||void 0,y=v.interactive,b=v.style,x=Ue(t,d),w=te.reduce(function(e,n){return e||t[n]},0);return w||e.error("Missing valid scale for legend."),s=function(t,e){var n=t.type||Qt;return t.type||1!==function(t){return te.reduce(function(e,n){return e+(t[n]?1:0)},0)}(t)||!t.fill&&!t.stroke||(n=u.isContinuous(e)?Zt:u.isDiscretizing(e)?Kt:Qt),n!==Zt?n:u.isDiscretizing(e)?Kt:Zt}(t,n.scaleType(w)),l={title:null!=t.title,type:s,vgrad:"symbol"!==s&&x.isVertical()},c=_(n.add($(null,[l]))),v=ze(function(t,e){var n={enter:{},update:{}};return Pe(n,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:e.strokeWidth,strokeDash:e.strokeDash,x:t("legendX"),y:t("legendY")}),n}(x,d),v,ee),r={enter:{x:{value:0},y:{value:0}}},f=_(n.add(et(a={type:s,scale:n.scaleRef(w),count:n.objectProperty(x("tickCount")),limit:n.property(x("symbolLimit")),values:n.objectProperty(t.values),minstep:n.property(t.tickMinStep),formatType:n.property(t.formatType),formatSpecifier:n.property(t.format)}))),s===Zt?(o=[Ze(t,w,d,p.gradient),nn(t,d,p.labels,f)],a.count=a.count||n.signalRef("max(2,2*floor((".concat(T(x.gradientLength()),")/100))"))):s===Kt?o=[Ke(t,w,d,p.gradient,f),nn(t,d,p.labels,f)]:(i=function(t,e){var n=Ue(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,d),o=[an(t,d,p,f,T(i.columns))],a.size=function(t,e,n){var r=T(Bn("size",t,n)),i=T(Bn("strokeWidth",t,n)),a=T(function(t,e,n){return We("fontSize",t)||function(t,e,n){var r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,$t));return m("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),e)}(t,n,o[0].marks)),o=[rn(Me,null,null,c,y,r,o,i)],l.title&&o.push(function(t,e,n,r){var i,a=Ue(t,e);return Pe(i={enter:{opacity:ne},update:{opacity:re,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:ne}},{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:dn},angle:{signal:pn},align:{signal:hn},baseline:{signal:vn},text:t.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),Ie(Qe,De,Yt,null,r,i,n)}(t,d,p.title,c)),h=rn(Ae,b,g,c,y,v,o),t.zindex&&(h.zindex=t.zindex),Pn(h,n)}function Bn(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):We(t,n[0].encode)}Fn.countsRef=function(t,e,n){var r,i,a,o=this.counts||(this.counts={}),u=Tn(e);return null!=u&&(t=this.scope,r=o[u]),r?n&&n.field&&Nn(t,r.agg.params,n):(a={groupby:t.fieldRef(e,"key"),pulse:_(this.output)},n&&n.field&&Nn(t,a,n),i=t.add(H(a)),r=t.add($({pulse:_(i)})),r={agg:i,ref:_(r)},null!=u&&(o[u]=r)),r.ref},Fn.tuplesRef=function(){return _(this.values)},Fn.extentRef=function(t,e){return jn(t,this,"extent","extent",e,!1)},Fn.domainRef=function(t,e){return jn(t,this,"domain","values",e,!1)},Fn.valuesRef=function(t,e,n){return jn(t,this,"vals","values",e,n||!0)},Fn.lookupRef=function(t,e){return jn(t,this,"lookup","tupleindex",e,!1)},Fn.indataRef=function(t,e){return jn(t,this,"indata","tupleindex",e,!0,!0)};var Ln='item.orient==="'.concat(jt,'"?-90:item.orient==="').concat(Rt,'"?90:0');function qn(t,n){var r,i,a=Ue(t=e.isString(t)?{text:t}:t,n.config.title),o=t.encode||{},u=o.group||{},s=u.name||void 0,l=u.interactive,c=u.style,f=[];return r=_(n.add($(null,[{}]))),f.push(function(t,e,n,r){var i={value:0},a=t.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Pe(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Ie(Qe,Te,Xt,null,r,o,n)}(t,a,function(t){var n=t.encode;return n&&n.title||e.extend({name:t.name,interactive:t.interactive,style:t.style},n)}(t),r)),t.subtitle&&f.push(function(t,e,n,r){var i={value:0},a=t.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Pe(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Ie(Qe,Ne,Jt,null,r,o,n)}(t,a,o.subtitle,r)),i=rn(Fe,c,s,r,l,function(t,e){var n={enter:{},update:{}};return Pe(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:Ve},angle:{signal:Ln},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),ze(n,e,ee)}(a,u),f),t.zindex&&(i.zindex=t.zindex),Pn(i,n)}function In(t,n){var r=[];t.transform&&t.transform.forEach(function(t){r.push(_n(t,n))}),t.on&&t.on.forEach(function(e){Rn(e,n,t.name)}),n.addDataPipeline(t.name,function(t,n,r){var i,a,o,u,s,l=[],c=null,f=!1,h=!1;for(t.values?D(t.values)||D(t.format)?(l.push(Wn(n,t)),l.push(c=Un())):l.push(c=Un({$ingest:t.values,$format:t.format})):t.url?D(t.url)||D(t.format)?(l.push(Wn(n,t)),l.push(c=Un())):l.push(c=Un({$request:t.url,$format:t.format})):t.source&&(c=i=e.array(t.source).map(function(t){return _(n.getData(t).output)}),l.push(null)),a=0,o=r.length;a<o;++a)u=r[a],s=u.metadata,c||s.source||l.push(c=Un()),l.push(u),s.generates&&(h=!0),s.modifies&&!h&&(f=!0),s.source?c=u:s.changes&&(c=null);return i&&(o=i.length-1,l[0]=ft({derive:f,pulse:o?i:i[0]}),(f||o)&&l.splice(1,0,Un())),c||l.push(Un()),l.push(pt({})),l}(t,n,r))}function Un(t){var e=$({},t);return e.metadata={source:!0},e}function Wn(t,e){return nt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}function Hn(t,e){return{scale:t.scale,range:e}}function Vn(t,n,r,i,a){var o,u,s,l,c,f,h,d,p,v=Ue(t,n),g=t.orient,m=t.gridScale,y=g===jt||g===Nt?1:-1,b=function(t,n){if(1===n);else if(e.isObject(t)){for(var r=t=e.extend({},t);null!=r.mult;){if(!e.isObject(r.mult))return r.mult*=n,t;r=r.mult=e.extend({},r.mult)}r.mult=n}else t=n*(t||0);return t}(t.offset,y);return Pe(o={enter:u={opacity:ne},update:l={opacity:re},exit:s={opacity:ne}},{stroke:v("gridColor"),strokeDash:v("gridDash"),strokeDashOffset:v("gridDashOffset"),strokeOpacity:v("gridOpacity"),strokeWidth:v("gridWidth")}),c={scale:t.scale,field:Gt,band:a.band,extra:a.extra,offset:a.offset,round:v("tickRound")},g===Nt||g===Pt?(f="x",h="y",p="height"):(f="y",h="x",p="width"),d=h+"2",l[f]=u[f]=s[f]=c,m?(l[h]=u[h]={scale:m,range:0,mult:y,offset:b},l[d]=u[d]={scale:m,range:1,mult:y,offset:b}):(l[h]=u[h]={value:0,offset:b},l[d]=u[d]={signal:p,mult:y,offset:b}),Ie(Xe,xe,null,Gt,i,o,r)}function Gn(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function $n(t,n){var i,a,o,u,s,l,c=function(t,n){var r=n.config,i=t.orient,a=i===Nt||i===Pt?r.axisX:r.axisY,o=r["axis"+i[0].toUpperCase()+i.slice(1)],u="band"===n.scaleType(t.scale)&&r.axisBand;return a||o||u?e.extend({},r.axis,a,o,u):r.axis}(t,n),f=t.encode||{},h=f.axis||{},d=h.name||void 0,p=h.interactive,v=h.style,g=Ue(t,c),m=function(t){var n,r,i=t("tickBand"),a=t("tickOffset");return i?i.signal?(n={signal:"(".concat(i.signal,")==='extent'?1:0.5")},r={signal:"(".concat(i.signal,")==='extent'?true:false")},e.isObject(a)||(a={signal:"(".concat(i.signal,")==='extent'?0:").concat(a)})):"extent"===i?(n=1,r=!0,a=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:a}}(g);return i={orient:t.orient,ticks:!!g("ticks"),labels:!!g("labels"),grid:!!g("grid"),domain:!!g("domain"),title:null!=t.title,translate:g("translate")},a=_(n.add($({},[i]))),h=ze({update:{offset:je(g("offset")||0),position:je(F(t.position,0)),titlePadding:je(g("titlePadding")),minExtent:je(g("minExtent")),maxExtent:je(g("maxExtent")),range:{signal:'abs(span(range("'.concat(t.scale,'")))')}}},f.axis,ee),o=_(n.add(V({scale:n.scaleRef(t.scale),extra:n.property(m.extra),count:n.objectProperty(t.tickCount),values:n.objectProperty(t.values),minstep:n.property(t.tickMinStep),formatType:n.property(t.formatType),formatSpecifier:n.property(t.format)}))),l=[],i.grid&&l.push(Vn(t,c,f.grid,o,m)),i.ticks&&(u=g("tickSize"),l.push(function(t,e,n,r,i,a){var o,u,s,l,c,f,h=Ue(t,e),d=t.orient,p=d===jt||d===Nt?-1:1;return Pe(o={enter:u={opacity:ne},update:l={opacity:re},exit:s={opacity:ne}},{stroke:h("tickColor"),strokeDash:h("tickDash"),strokeDashOffset:h("tickDashOffset"),strokeOpacity:h("tickOpacity"),strokeWidth:h("tickWidth")}),(c=je(i)).mult=p,f={scale:t.scale,field:Gt,band:a.band,extra:a.extra,offset:a.offset,round:h("tickRound")},d===Nt||d===Pt?(l.y=u.y=ne,l.y2=u.y2=c,l.x=u.x=s.x=f):(l.x=u.x=ne,l.x2=u.x2=c,l.y=u.y=s.y=f),Ie(Xe,we,null,Gt,r,o,n)}(t,c,f.ticks,o,u,m))),i.labels&&(u=i.ticks?u:0,l.push(function(t,e,n,i,a,o){var u,s,l,c,f,h,d,p,v,g,m,y=Ue(t,e),b=t.orient,x=b===jt||b===Nt?-1:1,_=b===Nt||b===Pt,w=t.scale,k=T(y("labelFlush")),A=T(y("labelFlushOffset")),E=0===k||!!k,M=y("labelAlign"),S=y("labelBaseline");return(c=je(a)).mult=x,c.offset=je(y("labelPadding")||0),c.offset.mult=x,f={scale:w,field:Gt,band:.5,offset:Ge(o.offset,y("labelOffset"))},_?(h=M||(E?Gn(w,k,'"left"','"right"','"center"'):"center"),d=S||(b===Nt?"bottom":"top"),p=!M):(h=M||(b===Rt?"left":"right"),d=S||(E?Gn(w,k,'"top"','"bottom"','"middle"'):"middle"),p=!S),p=p&&E&&A?Gn(w,k,"-("+A+")",A,0):null,Pe(s={enter:l={opacity:ne,x:_?f:c,y:_?c:f},update:{opacity:re,text:{field:It},x:l.x,y:l.y},exit:{opacity:ne,x:l.x,y:l.y}},(r(u={},_?"dx":"dy",p),r(u,"align",h),r(u,"baseline",d),r(u,"angle",y("labelAngle")),r(u,"fill",y("labelColor")),r(u,"fillOpacity",y("labelOpacity")),r(u,"font",y("labelFont")),r(u,"fontSize",y("labelFontSize")),r(u,"fontWeight",y("labelFontWeight")),r(u,"fontStyle",y("labelFontStyle")),r(u,"limit",y("labelLimit")),r(u,"lineHeight",y("labelLineHeight")),u)),v=y("labelBound"),g=y("labelOverlap"),m=y("labelSeparation"),t=Ie(Qe,_e,$t,Gt,i,s,n),(g||v)&&(t.overlap={separation:m,method:g,order:"datum.index",bound:v?{scale:w,orient:b,tolerance:v}:null}),t}(t,c,f.labels,o,u,m))),i.domain&&l.push(function(t,e,n,r){var i,a,o,u,s,l,c=Ue(t,e),f=t.orient;return Pe(i={enter:a={opacity:ne},update:o={opacity:re},exit:{opacity:ne}},{stroke:c("domainColor"),strokeDash:c("domainDash"),strokeDashOffset:c("domainDashOffset"),strokeWidth:c("domainWidth"),strokeOpacity:c("domainOpacity")}),f===Nt||f===Pt?(u="x",l="y"):(u="y",l="x"),s=u+"2",a[l]=ne,o[u]=a[u]=Hn(t,0),o[s]=a[s]=Hn(t,1),Ie(Xe,be,null,null,r,i,n)}(t,c,f.domain,a)),i.title&&l.push(function(t,n,r,i){var a,o,u,s,l=Ue(t,n),c=t.orient,f=c===jt||c===Nt?-1:1,h=c===Nt||c===Pt;return a={enter:o={opacity:ne,anchor:je(l("titleAnchor")),align:{signal:Ve}},update:u=e.extend({},o,{opacity:re,text:je(t.title)}),exit:{opacity:ne}},s={signal:'lerp(range("'.concat(t.scale,'"), ').concat(He(0,1,.5),")")},h?(u.x=s,o.angle={value:0},o.baseline={value:c===Nt?"bottom":"top"}):(u.y=s,o.angle={value:90*f},o.baseline={value:"bottom"}),Pe(a,{angle:l("titleAngle"),baseline:l("titleBaseline"),fill:l("titleColor"),fillOpacity:l("titleOpacity"),font:l("titleFont"),fontSize:l("titleFontSize"),fontStyle:l("titleFontStyle"),fontWeight:l("titleFontWeight"),limit:l("titleLimit"),lineHeight:l("titleLineHeight")},{align:l("titleAlign")}),!Re(a,"x",l("titleX"),"update")&&!h&&!qe("x",r)&&(a.enter.auto={value:!0}),!Re(a,"y",l("titleY"),"update")&&h&&!qe("y",r)&&(a.enter.auto={value:!0}),Ie(Qe,ke,Yt,null,i,a,r)}(t,c,f.title,a)),s=rn(ye,v,d,a,p,h,l),t.zindex&&(s.zindex=t.zindex),Pn(s,n)}function Yn(t,n,r){var i=e.array(t.signals),a=e.array(t.scales);return r||i.forEach(function(t){return g(t,n)}),e.array(t.projections).forEach(function(t){return function(t,e){var n=e.config.projection||{},r={};for(var i in t)"name"!==i&&(r[i]=Tt(t[i],i,e));for(i in n)null==r[i]&&(r[i]=Tt(n[i],i,e));e.addProjection(t.name,r)}(t,n)}),a.forEach(function(t){return function(t,n){var r=t.type||"linear";u.isValidScaleType(r)||e.error("Unrecognized scale type: "+e.stringValue(r)),n.addScale(t.name,{type:r,domain:void 0})}(t,n)}),e.array(t.data).forEach(function(t){return In(t,n)}),a.forEach(function(t){return xt(t,n)}),(r||i).forEach(function(t){return U(t,n)}),e.array(t.axes).forEach(function(t){return $n(t,n)}),e.array(t.marks).forEach(function(t){return Pn(t,n)}),e.array(t.legends).forEach(function(t){return zn(t,n)}),t.title&&qn(t.title,n),n.parseLambdas(),n}function Xn(t,n){var r,i,a,o,u,s,c=n.config;return u=_(n.root=n.add(x())),(s=function(t,n){var r=function(e){return F(t[e],n[e])},i=[Jn("background",r("background")),Jn("autosize",l(r("autosize"))),Jn("padding",h(r("padding"))),Jn("width",r("width")||0),Jn("height",r("height")||0)],a=i.reduce(function(t,e){return t[e.name]=e,t},{}),o={};return e.array(t.signals).forEach(function(t){e.hasOwnProperty(a,t.name)?t=e.extend(a[t.name],t):i.push(t),o[t.name]=t}),e.array(n.signals).forEach(function(t){e.hasOwnProperty(o,t.name)||e.hasOwnProperty(a,t.name)||i.push(t)}),i}(t,c)).forEach(function(t){return g(t,n)}),n.description=t.description||c.description,n.eventConfig=c.events,n.legends=n.objectProperty(c.legend&&c.legend.layout),i=n.add($()),a=ze({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t.encode),a=n.add(J(Be(a,$e,ge,t.style,n,{pulse:_(i)}))),o=n.add(gt({layout:n.objectProperty(t.layout),legends:n.legends,autosize:n.signalRef("autosize"),mark:u,pulse:_(a)})),n.operators.pop(),n.pushState(_(a),_(o),null),Yn(t,n,s),n.operators.push(o),r=n.add(G({mark:u,pulse:_(o)})),r=n.add(ht({pulse:_(r)})),r=n.add(pt({pulse:_(r)})),n.addData("root",new Dn(n,i,i,r)),n}function Jn(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function Qn(t){this.config=t,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Zn(t){this.config=t.config,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}var Kn=Qn.prototype=Zn.prototype;function tr(t){return(e.isArray(t)?er:nr)(t)}function er(t){for(var n,r="[",i=0,a=t.length;i<a;++i)n=t[i],r+=(i>0?",":"")+(e.isObject(n)?n.signal||tr(n):e.stringValue(n));return r+"]"}function nr(t){var n,r,i="{",a=0;for(n in t)r=t[n],i+=(++a>1?",":"")+e.stringValue(n)+":"+(e.isObject(r)?r.signal||tr(r):e.stringValue(r));return i+"}"}Kn.fork=function(){return new Zn(this)},Kn.isSubscope=function(){return this._subid>0},Kn.toRuntime=function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},Kn.id=function(){return(this._subid?this._subid+":":0)+this._id++},Kn.add=function(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(function(e){e.$ref=t.id}),t.refs=null),t},Kn.proxy=function(t){var e=t instanceof y?_(t):t;return this.add(ct({value:e}))},Kn.addStream=function(t){return this.streams.push(t),t.id=this.id(),t},Kn.addUpdate=function(t){return this.updates.push(t),t},Kn.finish=function(){var t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){var r;t&&((r=t.data||(t.data={}))[e]||(r[e]=[])).push(n)}for(t in this.data)for(var r in n((e=this.data[t]).input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values"),e.index)n(e.index[r],t,"index:"+r);return this},Kn.pushState=function(t,e,n){this._encode.push(_(this.add(pt({pulse:t})))),this._parent.push(e),this._lookup.push(n?_(this.proxy(n)):null),this._markpath.push(-1)},Kn.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},Kn.parent=function(){return e.peek(this._parent)},Kn.encode=function(){return e.peek(this._encode)},Kn.lookup=function(){return e.peek(this._lookup)},Kn.markpath=function(){var t=this._markpath;return++t[t.length-1]},Kn.fieldRef=function(t,n){if(e.isString(t))return w(t,n);t.signal||e.error("Unsupported field reference: "+e.stringValue(t));var r,i=t.signal,a=this.field[i];return a||(r={name:this.signalRef(i)},n&&(r.as=n),this.field[i]=a=_(this.add(K(r)))),a},Kn.compareRef=function(t){function n(t){return O(t)?(i=!0,r.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(i=!0,r.exprRef(t.expr)):t}var r=this,i=!1,a=e.array(t.field).map(n),o=e.array(t.order).map(n);return i?_(this.add(Y({fields:a,orders:o}))):A(a,o)},Kn.keyRef=function(t,n){var r=this.signals,i=!1;return t=e.array(t).map(function(t){return O(t)?(i=!0,_(r[t.signal])):t}),i?_(this.add(tt({fields:t,flat:n}))):function(t,e){var n={$key:t};return e&&(n.$flat=!0),n}(t,n)},Kn.sortRef=function(t){if(!t)return t;var e=M(t.op,t.field),n=t.order||"ascending";return n.signal?_(this.add(Y({fields:e,orders:this.signalRef(n.signal)}))):A(e,n)},Kn.event=function(t,e){var n=t+":"+e;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},Kn.hasOwnSignal=function(t){return e.hasOwnProperty(this.signals,t)},Kn.addSignal=function(t,n){this.hasOwnSignal(t)&&e.error("Duplicate signal name: "+e.stringValue(t));var r=n instanceof y?n:this.add(x(n));return this.signals[t]=r},Kn.getSignal=function(t){return this.signals[t]||e.error("Unrecognized signal name: "+e.stringValue(t)),this.signals[t]},Kn.signalRef=function(t){return this.signals[t]?_(this.signals[t]):(e.hasOwnProperty(this.lambdas,t)||(this.lambdas[t]=this.add(x(null))),_(this.lambdas[t]))},Kn.parseLambdas=function(){for(var t=Object.keys(this.lambdas),e=0,n=t.length;e<n;++e){var r=t[e],i=m(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},Kn.property=function(t){return t&&t.signal?this.signalRef(t.signal):t},Kn.objectProperty=function(t){return t&&e.isObject(t)?this.signalRef(t.signal||tr(t)):t},Kn.exprRef=function(t,e){var n={expr:m(t,this)};return e&&(n.expr.$name=e),_(this.add(Q(n)))},Kn.addBinding=function(t,n){this.bindings||e.error("Nested signals do not support binding: "+e.stringValue(t)),this.bindings.push(e.extend({signal:t},n))},Kn.addScaleProj=function(t,n){e.hasOwnProperty(this.scales,t)&&e.error("Duplicate scale or projection name: "+e.stringValue(t)),this.scales[t]=this.add(n)},Kn.addScale=function(t,e){this.addScaleProj(t,dt(e))},Kn.addProjection=function(t,e){this.addScaleProj(t,lt(e))},Kn.getScale=function(t){return this.scales[t]||e.error("Unrecognized scale name: "+e.stringValue(t)),this.scales[t]},Kn.projectionRef=Kn.scaleRef=function(t){return _(this.getScale(t))},Kn.projectionType=Kn.scaleType=function(t){return this.getScale(t).params.type},Kn.addData=function(t,n){return e.hasOwnProperty(this.data,t)&&e.error("Duplicate data set name: "+e.stringValue(t)),this.data[t]=n},Kn.getData=function(t){return this.data[t]||e.error("Undefined data set name: "+e.stringValue(t)),this.data[t]},Kn.addDataPipeline=function(t,n){return e.hasOwnProperty(this.data,t)&&e.error("Duplicate data set name: "+e.stringValue(t)),this.addData(t,Dn.fromEntries(this,n))};var rr="sans-serif",ir=30,ar=2,or="#4c78a8",ur="#000",sr="#888",lr="#ddd";function cr(){return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:or},area:{fill:or},image:null,line:{stroke:or,strokeWidth:ar},path:{stroke:or},rect:{fill:or},rule:{stroke:ur},shape:{stroke:or},symbol:{fill:or,size:64},text:{fill:ur,font:rr,fontSize:11},style:{"guide-label":{fill:ur,font:rr,fontSize:10},"guide-title":{fill:ur,font:rr,fontSize:11,fontWeight:"bold"},"group-title":{fill:ur,font:rr,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:ur,font:rr,fontSize:12},point:{size:ir,strokeWidth:ar,shape:"circle"},circle:{size:ir,strokeWidth:ar},square:{size:ir,strokeWidth:ar,shape:"square"},cell:{fill:"transparent",stroke:lr}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:sr,grid:!1,gridWidth:1,gridColor:lr,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:sr,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:lr,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:sr,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}t.AxisDomainRole=be,t.AxisGridRole=xe,t.AxisLabelRole=_e,t.AxisRole=ye,t.AxisTickRole=we,t.AxisTitleRole=ke,t.DataScope=Dn,t.FrameRole=ge,t.LegendEntryRole=Me,t.LegendLabelRole=Ce,t.LegendRole=Ae,t.LegendSymbolRole=Oe,t.LegendTitleRole=De,t.MarkRole=ve,t.Scope=Qn,t.ScopeRole=me,t.config=cr,t.parse=function(t,n){return e.isObject(t)||e.error("Input Vega specification must be an object."),Xn(t,new Qn(n=e.mergeConfig(cr(),n,t.config))).toRuntime()},t.signal=g,t.signalUpdates=U,t.stream=j,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(2147),n(1346),n(1345),n(2148),n(1172),n(1045))},2147:function(t,e,n){!function(t){"use strict";function e(t,e,n){return t.fields=e||[],t.fname=n,t}function n(t){return null==t?null:t.fields}function r(t){throw Error(t)}function i(t){var e,n,i,a=[],o=null,u=0,s=t.length,l="";function c(){a.push(l+t.substring(e,n)),l="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(i=t[n]))l+=t.substring(e,n),l+=t.substring(++n,++n),e=n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;e===u&&'"'===i?(e=n+1,o=i):e===u&&"'"===i?(e=n+1,o=i):"."!==i||u?"["===i?(n>e&&c(),u=e=n+1):"]"===i&&(u||r("Access path missing open bracket: "+t),u>0&&c(),u=0,e=n+1):n>e?c():e=n+1}return u&&r("Access path missing closing bracket: "+t),o&&r("Access path missing closing quote: "+t),n>e&&(n++,c()),a}var a=Array.isArray;function o(t){return t===Object(t)}function u(t){return"string"===typeof t}function s(t){return a(t)?"["+t.map(s)+"]":o(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function l(t,n){var r=i(t),a="return _["+r.map(s).join("][")+"];";return e(Function("_",a),[t=1===r.length?r[0]:t],n||t)}var c=[],f=l("id"),h=e(function(t){return t},c,"identity"),d=e(function(){return 0},c,"zero"),p=e(function(){return 1},c,"one"),v=e(function(){return!0},c,"true"),g=e(function(){return!1},c,"false");function m(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var y=0,b=1,x=2,_=3,w=4,k=function(t){return"__proto__"!==t};function A(t,e,n,r){var i,u;if(k(e))if(o(n)&&!a(n))for(i in u=o(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):k(i)&&(u[i]=n[i]);else t[e]=n}function E(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function M(t){return t[t.length-1]}function S(t){return null==t||""===t?null:+t}function C(t){return function(e){return t*Math.exp(e)}}function O(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function F(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function T(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function N(t,e,n,r){var i=n(t[0]),a=n(M(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function j(t,e,n,r,i){var a=r(t[0]),o=r(M(t)),u=null!=e?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function R(t){return null!=t?a(t)?t:[t]:[]}function P(t){return"function"===typeof t}var z=Object.prototype.hasOwnProperty;function B(t,e){return z.call(t,e)}var L={};function q(t){return"[object Date]"===Object.prototype.toString.call(t)}function I(t){return"number"===typeof t}var U=1e4;function W(t,e){for(var n="";--e>=0;)n+=t;return n}function H(t){return I(t)?t:q(t)?t:Date.parse(t)}t.Debug=w,t.Error=b,t.Info=_,t.None=y,t.Warn=x,t.accessor=e,t.accessorFields=n,t.accessorName=function(t){return null==t?null:t.fname},t.array=R,t.clampRange=function(t,e,n){var r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},t.compare=function(t,r){var a,o,u,l,c,f,h,d,p,v=[],g=(t=R(t)).map(function(t,e){return null==t?null:(v.push(e),P(t)?t:i(t).map(s).join("]["))}),m=v.length-1,y=R(r),b="var u,v;return ";if(m<0)return null;for(o=0;o<=m;++o)P(u=g[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,d=-1):(p=-1,d=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(a<m?":":":0");return u=Function("a","b",b+";"),h&&(u=u.bind(h)),t=t.reduce(function(t,e){return P(e)?(n(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(u,Object.keys(t))},t.constant=function(t){return P(t)?t:function(){return t}},t.debounce=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},t.error=r,t.extend=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},t.extent=function(t,e){var n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)null!=(r=t[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)null!=(r=e(t[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},t.extentIndex=function(t,e){var n,r,i,a,o,u=-1,s=t.length;if(null==e){for(;++u<s;)if(null!=(r=t[u])&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=t[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=e(t[u],u,t))&&r>=r){n=i=r;break}if(u===s)return[-1,-1];for(a=o=u;++u<s;)null!=(r=e(t[u],u,t))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},t.falsy=g,t.fastmap=function(t){var e,n,r={};function i(t){return B(r,t)&&r[t]!==L}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===L&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=L),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,a={},o=0;for(t in r)(i=r[t])===L||n&&n(i)||(a[t]=i,++o);e.size=o,e.empty=0,e.object=r=a}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},t.field=l,t.flush=function(t,e,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=t[0],l=M(t),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(e-s))<(u=Math.abs(l-e))&&o<=c?r:u<=c?i:a},t.hasOwnProperty=B,t.id=f,t.identity=h,t.inherits=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},t.inrange=function(t,e,n,r){var i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},t.isArray=a,t.isBoolean=function(t){return"boolean"===typeof t},t.isDate=q,t.isFunction=P,t.isNumber=I,t.isObject=o,t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.isString=u,t.key=function(t,n){return t&&(t=n?R(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):R(t)),e(t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?s(t):i(t).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},t,"key")},t.lerp=function(t,e){var n=t[0],r=M(t),i=+e;return i?1===i?r:n+i*(r-n):n},t.logger=function(t,e){var n=t||y;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=b&&m(e||"error","ERROR",arguments),this},warn:function(){return n>=x&&m(e||"warn","WARN",arguments),this},info:function(){return n>=_&&m(e||"log","INFO",arguments),this},debug:function(){return n>=w&&m(e||"log","DEBUG",arguments),this}}},t.lruCache=function(t){var e,n,r;t=+t||U;var i=function(){e={},n={},r=0},a=function(i,a){return++r>t&&(n=e,e={},r=1),e[i]=a};return i(),{clear:i,has:function(t){return B(e,t)||B(n,t)},get:function(t){return B(e,t)?e[t]:B(n,t)?a(t,n[t]):void 0},set:function(t,n){return B(e,t)?e[t]=n:a(t,n)}}},t.merge=function(t,e,n,r){var i=e.length,a=n.length;if(!a)return e;if(!i)return n;for(var o=r||new e.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o},t.mergeConfig=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=E(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(t,n,e[n],r)}return t},{})},t.one=p,t.pad=function(t,e,n,r){var i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?W(i,o)+a:"center"===r?W(i,~~(o/2))+a+W(i,Math.ceil(o/2)):a+W(i,o)},t.panLinear=function(t,e){return N(t,e,S,h)},t.panLog=function(t,e){var n=Math.sign(t[0]);return N(t,e,O(n),C(n))},t.panPow=function(t,e,n){return N(t,e,T(n),T(1/n))},t.panSymlog=function(t,e,n){return N(t,e,D(n),F(n))},t.peek=M,t.quarter=function(t){return 1+~~(new Date(t).getMonth()/3)},t.repeat=W,t.span=function(t){return t&&M(t)-t[0]||0},t.splitAccessPath=i,t.stringValue=s,t.toBoolean=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},t.toDate=function(t,e){return e=e||H,null==t||""===t?null:e(t)},t.toNumber=S,t.toSet=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},t.toString=function(t){return null==t||""===t?null:t+""},t.truncate=function(t,e,n,r){var i=null!=r?r:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},t.truthy=v,t.utcquarter=function(t){return 1+~~(new Date(t).getUTCMonth()/3)},t.visitArray=function(t,e,n){if(t){var r,i=0,a=t.length;if(e)for(;i<a;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}},t.writeConfig=A,t.zero=d,t.zoomLinear=function(t,e,n){return j(t,e,n,S,h)},t.zoomLog=function(t,e,n){var r=Math.sign(t[0]);return j(t,e,n,O(r),C(r))},t.zoomPow=function(t,e,n,r){return j(t,e,n,T(r),T(1/r))},t.zoomSymlog=function(t,e,n,r){return j(t,e,n,D(r),F(r))},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2148:function(t,e,n){!function(t){"use strict";var e,n,r="view",i="[",a="]",o="{",u="}",s=":",l=",",c="@",f=">",h=/[[\]{}]/,d={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function p(t,e,n,r,i){for(var a,o=0,u=t.length;e<u;++e){if(a=t[e],!o&&a===n)return e;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return e}function v(t){for(var e=[],n=0,r=t.length,s=0;s<r;)s=p(t,s,l,i+o,a+u),e.push(t.substring(n,s).trim()),n=++s;if(0===e.length)throw"Empty event selector: "+t;return e}function g(t){return"["===t[0]?function(t){var e,n,r=t.length,o=1;if((o=p(t,o,a,i,a))===r)throw"Empty between selector: "+t;if(2!==(e=v(t.substring(1,o))).length)throw"Between selector must have two elements: "+t;if((t=t.slice(o+1).trim())[0]!==f)throw"Expected '>' after between selector: "+t;return e=e.map(g),(n=g(t.slice(1).trim())).between?{between:e,stream:n}:(n.between=e,n)}(t):function(t){var r,f,d,v={source:e},g=[],m=[0,0],y=0,b=0,x=t.length,_=0;if(t[x-1]===u){if(!((_=t.lastIndexOf(o))>=0))throw"Unmatched right brace: "+t;try{m=function(t){var e=t.split(l);if(!t.length||e.length>2)throw t;return e.map(function(e){var n=+e;if(n!==n)throw t;return n})}(t.substring(_+1,x-1))}catch(w){throw"Invalid throttle specification: "+t}t=t.slice(0,_).trim(),x=t.length,_=0}if(!x)throw t;if(t[0]===c&&(y=++_),(r=p(t,_,s))<x&&(g.push(t.substring(b,r).trim()),b=_=++r),(_=p(t,_,i))===x)g.push(t.substring(b,x).trim());else if(g.push(t.substring(b,_).trim()),f=[],(b=++_)===x)throw"Unmatched left bracket: "+t;for(;_<x;){if((_=p(t,_,a))===x)throw"Unmatched left bracket: "+t;if(f.push(t.substring(b,_).trim()),_<x-1&&t[++_]!==i)throw"Expected left bracket: "+t;b=++_}if(!(x=g.length)||h.test(g[x-1]))throw"Invalid event selector: "+t;return x>1?(v.type=g[1],y?v.markname=g[0].slice(1):(d=g[0],n[d]?v.marktype=g[0]:v.source=g[0])):v.type=g[0],"!"===v.type.slice(-1)&&(v.consume=!0,v.type=v.type.slice(0,-1)),null!=f&&(v.filter=f),m[0]&&(v.throttle=m[0]),m[1]&&(v.debounce=m[1]),v}(t)}t.selector=function(t,i,a){return e=i||r,n=a||d,v(t.trim()).map(g)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},2149:function(t,e,n){(function(t){var r=n(2150),i=n(405),a=n(64),o=n(56),u=n(217),s=n(65),l=n(96),c=n(2151),f=n(15),h=n(16),d=n(215),p=n(212),v=n(19);!function(e){"use strict";var n=v.mark(st),g="4.7.0";function m(t,e,n){return t.fields=e||[],t.fname=n,t}function y(t){throw Error(t)}function b(t){var e,n,r,i=[],a=null,o=0,u=t.length,s="";function l(){i.push(s+t.substring(e,n)),s="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))s+=t.substring(e,n),s+=t.substring(++n,++n),e=n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r?(e=n+1,a=r):e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&l(),o=e=n+1):"]"===r&&(o||y("Access path missing open bracket: "+t),o>0&&l(),o=0,e=n+1):n>e?l():e=n+1}return o&&y("Access path missing closing bracket: "+t),a&&y("Access path missing closing quote: "+t),n>e&&(n++,l()),i}var x=Array.isArray;function _(t){return t===Object(t)}function w(t){return"string"===typeof t}function k(t){return x(t)?"["+t.map(k)+"]":_(t)||w(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var A=[],E=(function(t,e){var n=b(t),r="return _["+n.map(k).join("][")+"];";m(Function("_",r),[t=1===n.length?n[0]:t],e||t)}("id"),m(function(t){return t},A,"identity"));function M(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}m(function(){return 0},A,"zero"),m(function(){return 1},A,"one"),m(function(){return!0},A,"true"),m(function(){return!1},A,"false");var S=0,C=1,O=2,D=3,F=4;function T(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){for(var n in e)if("signals"===n)t.signals=j(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;N(t,n,e[n],r)}return t},{})}function N(t,e,n,r){var i,a;if(_(n)&&!x(n))for(i in a=_(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?N(a,i,n[i]):a[i]=n[i];else t[e]=n}function j(t,e){if(null==t)return e;var n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function R(t){return null!=t?x(t)?t:[t]:[]}var P=Object.prototype.hasOwnProperty;function z(t,e){return P.call(t,e)}function B(t){return"boolean"===typeof t}function L(t){return"number"===typeof t}function q(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e}function I(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}var U="log",W="continuous";function H(t,e,n){return t.fields=e||[],t.fname=n,t}function V(t){throw Error(t)}var G=Array.isArray;function $(t){return G(t)?"["+t.map($)+"]":(e=t)===Object(e)||function(t){return"string"===typeof t}(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t;var e}var Y=[];(function(t,e){var n=function(t){var e,n,r,i=[],a=null,o=0,u=t.length,s="";function l(){i.push(s+t.substring(e,n)),s="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))s+=t.substring(e,n),s+=t.substring(++n,++n),e=n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r?(e=n+1,a=r):e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&l(),o=e=n+1):"]"===r&&(o||V("Access path missing open bracket: "+t),o>0&&l(),o=0,e=n+1):n>e?l():e=n+1}return o&&V("Access path missing closing bracket: "+t),a&&V("Access path missing closing quote: "+t),n>e&&(n++,l()),i}(t),r="return _["+n.map($).join("][")+"];";H(Function("_",r),[t=1===n.length?n[0]:t],e||t)})("id"),H(function(t){return t},Y,"identity"),H(function(){return 0},Y,"zero"),H(function(){return 1},Y,"one"),H(function(){return!0},Y,"true"),H(function(){return!1},Y,"false");var X=Object.prototype.hasOwnProperty;function J(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Q(t){var e;return 1===t.length&&(e=t,t=function(t,n){return J(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}}var Z=Q(J).right,K=Math.sqrt(50),tt=Math.sqrt(10),et=Math.sqrt(2);function nt(t,e,n){var r,i,a,o,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=rt(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a}function rt(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=K?10:a>=tt?5:a>=et?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=K?10:a>=tt?5:a>=et?2:1)}function it(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=K?i*=10:a>=tt?i*=5:a>=et&&(i*=2),e<t?-i:i}function at(t,e){var n;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n<s||void 0===n&&s>=s)&&(n=s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;null!=(v=e(v,++l,t))&&(n<v||void 0===n&&v>=v)&&(n=v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n}function ot(t,e){var n;if(void 0===e){var r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n>s||void 0===n&&s>=s)&&(n=s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,h=void 0;try{for(var d,p=t[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;null!=(v=e(v,++l,t))&&(n>v||void 0===n&&v>=v)&&(n=v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return n}function ut(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function st(t,e){var r,i,a,o,u,s,l,c,f,h,d,p,g;return v.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e){n.next=30;break}r=!0,i=!1,a=void 0,n.prev=4,o=t[Symbol.iterator]();case 6:if(r=(u=o.next()).done){n.next=14;break}if(!(null!=(s=u.value)&&(s=+s)>=s)){n.next=11;break}return n.next=11,s;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),i=!0,a=n.t0;case 20:n.prev=20,n.prev=21,r||null==o.return||o.return();case 23:if(n.prev=23,!i){n.next=26;break}throw a;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:l=-1,c=!0,f=!1,h=void 0,n.prev=34,d=t[Symbol.iterator]();case 36:if(c=(p=d.next()).done){n.next=44;break}if(g=p.value,!(null!=(g=e(g,++l,t))&&(g=+g)>=g)){n.next=41;break}return n.next=41,g;case 41:c=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),f=!0,h=n.t1;case 50:n.prev=50,n.prev=51,c||null==d.return||d.return();case 53:if(n.prev=53,!f){n.next=56;break}throw h;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function lt(t,e,n){if(r=(t=Float64Array.from(st(t,n))).length){if((e=+e)<=0||r<2)return ot(t);if(e>=1)return at(t);var r,i=(r-1)*e,a=Math.floor(i),o=at(function t(e,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:J;i>r;){if(i-r>600){var o=i-r+1,u=n-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(o-l)/o)*(u-o/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-u*l/o+c)),Math.min(i,Math.floor(n+(o-u)*l/o+c)),a)}var f=e[n],h=r,d=i;for(ut(e,r,n),a(e[i],f)>0&&ut(e,r,i);h<d;){for(ut(e,h,d),++h,--d;a(e[h],f)<0;)++h;for(;a(e[d],f)>0;)--d}0===a(e[r],f)?ut(e,r,d):ut(e,++d,i),d<=n&&(r=d+1),n<=d&&(i=d-1)}return e}(t,a).subarray(0,a+1));return o+(ot(t.subarray(a+1))-o)*(i-a)}}function ct(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ft(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}var ht=Symbol("implicit");function dt(){var t=new Map,e=[],n=[],r=ht;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==ht)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;var r=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=u.value,c=l+"";t.has(c)||t.set(c,e.push(l))}}catch(f){a=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return dt(e,n).unknown(r)},ct.apply(i,arguments),i}function pt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function vt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function gt(){}var mt="\\s*([+-]?\\d+)\\s*",yt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",bt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xt=/^#([0-9a-f]{3,8})$/,_t=new RegExp("^rgb\\("+[mt,mt,mt]+"\\)$"),wt=new RegExp("^rgb\\("+[bt,bt,bt]+"\\)$"),kt=new RegExp("^rgba\\("+[mt,mt,mt,yt]+"\\)$"),At=new RegExp("^rgba\\("+[bt,bt,bt,yt]+"\\)$"),Et=new RegExp("^hsl\\("+[yt,bt,bt]+"\\)$"),Mt=new RegExp("^hsla\\("+[yt,bt,bt,yt]+"\\)$"),St={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ct(){return this.rgb().formatHex()}function Ot(){return this.rgb().formatRgb()}function Dt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=xt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ft(e):3===n?new Rt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new Rt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new Rt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=_t.exec(t))?new Rt(e[1],e[2],e[3],1):(e=wt.exec(t))?new Rt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=kt.exec(t))?Tt(e[1],e[2],e[3],e[4]):(e=At.exec(t))?Tt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Et.exec(t))?Lt(e[1],e[2]/100,e[3]/100,1):(e=Mt.exec(t))?Lt(e[1],e[2]/100,e[3]/100,e[4]):St.hasOwnProperty(t)?Ft(St[t]):"transparent"===t?new Rt(NaN,NaN,NaN,0):null}function Ft(t){return new Rt(t>>16&255,t>>8&255,255&t,1)}function Tt(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rt(t,e,n,r)}function Nt(t){return t instanceof gt||(t=Dt(t)),t?new Rt((t=t.rgb()).r,t.g,t.b,t.opacity):new Rt}function jt(t,e,n,r){return 1===arguments.length?Nt(t):new Rt(t,e,n,null==r?1:r)}function Rt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Pt(){return"#"+Bt(this.r)+Bt(this.g)+Bt(this.b)}function zt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Bt(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Lt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ut(t,e,n,r)}function qt(t){if(t instanceof Ut)return new Ut(t.h,t.s,t.l,t.opacity);if(t instanceof gt||(t=Dt(t)),!t)return new Ut;if(t instanceof Ut)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,s=(a+i)/2;return u?(o=e===a?(n-r)/u+6*(n<r):n===a?(r-e)/u+2:(e-n)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new Ut(o,u,s,t.opacity)}function It(t,e,n,r){return 1===arguments.length?qt(t):new Ut(t,e,n,null==r?1:r)}function Ut(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Wt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}pt(gt,Dt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ct,formatHex:Ct,formatHsl:function(){return qt(this).formatHsl()},formatRgb:Ot,toString:Ot}),pt(Rt,jt,vt(gt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pt,formatHex:Pt,formatRgb:zt,toString:zt})),pt(Ut,It,vt(gt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ut(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ut(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Rt(Wt(t>=240?t-240:t+120,i,r),Wt(t,i,r),Wt(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ht=Math.PI/180,Vt=180/Math.PI,Gt=.96422,$t=1,Yt=.82521,Xt=4/29,Jt=6/29,Qt=3*Jt*Jt,Zt=Jt*Jt*Jt;function Kt(t){if(t instanceof ee)return new ee(t.l,t.a,t.b,t.opacity);if(t instanceof ue)return se(t);t instanceof Rt||(t=Nt(t));var e,n,r=ae(t.r),i=ae(t.g),a=ae(t.b),o=ne((.2225045*r+.7168786*i+.0606169*a)/$t);return r===i&&i===a?e=n=o:(e=ne((.4360747*r+.3850649*i+.1430804*a)/Gt),n=ne((.0139322*r+.0971045*i+.7141733*a)/Yt)),new ee(116*o-16,500*(e-o),200*(o-n),t.opacity)}function te(t,e,n,r){return 1===arguments.length?Kt(t):new ee(t,e,n,null==r?1:r)}function ee(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function ne(t){return t>Zt?Math.pow(t,1/3):t/Qt+Xt}function re(t){return t>Jt?t*t*t:Qt*(t-Xt)}function ie(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ae(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oe(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ue)return new ue(t.h,t.c,t.l,t.opacity);if(t instanceof ee||(t=Kt(t)),0===t.a&&0===t.b)return new ue(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Vt;return new ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new ue(t,e,n,null==r?1:r)}function ue(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function se(t){if(isNaN(t.h))return new ee(t.l,0,0,t.opacity);var e=t.h*Ht;return new ee(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}pt(ee,te,vt(gt,{brighter:function(t){return new ee(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ee(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Rt(ie(3.1338561*(e=Gt*re(e))-1.6168667*(t=$t*re(t))-.4906146*(n=Yt*re(n))),ie(-.9787684*e+1.9161415*t+.033454*n),ie(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),pt(ue,oe,vt(gt,{brighter:function(t){return new ue(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ue(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return se(this).rgb()}}));var le=-.14861,ce=1.78277,fe=-.29227,he=-.90649,de=1.97294,pe=de*he,ve=de*ce,ge=ce*fe-he*le;function me(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ye)return new ye(t.h,t.s,t.l,t.opacity);t instanceof Rt||(t=Nt(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(ge*r+pe*e-ve*n)/(ge+pe-ve),a=r-i,o=(de*(n-i)-fe*a)/he,u=Math.sqrt(o*o+a*a)/(de*i*(1-i)),s=u?Math.atan2(o,a)*Vt-120:NaN;return new ye(s<0?s+360:s,u,i,t.opacity)}(t):new ye(t,e,n,null==r?1:r)}function ye(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function be(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function xe(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,u=r<e-1?t[r+2]:2*a-i;return be((n-r/e)*e,o,i,a,u)}}function _e(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],u=t[(r+2)%e];return be((n-r/e)*e,i,a,o,u)}}function we(t){return function(){return t}}function ke(t,e){return function(n){return t+n*e}}function Ae(t,e){var n=e-t;return n?ke(t,n>180||n<-180?n-360*Math.round(n/360):n):we(isNaN(t)?e:t)}function Ee(t){return 1===(t=+t)?Me:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):we(isNaN(e)?n:e)}}function Me(t,e){var n=e-t;return n?ke(t,n):we(isNaN(t)?e:t)}pt(ye,me,vt(gt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ye(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ye(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ht,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Rt(255*(e+n*(le*r+ce*i)),255*(e+n*(fe*r+he*i)),255*(e+n*(de*r)),this.opacity)}}));var Se=function t(e){var n=Ee(e);function r(t,e){var r=n((t=jt(t)).r,(e=jt(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Me(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Ce(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),u=new Array(i);for(n=0;n<i;++n)r=jt(e[n]),a[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return a=t(a),o=t(o),u=t(u),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=u(t),r+""}}}var Oe=Ce(xe),De=Ce(_e);function Fe(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Te(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ne(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=qe(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function je(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Re(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Pe(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=qe(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var ze=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Be=new RegExp(ze.source,"g");function Le(t,e){var n,r,i,a=ze.lastIndex=Be.lastIndex=0,o=-1,u=[],s=[];for(t+="",e+="";(n=ze.exec(t))&&(r=Be.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),u[o]?u[o]+=i:u[++o]=i),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:Re(n,r)})),a=Be.lastIndex;return a<e.length&&(i=e.slice(a),u[o]?u[o]+=i:u[++o]=i),u.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)u[(n=s[r]).i]=n.x(t);return u.join("")})}function qe(t,e){var n,r=typeof e;return null==e||"boolean"===r?we(e):("number"===r?Re:"string"===r?(n=Dt(e))?(e=n,Se):Le:e instanceof Dt?Se:e instanceof Date?je:Te(e)?Fe:Array.isArray(e)?Ne:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Pe:Re)(t,e)}function Ie(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ue,We,He,Ve,Ge=180/Math.PI,$e={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ye(t,e,n,r,i,a){var o,u,s;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Ge,skewX:Math.atan(s)*Ge,scaleX:o,scaleY:u}}function Xe(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var u=[],s=[];return a=t(a),o=t(o),function(t,r,i,a,o,u){if(t!==i||r!==a){var s=o.push("translate(",null,e,null,n);u.push({i:s-4,x:Re(t,i)},{i:s-2,x:Re(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,u,s),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Re(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,u,s),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Re(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,u,s),function(t,e,n,r,a,o){if(t!==n||e!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:Re(t,n)},{i:u-2,x:Re(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,u,s),a=o=null,function(t){for(var e,n=-1,r=s.length;++n<r;)u[(e=s[n]).i]=e.x(t);return u.join("")}}}var Je=Xe(function(t){return"none"===t?$e:(Ue||(Ue=document.createElement("DIV"),We=document.documentElement,He=document.defaultView),Ue.style.transform=t,t=He.getComputedStyle(We.appendChild(Ue),null).getPropertyValue("transform"),We.removeChild(Ue),Ye(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),Qe=Xe(function(t){return null==t?$e:(Ve||(Ve=document.createElementNS("http://www.w3.org/2000/svg","g")),Ve.setAttribute("transform",t),(t=Ve.transform.baseVal.consolidate())?Ye((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):$e)},", ",")",")"),Ze=Math.SQRT2,Ke=2,tn=4,en=1e-12;function nn(t){return((t=Math.exp(t))+1/t)/2}function rn(t){return function(e,n){var r=t((e=It(e)).h,(n=It(n)).h),i=Me(e.s,n.s),a=Me(e.l,n.l),o=Me(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var an=rn(Ae),on=rn(Me);function un(t){return function(e,n){var r=t((e=oe(e)).h,(n=oe(n)).h),i=Me(e.c,n.c),a=Me(e.l,n.l),o=Me(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var sn=un(Ae),ln=un(Me);function cn(t){return function e(n){function r(e,r){var i=t((e=me(e)).h,(r=me(r)).h),a=Me(e.s,r.s),o=Me(e.l,r.l),u=Me(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=u(t),e+""}}return n=+n,r.gamma=e,r}(1)}var fn=cn(Ae),hn=cn(Me);function dn(t,e){for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}var pn=Object.freeze({__proto__:null,interpolate:qe,interpolateArray:function(t,e){return(Te(e)?Fe:Ne)(t,e)},interpolateBasis:xe,interpolateBasisClosed:_e,interpolateDate:je,interpolateDiscrete:function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},interpolateHue:function(t,e){var n=Ae(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},interpolateNumber:Re,interpolateNumberArray:Fe,interpolateObject:Pe,interpolateRound:Ie,interpolateString:Le,interpolateTransformCss:Je,interpolateTransformSvg:Qe,interpolateZoom:function(t,e){var n,r,i=t[0],a=t[1],o=t[2],u=e[0],s=e[1],l=e[2],c=u-i,f=s-a,h=c*c+f*f;if(h<en)r=Math.log(l/o)/Ze,n=function(t){return[i+t*c,a+t*f,o*Math.exp(Ze*t*r)]};else{var d=Math.sqrt(h),p=(l*l-o*o+tn*h)/(2*o*Ke*d),v=(l*l-o*o-tn*h)/(2*l*Ke*d),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);r=(m-g)/Ze,n=function(t){var e,n=t*r,u=nn(g),s=o/(Ke*d)*(u*(e=Ze*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+s*c,a+s*f,o*u/nn(Ze*n+g)]}}return n.duration=1e3*r,n},interpolateRgb:Se,interpolateRgbBasis:Oe,interpolateRgbBasisClosed:De,interpolateHsl:an,interpolateHslLong:on,interpolateLab:function(t,e){var n=Me((t=te(t)).l,(e=te(e)).l),r=Me(t.a,e.a),i=Me(t.b,e.b),a=Me(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}},interpolateHcl:sn,interpolateHclLong:ln,interpolateCubehelix:fn,interpolateCubehelixLong:hn,piecewise:dn,quantize:function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}});function vn(t){return+t}var gn=[0,1];function mn(t){return t}function yn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function bn(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=yn(i,r),a=n(o,a)):(r=yn(r,i),a=n(a,o)),function(t){return a(r(t))}}function xn(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=yn(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Z(t,e,1,r)-1;return a[n](i[n](e))}}function _n(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function wn(){var t,e,n,r,i,a,o=gn,u=gn,s=qe,l=mn;function c(){var t=Math.min(o.length,u.length);return l!==mn&&(l=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?xn:bn,i=a=null,f}function f(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),u,s)))(t(l(e)))}return f.invert=function(n){return l(e((a||(a=r(u,o.map(t),Re)))(n)))},f.domain=function(t){return arguments.length?(o=Array.from(t,vn),c()):o.slice()},f.range=function(t){return arguments.length?(u=Array.from(t),c()):u.slice()},f.rangeRound=function(t){return u=Array.from(t),s=Ie,c()},f.clamp=function(t){return arguments.length?(l=!!t||mn,c()):l!==mn},f.interpolate=function(t){return arguments.length?(s=t,c()):s},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}function kn(){return wn()(mn,mn)}function An(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function En(t){return(t=An(Math.abs(t)))?t[1]:NaN}var Mn,Sn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cn(t){if(!(e=Sn.exec(t)))throw new Error("invalid format: "+t);var e;return new On({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function On(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Dn(t,e){var n=An(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Cn.prototype=On.prototype,On.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Fn={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Dn(100*t,e)},r:Dn,s:function(t,e){var n=An(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Mn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+An(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Tn(t){return t}var Nn,jn,Rn,Pn=Array.prototype.map,zn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Bn(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Tn:(e=Pn.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,u=e[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(t.substring(i-=u,i+u)),!((s+=u+1)>r));)u=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Tn:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Pn.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=Cn(t)).fill,n=t.align,f=t.sign,h=t.symbol,d=t.zero,p=t.width,v=t.comma,g=t.precision,m=t.trim,y=t.type;"n"===y?(v=!0,y="g"):Fn[y]||(void 0===g&&(g=12),m=!0,y="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===h?a:/[%p]/.test(y)?s:"",_=Fn[y],w=/[defgprs%]/.test(y);function k(t){var i,a,s,h=b,k=x;if("c"===y)k=_(t)+k,t="";else{var A=(t=+t)<0;if(t=isNaN(t)?c:_(Math.abs(t),g),m&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&(A=!1),h=(A?"("===f?f:l:"-"===f||"("===f?"":f)+h,k=("s"===y?zn[8+Mn/3]:"")+k+(A&&"("===f?")":""),w)for(i=-1,a=t.length;++i<a;)if(48>(s=t.charCodeAt(i))||s>57){k=(46===s?o+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}v&&!d&&(t=r(t,1/0));var E=h.length+t.length+k.length,M=E<p?new Array(p-E+1).join(e):"";switch(v&&d&&(t=r(M+t,M.length?p-k.length:1/0),M=""),n){case"<":t=h+t+k+M;break;case"=":t=h+M+t+k;break;case"^":t=M.slice(0,E=M.length>>1)+h+t+k+M.slice(E);break;default:t=M+h+t+k}return u(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:f,formatPrefix:function(t,e){var n=f(((t=Cn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(En(e)/3))),i=Math.pow(10,-r),a=zn[8+r/3];return function(t){return n(i*t)+a}}}}function Ln(t,e,n,r){var i,a=it(t,e,n);switch((r=Cn(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(En(e)/3)))-En(Math.abs(t)))}(a,o))||(r.precision=i),Rn(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,En(e)-En(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-En(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return jn(r)}function qn(t){var e=t.domain;return t.ticks=function(t){var n=e();return nt(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Ln(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,u=i[a],s=i[o];return s<u&&(r=u,u=s,s=r,r=a,a=o,o=r),(r=rt(u,s,n))>0?r=rt(u=Math.floor(u/r)*r,s=Math.ceil(s/r)*r,n):r<0&&(r=rt(u=Math.ceil(u*r)/r,s=Math.floor(s*r)/r,n)),r>0?(i[a]=Math.floor(u/r)*r,i[o]=Math.ceil(s/r)*r,e(i)):r<0&&(i[a]=Math.ceil(u*r)/r,i[o]=Math.floor(s*r)/r,e(i)),t},t}function In(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function Un(t){return Math.log(t)}function Wn(t){return Math.exp(t)}function Hn(t){return-Math.log(-t)}function Vn(t){return-Math.exp(-t)}function Gn(t){return isFinite(t)?+("1e"+t):t<0?0:t}function $n(t){return function(e){return-t(-e)}}function Yn(t){var e,n,r=t(Un,Wn),i=r.domain,a=10;function o(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(a),n=function(t){return 10===t?Gn:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(a),i()[0]<0?(e=$n(e),n=$n(n),t(Hn,Vn)):t(Un,Wn),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),u=o[0],s=o[o.length-1];(r=s<u)&&(h=u,u=s,s=h);var l,c,f,h=e(u),d=e(s),p=null==t?10:+t,v=[];if(!(a%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(c=1,l=n(h);c<a;++c)if(!((f=l*c)<u)){if(f>s)break;v.push(f)}}else for(;h<=d;++h)for(c=a-1,l=n(h);c>=1;--c)if(!((f=l*c)<u)){if(f>s)break;v.push(f)}2*v.length<p&&(v=nt(u,s,p))}else v=nt(h,d,Math.min(d-h,p)).map(n);return r?v.reverse():v},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!==typeof i&&(i=jn(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(In(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function Xn(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Jn(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Qn(t){var e=1,n=t(Xn(e),Jn(e));return n.constant=function(n){return arguments.length?t(Xn(e=+n),Jn(e)):e},qn(n)}function Zn(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Kn(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function tr(t){return t<0?-t*t:t*t}function er(t){var e=t(mn,mn),n=1;function r(){return 1===n?t(mn,mn):.5===n?t(Kn,tr):t(Zn(n),Zn(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},qn(e)}function nr(){var t=er(wn());return t.copy=function(){return _n(t,nr()).exponent(t.exponent())},ct.apply(t,arguments),t}Nn=Bn({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),jn=Nn.format,Rn=Nn.formatPrefix;var rr=new Date,ir=new Date;function ar(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,u=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return u;do{u.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return u},i.filter=function(n){return ar(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return rr.setTime(+e),ir.setTime(+r),t(rr),t(ir),Math.floor(n(rr,ir))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var or=ar(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});or.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?ar(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):or:null};var ur=6e4,sr=6048e5,lr=ar(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),cr=ar(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,e){t.setTime(+t+e*ur)},function(t,e){return(e-t)/ur},function(t){return t.getMinutes()}),fr=ar(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-t.getMinutes()*ur)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),hr=ar(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ur)/864e5},function(t){return t.getDate()-1});function dr(t){return ar(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ur)/sr})}var pr=dr(0),vr=dr(1),gr=(dr(2),dr(3),dr(4)),mr=(dr(5),dr(6),ar(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),yr=ar(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});yr.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ar(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var br=ar(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*ur)},function(t,e){return(e-t)/ur},function(t){return t.getUTCMinutes()}),xr=ar(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),_r=ar(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});function wr(t){return ar(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/sr})}var kr=wr(0),Ar=wr(1),Er=(wr(2),wr(3),wr(4)),Mr=(wr(5),wr(6),ar(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),Sr=ar(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});function Cr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Or(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Dr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}Sr.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ar(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Fr,Tr,Nr,jr={"-":"",_:" ",0:"0"},Rr=/^\s*\d+/,Pr=/^%/,zr=/[\\^$*+?|[\]().{}]/g;function Br(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Lr(t){return t.replace(zr,"\\$&")}function qr(t){return new RegExp("^(?:"+t.map(Lr).join("|")+")","i")}function Ir(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Ur(t,e,n){var r=Rr.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Wr(t,e,n){var r=Rr.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Hr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Vr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Gr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function $r(t,e,n){var r=Rr.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Yr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Xr(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Jr(t,e,n){var r=Rr.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Qr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Zr(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Kr(t,e,n){var r=Rr.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ti(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ei(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ni(t,e,n){var r=Rr.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ri(t,e,n){var r=Rr.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ii(t,e,n){var r=Rr.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ai(t,e,n){var r=Pr.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function oi(t,e,n){var r=Rr.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function ui(t,e,n){var r=Rr.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function si(t,e){return Br(t.getDate(),e,2)}function li(t,e){return Br(t.getHours(),e,2)}function ci(t,e){return Br(t.getHours()%12||12,e,2)}function fi(t,e){return Br(1+hr.count(yr(t),t),e,3)}function hi(t,e){return Br(t.getMilliseconds(),e,3)}function di(t,e){return hi(t,e)+"000"}function pi(t,e){return Br(t.getMonth()+1,e,2)}function vi(t,e){return Br(t.getMinutes(),e,2)}function gi(t,e){return Br(t.getSeconds(),e,2)}function mi(t){var e=t.getDay();return 0===e?7:e}function yi(t,e){return Br(pr.count(yr(t)-1,t),e,2)}function bi(t,e){var n=t.getDay();return t=n>=4||0===n?gr(t):gr.ceil(t),Br(gr.count(yr(t),t)+(4===yr(t).getDay()),e,2)}function xi(t){return t.getDay()}function _i(t,e){return Br(vr.count(yr(t)-1,t),e,2)}function wi(t,e){return Br(t.getFullYear()%100,e,2)}function ki(t,e){return Br(t.getFullYear()%1e4,e,4)}function Ai(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Br(e/60|0,"0",2)+Br(e%60,"0",2)}function Ei(t,e){return Br(t.getUTCDate(),e,2)}function Mi(t,e){return Br(t.getUTCHours(),e,2)}function Si(t,e){return Br(t.getUTCHours()%12||12,e,2)}function Ci(t,e){return Br(1+_r.count(Sr(t),t),e,3)}function Oi(t,e){return Br(t.getUTCMilliseconds(),e,3)}function Di(t,e){return Oi(t,e)+"000"}function Fi(t,e){return Br(t.getUTCMonth()+1,e,2)}function Ti(t,e){return Br(t.getUTCMinutes(),e,2)}function Ni(t,e){return Br(t.getUTCSeconds(),e,2)}function ji(t){var e=t.getUTCDay();return 0===e?7:e}function Ri(t,e){return Br(kr.count(Sr(t)-1,t),e,2)}function Pi(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Er(t):Er.ceil(t),Br(Er.count(Sr(t),t)+(4===Sr(t).getUTCDay()),e,2)}function zi(t){return t.getUTCDay()}function Bi(t,e){return Br(Ar.count(Sr(t)-1,t),e,2)}function Li(t,e){return Br(t.getUTCFullYear()%100,e,2)}function qi(t,e){return Br(t.getUTCFullYear()%1e4,e,4)}function Ii(){return"+0000"}function Ui(){return"%"}function Wi(t){return+t}function Hi(t){return Math.floor(+t/1e3)}!function(t){Fr=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,l=qr(i),c=Ir(i),f=qr(a),h=Ir(a),d=qr(o),p=Ir(o),v=qr(u),g=Ir(u),m=qr(s),y=Ir(s),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return s[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:si,e:si,f:di,H:li,I:ci,j:fi,L:hi,m:pi,M:vi,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Wi,s:Hi,S:gi,u:mi,U:yi,V:bi,w:xi,W:_i,x:null,X:null,y:wi,Y:ki,Z:Ai,"%":Ui},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return s[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:Ei,e:Ei,f:Di,H:Mi,I:Si,j:Ci,L:Oi,m:Fi,M:Ti,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Wi,s:Hi,S:Ni,u:ji,U:Ri,V:Pi,w:zi,W:Bi,x:null,X:null,y:Li,Y:qi,Z:Ii,"%":Ui},_={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:Zr,e:Zr,f:ii,H:ti,I:ti,j:Kr,L:ri,m:Qr,M:ei,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:Jr,Q:oi,s:ui,S:ni,u:Wr,U:Hr,V:Vr,w:Ur,W:Gr,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Yr,Y:$r,Z:Xr,"%":ai};function w(t,e){return function(n){var r,i,a,o=[],u=-1,s=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++u<l;)37===t.charCodeAt(u)&&(o.push(t.slice(s,u)),null!=(i=jr[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),s=u+1);return o.push(t.slice(s,u)),o.join("")}}function k(t,e){return function(n){var r,i,a=Dr(1900,void 0,1);if(A(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(!e||"Z"in a||(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=Or(Dr(a.y,0,1))).getUTCDay(),r=i>4||0===i?Ar.ceil(r):Ar(r),r=_r.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Cr(Dr(a.y,0,1))).getDay(),r=i>4||0===i?vr.ceil(r):vr(r),r=hr.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Or(Dr(a.y,0,1)).getUTCDay():Cr(Dr(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Or(a)):Cr(a)}}function A(t,e,n,r){for(var i,a,o=0,u=e.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=_[i in jr?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}(t),Tr=Fr.format,Fr.parse,Nr=Fr.utcFormat,Fr.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Vi=1e3,Gi=60*Vi,$i=60*Gi,Yi=24*$i,Xi=7*Yi,Ji=30*Yi,Qi=365*Yi;function Zi(t){return new Date(t)}function Ki(t){return t instanceof Date?+t:+new Date(+t)}function ta(t,e,n,r,i,a,o,u,s){var l=kn(),c=l.invert,f=l.domain,h=s(".%L"),d=s(":%S"),p=s("%I:%M"),v=s("%I %p"),g=s("%a %d"),m=s("%b %d"),y=s("%B"),b=s("%Y"),x=[[o,1,Vi],[o,5,5*Vi],[o,15,15*Vi],[o,30,30*Vi],[a,1,Gi],[a,5,5*Gi],[a,15,15*Gi],[a,30,30*Gi],[i,1,$i],[i,3,3*$i],[i,6,6*$i],[i,12,12*$i],[r,1,Yi],[r,2,2*Yi],[n,1,Xi],[e,1,Ji],[e,3,3*Ji],[t,1,Qi]];function _(u){return(o(u)<u?h:a(u)<u?d:i(u)<u?p:r(u)<u?v:e(u)<u?n(u)<u?g:m:t(u)<u?y:b)(u)}function w(e,n,r){if(null==e&&(e=10),"number"===typeof e){var i,a=Math.abs(r-n)/e,o=Q(function(t){return t[2]}).right(x,a);return o===x.length?(i=it(n/Qi,r/Qi,e),e=t):o?(i=(o=x[a/x[o-1][2]<x[o][2]/a?o-1:o])[1],e=o[0]):(i=Math.max(it(n,r,e),1),e=u),e.every(i)}return e}return l.invert=function(t){return new Date(c(t))},l.domain=function(t){return arguments.length?f(Array.from(t,Ki)):f().map(Zi)},l.ticks=function(t){var e,n=f(),r=n[0],i=n[n.length-1],a=i<r;return a&&(e=r,r=i,i=e),e=(e=w(t,r,i))?e.range(r,i+1):[],a?e.reverse():e},l.tickFormat=function(t,e){return null==e?_:s(e)},l.nice=function(t){var e=f();return(t=w(t,e[0],e[e.length-1]))?f(In(e,t)):l},l.copy=function(){return _n(l,ta(t,e,n,r,i,a,o,u,s))},l}function ea(){var t,e,n,r,i,a=0,o=1,u=mn,s=!1;function l(e){return isNaN(e=+e)?i:u(0===n?.5:(e=(r(e)-t)*n,s?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r,i;return arguments.length?(r=(n=p(e,2))[0],i=n[1],u=t(r,i),l):[u(0),u(1)]}}return l.domain=function(i){var u;return arguments.length?(u=p(i,2),a=u[0],o=u[1],t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),l):[a,o]},l.clamp=function(t){return arguments.length?(s=!!t,l):s},l.interpolator=function(t){return arguments.length?(u=t,l):u},l.range=c(qe),l.rangeRound=c(Ie),l.unknown=function(t){return arguments.length?(i=t,l):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),l}}function na(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ra(){var t=qn(ea()(mn));return t.copy=function(){return na(t,ra())},ft.apply(t,arguments)}function ia(){var t=er(ea());return t.copy=function(){return na(t,ia()).exponent(t.exponent())},ft.apply(t,arguments)}function aa(){var t,e,n,r,i,a,o,u=0,s=.5,l=1,c=1,f=mn,h=!1;function d(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(c*t<c*e?r:i),f(h?Math.max(0,Math.min(1,t)):t))}function v(t){return function(e){var n,r,i,a;return arguments.length?(r=(n=p(e,3))[0],i=n[1],a=n[2],f=dn(t,[r,i,a]),d):[f(0),f(.5),f(1)]}}return d.domain=function(o){var f;return arguments.length?(f=p(o,3),u=f[0],s=f[1],l=f[2],t=a(u=+u),e=a(s=+s),n=a(l=+l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,d):[u,s,l]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(f=t,d):f},d.range=v(qe),d.rangeRound=v(Ie),d.unknown=function(t){return arguments.length?(o=t,d):o},function(o){return a=o,t=o(u),e=o(s),n=o(l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,d}}function oa(){var t=er(aa());return t.copy=function(){return na(t,oa()).exponent(t.exponent())},ft.apply(t,arguments)}function ua(){var t,e,n=dt().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,u=0,s=0,l=.5;function c(){var n=r().length,c=a[1]<a[0],f=a[c-0],h=a[1-c],d=function(t,e,n){var r=t-e+2*n;return t?r>0?r:1:0}(n,u,s);t=(h-f)/(d||1),o&&(t=Math.floor(t)),f+=(h-f-t*(n-u))*l,e=t*(1-u),o&&(f=Math.round(f),e=Math.round(e));var p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(n).map(function(e){return f+t*e});return i(c?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],c()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,c()):o},n.padding=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),u=s,c()):u},n.paddingInner=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.paddingOuter=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.invertRange=function(t){if(null!=t[0]&&null!=t[1]){var n,o,u,s=+t[0],l=+t[1],c=a[1]<a[0],f=c?i().reverse():i(),h=f.length-1;if(s===s&&l===l&&(l<s&&(u=s,s=l,l=u),!(l<f[0]||s>a[1-c])))return n=Math.max(0,Z(f,s)-1),o=s===l?n:Z(f,l)-1,s-f[n]>e+1e-10&&++n,c&&(u=n,n=h-o,o=h-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(t){var e=n.invertRange([t,t]);return e?e[0]:e},n.copy=function(){return ua().domain(r()).range(a).round(o).paddingInner(u).paddingOuter(s).align(l)},c()}var sa=Array.prototype.map;function la(t){return sa.call(t,function(t){return+t})}var ca=Array.prototype.slice,fa={};function ha(t,e,n){var r,i=function(){var n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){var n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){var n,r,i,a,o=t.range(),u=e[0],s=e[1],l=-1;for(s<u&&(r=u,u=s,s=r),i=0,a=o.length;i<a;++i)o[i]>=u&&o[i]<=s&&(l<0&&(l=i),n=i);if(!(l<0))return u=t.invertExtent(o[l]),s=t.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=t,n};return i.metadata=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e}(null!=(r=n)?G(r)?r:[r]:[]),i}function da(t,e,n){return arguments.length>1?(fa[t]=ha(t,e,n),this):function(t){return function(t,e){return X.call(t,e)}(fa,t)}(t)?fa[t]:void 0}function pa(t,e,n){return dn(function(t,e){var n=pn[function(t){return"interpolate"+t.toLowerCase().split("-").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function va(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function ga(t,e){for(var n in t)ya(n,e(t[n]))}da("identity",function t(e){var n;function r(t){return isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,vn),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,vn):[0,1],qn(r)}),da("linear",function t(){var e=kn();return e.copy=function(){return _n(e,t())},ct.apply(e,arguments),qn(e)},W),da(U,function t(){var e=Yn(wn()).domain([1,10]);return e.copy=function(){return _n(e,t()).base(e.base())},ct.apply(e,arguments),e},[W,U]),da("pow",nr,W),da("sqrt",function(){return nr.apply(null,arguments).exponent(.5)},W),da("symlog",function t(){var e=Qn(wn());return e.copy=function(){return _n(e,t()).constant(e.constant())},ct.apply(e,arguments)},W),da("time",function(){return ct.apply(ta(yr,mr,pr,hr,fr,cr,lr,or,Tr).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[W,"temporal"]),da("utc",function(){return ct.apply(ta(Sr,Mr,kr,_r,xr,br,lr,or,Nr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[W,"temporal"]),da("sequential",ra,[W,"interpolating"]),da("".concat("sequential","-").concat("linear"),ra,[W,"interpolating"]),da("".concat("sequential","-").concat(U),function t(){var e=Yn(ea()).domain([1,10]);return e.copy=function(){return na(e,t()).base(e.base())},ft.apply(e,arguments)},[W,"interpolating",U]),da("".concat("sequential","-").concat("pow"),ia,[W,"interpolating"]),da("".concat("sequential","-").concat("sqrt"),function(){return ia.apply(null,arguments).exponent(.5)},[W,"interpolating"]),da("".concat("sequential","-").concat("symlog"),function t(){var e=Qn(ea());return e.copy=function(){return na(e,t()).constant(e.constant())},ft.apply(e,arguments)},[W,"interpolating"]),da("".concat("diverging","-").concat("linear"),function t(){var e=qn(aa()(mn));return e.copy=function(){return na(e,t())},ft.apply(e,arguments)},[W,"interpolating"]),da("".concat("diverging","-").concat(U),function t(){var e=Yn(aa()).domain([.1,1,10]);return e.copy=function(){return na(e,t()).base(e.base())},ft.apply(e,arguments)},[W,"interpolating",U]),da("".concat("diverging","-").concat("pow"),oa,[W,"interpolating"]),da("".concat("diverging","-").concat("sqrt"),function(){return oa.apply(null,arguments).exponent(.5)},[W,"interpolating"]),da("".concat("diverging","-").concat("symlog"),function t(){var e=Qn(aa());return e.copy=function(){return na(e,t()).constant(e.constant())},ft.apply(e,arguments)},[W,"interpolating"]),da("quantile",function t(){var e,n=[],r=[],i=[];function a(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=lt(n,t/e);return o}function o(t){return isNaN(t=+t)?e:r[Z(i,t)]}return o.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},o.domain=function(t){if(!arguments.length)return n.slice();n=[];var e=!0,r=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(e=(o=u.next()).done);e=!0){var s=o.value;null==s||isNaN(s=+s)||n.push(s)}}catch(l){r=!0,i=l}finally{try{e||null==u.return||u.return()}finally{if(r)throw i}}return n.sort(J),a()},o.range=function(t){return arguments.length?(r=Array.from(t),a()):r.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return t().domain(n).range(r).unknown(e)},ct.apply(o,arguments)},["discretizing","quantile"]),da("quantize",function t(){var e,n=0,r=1,i=1,a=[.5],o=[0,1];function u(t){return t<=t?o[Z(a,t,0,i)]:e}function s(){var t=-1;for(a=new Array(i);++t<i;)a[t]=((t+1)*r-(t-i)*n)/(i+1);return u}return u.domain=function(t){var e;return arguments.length?(e=p(t,2),n=e[0],r=e[1],n=+n,r=+r,s()):[n,r]},u.range=function(t){return arguments.length?(i=(o=Array.from(t)).length-1,s()):o.slice()},u.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:e>=i?[a[i-1],r]:[a[e-1],a[e]]},u.unknown=function(t){return arguments.length?(e=t,u):u},u.thresholds=function(){return a.slice()},u.copy=function(){return t().domain([n,r]).range(o).unknown(e)},ct.apply(qn(u),arguments)},"discretizing"),da("threshold",function t(){var e,n=[.5],r=[0,1],i=1;function a(t){return t<=t?r[Z(n,t,0,i)]:e}return a.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(r).unknown(e)},ct.apply(a,arguments)},"discretizing"),da("bin-ordinal",function t(){var e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(Z(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=la(t),r):e.slice()},r.range=function(t){return arguments.length?(n=ca.call(t),r):n.slice()},r.tickFormat=function(t,n){return Ln(e[0],function(t){return t[t.length-1]}(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},["discrete","discretizing"]),da("ordinal",dt,"discrete"),da("band",ua,"discrete"),da("point",function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(ua().paddingInner(1))},"discrete");var ma={};function ya(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(ma[t]=e,this):ma[t]}ga({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},va),ga({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},function(t){return pa(va(t))}),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var ba=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(e){var n=function(){function e(t,e){return null!=e&&t instanceof e}var n,r,i;try{n=Map}catch(s){n=function(){}}try{r=Set}catch(s){r=function(){}}try{i=Promise}catch(s){i=function(){}}function a(o,s,l,c,f){"object"===typeof s&&(l=s.depth,c=s.prototype,f=s.includeNonEnumerable,s=s.circular);var h=[],d=[],p="undefined"!=typeof t;return"undefined"==typeof s&&(s=!0),"undefined"==typeof l&&(l=1/0),function o(l,v){if(null===l)return null;if(0===v)return l;var g,m;if("object"!=typeof l)return l;if(e(l,n))g=new n;else if(e(l,r))g=new r;else if(e(l,i))g=new i(function(t,e){l.then(function(e){t(o(e,v-1))},function(t){e(o(t,v-1))})});else if(a.__isArray(l))g=[];else if(a.__isRegExp(l))g=new RegExp(l.source,u(l)),l.lastIndex&&(g.lastIndex=l.lastIndex);else if(a.__isDate(l))g=new Date(l.getTime());else{if(p&&t.isBuffer(l))return g=t.allocUnsafe?t.allocUnsafe(l.length):new t(l.length),l.copy(g),g;e(l,Error)?g=Object.create(l):"undefined"==typeof c?(m=Object.getPrototypeOf(l),g=Object.create(m)):(g=Object.create(c),m=c)}if(s){var y=h.indexOf(l);if(-1!=y)return d[y];h.push(l),d.push(g)}for(var b in e(l,n)&&l.forEach(function(t,e){var n=o(e,v-1),r=o(t,v-1);g.set(n,r)}),e(l,r)&&l.forEach(function(t){var e=o(t,v-1);g.add(e)}),l){var x;m&&(x=Object.getOwnPropertyDescriptor(m,b)),x&&null==x.set||(g[b]=o(l[b],v-1))}if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(l);for(b=0;b<_.length;b++){var w=_[b];(!(A=Object.getOwnPropertyDescriptor(l,w))||A.enumerable||f)&&(g[w]=o(l[w],v-1),A.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(f){var k=Object.getOwnPropertyNames(l);for(b=0;b<k.length;b++){var A,E=k[b];(A=Object.getOwnPropertyDescriptor(l,E))&&A.enumerable||(g[E]=o(l[E],v-1),Object.defineProperty(g,E,{enumerable:!1}))}}return g}(o,l)}function o(t){return Object.prototype.toString.call(t)}function u(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return a.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},a.__objToStr=o,a.__isDate=function(t){return"object"===typeof t&&"[object Date]"===o(t)},a.__isArray=function(t){return"object"===typeof t&&"[object Array]"===o(t)},a.__isRegExp=function(t){return"object"===typeof t&&"[object RegExp]"===o(t)},a.__getRegExpFlags=u,a}();e.exports&&(e.exports=n)}),xa=function(t,e){e||(e={}),"function"===typeof e&&(e={cmp:e});var n,r="boolean"===typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},a={key:r,value:t[r]};return n(i,a)}}),a=[];return function t(e){if(e&&e.toJSON&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var n,o;if(Array.isArray(e)){for(o="[",n=0;n<e.length;n++)n&&(o+=","),o+=t(e[n])||"null";return o+"]"}if(null===e)return"null";if(-1!==a.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=a.push(e)-1,s=Object.keys(e).sort(i&&i(e));for(o="",n=0;n<s.length;n++){var l=s[n],c=t(e[l]);c&&(o&&(o+=","),o+=JSON.stringify(l)+":"+c)}return a.splice(u,1),"{"+o+"}"}}(t)};function _a(t){return!!t.or}function wa(t){return!!t.and}function ka(t){return!!t.not}function Aa(t,e){return ka(t)?{not:Aa(t.not,e)}:wa(t)?{and:t.and.map(function(t){return Aa(t,e)})}:_a(t)?{or:t.or.map(function(t){return Aa(t,e)})}:e(t)}var Ea=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!==i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(a=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!==i--;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},Ma=ba;function Sa(t,e){var n={},r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;z(t,s)&&(n[s]=t[s])}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}function Ca(t,e){var n=Object.assign({},t),r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)delete n[o.value]}catch(s){i=!0,a=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}Set.prototype.toJSON=function(){return"Set(".concat(d(this).map(function(t){return xa(t)}).join(","),")")};var Oa=xa;function Da(t){if(L(t))return t;var e=w(t)?t:xa(t);if(e.length<250)return e;for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n&=n;return n}function Fa(t){return!1===t||null===t}function Ta(t,e){return t.indexOf(e)>-1}function Na(t,e){var n=0,r=!0,i=!1,a=void 0;try{for(var o,u=t.entries()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=p(s,2),c=l[0];if(e(l[1],c,n++))return!0}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}function ja(t,e){var n=0,r=!0,i=!1,a=void 0;try{for(var o,u=t.entries()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=p(s,2),c=l[0];if(!e(l[1],c,n++))return!1}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!0}function Ra(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];N(t,i,e[i],!0)}}function Pa(t,e){var n,r=[],i={},a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;(n=e(c))in i||(i[n]=1,r.push(c))}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return r}function za(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(e.has(u))return!0}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}function Ba(t){var e=new Set,n=!0,r=!1,i=void 0;try{for(var a,o=function(){var t=b(a.value).map(function(t,e){return 0===e?t:"[".concat(t,"]")});t.map(function(e,n){return t.slice(0,n+1).join("")}).forEach(function(t){return e.add(t)})},u=t[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)o()}catch(s){r=!0,i=s}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}return e}function La(t,e){return void 0===t||void 0===e||za(Ba(t),Ba(e))}var qa=Object.keys,Ia=Object.values;function Ua(t){return!0===t||!1===t}function Wa(t){var e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function Ha(t,e){return ka(t)?"!("+Ha(t.not,e)+")":wa(t)?"("+t.and.map(function(t){return Ha(t,e)}).join(") && (")+")":_a(t)?"("+t.or.map(function(t){return Ha(t,e)}).join(") || (")+")":e(t)}function Va(t,e){if(0===e.length)return!0;var n=e.shift();return Va(t[n],e)&&delete t[n],0===qa(t).length}function Ga(t){return t.charAt(0).toUpperCase()+t.substr(1)}function $a(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ya(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=b(t),r=[],i=1;i<=n.length;i++){var a="[".concat(n.slice(0,i).map(k).join("]["),"]");r.push("".concat(e).concat(a))}return r.join(" && ")}function Xa(t){return"".concat(b(t).map($a).join("\\."))}function Ja(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Qa(t){return"".concat(b(t).join("."))}function Za(t){return t?b(t).length:0}function Ka(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var a=i[r];if(void 0!==a)return a}}var to=42;function eo(t){return(t%360+360)%360}function no(t){return!!L(t)||!isNaN(t)&&!isNaN(parseFloat(t))}var ro={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function io(t){return t&&t.condition}var ao=["domain","grid","labels","ticks","title"],oo={grid:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOpacity:"main",labelOffset:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},uo={orient:1,bandPosition:1,domain:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,translate:1,zindex:1},so=Object.assign(Object.assign({},uo),{style:1,labelExpr:1,encoding:1});function lo(t){return!!so[t]}var co="area",fo="bar",ho="image",po="line",vo="point",go="rect",mo="rule",yo="text",bo="tick",xo="trail",_o="circle",wo="square",ko="geoshape";function Ao(t){return Ta(["line","area","trail"],t)}function Eo(t){return Ta(["rect","bar","image"],t)}var Mo=qa({area:1,bar:1,image:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1});function So(t){return t.type}q(Mo);var Co=[].concat(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],["fill","fillOpacity"]),Oo=["filled","color","tooltip","invalid","timeUnitBandPosition","timeUnitBand"],Do={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Fo={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},To={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function No(t){return!!t.mark}var jo=function(){function t(e,n){f(this,t),this.name=e,this.run=n}return h(t,[{key:"hasMatchingType",value:function(t){return!!No(t)&&(So(e=t.mark)?e.type:e)===this.name;var e}}]),t}(),Ro={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Po={count:1,min:1,max:1};function zo(t){return!!t&&!!t.argmin}function Bo(t){return!!t&&!!t.argmax}function Lo(t){return w(t)&&!!Ro[t]}var qo=["count","valid","missing","distinct"];function Io(t){return w(t)&&Ta(qo,t)}var Uo=["count","sum","distinct","valid","missing"],Wo=q(["mean","average","median","q1","q3","min","max"]),Ho="row",Vo="column",Go="facet",$o="x",Yo="y",Xo="x2",Jo="y2",Qo="latitude",Zo="longitude",Ko="latitude2",tu="longitude2",eu="color",nu="fill",ru="stroke",iu="shape",au="size",ou="opacity",uu="fillOpacity",su="strokeOpacity",lu="strokeWidth",cu="strokeDash",fu="text",hu="order",du="detail",pu="key",vu="tooltip",gu="href",mu="url",yu={longitude:1,longitude2:1,latitude:1,latitude2:1},bu=qa(yu),xu=Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),yu),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1});function _u(t){return"color"===t||"fill"===t||"stroke"===t}var wu={row:1,column:1,facet:1},ku=qa(wu),Au=Object.assign(Object.assign({},xu),wu),Eu=qa(Au),Mu=I(Au,["order","detail","tooltip"]),Su=I(Mu,["row","column","facet"]);function Cu(t){return!!Au[t]}var Ou=["x2","y2","latitude2","longitude2"];function Du(t){return Fu(t)!==t}function Fu(t){switch(t){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude"}return t}function Tu(t){switch(t){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2"}}var Nu=I(xu,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]),ju=qa(Nu),Ru={x:1,y:1},Pu=qa(Ru);function zu(t){return"x"===t?"width":"height"}function Bu(t){return"width"===t?"x":"y"}var Lu=I(Nu,["text","tooltip","href","url","detail","key","order"]),qu=qa(Lu),Iu=Object.assign(Object.assign({},Ru),Lu),Uu=qa(Iu);function Wu(t){return!!Iu[t]}function Hu(t,e){return function(t){switch(t){case eu:case nu:case ru:case du:case pu:case vu:case gu:case hu:case ou:case uu:case su:case lu:case Go:case Ho:case Vo:return Vu;case $o:case Yo:case Qo:case Zo:return Gu;case Xo:case Jo:case Ko:case tu:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case au:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case cu:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case iu:return{point:"always",geoshape:"always"};case fu:return{text:"always"};case mu:return{image:"always"}}}(t)[e]}var Vu={area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Gu=I(Vu,["geoshape"]);function $u(t){switch(t){case $o:case Yo:case au:case lu:case ou:case uu:case su:case Xo:case Jo:return;case Go:case Ho:case Vo:case iu:case cu:case fu:case vu:case gu:case mu:return"discrete";case eu:case nu:case ru:return"flexible";case Qo:case Zo:case Ko:case tu:case du:case pu:case hu:return}}function Yu(t){var e=t.anchor,n=t.frame,r=t.offset,i=t.orient,a=t.color,o=t.subtitleColor,u=t.subtitleFont,s=t.subtitleFontSize,l=t.subtitleFontStyle,c=t.subtitleFontWeight,f=t.subtitleLineHeight,h=t.subtitlePadding,d=I(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]);return{mark:Object.assign(Object.assign({},d),a?{fill:a}:{}),nonMark:Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),subtitle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),s?{subtitleFontSize:s}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),h?{subtitlePadding:h}:{})}}function Xu(t){return w(t)||x(t)&&w(t[0])}function Ju(t){return t&&!!t.signal}function Qu(t){return!!t.step}function Zu(t){return!x(t)&&"field"in t&&"data"in t}var Ku=qa({blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),ts=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function es(t){return Ju(t)?t:{value:t}}function ns(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function rs(t,e,n){return Ka(e[t],is(t,e,n))}function is(t,e,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).vgChannel;return Ka(r?as(t,e,n.style):void 0,as(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function as(t,e,n){return os(t,ns(e),n)}function os(t,e,n){var r;e=R(e);var i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=n[u.value];l&&void 0!==l[t]&&(r=l[t])}}catch(c){a=!0,o=c}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}function us(t,e){return R(t).reduce(function(t,n){var r;return t.field.push(tc(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t},{field:[],order:[]})}function ss(t,e){var n=d(t);return e.forEach(function(t){var e=!0,r=!1,i=void 0;try{for(var a,o=n[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value;if(Ea(u,t))return}}catch(s){r=!0,i=s}finally{try{e||null==o.return||o.return()}finally{if(r)throw i}}n.push(t)}),n}function ls(t,e){return Ea(t,e)||!e?t:t?[].concat(d(R(t)),d(R(e))).join(", "):e}function cs(t,e){var n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if(Xu(n)&&Xu(r))return{explicit:t.explicit,value:ls(n,r)};if(!Xu(n)&&!Xu(r))return{explicit:t.explicit,value:ss(n,r)};throw new Error("It should never reach here")}var fs=Object.freeze({__proto__:null,invalidSpec:function(t){return"Invalid specification ".concat(JSON.stringify(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')},FIT_NON_SINGLE:'Autosize "fit" only works for single views and layered views.',containerSizeNonSingle:function(t){return"".concat("width"==t?"Width":"Height",' "container" only works for single views and layered views.')},containerSizeNotCompatibleWithAutosize:function(t){return"".concat("width"==t?"Width":"Height",' "container" only works well with autosize "fit" or "fit-x".')},droppingFit:function(t){return t?'Dropping "fit-'.concat(t,'" because spec has discrete ').concat(zu(t),"."):'Dropping "fit" because spec has discrete size.'},cannotProjectOnChannelWithoutField:function(t){return'Cannot project a selection on encoding channel "'.concat(t,'", which has no field.')},cannotProjectAggregate:function(t,e){return'Cannot project a selection on encoding channel "'.concat(t,'" as it uses an aggregate function ("').concat(e,'").')},nearestNotSupportForContinuous:function(t){return'The "nearest" transform is not supported for '.concat(t," marks.")},selectionNotSupported:function(t){return"Selection not supported for ".concat(t," yet.")},selectionNotFound:function(t){return'Cannot find a selection named "'.concat(t,'".')},SCALE_BINDINGS_CONTINUOUS:"Scale bindings are currently only supported for scales with unbinned, continuous domains.",LEGEND_BINDINGS_PROJECT_LENGTH:"Legend bindings are only supported for selections over an individual field or encoding channel.",noSameUnitLookup:function(t){return'Cannot define and lookup the "'.concat(t,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?"},noSuchRepeatedValue:function(t){return'Unknown repeated value "'.concat(t,'".')},columnsNotSupportByRowCol:function(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')},CONCAT_CANNOT_SHARE_AXIS:"Axes cannot be shared in concatenated views yet (https://github.com/vega/vega-lite/issues/2415).",REPEAT_CANNOT_SHARE_AXIS:"Axes cannot be shared in repeated views yet (https://github.com/vega/vega-lite/issues/2415).",unrecognizedParse:function(t){return'Unrecognized parse "'.concat(t,'".')},differentParse:function(t,e,n){return'An ancestor parsed field "'.concat(t,'" as ').concat(n," but a child wants to parse the field as ").concat(e,".")},invalidTransformIgnored:function(t){return"Ignoring an invalid transform: ".concat(Oa(t),".")},NO_FIELDS_NEEDS_AS:'If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.',encodingOverridden:function(t){return"Layer's shared ".concat(t.join(",")," channel ").concat(1===t.length?"is":"are"," overriden.")},projectionOverridden:function(t){var e=t.parentProjection,n=t.projection;return"Layer's shared projection ".concat(Oa(e)," is overridden by a child projection ").concat(Oa(n),".")},primitiveChannelDef:function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(Oa(n),"}.")},invalidFieldType:function(t){return'Invalid field type "'.concat(t,'".')},invalidFieldTypeForCountAggregate:function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')},invalidAggregate:function(t){return'Invalid aggregation operator "'.concat(t,'".')},missingFieldType:function(t,e){return'Missing type for channel "'.concat(t,'", using "').concat(e,'" instead.')},droppingColor:function(t,e){var n=e.fill,r=e.stroke;return"Dropping color ".concat(t," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")},emptyFieldDef:function(t,e){return"Dropping ".concat(Oa(t),' from channel "').concat(e,'" since it does not contain any data field, value, or signal.')},latLongDeprecated:function(t,e,n){return"".concat(t,"-encoding with type ").concat(e," is deprecated. Replacing with ").concat(n,"-encoding.")},LINE_WITH_VARYING_SIZE:"Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.",incompatibleChannel:function(t,e,n){return"".concat(t,' dropped as it is incompatible with "').concat(e,'"').concat(n?" when ".concat(n):"",".")},invalidEncodingChannel:function(t){return"".concat(t,"-encoding is dropped as ").concat(t," is not a valid encoding channel.")},facetChannelShouldBeDiscrete:function(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")},facetChannelDropped:function(t){return"Facet encoding dropped as ".concat(t.join(" and ")," ").concat(t.length>1?"are":"is"," also specified.")},discreteChannelCannotEncode:function(t,e){return'Using discrete channel "'.concat(t,'" to encode "').concat(e,'" field can be misleading as it does not encode ').concat("ordinal"===e?"order":"magnitude",".")},lineWithRange:function(t,e){return"Line mark is for continuous lines and thus cannot be used with ".concat(t&&e?"x2 and y2":t?"x2":"y2",". We will use the rule mark (line segments) instead.")},orientOverridden:function(t,e){return'Specified orient "'.concat(t,'" overridden with "').concat(e,'".')},CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:"Custom domain scale cannot be unioned with default field-based domain.",RANGE_STEP_DEPRECATED:'Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.',cannotUseScalePropertyWithNonColor:function(t){return'Cannot use the scale property "'.concat(t,'" with non-color channel.')},unaggregateDomainHasNoEffectForRawField:function(t){return"Using unaggregated domain with raw field has no effect (".concat(Oa(t),").")},unaggregateDomainWithNonSharedDomainOp:function(t){return'Unaggregated domain not applicable for "'.concat(t,'" since it produces values outside the origin domain of the source data.')},unaggregatedDomainWithLogScale:function(t){return"Unaggregated domain is currently unsupported for log scale (".concat(Oa(t),").")},cannotApplySizeToNonOrientedMark:function(t){return'Cannot apply size to non-oriented mark "'.concat(t,'".')},scaleTypeNotWorkWithChannel:function(t,e,n){return'Channel "'.concat(t,'" does not work with "').concat(e,'" scale. We are using "').concat(n,'" scale instead.')},scaleTypeNotWorkWithFieldDef:function(t,e){return'FieldDef does not work with "'.concat(t,'" scale. We are using "').concat(e,'" scale instead.')},scalePropertyNotWorkWithScaleType:function(t,e,n){return"".concat(n,"-scale's \"").concat(e,'" is dropped as it does not work with ').concat(t," scale.")},scaleTypeNotWorkWithMark:function(t,e){return'Scale type "'.concat(e,'" does not work with mark "').concat(t,'".')},stepDropped:function(t){return'The step for "'.concat(t,'" is dropped because the ').concat("width"===t?"x":"y"," is continuous.")},mergeConflictingProperty:function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(Oa(n)," and ").concat(Oa(r),"). Using ").concat(Oa(n),".")},mergeConflictingDomainProperty:function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(Oa(n)," and ").concat(Oa(r),"). Using the union of the two domains.")},independentScaleMeansIndependentGuide:function(t){return'Setting the scale to be independent for "'.concat(t,'" means we also have to set the guide (axis or legend) to be independent.')},domainSortDropped:function(t){return"Dropping sort property ".concat(Oa(t),' as unioned domains only support boolean or op "count", "min", and "max".')},UNABLE_TO_MERGE_DOMAINS:"Unable to merge domains.",MORE_THAN_ONE_SORT:"Domains that should be unioned has conflicting sort properties. Sort will be set to true.",INVALID_CHANNEL_FOR_AXIS:"Invalid channel for axis.",cannotStackRangedMark:function(t){return'Cannot stack "'.concat(t,'" if there is already "').concat(t,'2".')},cannotStackNonLinearScale:function(t){return"Cannot stack non-linear scale (".concat(t,").")},stackNonSummativeAggregate:function(t){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(t,'").')},invalidTimeUnit:function(t,e){return"Invalid ".concat(t,": ").concat(Oa(e),".")},dayReplacedWithDate:function(t){return'Time unit "'.concat(t,'" is not supported. We are replacing it with ').concat(Ja(t,"day","date"),".")},droppedDay:function(t){return"Dropping day from datetime ".concat(Oa(t)," as day cannot be combined with other units.")},errorBarCenterAndExtentAreNotNeeded:function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")},errorBarCenterIsUsedWithWrongExtent:function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")},errorBarContinuousAxisHasCustomizedAggregate:function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")},errorBarCenterIsNotNeeded:function(t,e){return"Center is not needed to be specified in ".concat(e," when extent is ").concat(t,".")},errorBand1DNotSupport:function(t){return"1D error band does not support ".concat(t,".")},channelRequiredForBinned:function(t){return"Channel ".concat(t,' is required for "binned" bin.')},domainRequiredForThresholdScale:function(t){return"Domain for ".concat(t," is required for threshold scale.")}}),hs=function(t,e){var n=t||S;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=C&&M(e||"error","ERROR",arguments),this},warn:function(){return n>=O&&M(e||"warn","WARN",arguments),this},info:function(){return n>=D&&M(e||"log","INFO",arguments),this},debug:function(){return n>=F&&M(e||"log","DEBUG",arguments),this}}}(O),ds=hs;function ps(){var t;(t=ds).warn.apply(t,arguments)}var vs=2006;function gs(t){return!!t&&(!!t.year||!!t.quarter||!!t.month||!!t.date||!!t.day||!!t.hours||!!t.minutes||!!t.seconds||!!t.milliseconds)}var ms,ys=["january","february","march","april","may","june","july","august","september","october","november","december"],bs=ys.map(function(t){return t.substr(0,3)}),xs=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],_s=xs.map(function(t){return t.substr(0,3)});function ws(t,e){var n=[];if(e&&void 0!==t.day&&qa(t).length>1&&(ps(fs.droppedDay(t)),delete(t=Ma(t)).day),void 0!==t.year?n.push(t.year):void 0!==t.day?n.push(vs):n.push(0),void 0!==t.month){var r=e?function(t){if(no(t)&&(t=+t),L(t))return t-1;var e=t.toLowerCase(),n=ys.indexOf(e);if(-1!==n)return n;var r=e.substr(0,3),i=bs.indexOf(r);if(-1!==i)return i;throw new Error(fs.invalidTimeUnit("month",t))}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){var i=e?function(t){if(no(t)&&(t=+t),L(t))return t>4&&ps(fs.invalidTimeUnit("quarter",t)),t-1;throw new Error(fs.invalidTimeUnit("quarter",t))}(t.quarter):t.quarter;n.push(L(i)?3*i:i+"*3")}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){var a=e?function(t){if(no(t)&&(t=+t),L(t))return t%7;var e=t.toLowerCase(),n=xs.indexOf(e);if(-1!==n)return n;var r=e.substr(0,3),i=_s.indexOf(r);if(-1!==i)return i;throw new Error(fs.invalidTimeUnit("day",t))}(t.day):t.day;n.push(L(a)?a+1:a+"+1")}else n.push(1);for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=t[u[o]];n.push("undefined"===typeof s?0:s)}return n}function ks(t){var e=ws(t,!0).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}!function(t){t.YEAR="year",t.MONTH="month",t.DAY="day",t.DATE="date",t.HOURS="hours",t.MINUTES="minutes",t.SECONDS="seconds",t.MILLISECONDS="milliseconds",t.YEARMONTH="yearmonth",t.YEARMONTHDATE="yearmonthdate",t.YEARMONTHDATEHOURS="yearmonthdatehours",t.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",t.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",t.MONTHDATE="monthdate",t.MONTHDATEHOURS="monthdatehours",t.HOURSMINUTES="hoursminutes",t.HOURSMINUTESSECONDS="hoursminutesseconds",t.MINUTESSECONDS="minutesseconds",t.SECONDSMILLISECONDS="secondsmilliseconds",t.QUARTER="quarter",t.YEARQUARTER="yearquarter",t.QUARTERMONTH="quartermonth",t.YEARQUARTERMONTH="yearquartermonth",t.UTCYEAR="utcyear",t.UTCMONTH="utcmonth",t.UTCDAY="utcday",t.UTCDATE="utcdate",t.UTCHOURS="utchours",t.UTCMINUTES="utcminutes",t.UTCSECONDS="utcseconds",t.UTCMILLISECONDS="utcmilliseconds",t.UTCYEARMONTH="utcyearmonth",t.UTCYEARMONTHDATE="utcyearmonthdate",t.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",t.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",t.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",t.UTCMONTHDATE="utcmonthdate",t.UTCMONTHDATEHOURS="utcmonthdatehours",t.UTCHOURSMINUTES="utchoursminutes",t.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",t.UTCMINUTESSECONDS="utcminutesseconds",t.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",t.UTCQUARTER="utcquarter",t.UTCYEARQUARTER="utcyearquarter",t.UTCQUARTERMONTH="utcquartermonth",t.UTCYEARQUARTERMONTH="utcyearquartermonth"}(ms||(ms={}));var As={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Es=qa(As),Ms={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1},Ss={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},Cs=Object.assign(Object.assign({},Ms),Ss);function Os(t){return!!Cs[t]}Object.assign(Object.assign(Object.assign(Object.assign({},As),Ms),{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1}),Ss);var Ds={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Fs(t){return Es.reduce(function(e,n){return Ts(t,n)?[].concat(d(e),[n]):e},[])}function Ts(t,e){var n=t.indexOf(e);return n>-1&&(e!==ms.SECONDS||0===n||"i"!==t.charAt(n-1))}function Ns(t,e){var n,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1}).end,i=Ya(e),a=Os(t)?"utc":"",o=Es.reduce(function(e,r){var o;return Ts(t,r)&&(e[r]=(o=r)===ms.QUARTER?"(".concat(a,"quarter(").concat(i,")-1)"):"".concat(a).concat(o,"(").concat(i,")"),n=r),e},{});return r&&(o[n]+="+1"),function(t){var e=ws(t,!1).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}(o)}function js(t,e,n){if(t){var r=function(t){if(t){var e=Fs(t);return"timeUnitSpecifier(".concat(xa(e),", ").concat(xa(Ds),")")}}(t);return n||Os(t)?"utcFormat(".concat(e,", ").concat(r,")"):"timeFormat(".concat(e,", ").concat(r,")")}}function Rs(t){var e;if(t)return w(t)?e={unit:Ps(t)}:_(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:Ps(t.unit)}:{})),Os(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function Ps(t){return"day"!==t&&t.indexOf("day")>=0?(ps(fs.dayReplacedWithDate(t)),Ja(t,"day","date")):t}function zs(t){return t&&!!t.field&&void 0!==t.equal}function Bs(t){return t&&!!t.field&&void 0!==t.lt}function Ls(t){return t&&!!t.field&&void 0!==t.lte}function qs(t){return t&&!!t.field&&void 0!==t.gt}function Is(t){return t&&!!t.field&&void 0!==t.gte}function Us(t){if(t&&t.field){if(x(t.range)&&2===t.range.length)return!0;if(Ju(t.range))return!0}return!1}function Ws(t){return t&&!!t.field&&(x(t.oneOf)||x(t.in))}function Hs(t){return Ws(t)||zs(t)||Us(t)||Bs(t)||qs(t)||Ls(t)||Is(t)}function Vs(t,e){return yc(t,{timeUnit:e,time:!0})}function Gs(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.field,i=null===(e=Rs(t.timeUnit))||void 0===e?void 0:e.unit,a=i?"time("+Ns(i,r)+")":tc(t,{expr:"datum"});if(zs(t))return a+"==="+Vs(t.equal,i);if(Bs(t)){var o=t.lt;return"".concat(a,"<").concat(Vs(o,i))}if(qs(t)){var u=t.gt;return"".concat(a,">").concat(Vs(u,i))}if(Ls(t)){var s=t.lte;return"".concat(a,"<=").concat(Vs(s,i))}if(Is(t)){var l=t.gte;return"".concat(a,">=").concat(Vs(l,i))}if(Ws(t))return"indexof([".concat(function(t,e){return t.map(function(t){return Vs(t,e)})}(t.oneOf,i).join(","),"], ").concat(a,") !== -1");if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return $s(a,t.valid);if(Us(t)){var c=t.range,f=Ju(c)?{signal:"".concat(c.signal,"[0]")}:c[0],h=Ju(c)?{signal:"".concat(c.signal,"[1]")}:c[1];if(null!==f&&null!==h&&n)return"inrange("+a+", ["+Vs(f,i)+", "+Vs(h,i)+"])";var d=[];return null!==f&&d.push("".concat(a," >= ").concat(Vs(f,i))),null!==h&&d.push("".concat(a," <= ").concat(Vs(h,i))),d.length>0?d.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(t)))}function $s(t){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?"!isValid(".concat(t,") || !isFinite(+").concat(t,")"):"isValid(".concat(t,") && isFinite(+").concat(t,")")}function Ys(t){var e;return Hs(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=Rs(t.timeUnit))||void 0===e?void 0:e.unit}):t}var Xs,Js={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1},Qs="quantitative",Zs="ordinal",Ks="temporal",tl="nominal",el="geojson";!function(t){t.LINEAR="linear",t.LOG="log",t.POW="pow",t.SQRT="sqrt",t.SYMLOG="symlog",t.IDENTITY="identity",t.SEQUENTIAL="sequential",t.TIME="time",t.UTC="utc",t.QUANTILE="quantile",t.QUANTIZE="quantize",t.THRESHOLD="threshold",t.BIN_ORDINAL="bin-ordinal",t.ORDINAL="ordinal",t.POINT="point",t.BAND="band"}(Xs||(Xs={}));var nl={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},rl=qa(nl),il={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function al(t){return il[t]}var ol=["linear","log","pow","sqrt","symlog","time","utc"],ul=q(ol),sl=q(["linear","log","pow","sqrt","symlog"]),ll=q(["quantile","quantize","threshold"]),cl=q(ol.concat(["quantile","quantize","threshold","sequential","identity"])),fl=q(["ordinal","bin-ordinal","point","band"]);function hl(t){return t in fl}function dl(t){return t in cl}function pl(t){return t in ul}function vl(t){return t in ll}function gl(t){return null===t||void 0===t?void 0:t.selection}var ml=I({type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},["type","domain","range","scheme"]),yl=qa(ml);function bl(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Ta(["point","band","identity"],t);case"bins":return!Ta(["point","band","identity","ordinal"],t);case"round":return pl(t)||"band"===t||"point"===t;case"padding":return pl(t)||Ta(["point","band"],t);case"paddingOuter":case"align":return Ta(["point","band"],t);case"paddingInner":return"band"===t;case"domainMid":case"clamp":return pl(t);case"nice":return pl(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return dl(t)&&!Ta(["log","time","utc","threshold","quantile"],t)}}function xl(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return _u(t)?void 0:fs.cannotUseScalePropertyWithNonColor(t);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function _l(t,e){return Ta([Zs,tl],e)?void 0===t||hl(t):e===Ks?Ta([Xs.TIME,Xs.UTC,void 0],t):e!==Qs||Ta([Xs.LOG,Xs.POW,Xs.SQRT,Xs.SYMLOG,Xs.QUANTILE,Xs.QUANTIZE,Xs.THRESHOLD,Xs.LINEAR,void 0],t)}function wl(t,e){switch(t){case $o:case Yo:return pl(e)||Ta(["band","point"],e);case au:case lu:case ou:case uu:case su:return pl(e)||vl(e)||Ta(["band","point","ordinal"],e);case eu:case nu:case ru:return"band"!==e;case cu:return"ordinal"===e||vl(e);case iu:return"ordinal"===e}return!1}function kl(t,e){return t+"_"+e}!function(){var t,e={},n=!0,r=!1,i=void 0;try{for(var a,o=Eu[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=!0,l=!1,c=void 0;try{for(var f,h=qa(Js)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value,p=!0,v=!1,g=void 0;try{for(var m,y=rl[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value,x=kl(u,d);wl(u,b)&&_l(b,d)&&(e[x]=null!==(t=e[x])&&void 0!==t?t:[],e[x].push(b))}}catch(_){v=!0,g=_}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}}}catch(_){l=!0,c=_}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}}}catch(_){r=!0,i=_}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}();var Al=" \u2013 ",El=new Set;function Ml(t){return t&&"number"!==t&&"time"!==t&&El.has(t)}function Sl(t){var e=t.formatType,n=t.field,r=t.format;return"".concat(e,"(").concat(n,", ").concat(JSON.stringify(r),")")}function Cl(t){var e,n=t.fieldDef,r=t.format,i=t.formatType,a=t.expr,o=t.config,u=t.field,s=t.omitNumberFormatAndEmptyTimeFormat,l=t.omitTimeFormatConfig,c=t.isUTCScale;u=null!==u&&void 0!==u?u:tc(n,{expr:a}),c=null!==c&&void 0!==c?c:Ql(n)&&n.scale&&n.scale.type===Xs.UTC;var f=l?null:o.timeFormat;if(Ml(i))return{signal:Sl({formatType:i,format:r,field:u})};if(i&&(i=void 0),gc(n)){var h=function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return!e||n?(n=w(n)?n:r)||a?"".concat(i?"utc":"time","Format(").concat(t,", '").concat(n,"')"):void 0:js(e,t,i)}(u,null===(e=Rs(n.timeUnit))||void 0===e?void 0:e.unit,r,f,c,!s);return h?{signal:h}:void 0}return s?void 0:(r=Ol(n,r,o),wc(n.bin)?{signal:Tl(u,tc(n,{expr:a,binSuffix:"end"}),r,i,o)}:"quantitative"===n.type||r?{signal:"".concat(Dl(tc(n,{expr:a,binSuffix:"range"}),r))}:{signal:"''+".concat(tc(n,{expr:a}))})}function Ol(t,e,n){return w(e)?e:t.type===Qs?n.numberFormat:void 0}function Dl(t,e){return"format(".concat(t,', "').concat(e||"",'")')}function Fl(t,e,n,r){var i;return Ml(n)?Sl({formatType:n,field:t,format:e}):Dl(t,null!==(i=w(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function Tl(t,e,n,r,i){var a=Fl(t,n,r,i),o=Fl(e,n,r,i);return"".concat($s(t,!1),' ? "null" : ').concat(a,' + "').concat(Al,'" + ').concat(o)}var Nl="min",jl={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Rl(t){return!!jl[t]}function Pl(t){return!!t&&!!t.encoding}function zl(t){return!!t&&("count"===t.op||!!t.field)}function Bl(t){return!!t&&x(t)}function Ll(t){return!!t.row||!!t.column}function ql(t){return void 0!==t.facet}function Il(t){var e=t.field,n=t.timeUnit,r=t.bin,i=t.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function Ul(t){return Yl(t)&&!!t.sort}function Wl(t,e,n,r,i){var a=(arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}).isMidPoint,o=e.timeUnit,u=e.bin;if(Ta(["x","y"],t)){if(Zl(e)&&void 0!==e.band)return e.band;if(o&&!n)return a?is("timeUnitBandPosition",r,i):Eo(r.type)?is("timeUnitBand",r,i):0;if(wc(u))return Eo(r.type)&&!a?1:.5}}function Hl(t,e,n,r,i){return!!(wc(e.bin)||e.timeUnit&&Yl(e)&&"temporal"===e.type)&&!!Wl(t,e,n,r,i)}function Vl(t){return!!t&&!!t.condition}function Gl(t){return!!t&&!!t.condition&&!x(t.condition)&&$l(t.condition)}function $l(t){return!!t&&(!!t.field||"count"===t.aggregate)}function Yl(t){return!!t&&(!!t.field&&!!t.type||"count"===t.aggregate)}function Xl(t){return $l(t)&&w(t.field)}function Jl(t){return t&&"value"in t&&void 0!==t.value}function Ql(t){return!!t&&(!!t.scale||!!t.sort)}function Zl(t){return!!t&&(!!t.axis||!!t.stack||!!t.impute||void 0!==t.band)}function Kl(t){return!!t&&!!t.format}function tc(t){var e,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.field,o=i.prefix,u=i.suffix,s="";if(function(t){return"count"===t.aggregate}(t))a=function(t){return function(t){return 0===t.indexOf("__")}(t)?t:"__".concat(t)}("count");else{var l;if(!i.nofn)if(function(t){return!!t.op}(t))l=t.op;else{var c=t.bin,f=t.aggregate,h=t.timeUnit;wc(c)?(l=_c(c),u=(null!==(e=i.binSuffix)&&void 0!==e?e:"")+(null!==(n=i.suffix)&&void 0!==n?n:"")):f?Bo(f)?(s=".".concat(a),a="argmax_".concat(f.argmax)):zo(f)?(s=".".concat(a),a="argmin_".concat(f.argmin)):l=String(f):h&&(l=function(t){var e=Rs(t),n=e.utc,r=I(e,["utc"]);return r.unit?(n?"utc":"")+qa(r).map(function(t){return Wa("".concat("unit"===t?"":"_".concat(t,"_")).concat(r[t]))}).join(""):(n?"utc":"")+"timeunit"+qa(r).map(function(t){return Wa("_".concat(t,"_").concat(r[t]))}).join("")}(h),u=(!Ta(["range","mid"],i.binSuffix)&&i.binSuffix||"")+(null!==(r=i.suffix)&&void 0!==r?r:""))}l&&(a=a?"".concat(l,"_").concat(a):l)}return u&&(a="".concat(a,"_").concat(u)),o&&(a="".concat(o,"_").concat(a)),i.forAs?a:i.expr?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(e,"[").concat(k(b(t).join(".")),"]")}(a,i.expr)+s:Xa(a)+s}function ec(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!t.bin;case"temporal":return!1}throw new Error(fs.invalidFieldType(t.type))}function nc(t){return!ec(t)}var rc=function(t,e){switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){var e=t.aggregate,n=t.bin,r=t.timeUnit,i=t.field;if(Bo(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(zo(e))return"".concat(i," for argmin(").concat(e.argmin,")");var a=Rs(r),o=e||(null===a||void 0===a?void 0:a.unit)||(null===a||void 0===a?void 0:a.maxbins)&&"timeunit"||wc(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}(t);default:return function(t,e){var n,r=t.field,i=t.bin,a=t.timeUnit,o=t.aggregate;if("count"===o)return e.countTitle;if(wc(i))return"".concat(r," (binned)");if(a){var u=null===(n=Rs(a))||void 0===n?void 0:n.unit;if(u)return"".concat(r," (").concat(Fs(u).join("-"),")")}else if(o)return Bo(o)?"".concat(r," for max ").concat(o.argmax):zo(o)?"".concat(r," for min ").concat(o.argmin):"".concat(Ga(o)," of ").concat(r);return r}(t,e)}},ic=rc;function ac(t){ic=t}function oc(t,e,n){var r,i,a=n.allowDisabling,o=n.includeDefault,u=void 0===o||o,s=(null!==(r=uc(t))&&void 0!==r?r:{}).title,l=u?sc(t,e):void 0;return a?Ka(s,t.title,l):null!==(i=null!==s&&void 0!==s?s:t.title)&&void 0!==i?i:l}function uc(t){return Zl(t)&&t.axis?t.axis:(e=t)&&e.legend&&t.legend?t.legend:function(t){return!!t&&!!t.header}(t)&&t.header?t.header:void 0;var e}function sc(t,e){return ic(t,e)}function lc(t){var e;if(Kl(t))return{format:t.format,formatType:t.formatType};var n=null!==(e=uc(t))&&void 0!==e?e:{};return{format:n.format,formatType:n.formatType}}function cc(t){return $l(t)?t:Gl(t)?t.condition:void 0}function fc(t){return $l(t)?t:Gl(t)?t.condition:void 0}function hc(t,e){if(w(t)||L(t)||B(t)){var n=w(t)?"string":L(t)?"number":"boolean";return ps(fs.primitiveChannelDef(e,n,t)),{value:t}}return $l(t)?dc(t,e):Gl(t)?Object.assign(Object.assign({},t),{condition:dc(t.condition,e)}):t}function dc(t,e){var n=t.aggregate,r=t.timeUnit,i=t.bin,a=t.field,o=Object.assign({},t);if(!n||Lo(n)||Bo(n)||zo(n)||(ps(fs.invalidAggregate(n)),delete o.aggregate),r&&(o.timeUnit=Rs(r)),a&&(o.field="".concat(a)),wc(i)&&(o.bin=pc(i,e)),kc(i)&&!Ta(Pu,e)&&ps("Channel ".concat(e,' should not be used with "binned" bin.')),Yl(o)){var u=o.type,s=function(t){if(t)switch(t=t.toLowerCase()){case"q":case Qs:return"quantitative";case"t":case Ks:return"temporal";case"o":case Zs:return"ordinal";case"n":case tl:return"nominal";case el:return"geojson"}}(u);u!==s&&(o.type=s),"quantitative"!==u&&Io(n)&&(ps(fs.invalidFieldTypeForCountAggregate(u,n)),o.type="quantitative")}else if(!Du(e)){var l=function(t,e){if(t.timeUnit)return"temporal";if(wc(t.bin))return"quantitative";switch($u(e)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(o,e);ps(fs.missingFieldType(e,l)),o.type=l}if(Yl(o)){var c=function(t,e){var n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case"row":case"column":case"facet":return nc(t)?{compatible:!1,warning:fs.facetChannelShouldBeDiscrete(e)}:vc;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":case"url":return vc;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==Qs?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:vc;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"x2":case"y2":return"nominal"!==n||t.sort?vc:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case"strokeDash":return Ta(["ordinal","nominal"],t.type)?vc:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case"shape":return Ta(["ordinal","nominal","geojson"],t.type)?vc:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==t.type||"sort"in t?vc:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,e),f=c.compatible,h=c.warning;f||ps(h)}if(Ul(o)&&w(o.sort)){var d=o.sort;if(Rl(d))return Object.assign(Object.assign({},o),{sort:{encoding:d}});var p=d.substr(1);if("-"===d.charAt(0)&&Rl(p))return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}return o}function pc(t,e){return B(t)?{maxbins:Mc(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:Mc(e)})}var vc={compatible:!0};function gc(t){var e=uc(t),n=e&&e.formatType||Kl(t)&&t.formatType;return"time"===n||!n&&function(t){return"temporal"===t.type||!!t.timeUnit}(t)}function mc(t){var e=uc(t),n=e&&e.formatType||Kl(t)&&t.formatType;return n&&Ml(n)}function yc(t,e){var n,r,i=e.timeUnit,a=e.type,o=e.time,u=e.undefinedIfExprNotRequired,s=null===(n=Rs(i))||void 0===n?void 0:n.unit;if(Ju(t)){var c=t.signal;if(o&&!s&&"temporal"!==a)return o?"isDate(".concat(c,") ? time(").concat(c,") : ").concat(c):c;r=c}else gs(t)?r=ks(t):(w(t)||L(t))&&(s||"temporal"===a)&&(r=function(t){return!!As[t]}(s)?ks(l({},s,t)):"datetime(".concat(JSON.stringify(t),")"));return r?o?"time(".concat(r,")"):r:u?void 0:JSON.stringify(t)}function bc(t,e){var n,r=t.type,i=null===(n=Rs(t.timeUnit))||void 0===n?void 0:n.unit;return e.map(function(t){var e=yc(t,{timeUnit:i,type:r,undefinedIfExprNotRequired:!0});return void 0!==e?{signal:e}:t})}function xc(t,e){return wc(t.bin)?Wu(e)&&Ta(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function _c(t){return B(t)&&(t=pc(t,void 0)),"bin"+qa(t).map(function(e){return Ec(t[e])?Wa("_".concat(e,"_").concat(Object.entries(t[e]))):Wa("_".concat(e,"_").concat(t[e]))}).join("")}function wc(t){return!0===t||Ac(t)&&!t.binned}function kc(t){return"binned"===t||Ac(t)&&!0===t.binned}function Ac(t){return _(t)}function Ec(t){return null===t||void 0===t?void 0:t.selection}function Mc(t){switch(t){case Ho:case Vo:case au:case eu:case nu:case ru:case lu:case ou:case uu:case su:case iu:return 6;case cu:return 4;default:return 10}}function Sc(t,e){var n=t&&t[e];return!!n&&(x(n)?Na(n,function(t){return!!t.field}):$l(n)||Gl(n))}function Cc(t){return Na(Eu,function(e){if(Sc(t,e)){var n=t[e];if(x(n))return Na(n,function(t){return!!t.aggregate});var r=cc(n);return r&&!!r.aggregate}return!1})}function Oc(t,e){var n=[],r=[],i=[],a=[],o={};return Tc(t,function(u,s){if($l(u)){var l=u.field,c=u.aggregate,f=u.bin,h=u.timeUnit,d=I(u,["field","aggregate","bin","timeUnit"]);if(c||h||f){var p,v=uc(u),g=v&&v.title,m=tc(u,{forAs:!0}),y=Object.assign(Object.assign(Object.assign({},g?[]:{title:oc(u,e,{allowDisabling:!0})}),d),{field:m}),b="x"===s||"y"===s;if(c){if(Bo(c)?(p="argmax",m=tc({op:"argmax",field:c.argmax},{forAs:!0}),y.field="".concat(m,".").concat(l)):zo(c)?(p="argmin",m=tc({op:"argmin",field:c.argmin},{forAs:!0}),y.field="".concat(m,".").concat(l)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(p=c),p){var x={op:p,as:m};l&&(x.field=l),a.push(x)}}else if(n.push(m),Yl(u)&&wc(f)){if(r.push({bin:f,field:l,as:m}),n.push(tc(u,{binSuffix:"end"})),xc(u,s)&&n.push(tc(u,{binSuffix:"range"})),b){var _={field:m+"_end"};o[s+"2"]=_}y.bin="binned",Du(s)||(y.type="quantitative")}else if(h){i.push({timeUnit:h,field:l,as:m});var w=Yl(u)&&u.type!==Ks&&"time";w&&("text"===s||"tooltip"===s?y.formatType=w:function(t){return!!Nu[t]}(s)?y.legend=Object.assign({formatType:w},y.legend):b&&(y.axis=Object.assign({formatType:w},y.axis)))}o[s]=y}else n.push(l),o[s]=t[s]}else o[s]=t[s]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function Dc(t,e){var n=e.type;return qa(t).reduce(function(r,i){if(!Cu(i))return ps(fs.invalidEncodingChannel(i)),r;if(!function(t,e,n){var r=Hu(e,n);if(!r)return!1;if("binned"===r){var i=t["x2"===e?"x":"y"];return!!($l(i)&&$l(t[e])&&kc(i.bin))}return!0}(t,i,n))return ps(fs.incompatibleChannel(i,n)),r;if("size"===i&&"line"===n){var a=fc(t[i]);if(null===a||void 0===a?void 0:a.aggregate)return ps(fs.LINE_WITH_VARYING_SIZE),r}if("color"===i&&(e.filled?"fill"in t:"stroke"in t))return ps(fs.droppingColor("encoding",{fill:"fill"in t,stroke:"stroke"in t})),r;var o=t[i];if("detail"===i||"order"===i&&!x(o)&&!Jl(o)||"tooltip"===i&&x(o))o&&(r[i]=R(o).reduce(function(t,e){return $l(e)?t.push(dc(e,i)):ps(fs.emptyFieldDef(e,i)),t},[]));else{if("tooltip"===i&&null===o)r[i]=null;else if(!$l(o)&&!Jl(o)&&!Vl(o)&&!Ju(o))return ps(fs.emptyFieldDef(o,i)),r;r[i]=hc(o,i)}return r},{})}function Fc(t){var e=[],n=!0,r=!1,i=void 0;try{for(var a,o=qa(t)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(Sc(t,u)){var s=R(t[u]),l=!0,c=!1,f=void 0;try{for(var h,d=s[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;$l(p)?e.push(p):Gl(p)&&e.push(p.condition)}}catch(v){c=!0,f=v}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}function Tc(t,e,n){if(t){var r=!0,i=!1,a=void 0;try{for(var o,u=qa(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=t[s];if(x(l)){var c=!0,f=!1,h=void 0;try{for(var d,p=l[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;e.call(n,v,s)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}else e.call(n,l,s)}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}}function Nc(t,e,n,r){return t?qa(t).reduce(function(n,i){var a=t[i];return x(a)?a.reduce(function(t,n){return e.call(r,t,n,i)},n):e.call(r,n,a,i)},n):n}function jc(t,e){return qa(e).reduce(function(n,r){switch(r){case"x":case"y":case"href":case"url":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"tooltip":return n;case"order":if("line"===t||"trail"===t)return n;case"detail":case"key":var i=e[r];return(x(i)||$l(i))&&R(i).forEach(function(t){t.aggregate||n.push(tc(t,{}))}),n;case"size":if("trail"===t)return n;case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":var a=fc(e[r]);return a&&!a.aggregate&&n.push(tc(a,{})),n}},[])}function Rc(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var i=t.map(function(t){var n=t.fieldPrefix,i=t.titlePrefix,a=r?" of ".concat(e.field):"";return{field:n+e.field,type:e.type,title:Ju(i)?{signal:i+'"'.concat(escape(a),'"')}:i+a}});return{tooltip:[].concat(d(i),d(Fc(n)))}}function Pc(t){var e=t.axis,n=t.title,r=t.field;return e&&void 0!==e.title?void 0:Ka(n,r)}function zc(t,e,n,r,i){var a=n.scale,o=n.axis;return function(u){var s=u.partName,c=u.mark,f=u.positionPrefix,h=u.endPositionPrefix,d=void 0===h?void 0:h,p=u.extraEncoding,v=void 0===p?{}:p,g=Pc(n);return Bc(t,s,i,{mark:c,encoding:Object.assign(Object.assign(Object.assign(l({},e,Object.assign(Object.assign(Object.assign({field:f+"_"+n.field,type:n.type},void 0!==g?{title:g}:{}),void 0!==a?{scale:a}:{}),void 0!==o?{axis:o}:{})),w(d)?l({},e+"2",{field:d+"_"+n.field}):{}),r),v)})}}function Bc(t,e,n,r){var i=t.clip,a=t.color,o=t.opacity,u=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),i?{clip:i}:{}),a?{color:a}:{}),o?{opacity:o}:{}),So(r.mark)?r.mark:{type:r.mark}),{style:"".concat(u,"-").concat(e)}),B(t[e])?{}:t[e])})]:[]}function Lc(t,e,n){var r=t.encoding,i="vertical"===e?"y":"x",a=r[i],o=r[i+"2"],u=r[i+"Error"],s=r[i+"Error2"];return{continuousAxisChannelDef:qc(a,n),continuousAxisChannelDef2:qc(o,n),continuousAxisChannelDefError:qc(u,n),continuousAxisChannelDefError2:qc(s,n),continuousAxis:i}}function qc(t,e){if(t&&t.aggregate){var n=t.aggregate,r=I(t,["aggregate"]);return n!==e&&ps(fs.errorBarContinuousAxisHasCustomizedAggregate(n,e)),r}return t}function Ic(t,e){var n=t.mark,r=t.encoding;if($l(r.x)&&nc(r.x)){if($l(r.y)&&nc(r.y)){if(void 0===r.x.aggregate&&r.y.aggregate===e)return"vertical";if(void 0===r.y.aggregate&&r.x.aggregate===e)return"horizontal";if(r.x.aggregate===e&&r.y.aggregate===e)throw new Error("Both x and y cannot have aggregate");return So(n)&&n.orient?n.orient:"vertical"}return"horizontal"}if($l(r.y)&&nc(r.y))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}var Uc="boxplot",Wc=qa({box:1,median:1,outliers:1,rule:1,ticks:1}),Hc=new jo(Uc,Gc);function Vc(t){return L(t)?"tukey":t}function Gc(t,e){var n,r,i=e.config,a=t.mark,o=(t.encoding,t.selection),u=(t.projection,I(t,["mark","encoding","selection","projection"])),s=So(a)?a:{type:a};o&&ps(fs.selectionNotSupported("boxplot"));var c,f=null!==(n=s.extent)&&void 0!==n?n:i.boxplot.extent,h=Ka(s.size,i.boxplot.size),p=Vc(f),v=function(t,e,n){var r=Ic(t,Uc),i=Lc(t,r,Uc),a=i.continuousAxisChannelDef,o=i.continuousAxis,u=a.field,s=Vc(e),l=[].concat(d($c(u)),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:("min-max"===s?"lower_whisker_":"min_")+u},{op:"max",field:u,as:("min-max"===s?"upper_whisker_":"max_")+u}]),c="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_"+u},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(e,', datum["max_').concat(u,'"])'),as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(e,', datum["min_').concat(u,'"])'),as:"lower_whisker_"+u}],f=t.encoding,h=o,p=(f[h],function(t){var e,n,r=t.tooltip,i=I(t,["tooltip"]);return r?(x(r)?(r.forEach(function(t){t.aggregate?(e||(e=[]),e.push(t)):(n||(n=[]),n.push(t))}),e&&(i.tooltip=e)):r.aggregate?i.tooltip=r:n=r,x(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:i}):{filteredEncoding:t}}(I(f,["symbol"===typeof h?h:h+""]))),v=p.customTooltipWithoutAggregatedField,g=Oc(p.filteredEncoding,n),m=g.bins,y=g.timeUnits,b=g.aggregate,_=g.groupby,w=g.encoding,k="vertical"===r?"horizontal":"vertical",A=r;return{transform:[].concat(d(m),d(y),[{aggregate:[].concat(d(b),d(l)),groupby:_}],c),groupby:_,aggregate:b,continuousAxisChannelDef:a,continuousAxis:o,encodingWithoutContinuousAxis:w,ticksOrient:k,boxOrient:A,customTooltipWithoutAggregatedField:v}}(t,f,i),g=v.transform,m=v.continuousAxisChannelDef,y=v.continuousAxis,b=v.groupby,w=v.aggregate,k=v.encodingWithoutContinuousAxis,A=v.ticksOrient,E=v.boxOrient,M=v.customTooltipWithoutAggregatedField,S=(k.color,k.size),C=I(k,["color","size"]),O=function(t){return zc(s,y,m,t,i.boxplot)},D=O(C),F=O(k),T=O(Object.assign(Object.assign({},C),S?{size:S}:{})),N=Rc([{fieldPrefix:"min-max"===p?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===p?"lower_whisker_":"min_",titlePrefix:"Min"}],m,k),j={type:"tick",color:"black",opacity:1,orient:A,invalid:null},R="min-max"===p?N:Rc([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,k),P=[].concat(d(D({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:R})),d(D({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:R})),d(D({partName:"ticks",mark:j,positionPrefix:"lower_whisker",extraEncoding:R})),d(D({partName:"ticks",mark:j,positionPrefix:"upper_whisker",extraEncoding:R}))),z=[].concat(d("tukey"!==p?P:[]),d(F({partName:"box",mark:Object.assign(Object.assign({type:"bar"},h?{size:h}:{}),{orient:E,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:N})),d(T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},_(i.boxplot.median)&&i.boxplot.median.color?{color:i.boxplot.median.color}:{}),h?{size:h}:{}),{orient:A}),positionPrefix:"mid_box",extraEncoding:N})));if("min-max"!==p){var B='datum["lower_box_'.concat(m.field,'"]'),L='datum["upper_box_'.concat(m.field,'"]'),q="(".concat(L," - ").concat(B,")"),U="".concat(B," - ").concat(f," * ").concat(q),W="".concat(L," + ").concat(f," * ").concat(q),H='datum["'.concat(m.field,'"]'),V={joinaggregate:$c(m.field),groupby:b},G=void 0;"tukey"===p&&(G={transform:[{filter:"(".concat(U," <= ").concat(H,") && (").concat(H," <= ").concat(W,")")},{aggregate:[{op:"min",field:m.field,as:"lower_whisker_"+m.field},{op:"max",field:m.field,as:"upper_whisker_"+m.field},{op:"min",field:"lower_box_"+m.field,as:"lower_box_"+m.field},{op:"max",field:"upper_box_"+m.field,as:"upper_box_"+m.field}].concat(d(w)),groupby:b}],layer:P});var $=I(C,["tooltip"]),Y=m.scale,X=m.axis,J=Pc(m),Q=Bc(s,"outliers",i.boxplot,{transform:[{filter:"(".concat(H," < ").concat(U,") || (").concat(H," > ").concat(W,")")}],mark:"point",encoding:Object.assign(Object.assign(l({},y,Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==J?{title:J}:{}),void 0!==Y?{scale:Y}:{}),void 0!==X?{axis:X}:{})),$),M?{tooltip:M}:{})})[0];Q&&G?c={transform:[V],layer:[Q,G]}:Q?(c=Q).transform.unshift(V):G&&(c=G).transform.unshift(V)}return c?Object.assign(Object.assign({},u),{layer:[c,{transform:g,layer:z}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(g),layer:z})}function $c(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}var Yc="errorbar",Xc=qa({ticks:1,rule:1}),Jc=new jo(Yc,Qc);function Qc(t,e){var n=e.config,r=Kc(t,Yc,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,l=r.markDef,c=r.outerSpec,f=r.tooltipEncoding,h=zc(l,o,a,u,n.errorbar),p={type:"tick",orient:s},v=[].concat(d(h({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:f})),d(h({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:f})),d(h({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})));return Object.assign(Object.assign(Object.assign({},c),{transform:i}),v.length>1?{layer:v}:Object.assign({},v[0]))}function Zc(t,e){var n=t.encoding;if(function(t){return($l(t.x)||$l(t.y))&&!$l(t.x2)&&!$l(t.y2)&&!$l(t.xError)&&!$l(t.xError2)&&!$l(t.yError)&&!$l(t.yError2)}(n))return{orient:Ic(t,e),inputType:"raw"};var r=function(t){return $l(t.x2)||$l(t.y2)}(n),i=function(t){return $l(t.xError)||$l(t.xError2)||$l(t.yError)||$l(t.yError2)}(n),a=n.x,o=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));var u=n.x2,s=n.y2;if($l(u)&&$l(s))throw new Error("".concat(e," cannot have both x2 and y2"));if($l(u)){if($l(a)&&nc(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if($l(s)){if($l(o)&&nc(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}var l=n.xError,c=n.xError2,f=n.yError,h=n.yError2;if($l(c)&&!$l(l))throw new Error("".concat(e," cannot have xError2 without xError"));if($l(h)&&!$l(f))throw new Error("".concat(e," cannot have yError2 without yError"));if($l(l)&&$l(f))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if($l(l)){if($l(a)&&nc(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if($l(f)){if($l(o)&&nc(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function Kc(t,e,n){var r,i=t.mark,a=t.encoding,o=t.selection,u=(t.projection,I(t,["mark","encoding","selection","projection"])),s=So(i)?i:{type:i};o&&ps(fs.selectionNotSupported(e));var l=Zc(t,e),c=l.orient,f=l.inputType,h=Lc(t,c,e),p=h.continuousAxisChannelDef,v=h.continuousAxisChannelDef2,g=h.continuousAxisChannelDefError,m=h.continuousAxisChannelDefError2,y=h.continuousAxis,b=function(t,e,n,r,i,a,o,u){var s,l=[],c=[],f=e.field,h=!1;if("raw"===a){var d,p,v,g=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":u.errorbar.center,m=t.extent?t.extent:"mean"===g?"stderr":"iqr";"median"===g!==("iqr"===m)&&ps(fs.errorBarCenterIsUsedWithWrongExtent(g,m,o)),"stderr"===m||"stdev"===m?(l=[{op:m,field:f,as:"extent_"+f},{op:g,field:f,as:"center_"+f}],c=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_"+f},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_"+f}],s=[{fieldPrefix:"center_",titlePrefix:Ga(g)},{fieldPrefix:"upper_",titlePrefix:tf(g,m,"+")},{fieldPrefix:"lower_",titlePrefix:tf(g,m,"-")}],h=!0):(t.center&&t.extent&&ps(fs.errorBarCenterIsNotNeeded(t.extent,o)),"ci"===m?(d="mean",p="ci0",v="ci1"):(d="median",p="q1",v="q3"),l=[{op:p,field:f,as:"lower_"+f},{op:v,field:f,as:"upper_"+f},{op:d,field:f,as:"center_"+f}],s=[{fieldPrefix:"upper_",titlePrefix:oc({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:oc({field:f,aggregate:p,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:oc({field:f,aggregate:d,type:"quantitative"},u,{allowDisabling:!1})}])}else{(t.center||t.extent)&&ps(fs.errorBarCenterAndExtentAreNotNeeded(t.center,t.extent)),"aggregated-upper-lower"===a?(s=[],c=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+f},{calculate:'datum["'.concat(f,'"]'),as:"lower_"+f}]):"aggregated-error"===a&&(s=[{fieldPrefix:"",titlePrefix:f}],c=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_"+f}],i?c.push({calculate:'datum["'.concat(f,'"] + datum["').concat(i.field,'"]'),as:"lower_"+f}):c.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_"+f}));var y=!0,b=!1,x=void 0;try{for(var _,w=c[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var k=_.value;s.push({fieldPrefix:k.as.substring(0,6),titlePrefix:Ja(Ja(k.calculate,'datum["',""),'"]',"")})}}catch(A){b=!0,x=A}finally{try{y||null==w.return||w.return()}finally{if(b)throw x}}}return{postAggregateCalculates:c,errorBarSpecificAggregate:l,tooltipSummary:s,tooltipTitleWithFieldName:h}}(s,p,v,g,m,f,e,n),x=b.errorBarSpecificAggregate,_=b.postAggregateCalculates,w=b.tooltipSummary,k=b.tooltipTitleWithFieldName,A=a,E=y,M=(A[E],"x"===y?"x2":"y2"),S=(A[M],"x"===y?"xError":"yError"),C=(A[S],"x"===y?"xError2":"yError2"),O=(A[C],Oc(I(A,["symbol"===typeof E?E:E+"","symbol"===typeof M?M:M+"","symbol"===typeof S?S:S+"","symbol"===typeof C?C:C+""]),n)),D=O.bins,F=O.timeUnits,T=O.aggregate,N=O.groupby,j=O.encoding,R=[].concat(d(T),d(x)),P="raw"!==f?[]:N,z=Rc(w,p,j,k);return{transform:[].concat(d(null!==(r=u.transform)&&void 0!==r?r:[]),d(D),d(F),d(0===R.length?[]:[{aggregate:R,groupby:P}]),d(_)),groupby:P,continuousAxisChannelDef:p,continuousAxis:y,encodingWithoutContinuousAxis:j,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:s,outerSpec:u,tooltipEncoding:z}}function tf(t,e,n){return Ga(t)+" "+n+" "+e}var ef="errorband",nf=qa({band:1,borders:1}),rf=new jo(ef,af);function af(t,e){var n=e.config,r=Kc(t,ef,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,l=r.outerSpec,c=r.tooltipEncoding,f=s,h=zc(f,o,a,u,n.errorband),p=void 0!==t.encoding.x&&void 0!==t.encoding.y,v={type:p?"area":"rect"},g={type:p?"line":"rule"},m=Object.assign(Object.assign({},f.interpolate?{interpolate:f.interpolate}:{}),f.tension&&f.interpolate?{tension:f.tension}:{});return p?(v=Object.assign(Object.assign({},v),m),g=Object.assign(Object.assign({},g),m)):f.interpolate?ps(fs.errorBand1DNotSupport("interpolate")):f.tension&&ps(fs.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},l),{transform:i,layer:[].concat(d(h({partName:"band",mark:v,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})),d(h({partName:"borders",mark:g,positionPrefix:"lower",extraEncoding:c})),d(h({partName:"borders",mark:g,positionPrefix:"upper",extraEncoding:c})))})}var of={};function uf(t,e,n){var r=new jo(t,e);of[t]={normalizer:r,parts:n}}uf(Uc,Gc,Wc),uf(Yc,Qc,Xc),uf(ef,af,nf);var sf=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],lf=qa({size:1,shape:1,fill:1,stroke:1,strokeDash:1,strokeWidth:1,opacity:1}),cf={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},ff="_vgsid_",hf={single:{on:"click",fields:[ff],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[ff],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function df(t){return!!t&&("legend"===t||!!t.legend)}function pf(t){return df(t)&&_(t)}function vf(t){return void 0!==t.concat}function gf(t){return void 0!==t.vconcat}function mf(t){return void 0!==t.hconcat}function yf(t){return void 0!==t.repeat}function bf(t){return _(t)&&void 0!==t.step}function xf(t){return t.view||t.width||t.height}var _f=qa({align:1,bounds:1,center:1,columns:1,spacing:1});function wf(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function kf(t,e){var n=Af(t,e);return bf(n)?n.step:Ef}function Af(t,e){var n;return Ka(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}var Ef=20,Mf={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:Ef},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},area:{},bar:Fo,circle:{},geoshape:{},image:{},line:{},point:{},rect:To,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},axis:{},axisX:{},axisY:{},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:hf,style:{},title:{},facet:{spacing:20},repeat:{spacing:20},concat:{spacing:20}},Sf=ya("tableau10"),Cf={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Of={blue:Sf[0],orange:Sf[1],red:Sf[2],teal:Sf[3],green:Sf[4],yellow:Sf[5],purple:Sf[6],pink:Sf[7],brown:Sf[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Df(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=t.font,r=t.fontSize,i=I(t,["color","font","fontSize"]);return T({},Mf,n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:_(t)?Object.assign(Object.assign({},Of),t):Of}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:_(t)?Object.assign(Object.assign({},Cf),t):Cf}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}var Ff=["view"].concat(d(Mo)),Tf=["color","fontSize","background","padding","facet","concat","repeat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","scale","selection","overlay"],Nf=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function jf(t){t=Ma(t);var e=!0,n=!1,r=void 0;try{for(var i,a=Tf[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)delete t[i.value]}catch(V){n=!0,r=V}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}if(t.axis)for(var o in t.axis)io(t.axis[o])&&delete t.axis[o];if(t.legend){var u=!0,s=!1,l=void 0;try{for(var c,f=sf[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;delete t.legend[h]}}catch(V){s=!0,l=V}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}if(t.mark){var d=!0,p=!1,v=void 0;try{for(var g,m=Oo[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value;delete t.mark[y]}}catch(V){p=!0,v=V}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}var b=!0,x=!1,w=void 0;try{for(var k,A=Ff[Symbol.iterator]();!(b=(k=A.next()).done);b=!0){var E=k.value,M=!0,S=!1,C=void 0;try{for(var O,D=Oo[Symbol.iterator]();!(M=(O=D.next()).done);M=!0){var F=O.value;delete t[E][F]}}catch(V){S=!0,C=V}finally{try{M||null==D.return||D.return()}finally{if(S)throw C}}var T=Nf[E];if(T){var N=!0,j=!1,R=void 0;try{for(var P,z=T[Symbol.iterator]();!(N=(P=z.next()).done);N=!0){var B=P.value;delete t[E][B]}}catch(V){j=!0,R=V}finally{try{N||null==z.return||z.return()}finally{if(j)throw R}}}Rf(t,E)}}catch(V){x=!0,w=V}finally{try{b||null==A.return||A.return()}finally{if(x)throw w}}var L=!0,q=!1,I=void 0;try{for(var U,W=qa(of)[Symbol.iterator]();!(L=(U=W.next()).done);L=!0)delete t[U.value]}catch(V){q=!0,I=V}finally{try{L||null==W.return||W.return()}finally{if(q)throw I}}for(var H in function(t){var e=Yu(t.title),n=e.mark,r=e.subtitle,i=Object.assign(Object.assign({},t.style["group-title"]),n);qa(i).length>0&&(t.style["group-title"]=i),qa(r).length>0?t.title=r:delete t.title}(t),t)_(t[H])&&0===qa(t[H]).length&&delete t[H];return qa(t).length>0?t:void 0}function Rf(t,e,n,r){var i=r?t[e][r]:t[e];"view"===e&&(n="cell");var a=Object.assign(Object.assign({},i),t.style[null!==n&&void 0!==n?n:e]);qa(a).length>0&&(t.style[null!==n&&void 0!==n?n:e]=a),r||delete t[e]}function Pf(t){return void 0!==t.layer}var zf=function(){function t(){f(this,t)}return h(t,[{key:"map",value:function(t,e){return ql(t)?this.mapFacet(t,e):yf(t)?this.mapRepeat(t,e):mf(t)?this.mapHConcat(t,e):gf(t)?this.mapVConcat(t,e):vf(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}},{key:"mapLayerOrUnit",value:function(t,e){if(Pf(t))return this.mapLayer(t,e);if(No(t))return this.mapUnit(t,e);throw new Error(fs.invalidSpec(t))}},{key:"mapLayer",value:function(t,e){var n=this;return Object.assign(Object.assign({},t),{layer:t.layer.map(function(t){return n.mapLayerOrUnit(t,e)})})}},{key:"mapHConcat",value:function(t,e){var n=this;return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(function(t){return n.map(t,e)})})}},{key:"mapVConcat",value:function(t,e){var n=this;return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(function(t){return n.map(t,e)})})}},{key:"mapConcat",value:function(t,e){var n=this,r=t.concat,i=I(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(function(t){return n.map(t,e)})})}},{key:"mapFacet",value:function(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}},{key:"mapRepeat",value:function(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}]),t}(),Bf={zero:1,center:1,normalize:1},Lf=[fo,co,mo,vo,_o,wo,po,yo,bo],qf=[fo,co];function If(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=So(t)?t.type:t;if(!Ta(Lf,r))return null;var i=function(t){var e=t.x,n=t.y;if($l(e)&&$l(n))if("quantitative"===e.type&&"quantitative"===n.type){if(e.stack)return"x";if(n.stack)return"y";if(!!e.aggregate!==!!n.aggregate)return e.aggregate?"x":"y"}else{if("quantitative"===e.type)return"x";if("quantitative"===n.type)return"y"}else{if($l(e)&&"quantitative"===e.type)return"x";if($l(n)&&"quantitative"===n.type)return"y"}}(e);if(!i)return null;var a,o=e[i],u=Xl(o)?tc(o,{}):void 0,s="x"===i?"y":"x",l=e[s],c=Xl(l)?tc(l,{}):void 0,f=ju.reduce(function(t,n){return"tooltip"!==n&&Sc(e,n)&&R(e[n]).forEach(function(e){var r=fc(e);if(!r.aggregate){var i=Xl(r)?tc(r,{}):void 0;(!i||i!==c&&i!==u)&&t.push({channel:n,fieldDef:r})}}),t},[]);if(void 0!==o.stack?a=B(o.stack)?o.stack?"zero":null:o.stack:f.length>0&&Ta(qf,r)&&(a="zero"),!a||!Bf[a])return null;if(Cc(e)&&0===f.length)return null;if(o.scale&&o.scale.type&&o.scale.type!==Xs.LINEAR){if(n.disallowNonLinearStack)return null;ps(fs.cannotStackNonLinearScale(o.scale.type))}return Sc(e,i===$o?Xo:Jo)?(void 0!==o.stack&&ps(fs.cannotStackRangedMark(i)),null):(o.aggregate&&!Ta(Uo,o.aggregate)&&ps(fs.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:l?s:void 0,groupbyField:c,fieldChannel:i,impute:null!==o.impute&&Ao(r),stackBy:f,offset:a})}function Uf(t){var e=I(t,["point","line"]);return qa(e).length>1?e:e.type}function Wf(t){for(var e=0,n=["line","area","rule","trail"];e<n.length;e++){var r=n[e];t[r]&&(t=Object.assign(Object.assign({},t),l({},r,Ca(t[r],["point","line"]))))}return t}function Hf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?_(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?_(e.point)?e.point:{}:void 0}function Vf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}var Gf=function(){function t(){f(this,t),this.name="path-overlay"}return h(t,[{key:"hasMatchingType",value:function(t,e){if(No(t)){var n=t.mark,r=t.encoding,i=So(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!Hf(i,e[i.type],r);case"area":return!!Hf(i,e[i.type],r)||!!Vf(i,e[i.type])}}return!1}},{key:"run",value:function(t,e,n){var r=e.config,i=t.selection,a=t.projection,o=t.encoding,u=t.mark,s=I(t,["selection","projection","encoding","mark"]),c=So(u)?u:{type:u},f=Hf(c,r[c.type],o),h="area"===c.type&&Vf(c,r[c.type]),d=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:Uf(Object.assign(Object.assign({},"area"===c.type&&void 0===c.opacity&&void 0===c.fillOpacity?{opacity:.7}:{}),c)),encoding:Ca(o,["shape"])})],p=If(c,o),v=o;if(p){var g=p.fieldChannel,m=p.offset;v=Object.assign(Object.assign({},o),l({},g,Object.assign(Object.assign({},o[g]),m?{stack:m}:{})))}return h&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},Sa(c,["clip","interpolate","tension","tooltip"])),h),encoding:v})),f&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Sa(c,["clip","tooltip"])),f),encoding:v})),n(Object.assign(Object.assign({},s),{layer:d}),Object.assign(Object.assign({},e),{config:Wf(r)}))}}]),t}(),$f=function(){function t(){f(this,t),this.name="RangeStep"}return h(t,[{key:"hasMatchingType",value:function(t){var e;if(No(t)&&t.encoding){var n=!0,r=!1,i=void 0;try{for(var a,o=Pu[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=t.encoding[u];if(s&&$l(s)&&(null===(e=null===s||void 0===s?void 0:s.scale)||void 0===e?void 0:e.rangeStep))return!0}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}return!1}},{key:"run",value:function(t){var e,n={},r=Object.assign({},t.encoding),i=!0,a=!1,o=void 0;try{for(var u,s=Pu[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,f=zu(c),h=r[c];if(h&&$l(h)&&(null===(e=null===h||void 0===h?void 0:h.scale)||void 0===e?void 0:e.rangeStep)){var d=h.scale,p=I(h,["scale"]),v=I(d,["rangeStep"]);n[f]={step:d.rangeStep},ps(fs.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),l({},c,Object.assign(Object.assign({},p),qa(v).length>0?{scale:v}:{})))}}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return Object.assign(Object.assign(Object.assign({},n),t),{encoding:r})}}]),t}(),Yf=function(){function t(){f(this,t),this.name="RuleForRangedLine"}return h(t,[{key:"hasMatchingType",value:function(t){if(No(t)){var e=t.encoding;if("line"===t.mark){var n=!0,r=!1,i=void 0;try{for(var a,o=Ou[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=e[Fu(u)];if(e[u]&&$l(s)&&!kc(s.bin))return!0}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}return!1}},{key:"run",value:function(t,e,n){var r=t.encoding;return ps(fs.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},t),{mark:"rule"}),e)}}]),t}();function Xf(t){var e=t.parentEncoding,n=t.encoding;if(e&&n){var r=qa(e).reduce(function(t,e){return n[e]&&t.push(e),t},[]);r.length>0&&ps(fs.encodingOverridden(r))}var i=Object.assign(Object.assign({},null!==e&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{});return qa(i).length>0?i:void 0}function Jf(t){var e=t.parentProjection,n=t.projection;return e&&n&&ps(fs.projectionOverridden({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function Qf(t,e){void 0===e&&(e=Df(t.config));var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Zf.map(t,{config:e})}(t,e),r=function(t,e,n){var r=e.width,i=e.height,a=No(t)||Pf(t),o={};a?"container"==r&&"container"==i?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==i&&(o.type="fit-y",o.contains="padding"):("container"==r&&(ps(fs.containerSizeNonSingle("width")),r=void 0),"container"==i&&(ps(fs.containerSizeNonSingle("height")),i=void 0));var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Kf(n.autosize):{}),Kf(t.autosize));if("fit"!==u.type||a||(ps(fs.FIT_NON_SINGLE),u.type="pad"),"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&ps(fs.containerSizeNotCompatibleWithAutosize("width")),"container"==i&&"fit"!=u.type&&"fit-y"!=u.type&&ps(fs.containerSizeNotCompatibleWithAutosize("height")),!Ea(u,{type:"pad"}))return u}(n,{width:t.width,height:t.height,autosize:t.autosize},e);return Object.assign(Object.assign({},n),r?{autosize:r}:{})}var Zf=new(function(t){function e(){var t;return f(this,e),(t=a(this,o(e).apply(this,arguments))).nonFacetUnitNormalizers=[Hc,Jc,rf,new Gf,new Yf,new $f],t}return s(e,zf),h(e,[{key:"map",value:function(t,n){if(No(t)){var r=Sc(t.encoding,Ho),i=Sc(t.encoding,Vo),a=Sc(t.encoding,Go);if(r||i||a)return this.mapFacetedUnit(t,n)}return u(o(e.prototype),"map",this).call(this,t,n)}},{key:"mapUnit",value:function(t,e){var n=e.parentEncoding,r=e.parentProjection;if(n||r)return this.mapUnitWithParentEncodingOrProjection(t,e);var i=this.mapLayerOrUnit.bind(this),a=!0,o=!1,u=void 0;try{for(var s,l=this.nonFacetUnitNormalizers[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(c.hasMatchingType(t,e.config))return c.run(t,e,i)}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return t}},{key:"mapRepeat",value:function(t,e){var n=t.repeat;return!x(n)&&t.columns&&(t=Ca(t,["columns"]),ps(fs.columnsNotSupportByRowCol("repeat"))),Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}},{key:"mapFacet",value:function(t,n){return Ll(t.facet)&&t.columns&&(t=Ca(t,["columns"]),ps(fs.columnsNotSupportByRowCol("facet"))),u(o(e.prototype),"mapFacet",this).call(this,t,n)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(t,e){var n=t.encoding,r=t.projection,i=e.parentEncoding,a=e.parentProjection,o=e.config,u=Jf({parentProjection:a,projection:r}),s=Xf({parentEncoding:i,encoding:n});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(t,e){var n=t.encoding,r=n.row,i=n.column,a=n.facet,o=I(n,["row","column","facet"]),u=t.mark,s=t.width,l=t.projection,c=t.height,f=t.view,h=t.selection,d=(t.encoding,I(t,["mark","width","projection","height","view","selection","encoding"])),p=this.getFacetMappingAndLayout({row:r,column:i,facet:a}),v=p.facetMapping,g=p.layout;return this.mapFacet(Object.assign(Object.assign(Object.assign({},d),g),{facet:v,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),c?{height:c}:{}),f?{view:f}:{}),l?{projection:l}:{}),{mark:u,encoding:o}),h?{selection:h}:{})}),e)}},{key:"getFacetMappingAndLayout",value:function(t){var e,n=t.row,r=t.column,i=t.facet;if(n||r){i&&ps(fs.facetChannelDropped([].concat(d(n?[Ho]:[]),d(r?[Vo]:[]))));for(var a={},o={},u=0,s=[Ho,Vo];u<s.length;u++){var l=s[u],c=t[l];if(c){var f=I(c,["align","center","spacing","columns"]);a[l]=f;for(var h=0,p=["align","center","spacing"];h<p.length;h++){var v=p[h];void 0!==c[v]&&(o[v]=null!==(e=o[v])&&void 0!==e?e:{},o[v][l]=c[v])}}}return{facetMapping:a,layout:o}}var g=i.align,m=i.center,y=i.spacing,b=i.columns;return{facetMapping:I(i,["align","center","spacing","columns"]),layout:Object.assign(Object.assign(Object.assign(Object.assign({},g?{align:g}:{}),m?{center:m}:{}),y?{spacing:y}:{}),b?{columns:b}:{})}}},{key:"mapLayer",value:function(t,n){var r=n.parentEncoding,i=n.parentProjection,a=I(n,["parentEncoding","parentProjection"]),s=t.encoding,l=t.projection,c=I(t,["encoding","projection"]),f=Object.assign(Object.assign({},a),{parentEncoding:Xf({parentEncoding:r,encoding:s}),parentProjection:Jf({parentProjection:i,projection:l})});return u(o(e.prototype),"mapLayer",this).call(this,c,f)}}]),e}());function Kf(t){return w(t)?{type:t}:null!==t&&void 0!==t?t:{}}var th=["background","padding"];function eh(t){return th.reduce(function(e,n){return t&&void 0!==t[n]&&(e[n]=t[n]),e},{})}function nh(t){return!!t.url}function rh(t){return!!t.values}function ih(t){return!!t.name&&!nh(t)&&!rh(t)&&!ah(t)}function ah(t){return t&&(oh(t)||uh(t)||sh(t))}function oh(t){return!!t.sequence}function uh(t){return!!t.sphere}function sh(t){return!!t.graticule}var lh="main",ch="raw";function fh(t){return void 0!==t.filter}function hh(t){return void 0!==t.lookup}function dh(t){return void 0!==t.pivot}function ph(t){return void 0!==t.density}function vh(t){return void 0!==t.quantile}function gh(t){return void 0!==t.regression}function mh(t){return void 0!==t.loess}function yh(t){return void 0!==t.sample}function bh(t){return void 0!==t.window}function xh(t){return void 0!==t.joinaggregate}function _h(t){return void 0!==t.flatten}function wh(t){return void 0!==t.calculate}function kh(t){return!!t.bin}function Ah(t){return void 0!==t.impute}function Eh(t){return void 0!==t.timeUnit}function Mh(t){return void 0!==t.aggregate}function Sh(t){return void 0!==t.stack}function Ch(t){return void 0!==t.fold}function Oh(t,e,n){return Dh=e||Th,Fh=n||Uh,Hh(t.trim()).map(Vh)}var Dh,Fh,Th="view",Nh="[",jh="]",Rh="{",Ph="}",zh=":",Bh=",",Lh="@",qh=">",Ih=/[[\]{}]/,Uh={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function Wh(t,e,n,r,i){for(var a,o=0,u=t.length;e<u;++e){if(a=t[e],!o&&a===n)return e;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return e}function Hh(t){for(var e=[],n=0,r=t.length,i=0;i<r;)i=Wh(t,i,Bh,Nh+Rh,jh+Ph),e.push(t.substring(n,i).trim()),n=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function Vh(t){return"["===t[0]?function(t){var e,n,r=t.length,i=1;if((i=Wh(t,i,jh,Nh,jh))===r)throw"Empty between selector: "+t;if(2!==(e=Hh(t.substring(1,i))).length)throw"Between selector must have two elements: "+t;if((t=t.slice(i+1).trim())[0]!==qh)throw"Expected '>' after between selector: "+t;return e=e.map(Vh),(n=Vh(t.slice(1).trim())).between?{between:e,stream:n}:(n.between=e,n)}(t):function(t){var e,n,r={source:Dh},i=[],a=[0,0],o=0,u=0,s=t.length,l=0;if(t[s-1]===Ph){if(!((l=t.lastIndexOf(Rh))>=0))throw"Unmatched right brace: "+t;try{a=function(t){var e=t.split(Bh);if(!t.length||e.length>2)throw t;return e.map(function(e){var n=+e;if(n!==n)throw t;return n})}(t.substring(l+1,s-1))}catch(c){throw"Invalid throttle specification: "+t}t=t.slice(0,l).trim(),s=t.length,l=0}if(!s)throw t;if(t[0]===Lh&&(o=++l),(e=Wh(t,l,zh))<s&&(i.push(t.substring(u,e).trim()),u=l=++e),(l=Wh(t,l,Nh))===s)i.push(t.substring(u,s).trim());else if(i.push(t.substring(u,l).trim()),n=[],(u=++l)===s)throw"Unmatched left bracket: "+t;for(;l<s;){if((l=Wh(t,l,jh))===s)throw"Unmatched left bracket: "+t;if(n.push(t.substring(u,l).trim()),l<s-1&&t[++l]!==Nh)throw"Expected left bracket: "+t;u=++l}if(!(s=i.length)||Ih.test(i[s-1]))throw"Invalid event selector: "+t;return s>1?(r.type=i[1],o?r.markname=i[0].slice(1):function(t){return Fh[t]}(i[0])?r.marktype=i[0]:r.source=i[0]):r.type=i[0],"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1)),null!=n&&(r.filter=n),a[0]&&(r.throttle=a[0]),a[1]&&(r.debounce=a[1]),r}(t)}function Gh(t,e,n,r){var i=e&&e.condition,a=r(e);if(i){var o=R(i).map(function(e){var n=r(e),i=function(t){return t.selection}(e)?ug(t,e.selection):lg(t,e.test);return Object.assign({test:i},n)});return l({},n,[].concat(d(o),d(void 0!==a?[a]:[])))}return void 0!==a?l({},n,a):{}}function $h(t){var e=t.channel,n=t.channelDef,r=t.markDef,i=t.scale,a=Kh(t);return $l(n)&&!Io(n.aggregate)&&i&&pl(i.get("type"))&&!1===i.get("zero")?Yh({fieldDef:n,channel:e,markDef:r,ref:a}):a}function Yh(t){var e=t.fieldDef,n=t.channel,r=t.markDef,i=t.ref;return Ao(r.type)?i:[Xh(e,n),i]}function Xh(t,e){var n=Jh(t,!0),r="x"===Fu(e)?{value:0}:{field:{group:"height"}};return Object.assign({test:n},r)}function Jh(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return $s(w(t)?t:tc(t,{expr:"datum"}),!e)}function Qh(t,e,n,r){var i=Object.assign(Object.assign({},e?{scale:e}:{}),{field:tc(t,n)});if(r){var a=r.offset,o=r.band;return Object.assign(Object.assign(Object.assign({},i),a?{offset:a}:{}),o?{band:o}:{})}return i}function Zh(t){var e=t.scaleName,n=t.fieldDef,r=t.fieldDef2,i=t.offset,a=t.startSuffix,o=t.band,u=void 0===o?.5:o,s=0<u&&u<1?"datum":void 0,l=tc(n,{expr:s,suffix:a}),c=void 0!==r?tc(r,{expr:s}):tc(n,{suffix:"end",expr:s});if(0===u)return Object.assign({scale:e,field:l},i?{offset:i}:{});if(1===u)return Object.assign({scale:e,field:c},i?{offset:i}:{});var f="".concat(u," * ").concat(l," + ").concat(1-u," * ").concat(c);return Object.assign({signal:'scale("'.concat(e,'", ').concat(f,")")},i?{offset:i}:{})}function Kh(t){var e=t.channel,n=t.channelDef,r=t.channel2Def,i=t.markDef,a=t.config,o=t.scaleName,u=t.scale,s=t.stack,l=t.offset,c=t.defaultRef;if(n){if($l(n)){if(Yl(n)){var f=Wl(e,n,r,i,a,{isMidPoint:!0});if(wc(n.bin)||f&&n.timeUnit)return Ta([$o,Yo],e)&&Ta([Qs,Ks],n.type)?s&&s.impute?Qh(n,o,{binSuffix:"mid"},{offset:l}):Zh({scaleName:o,fieldDef:n,band:f,offset:l}):Qh(n,o,xc(n,e)?{binSuffix:"range"}:{},{offset:l});if(kc(n.bin)){if($l(r))return Zh({scaleName:o,fieldDef:n,fieldDef2:r,band:f,offset:l});var h=e===$o?Xo:Jo;ps(fs.channelRequiredForBinned(h))}}if(u){var d=u.get("type");if(hl(d))return Qh(n,o,{binSuffix:"range"},"band"===d?{band:Ka(Zl(n)?n.band:void 0,.5),offset:l}:{offset:l})}return Qh(n,o,{},{offset:l})}if(Jl(n)){var p=n.value,v=l?{offset:l}:{};return Object.assign(Object.assign({},td(e,p)),v)}if(Ju(n))return n}var g="function"===typeof c?Object.assign(Object.assign({},c()),l?{offset:l}:{}):c;return g?Object.assign(Object.assign({},g),l?{offset:l}:{}):g}function td(t,e){return Ta(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:Ta(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:es(e)}function ed(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.markDef,i=e.encoding,a=e.config,o=n.vgChannel,u=void 0===o?t:o,s=n.defaultRef,l=n.defaultValue;void 0===s&&void 0!==(l=null!==l&&void 0!==l?l:u===t?r[t]:Ka(r[t],r[u],is(t,r,a,{vgChannel:u})))&&(s=es(l));var c=i[t];return Gh(e,c,u,function(n){return Kh({channel:t,channelDef:n,markDef:r,config:a,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s})})}function nd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0},n=t.markDef,r=t.encoding,i=t.config,a=n.type,o=Ka(e.filled,n.filled),u={fill:is("fill",n,i),stroke:is("stroke",n,i),color:is("color",n,i)},s=Ta(["bar","point","circle","square","geoshape"],a)?"transparent":void 0,l=Ka(n.fill,!0===o?n.color:void 0,u.fill,!0===o?u.color:void 0,s),c=Ka(n.stroke,!1===o?n.color:void 0,u.stroke,!1===o?u.color:void 0),f=o?"fill":"stroke",h=Object.assign(Object.assign({},l?{fill:es(l)}:{}),c?{stroke:es(c)}:{});return n.color&&(o?n.fill:n.stroke)&&ps(fs.droppingColor("property",{fill:"fill"in n,stroke:"stroke"in n})),Object.assign(Object.assign(Object.assign(Object.assign({},h),ed("color",t,{vgChannel:f,defaultValue:o?l:c})),ed("fill",t,{defaultValue:r.fill?l:void 0})),ed("stroke",t,{defaultValue:r.stroke?c:void 0}))}function rd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=t.encoding[e];return Gh(t,n,e,function(e){return id(e,t.config)})}function id(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(t){if(Jl(t))return{value:t.value};if(Yl(t)){var r=lc(t);return Cl({fieldDef:t,format:r.format,formatType:r.formatType,expr:n,config:e})}}}function ad(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.encoding,r=t.markDef,i=t.config,a=n.tooltip;return x(a)?{tooltip:od({tooltip:a},i,e)}:Gh(t,a,"tooltip",function(a){var o=id(a,t.config,e.reactiveGeom?"datum.datum":"datum");if(o)return o;if(null!==a){var u=Ka(r.tooltip,is("tooltip",r,i));return!0===u&&(u={content:"encoding"}),w(u)?{value:u}:_(u)?"encoding"===u.content?od(n,i,e):{signal:"datum"}:void 0}})}function od(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).reactiveGeom,r=[],i={},a={},o=n?"datum.datum":"datum",u=[];function s(n,r){var i=Fu(r),s=Yl(n)?n:Object.assign(Object.assign({},n),{type:t[i].type}),l=R(oc(s,e,{allowDisabling:!1})).join(", "),c=id(s,e,o).signal;if("x"===r||"y"===r){var f="x"===r?"x2":"y2",h=cc(t[f]);if(kc(s.bin)&&h){var d=tc(s,{expr:o}),p=tc(h,{expr:o}),v=lc(s);c=Tl(d,p,v.format,v.formatType,e),a[f]=!0}}u.push({channel:r,key:l,value:c})}Tc(t,function(t,e){$l(t)?s(t,e):Gl(t)&&s(t.condition,e)});for(var l=0,c=u;l<c.length;l++){var f=c[l],h=f.channel,d=f.key,p=f.value;a[h]||i[d]||(r.push("".concat(k(d),": ").concat(p)),i[d]=!0)}return r.length>0?{signal:"{".concat(r.join(", "),"}")}:void 0}function ud(t,e){var n=e[t+"Offset"];if(n)return n}function sd(t,e,n){var r=n.defaultPos,i=n.vgChannel,a=e.encoding,o=e.markDef,u=e.config,s=e.stack,c=a[t],f=a[t===$o?Xo:Jo],h=e.scaleName(t),d=e.getScaleComponent(t),p=ud(t,o),v=ld({model:e,defaultPos:r,channel:t,scaleName:h,scale:d}),g=c||!a.latitude&&!a.longitude?function(t){var e=t.channel,n=t.channelDef,r=t.scaleName,i=t.stack,a=t.offset;return $l(n)&&i&&e===i.fieldChannel?Zl(n)&&void 0!==n.band?Zh({scaleName:r,fieldDef:n,startSuffix:"start",band:n.band,offset:0}):Qh(n,r,{suffix:"end"},{offset:a}):$h(t)}({channel:t,channelDef:c,channel2Def:f,markDef:o,config:u,scaleName:h,scale:d,stack:s,offset:p,defaultRef:v}):{field:e.getName(t)};return l({},null!==i&&void 0!==i?i:t,g)}function ld(t){var e=t.model,n=t.defaultPos,r=t.channel,i=t.scaleName,a=t.scale,o=e.markDef,u=e.config;return function(){var t=Fu(r),s=Ka(o[r],is(r,o,u));if(void 0!==s)return td(r,s);if("zeroOrMin"===n||"zeroOrMax"===n){if(i){var l=a.get("type");if(Ta([Xs.LOG,Xs.TIME,Xs.UTC],l));else if(a.domainDefinitelyIncludesZero())return{scale:i,value:0}}return"zeroOrMin"===n?"x"===t?{value:0}:{field:{group:"height"}}:"x"===t?{field:{group:"width"}}:{value:0}}var c=e["x"===t?"width":"height"];return Object.assign(Object.assign({},c),{mult:.5})}}var cd={left:"x",center:"xc",right:"x2"},fd={top:"y",middle:"yc",bottom:"y2"};function hd(t,e,n){var r="x"===t?"align":"baseline",i=Ka(e[r],is(r,e,n));return"x"===t?cd[null!==i&&void 0!==i?i:"center"]:fd[null!==i&&void 0!==i?i:"middle"]}function dd(t,e,n){var r=n.defaultPos,i=n.defaultPos2;return n.range?pd(t,e,{defaultPos:r,defaultPos2:i}):sd(t,e,{defaultPos:r})}function pd(t,e,n){var r=n.defaultPos,i=n.defaultPos2,a=e.markDef,o=e.config,u="x"===t?"width":"height",s=function(t,e,n){var r,i=t.encoding,a=t.mark,o=t.markDef,u=t.stack,s=t.config,c="x2"===n?"x":"y",f="x2"===n?"width":"height",h=i[c],d=t.scaleName(c),p=t.getScaleComponent(c),v=ud(n,t.markDef);if(!h&&(i.latitude||i.longitude))return l({},n,{field:t.getName(n)});var g=function(t){var e=t.channel,n=t.channelDef,r=t.channel2Def,i=t.markDef,a=t.config,o=t.scaleName,u=t.scale,s=t.stack,l=t.offset,c=t.defaultRef;return $l(n)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?Qh(n,o,{suffix:"start"},{offset:l}):$h({channel:e,channelDef:r,scaleName:o,scale:u,stack:s,markDef:i,config:a,offset:l,defaultRef:c})}({channel:n,channelDef:h,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:p,stack:u,offset:v,defaultRef:void 0});if(void 0!==g)return l({},n,g);var m=ld({model:t,defaultPos:e,channel:n,scaleName:d,scale:p})();return Ka(vd(n,o),vd(n,(l(r={},n,as(n,o,s.style)),l(r,f,as(f,o,s.style)),r)),vd(n,s[a]),vd(n,s.mark),l({},n,m))}(e,i,"x"===t?"x2":"y2"),c=s[u]?hd(t,a,o):t;return Object.assign(Object.assign({},sd(t,e,{defaultPos:r,vgChannel:c})),s)}function vd(t,e){var n="x2"===t?"width":"height";return e[t]?l({},t,td(t,e[t])):e[n]?l({},n,{value:e[n]}):void 0}function gd(t,e,n){var r,i,a,o,u=t.config,s=t.encoding,c=t.markDef,f="x"===e?"x2":"y2",h="x"===e?"width":"height",d=s[e],p=s[f],v=t.getScaleComponent(e),g=v?v.get("type"):void 0,m=t.scaleName(e),y=c.orient,b=null!==(o=null!==(a=null!==(i=null!==(r=s[h])&&void 0!==r?r:s.size)&&void 0!==i?i:c[h])&&void 0!==a?a:c.size)&&void 0!==o?o:is("size",c,u,{vgChannel:h}),x="x"===e?"vertical"===y:"horizontal"===y;return $l(d)&&(wc(d.bin)||kc(d.bin)||d.timeUnit&&!p)&&!b&&!hl(g)?function(t){var e,n,r=t.fieldDef,i=t.fieldDef2,a=t.channel,o=t.band,u=t.scaleName,s=t.markDef,c=t.spacing,f=void 0===c?0:c,h=t.reverse,d=a===$o?Xo:Jo;return wc(r.bin)||r.timeUnit?(l(e={},d,xd({channel:a,fieldDef:r,scaleName:u,markDef:s,band:(1-o)/2,offset:bd(d,f,h)})),l(e,a,xd({channel:a,fieldDef:r,scaleName:u,markDef:s,band:1-(1-o)/2,offset:bd(a,f,h)})),e):kc(r.bin)&&$l(i)?(l(n={},d,Qh(r,u,{},{offset:bd(d,f,h)})),l(n,a,Qh(i,u,{},{offset:bd(a,f,h)})),n):void ps(fs.channelRequiredForBinned(d))}({fieldDef:d,fieldDef2:p,channel:e,markDef:c,scaleName:m,band:Wl(e,d,void 0,c,u),spacing:Ka(c.binSpacing,u[n].binSpacing),reverse:v.get("reverse")}):($l(d)&&hl(g)||x)&&!p?$l(d)&&g===Xs.BAND?function(t,e,n,r){var i,a=n.scaleName(e),o="x"===e?"width":"height",u=n.markDef,s=n.encoding,c=n.config,f=hd(e,u,c),h=ud(e,u),d=l({},f,Qh(t,a,{},{band:.5,offset:h}));if(s.size||null!==u.size&&void 0!==u.size)if(u.orient){if(fc(s.size)||Jl(s.size))return Object.assign(Object.assign({},d),ed("size",n,{vgChannel:o}));if(void 0!==u.size)return Object.assign(Object.assign({},d),l({},o,{value:u.size}))}else ps(fs.cannotApplySizeToNonOrientedMark(u.type));if(void 0!==(null===r||void 0===r?void 0:r.value))return Object.assign(Object.assign({},d),l({},o,r));var p=t.band,v=void 0===p?1:p;return l(i={},e,Qh(t,a,{binSuffix:"range"},{band:(1-v)/2,offset:h})),l(i,o,null!==r&&void 0!==r?r:yd(a,v)),i}(d,e,t,md(n,c,h,m,v,u,Zl(d)?d.band:void 0)):function(t,e,n){var r="x"===t?"xc":"yc",i="x"===t?"width":"height";return Object.assign(Object.assign({},sd(t,e,{defaultPos:"mid",vgChannel:r})),ed("size",e,{defaultRef:n,vgChannel:i}))}(e,t,md(n,c,h,m,v,u)):pd(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function md(t,e,n,r,i,a,o){var u=Ka(e[n],e.size,is("size",e,a,{vgChannel:n}));if(void 0!==u)return es(u);if(i){var s=i.get("type");if("point"===s||"band"===s){if(void 0!==a[t].discreteBandSize)return{value:a[t].discreteBandSize};if(s===Xs.POINT){var l=i.get("range");return Qu(l)&&L(l.step)?{value:l.step-2}:{value:Ef-2}}return yd(r,o)}return{value:a[t].continuousBandSize}}var c=kf(a.view,n);return{value:Ka(a[t].discreteBandSize,c-2)}}function yd(t){return{scale:t,band:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]}}function bd(t,e,n){return Ju(n)?"x"===t||"y2"===t?{signal:"".concat(n.signal," ? ").concat(e," : 0")}:{signal:"".concat(n.signal," ? 0 : ").concat(e)}:{x:n?e:0,x2:n?0:e,y:n?0:e,y2:n?e:0}[t]}function xd(t){var e=t.channel,n=t.fieldDef,r=t.scaleName;return Yh({fieldDef:n,channel:e,markDef:t.markDef,ref:Zh({scaleName:r,fieldDef:n,band:t.band,offset:t.offset})})}function _d(t,e){var n="include"===e.color?nd(t):{},r=n.fill,i=void 0===r?void 0:r,a=n.stroke,o=void 0===a?void 0:a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return Ku.reduce(function(n,r){return void 0!==t[r]&&"ignore"!==e[r]&&(n[r]={value:t[r]}),n},{})}(t.markDef,e)),wd(t,"fill",i)),wd(t,"stroke",o)),ed("opacity",t)),ed("fillOpacity",t)),ed("strokeOpacity",t)),ed("strokeWidth",t)),ed("strokeDash",t)),ad(t)),rd(t,"href"))}function wd(t,e,n){var r=t.config,i=t.mark;if("hide"===rs("invalid",t.markDef,r)&&n&&!Ao(i)){var a=function(t,e){var n=e.invalid,r=void 0!==n&&n,i=e.channels.reduce(function(e,n){var r=t.getScaleComponent(n);if(r){var i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&dl(i)&&(e[a]=!0)}return e},{}),a=qa(i);if(a.length>0){var o=r?"||":"&&";return a.map(function(t){return Jh(t,r)}).join(" ".concat(o," "))}}(t,{invalid:!0,channels:Uu});if(a)return l({},e,[{test:a,value:null}].concat(d(R(n))))}return n?l({},e,n):{}}function kd(t){var e=t.config;if(rs("invalid",t.markDef,e)){var n=function(t,e){var n=e.invalid,r=void 0!==n&&n,i=e.channels.reduce(function(e,n){var r=t.getScaleComponent(n);if(r){var i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&dl(i)&&(e[a]=!0)}return e},{}),a=qa(i);if(a.length>0){var o=r?"||":"&&";return a.map(function(t){return Jh(t,r)}).join(" ".concat(o," "))}}(t,{channels:["x","y"]});if(n)return{defined:{signal:n}}}return{}}function Ad(t,e){if(void 0!==e)return l({},t,{value:e})}var Ed={has:function(t){return"interval"!==t.type&&t.nearest},parse:function(t,e){if(e.events){var n=!0,r=!1,i=void 0;try{for(var a,o=e.events[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)a.value.markname=t.getName("voronoi")}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}},marks:function(t,e,n){var r=e.project.hasChannel,i=r.x,a=r.y,o=t.mark;if(Ao(o))return ps(fs.nearestNotSupportForContinuous(o)),n;var u={name:t.getName("voronoi"),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},ad(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!a?"datum.datum.x || 0":"0"},y:{expr:a||!i?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]},s=0,l=!1;return n.forEach(function(e,n){var r,i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf("voronoi")>=0&&(l=!0)}),l||n.splice(s+1,0,u),n}},Md=function(){function t(e,n){f(this,t),this.debugName=n,this._children=[],this._parent=null,e&&(this.parent=e)}return h(t,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(t,e){this._children.indexOf(t)>-1?console.warn("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return this._children.splice(e,1),e}},{key:"remove",value:function(){var t=this._parent.removeChild(this),e=!0,n=!1,r=void 0;try{for(var i,a=this._children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o._parent=this._parent,this._parent.addChild(o,t++)}}catch(u){n=!0,r=u}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"insertAsParentOf",value:function(t){var e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}},{key:"swapWithParent",value:function(){var t=this._parent,e=t.parent,n=!0,r=!1,i=void 0;try{for(var a,o=this._children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)a.value.parent=t}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t,t&&t.addChild(this)}},{key:"children",get:function(){return this._children}}]),t}(),Sd=function(t){function e(t,n,r,i){var u;return f(this,e),(u=a(this,o(e).call(this,t,n))).type=r,u.refCounts=i,u._source=u._name=n,!u.refCounts||u._name in u.refCounts||(u.refCounts[u._name]=0),u}return s(e,Md),h(e,[{key:"clone",value:function(){var t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(function(t){var e=++to;return t?String(t)+e:e}())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(t){this._source=t}}]),e}(),Cd=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).formula=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.formula))}},{key:"merge",value:function(t){for(var e in this.formula=Object.assign({},this.formula),t.formula)this.formula[e]&&!t.formula[e].band||(this.formula[e]=t.formula[e]);var n=!0,r=!1,i=void 0;try{for(var a,o=t.children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;t.removeChild(u),u.parent=this}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}t.remove()}},{key:"producedFields",value:function(){return new Set(Ia(this.formula).map(function(t){return t.as}))}},{key:"dependentFields",value:function(){return new Set(Ia(this.formula).map(function(t){return t.field}))}},{key:"hash",value:function(){return"TimeUnit ".concat(Da(this.formula))}},{key:"assemble",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,a=Ia(this.formula)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=o.field,s=o.as,l=Rs(o.timeUnit),c=l.unit,f=l.utc,h=I(l,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:u,type:"timeunit"},c?{units:Fs(c)}:{}),f?{timezone:"utc"}:{}),h),{as:[s,"".concat(s,"_end")]}))}}catch(d){n=!0,r=d}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}}],[{key:"makeFromEncoding",value:function(t,n){var r=n.reduceFieldDef(function(t,e,r){var i=e.field,a=e.timeUnit,o=Ly(n)?n.encoding[Tu(r)]:void 0,u=Ly(n)&&Hl(r,e,o,n.markDef,n.config);if(a){var s=tc(e,{forAs:!0});t[Da({as:s,field:i,timeUnit:a})]=Object.assign({as:s,field:i,timeUnit:a},u?{band:!0}:{})}return t},{});return 0===qa(r).length?null:new e(t,r)}},{key:"makeFromTransform",value:function(t,n){var r=Object.assign({},n),i=r.timeUnit,a=I(r,["timeUnit"]),o=Rs(i),u=Object.assign(Object.assign({},a),{timeUnit:o});return new e(t,l({},Da(u),u))}}]),e}(),Od="_tuple_fields",Dd=function t(){f(this,t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.items=n,this.hasChannel={},this.hasField={}},Fd={has:function(t){return"single"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!df(t.bind)},parse:function(t,e,n,r){r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:function(t,e,n){var r=e.name,i=e.project,a=e.bind,o=e.init&&e.init[0],u=Ed.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(function(t,i){var s,l,c=Wa("".concat(r,"_").concat(t.field));n.filter(function(t){return t.name===c}).length||n.unshift(Object.assign(Object.assign({name:c},o?{init:Yd(o[i])}:{value:null}),{on:e.events?[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(k(t.field),"] : null")}]:[],bind:null!==(l=null!==(s=a[t.field])&&void 0!==s?s:a[t.channel])&&void 0!==l?l:a}))}),n},signals:function(t,e,n){var r=e.name,i=e.project,a=n.filter(function(t){return t.name===r+ap})[0],o=r+Od,u=i.items.map(function(t){return Wa("".concat(r,"_").concat(t.field))}),s=u.map(function(t){return"".concat(t," !== null")}).join(" && ");return u.length&&(a.update="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")),delete a.value,delete a.on,n}},Td={has:function(t){return"multi"===t.type&&!!t.toggle},signals:function(t,e,n){return n.concat({name:e.name+"_toggle",value:!1,on:[{events:e.events,update:e.toggle}]})},modifyExpr:function(t,e){var n=e.name+ap,r=e.name+"_toggle";return"".concat(r," ? null : ").concat(n,", ")+("global"===e.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(cp(t),"}, "))+"".concat(r," ? ").concat(n," : null")}},Nd={has:function(t){return void 0!==t.clear&&!1!==t.clear},parse:function(t,e,n){n.clear&&(e.clear=w(n.clear)?Oh(n.clear,"scope"):n.clear)},topLevelSignals:function(t,e,n){return Fd.has(e)&&e.project.items.forEach(function(t){var r=n.findIndex(function(n){return n.name===Wa("".concat(e.name,"_").concat(t.field))});-1!==r&&n[r].on.push({events:e.clear,update:"null"})}),n},signals:function(t,e,n){function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)e.project.items.forEach(function(t){var e=n.findIndex(function(e){return e.name===t.signals.visual});r(e,"[0, 0]"),-1===e&&r(n.findIndex(function(e){return e.name===t.signals.data}),"null")});else{var i=n.findIndex(function(t){return t.name===e.name+ap});r(i,"null"),Td.has(e)&&r(i=n.findIndex(function(t){return t.name===e.name+"_toggle"}),"false")}return n}},jd={has:function(t){return"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind},parse:function(t,e){var n=e.scales=[],r=!0,i=!1,a=void 0;try{for(var o,u=e.project.items[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=s.channel;if(Wu(l)){var c=t.getScaleComponent(l),f=c?c.get("type"):void 0;if(c&&dl(f)){var h={selection:e.name,field:s.field};c.set("selectionExtent",h,!0),n.push(s),t.repeater&&t.repeater.row===t.repeater.column&&t.getScaleComponent(l===$o?Yo:$o).set("selectionExtent",h,!0)}else ps(fs.SCALE_BINDINGS_CONTINUOUS)}}}catch(d){i=!0,a=d}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}},topLevelSignals:function(t,e,n){var r=e.scales.filter(function(t){return 0===n.filter(function(e){return e.name===t.signals.data}).length});if(!t.parent||Pd(t)||0===r.length)return n;var i=n.filter(function(t){return t.name===e.name})[0],a=i.update;if(a.indexOf(up)>=0)i.update="{".concat(r.map(function(t){return"".concat(k(t.field),": ").concat(t.signals.data)}).join(", "),"}");else{var o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value,h="".concat(k(f.field),": ").concat(f.signals.data);a.indexOf(h)<0&&(a="".concat(a.substring(0,a.length-1),", ").concat(h,"}"))}}catch(d){u=!0,s=d}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}i.update=a}return n.concat(r.map(function(t){return{name:t.signals.data}}))},signals:function(t,e,n){if(t.parent&&!Pd(t)){var r=!0,i=!1,a=void 0;try{for(var o,u=function(){var t=o.value,e=n.filter(function(e){return e.name===t.signals.data})[0];e.push="outer",delete e.value,delete e.update},s=e.scales[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u()}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}return n}};function Rd(t,e){var n=k(t.scaleName(e));return"domain(".concat(n,")")}function Pd(t){var e;return t.parent&&Wy(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:Pd(t.parent.parent))}var zd={has:function(t){var e="global"===t.resolve&&t.bind&&df(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==ff;return e&&!n&&ps(fs.LEGEND_BINDINGS_PROJECT_LENGTH),e&&n},parse:function(t,e,n,r){var i;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){var a='event.item && indexof(event.item.mark.role, "legend") < 0',o=!0,u=!1,s=void 0;try{for(var l,c=e.events[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;f.filter=R(null!==(i=f.filter)&&void 0!==i?i:[]),f.filter.indexOf(a)<0&&f.filter.push(a)}}catch(p){u=!0,s=p}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}}var h=pf(e.bind)?e.bind.legend:"click",d=w(h)?Oh(h,"view"):R(h);e.bind={legend:{merge:d}}},topLevelSignals:function(t,e,n){var r=e.name,i=pf(e.bind)&&e.bind.legend,a=function(t){return function(e){var n=Ma(e);return n.markname=t,n}},o=!0,u=!1,s=void 0;try{for(var l,c=function(){var t=l.value;if(!t.hasLegend)return"continue";var o="".concat(Wa(t.field),"_legend"),u="".concat(r,"_").concat(o);if(0===n.filter(function(t){return t.name===u}).length){var s=i.merge.map(a("".concat(o,"_symbols"))).concat(i.merge.map(a("".concat(o,"_labels")))).concat(i.merge.map(a("".concat(o,"_entries"))));n.unshift(Object.assign(Object.assign({name:u},e.init?{}:{value:null}),{on:[{events:s,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(u),force:!0}]}))}},f=e.project.items[Symbol.iterator]();!(o=(l=f.next()).done);o=!0)c()}catch(h){u=!0,s=h}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}return n},signals:function(t,e,n){var r=e.name,i=e.project,a=n.find(function(t){return t.name===r+ap}),o=r+Od,u=i.items.filter(function(t){return t.hasLegend}).map(function(t){return Wa("".concat(r,"_").concat(Wa(t.field),"_legend"))}),s=u.map(function(t){return"".concat(t," !== null")}).join(" && "),l="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null");e.events&&u.length>0?a.on.push({events:u.map(function(t){return{signal:t}}),update:l}):u.length>0&&(a.update=l,delete a.value,delete a.on);var c=n.find(function(t){return t.name===r+"_toggle"}),f=pf(e.bind)&&e.bind.legend;return c&&(e.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}},Bd="_translate_anchor",Ld="_translate_delta",qd={has:function(t){return"interval"===t.type&&t.translate},signals:function(t,e,n){var r=e.name,i=jd.has(e),a=r+Bd,o=e.project.hasChannel,u=o.x,s=o.y,l=Oh(e.translate,"scope");return i||(l=l.map(function(t){return t.between[0].markname=r+Qd,t})),n.push({name:a,value:{},on:[{events:l.map(function(t){return t.between[0]}),update:"{x: x(unit), y: y(unit)"+(void 0!==u?", extent_x: "+(i?Rd(t,$o):"slice(".concat(u.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(i?Rd(t,Yo):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+Ld,value:{},on:[{events:l,update:"{x: ".concat(a,".x - x(unit), y: ").concat(a,".y - y(unit)}")}]}),void 0!==u&&Id(t,e,u,"width",n),void 0!==s&&Id(t,e,s,"height",n),n}};function Id(t,e,n,r,i){var a,o=e.name,u=o+Bd,s=o+Ld,l=n.channel,c=jd.has(e),f=i.filter(function(t){return t.name===n.signals[c?"data":"visual"]})[0],h=t.getSizeSignalRef(r).signal,d=t.getScaleComponent(l),p=d.get("type"),v=c&&l===$o?"-":"",g="".concat(u,".extent_").concat(l),m="".concat(v).concat(s,".").concat(l," / ")+(c?"".concat(h):"span(".concat(g,")")),y="".concat(c?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(g,", ").concat(m)+(c&&"pow"===p?", ".concat(null!==(a=d.get("exponent"))&&void 0!==a?a:1):"")+")";f.on.push({events:{signal:s},update:c?y:"clampRange(".concat(y,", 0, ").concat(h,")")})}var Ud="_zoom_anchor",Wd="_zoom_delta",Hd={has:function(t){return"interval"===t.type&&t.zoom},signals:function(t,e,n){var r=e.name,i=jd.has(e),a=r+Wd,o=e.project.hasChannel,u=o.x,s=o.y,l=k(t.scaleName($o)),c=k(t.scaleName(Yo)),f=Oh(e.zoom,"scope");return i||(f=f.map(function(t){return t.markname=r+Qd,t})),n.push({name:r+Ud,on:[{events:f,update:i?"{"+[l?"x: invert(".concat(l,", x(unit))"):"",c?"y: invert(".concat(c,", y(unit))"):""].filter(function(t){return!!t}).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==u&&Vd(t,e,u,"width",n),void 0!==s&&Vd(t,e,s,"height",n),n}};function Vd(t,e,n,r,i){var a,o=e.name,u=n.channel,s=jd.has(e),l=i.filter(function(t){return t.name===n.signals[s?"data":"visual"]})[0],c=t.getSizeSignalRef(r).signal,f=t.getScaleComponent(u),h=f.get("type"),d=s?Rd(t,u):l.name,p=o+Wd,v="".concat(o).concat(Ud,".").concat(u),g="".concat(s?"log"===h?"zoomLog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear","(").concat(d,", ").concat(v,", ").concat(p)+(s&&"pow"===h?", ".concat(null!==(a=f.get("exponent"))&&void 0!==a?a:1):"")+")";l.on.push({events:{signal:p},update:s?g:"clampRange(".concat(g,", 0, ").concat(c,")")})}var Gd=[{has:function(){return!0},parse:function(t,e,n){var r,i,a,o=e.name,u=null!==(r=e.project)&&void 0!==r?r:e.project=new Dd,s={},c={},f=new Set,h=function(t,e){for(var n="visual"===e?t.channel:t.field,r=Wa("".concat(o,"_").concat(n)),i=1;f.has(r);i++)r=Wa("".concat(o,"_").concat(n,"_").concat(i));return f.add(r),l({},e,r)};if(!n.fields&&!n.encodings){var d=t.config.selection[n.type];if(n.init){var p=!0,v=!1,g=void 0;try{for(var m,y=R(n.init)[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value,x=!0,_=!1,w=void 0;try{for(var k,A=qa(b)[Symbol.iterator]();!(x=(k=A.next()).done);x=!0){var E=k.value;Su[E]?(n.encodings||(n.encodings=[])).push(E):"interval"===n.type?(ps('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(E)}}catch($){_=!0,w=$}finally{try{x||null==A.return||A.return()}finally{if(_)throw w}}}}catch($){v=!0,g=$}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}}else n.encodings=d.encodings,n.fields=d.fields}var M=!0,S=!1,C=void 0;try{for(var O,D=(null!==(i=n.fields)&&void 0!==i?i:[])[Symbol.iterator]();!(M=(O=D.next()).done);M=!0){var F=O.value,T={type:"E",field:F};T.signals=Object.assign({},h(T,"data")),u.items.push(T),u.hasField[F]=T}}catch($){S=!0,C=$}finally{try{M||null==D.return||D.return()}finally{if(S)throw C}}var N=!0,j=!1,P=void 0;try{for(var z,B=(null!==(a=n.encodings)&&void 0!==a?a:[])[Symbol.iterator]();!(N=(z=B.next()).done);N=!0){var L=z.value,q=t.fieldDef(L);if(q){var I=q.field;if(q.aggregate){ps(fs.cannotProjectAggregate(L,q.aggregate));continue}if(!I){ps(fs.cannotProjectOnChannelWithoutField(L));continue}if(q.timeUnit){I=t.vgField(L);var U={timeUnit:q.timeUnit,as:I,field:q.field};c[Da(U)]=U}if(!s[I]){var W="E";"interval"===e.type?dl(t.getScaleComponent(L).get("type"))&&(W="R"):q.bin&&(W="R-RE");var H={field:I,channel:L,type:W};H.signals=Object.assign(Object.assign({},h(H,"data")),h(H,"visual")),u.items.push(s[I]=H),u.hasField[I]=u.hasChannel[L]=s[I]}}else ps(fs.cannotProjectOnChannelWithoutField(L))}}catch($){j=!0,P=$}finally{try{N||null==B.return||B.return()}finally{if(j)throw P}}if(n.init){var V=function(t){return u.items.map(function(e){return void 0!==t[e.channel]?t[e.channel]:t[e.field]})};if("interval"===n.type)e.init=V(n.init);else{var G=R(n.init);e.init=G.map(V)}}qa(c).length>0&&(u.timeUnit=new Cd(null,c))},signals:function(t,e,n){var r=e.name+Od;return n.filter(function(t){return t.name===r}).length>0?n:n.concat({name:r,value:e.project.items.map(function(t){var e=I(t,["signals","hasLegend"]),n=Ma(e);return n.field=Xa(n.field),n})})}},Td,jd,zd,qd,Hd,Fd,Ed,Nd];function $d(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=Gd[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.has(t)&&e(u)}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}function Yd(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E;if(x(t)){var r=t.map(function(t){return Yd(t,e,n)});return e?"[".concat(r.join(", "),"]"):r}return gs(t)?n(e?ks(t):function(t){var e=ws(t,!0);return t.utc?+new Date(Date.UTC.apply(Date,d(e))):+c(Date,d(e))}(t)):e?n(JSON.stringify(t)):t}function Xd(t,e){return lp(t,function(n,r){e=r.marks?r.marks(t,n,e):e,$d(n,function(r){r.marks&&(e=r.marks(t,n,e))})}),e}function Jd(t){return t.map(function(t){return t.on&&!t.on.length&&delete t.on,t})}var Qd="_brush",Zd="_scale_trigger",Kd={signals:function(t,e){var n=e.name,r=n+Od,i=jd.has(e),a=[],o=[],u=[];if(e.translate&&!i){var s="!event.item || event.item.mark.name !== ".concat(k(n+Qd));tp(e,function(t,e){var n,r=R(null!==(n=e.between[0].filter)&&void 0!==n?n:e.between[0].filter=[]);return r.indexOf(s)<0&&r.push(s),t})}e.project.items.forEach(function(n,r){var i=n.channel;if(i===$o||i===Yo){var s=e.init?e.init[r]:null,l=function(t,e,n,r){var i=n.channel,a=n.signals.visual,o=n.signals.data,u=jd.has(e),s=k(t.scaleName(i)),l=t.getScaleComponent(i),c=l?l.get("type"):void 0,f=function(t){return"scale(".concat(s,", ").concat(t,")")},h=t.getSizeSignalRef(i===$o?"width":"height").signal,p="".concat(i,"(unit)"),v=tp(e,function(t,e){return[].concat(d(t),[{events:e.between[0],update:"[".concat(p,", ").concat(p,"]")},{events:e,update:"[".concat(a,"[0], clamp(").concat(p,", 0, ").concat(h,")]")}])});return v.push({events:{signal:e.name+Zd},update:dl(c)?"[".concat(f("".concat(o,"[0]")),", ").concat(f("".concat(o,"[1]")),"]"):"[0, 0]"}),u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:Yd(r,!0,f)}:{value:[]}),{on:v}),Object.assign(Object.assign({name:o},r?{init:Yd(r)}:{}),{on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(s,", ").concat(a,")")}]})]}(t,e,n,s),c=n.signals.data,f=n.signals.visual,h=k(t.scaleName(i)),p=dl(t.getScaleComponent(i).get("type"))?"+":"";a.push.apply(a,d(l)),o.push(c),u.push({scaleName:t.scaleName(i),expr:"(!isArray(".concat(c,") || ")+"(".concat(p,"invert(").concat(h,", ").concat(f,")[0] === ").concat(p).concat(c,"[0] && ")+"".concat(p,"invert(").concat(h,", ").concat(f,")[1] === ").concat(p).concat(c,"[1]))")})}else ps("Interval selections only support x and y encoding channels.")}),i||a.push({name:n+Zd,value:{},on:[{events:u.map(function(t){return{scale:t.scaleName}}),update:u.map(function(t){return t.expr}).join(" && ")+" ? ".concat(n+Zd," : {}")}]});var l=e.init,c="unit: ".concat(cp(t),", fields: ").concat(r,", values");return a.concat(Object.assign(Object.assign({name:n+ap},l?{init:"{".concat(c,": ").concat(Yd(l),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(c,": [").concat(o,"]} : null")}]}))},modifyExpr:function(t,e){return e.name+ap+", "+("global"===e.resolve?"true":"{unit: ".concat(cp(t),"}"))},marks:function(t,e,n){var r=e.name,i=e.project.hasChannel,a=i.x,o=i.y,u=a&&a.signals.visual,s=o&&o.signals.visual,l="data(".concat(k(e.name+ip),")");if(jd.has(e))return n;var c={x:void 0!==a?{signal:"".concat(u,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==a?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===e.resolve){var f=!0,h=!1,p=void 0;try{for(var v,g=qa(c)[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var m=v.value;c[m]=[Object.assign({test:"".concat(l,".length && ").concat(l,"[0].unit === ").concat(cp(t))},c[m]),{value:0}]}}catch(E){h=!0,p=E}finally{try{f||null==g.return||g.return()}finally{if(h)throw p}}}var y=e.mark,b=y.fill,x=y.fillOpacity,_=y.cursor,w=I(y,["fill","fillOpacity","cursor"]),A=qa(w).reduce(function(t,e){return t[e]=[{test:[void 0!==a&&"".concat(u,"[0] !== ").concat(u,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter(function(t){return t}).join(" && "),value:w[e]},{value:null}],t},{});return[{name:r+Qd+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:b},fillOpacity:{value:x}},update:c}}].concat(d(n),[{name:r+Qd,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},_?{cursor:{value:_}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},c),A)}}])}};function tp(t,e){return t.events.reduce(function(t,n){return n.between?e(t,n):(ps("".concat(n," is not an ordered event stream for interval selections.")),t)},[])}function ep(t,e){var n=e.name,r=n+Od,i=e.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(function(e){var n=t.fieldDef(e.channel);return n&&n.bin?"[".concat(a,"[").concat(k(t.vgField(e.channel,{})),"], ")+"".concat(a,"[").concat(k(t.vgField(e.channel,{binSuffix:"end"})),"]]"):"".concat(a,"[").concat(k(e.field),"]")}).join(", "),u="unit: ".concat(cp(t),", fields: ").concat(r,", values"),s=e.events;return[{name:n+ap,on:s?[{events:s,update:"datum && item().mark.marktype !== 'group' ? {".concat(u,": [").concat(o,"]} : null"),force:!0}]:[]}]}var np={signals:ep,modifyExpr:function(t,e){return e.name+ap+", "+("global"===e.resolve?"null":"{unit: ".concat(cp(t),"}"))}},rp={signals:ep,modifyExpr:function(t,e){return e.name+ap+", "+("global"===e.resolve?"true":"{unit: ".concat(cp(t),"}"))}},ip="_store",ap="_tuple",op="_modify",up="vlSelectionResolve",sp={single:rp,multi:np,interval:Kd};function lp(t,e){var n=t.component.selection;if(n){var r=!0,i=!1,a=void 0;try{for(var o,u=Ia(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(!0===e(s,sp[s.type]))break}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}}function cp(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0}).escape?k(t.name):t.name,n=function(t){for(var e=t.parent;e&&!qy(e);)e=e.parent;return e}(t);if(n){var r=n.facet,i=!0,a=!1,o=void 0;try{for(var u,s=ku[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;r[l]&&(e+=" + '__facet_".concat(l,"_' + (facet[").concat(k(n.vgField(l)),"])"))}}catch(c){a=!0,o=c}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}return e}function fp(t){var e=!1;return lp(t,function(t){e=e||t.project.items.some(function(t){return t.field===ff})}),e}var hp,dp,pp,vp,gp,mp="RawCode",yp="Literal",bp="Property",xp="Identifier",_p="ArrayExpression",wp="BinaryExpression",kp="CallExpression",Ap="ConditionalExpression",Ep="LogicalExpression",Mp="MemberExpression",Sp="ObjectExpression",Cp="UnaryExpression";function Op(t){this.type=t}Op.prototype.visit=function(t){var e,n,r;if(t(this))return 1;for(n=0,r=(e=function(t){switch(t.type){case _p:return t.elements;case wp:case Ep:return[t.left,t.right];case kp:var e=t.arguments.slice();return e.unshift(t.callee),e;case Ap:return[t.test,t.consequent,t.alternate];case Mp:return[t.object,t.property];case Sp:return t.properties;case bp:return[t.key,t.value];case Cp:return[t.argument];case xp:case yp:case mp:default:return[]}}(this)).length;n<r;++n)if(e[n].visit(t))return 1};var Dp=1,Fp=2,Tp=3,Np=4,jp=5,Rp=6,Pp=7,zp=8;(hp={})[Dp]="Boolean",hp[Fp]="<end>",hp[Tp]="Identifier",hp[Np]="Keyword",hp[jp]="Null",hp[Rp]="Numeric",hp[Pp]="Punctuator",hp[zp]="String",hp[9]="RegularExpression";var Bp="ArrayExpression",Lp="BinaryExpression",qp="CallExpression",Ip="ConditionalExpression",Up="Identifier",Wp="Literal",Hp="LogicalExpression",Vp="MemberExpression",Gp="ObjectExpression",$p="Property",Yp="UnaryExpression",Xp="Unexpected token %0",Jp="Unexpected number",Qp="Unexpected string",Zp="Unexpected identifier",Kp="Unexpected reserved word",tv="Unexpected end of input",ev="Invalid regular expression",nv="Invalid regular expression: missing /",rv="Octal literals are not allowed in strict mode.",iv="Duplicate data property in object literal not allowed in strict mode",av="ILLEGAL",ov="Disabled.",uv=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),sv=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function lv(t,e){if(!t)throw new Error("ASSERT: "+e)}function cv(t){return t>=48&&t<=57}function fv(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function hv(t){return"01234567".indexOf(t)>=0}function dv(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function pv(t){return 10===t||13===t||8232===t||8233===t}function vv(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&uv.test(String.fromCharCode(t))}function gv(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&sv.test(String.fromCharCode(t))}var mv={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function yv(){for(var t;pp<vp&&(dv(t=dp.charCodeAt(pp))||pv(t));)++pp}function bv(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)pp<vp&&fv(dp[pp])?(r=dp[pp++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Rv({},Xp,av);return String.fromCharCode(i)}function xv(){var t,e,n,r;for(e=0,"}"===(t=dp[pp])&&Rv({},Xp,av);pp<vp&&fv(t=dp[pp++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&Rv({},Xp,av),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function _v(){var t,e;for(t=dp.charCodeAt(pp++),e=String.fromCharCode(t),92===t&&(117!==dp.charCodeAt(pp)&&Rv({},Xp,av),++pp,(t=bv("u"))&&"\\"!==t&&vv(t.charCodeAt(0))||Rv({},Xp,av),e=t);pp<vp&&gv(t=dp.charCodeAt(pp));)++pp,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==dp.charCodeAt(pp)&&Rv({},Xp,av),++pp,(t=bv("u"))&&"\\"!==t&&gv(t.charCodeAt(0))||Rv({},Xp,av),e+=t);return e}function wv(){var t,e;return t=pp,{type:1===(e=92===dp.charCodeAt(pp)?_v():function(){var t,e;for(t=pp++;pp<vp;){if(92===(e=dp.charCodeAt(pp)))return pp=t,_v();if(!gv(e))break;++pp}return dp.slice(t,pp)}()).length?Tp:mv.hasOwnProperty(e)?Np:"null"===e?jp:"true"===e||"false"===e?Dp:Tp,value:e,start:t,end:pp}}function kv(){var t,e,n,r,i=pp,a=dp.charCodeAt(pp),o=dp[pp];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++pp,{type:Pp,value:String.fromCharCode(a),start:i,end:pp};default:if(61===(t=dp.charCodeAt(pp+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return pp+=2,{type:Pp,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:pp};case 33:case 61:return pp+=2,61===dp.charCodeAt(pp)&&++pp,{type:Pp,value:dp.slice(i,pp),start:i,end:pp}}}return">>>="===(r=dp.substr(pp,4))?{type:Pp,value:r,start:i,end:pp+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:Pp,value:n,start:i,end:pp+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:Pp,value:e,start:i,end:pp+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:Pp,value:o,start:i,end:++pp}:void Rv({},Xp,av)}function Av(){var t,e,n;if(lv(cv((n=dp[pp]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=pp,t="","."!==n){if(t=dp[pp++],n=dp[pp],"0"===t){if("x"===n||"X"===n)return++pp,function(t){for(var e="";pp<vp&&fv(dp[pp]);)e+=dp[pp++];return 0===e.length&&Rv({},Xp,av),vv(dp.charCodeAt(pp))&&Rv({},Xp,av),{type:Rp,value:parseInt("0x"+e,16),start:t,end:pp}}(e);if(hv(n))return function(t){for(var e="0"+dp[pp++];pp<vp&&hv(dp[pp]);)e+=dp[pp++];return(vv(dp.charCodeAt(pp))||cv(dp.charCodeAt(pp)))&&Rv({},Xp,av),{type:Rp,value:parseInt(e,8),octal:!0,start:t,end:pp}}(e);n&&cv(n.charCodeAt(0))&&Rv({},Xp,av)}for(;cv(dp.charCodeAt(pp));)t+=dp[pp++];n=dp[pp]}if("."===n){for(t+=dp[pp++];cv(dp.charCodeAt(pp));)t+=dp[pp++];n=dp[pp]}if("e"===n||"E"===n)if(t+=dp[pp++],"+"!==(n=dp[pp])&&"-"!==n||(t+=dp[pp++]),cv(dp.charCodeAt(pp)))for(;cv(dp.charCodeAt(pp));)t+=dp[pp++];else Rv({},Xp,av);return vv(dp.charCodeAt(pp))&&Rv({},Xp,av),{type:Rp,value:parseFloat(t),start:e,end:pp}}function Ev(){var t,e,n,r;return gp=null,yv(),t=pp,e=function(){var t,e,n,r;for(lv("/"===(t=dp[pp]),"Regular expression literal must start with a slash"),e=dp[pp++],n=!1,r=!1;pp<vp;)if(e+=t=dp[pp++],"\\"===t)pv((t=dp[pp++]).charCodeAt(0))&&Rv({},nv),e+=t;else if(pv(t.charCodeAt(0)))Rv({},nv);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||Rv({},nv),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";pp<vp&&gv((t=dp[pp]).charCodeAt(0));)++pp,"\\"===t&&pp<vp?Rv({},Xp,av):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&Rv({},ev,n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e){if(parseInt(e,16)<=1114111)return"x";Rv({},ev)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Rv({},ev)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:pp}}function Mv(){var t;return yv(),pp>=vp?{type:Fp,start:pp,end:pp}:vv(t=dp.charCodeAt(pp))?wv():40===t||41===t||59===t?kv():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(lv("'"===(t=dp[pp])||'"'===t,"String literal must starts with a quote"),e=pp,++pp;pp<vp;){if((n=dp[pp++])===t){t="";break}if("\\"===n)if((n=dp[pp++])&&pv(n.charCodeAt(0)))"\r"===n&&"\n"===dp[pp]&&++pp;else switch(n){case"u":case"x":"{"===dp[pp]?(++pp,i+=xv()):i+=bv(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:hv(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),pp<vp&&hv(dp[pp])&&(a=!0,r=8*r+"01234567".indexOf(dp[pp++]),"0123".indexOf(n)>=0&&pp<vp&&hv(dp[pp])&&(r=8*r+"01234567".indexOf(dp[pp++]))),i+=String.fromCharCode(r)):i+=n}else{if(pv(n.charCodeAt(0)))break;i+=n}}return""!==t&&Rv({},Xp,av),{type:zp,value:i,octal:a,start:e,end:pp}}():46===t?cv(dp.charCodeAt(pp+1))?Av():kv():cv(t)?Av():kv()}function Sv(){var t;return pp=(t=gp).end,gp=Mv(),pp=t.end,t}function Cv(){var t;t=pp,gp=Mv(),pp=t}function Ov(t,e,n){var r=new Op("||"===t||"&&"===t?Hp:Lp);return r.operator=t,r.left=e,r.right=n,r}function Dv(t,e){var n=new Op(qp);return n.callee=t,n.arguments=e,n}function Fv(t){var e=new Op(Up);return e.name=t,e}function Tv(t){var e=new Op(Wp);return e.value=t.value,e.raw=dp.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function Nv(t,e,n){var r=new Op(Vp);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function jv(t,e,n){var r=new Op($p);return r.key=e,r.value=n,r.kind=t,r}function Rv(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,function(t,e){return lv(e<r.length,"Message reference must be in range"),r[e]});throw(n=new Error(i)).index=pp,n.description=i,n}function Pv(t){t.type===Fp&&Rv(t,tv),t.type===Rp&&Rv(t,Jp),t.type===zp&&Rv(t,Qp),t.type===Tp&&Rv(t,Zp),t.type===Np&&Rv(t,Kp),Rv(t,Xp,t.value)}function zv(t){var e=Sv();e.type===Pp&&e.value===t||Pv(e)}function Bv(t){return gp.type===Pp&&gp.value===t}function Lv(t){return gp.type===Np&&gp.value===t}function qv(){var t=[];for(pp=gp.start,zv("[");!Bv("]");)Bv(",")?(Sv(),t.push(null)):(t.push(Zv()),Bv("]")||zv(","));return Sv(),function(t){var e=new Op(Bp);return e.elements=t,e}(t)}function Iv(){var t;return pp=gp.start,(t=Sv()).type===zp||t.type===Rp?(t.octal&&Rv(t,rv),Tv(t)):Fv(t.value)}function Uv(){var t,e,n;return pp=gp.start,(t=gp).type===Tp?(n=Iv(),zv(":"),jv("init",n,Zv())):t.type!==Fp&&t.type!==Pp?(e=Iv(),zv(":"),jv("init",e,Zv())):void Pv(t)}function Wv(){var t,e,n=[],r={},i=String;for(pp=gp.start,zv("{");!Bv("}");)e="$"+((t=Uv()).key.type===Up?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Rv({},iv):r[e]=!0,n.push(t),Bv("}")||zv(",");return zv("}"),function(t){var e=new Op(Gp);return e.properties=t,e}(n)}var Hv={if:1,this:1};function Vv(){var t,e,n;if(Bv("("))return function(){var t;return zv("("),t=Kv(),zv(")"),t}();if(Bv("["))return qv();if(Bv("{"))return Wv();if(t=gp.type,pp=gp.start,t===Tp||Hv[gp.value])n=Fv(Sv().value);else if(t===zp||t===Rp)gp.octal&&Rv(gp,rv),n=Tv(Sv());else{if(t===Np)throw new Error(ov);t===Dp?((e=Sv()).value="true"===e.value,n=Tv(e)):t===jp?((e=Sv()).value=null,n=Tv(e)):Bv("/")||Bv("/=")?(n=Tv(Ev()),Cv()):Pv(Sv())}return n}function Gv(){var t=[];if(zv("("),!Bv(")"))for(;pp<vp&&(t.push(Zv()),!Bv(")"));)zv(",");return zv(")"),t}function $v(){var t;return pp=gp.start,function(t){return t.type===Tp||t.type===Np||t.type===Dp||t.type===jp}(t=Sv())||Pv(t),Fv(t.value)}function Yv(){var t;return zv("["),t=Kv(),zv("]"),t}function Xv(){var t=function(){var t;for(t=Vv();;)if(Bv("."))zv("."),t=Nv(".",t,$v());else if(Bv("("))t=Dv(t,Gv());else{if(!Bv("["))break;t=Nv("[",t,Yv())}return t}();if(gp.type===Pp&&(Bv("++")||Bv("--")))throw new Error(ov);return t}function Jv(){var t,e;if(gp.type!==Pp&&gp.type!==Np)e=Xv();else{if(Bv("++")||Bv("--"))throw new Error(ov);if(Bv("+")||Bv("-")||Bv("~")||Bv("!"))t=Sv(),e=Jv(),e=function(t,e){var n=new Op(Yp);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(Lv("delete")||Lv("void")||Lv("typeof"))throw new Error(ov);e=Xv()}}return e}function Qv(t){var e=0;if(t.type!==Pp&&t.type!==Np)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function Zv(){var t,e;return t=function(){var t,e,n,r,i,a,o,u,s,l;if(t=gp,s=Jv(),0===(i=Qv(r=gp)))return s;for(r.prec=i,Sv(),e=[t,gp],a=[s,r,o=Jv()];(i=Qv(gp))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),u=a.pop().value,s=a.pop(),e.pop(),n=Ov(u,s,o),a.push(n);(r=Sv()).prec=i,a.push(r),e.push(gp),n=Jv(),a.push(n)}for(n=a[l=a.length-1],e.pop();l>1;)e.pop(),n=Ov(a[l-1].value,a[l-2],n),l-=2;return n}(),Bv("?")&&(Sv(),e=Zv(),zv(":"),t=function(t,e,n){var r=new Op(Ip);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,Zv())),t}function Kv(){var t=Zv();if(Bv(","))throw new Error(ov);return t}function tg(t,e,n){return t.fields=e||[],t.fname=n,t}function eg(t){throw Error(t)}var ng=Array.isArray;function rg(t){return ng(t)?"["+t.map(rg)+"]":(e=t)===Object(e)||function(t){return"string"===typeof t}(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t;var e}var ig=[];function ag(t){var e=function(t){pp=0,vp=(dp=t).length,gp=null,Cv();var e=Kv();if(gp.type!==Fp)throw new Error("Unexpect token after expression.");return e}(t),n=new Set;return e.visit(function(t){"MemberExpression"===t.type&&function t(e){return"MemberExpression"===e.object.type?t(e.object):"datum"===e.object.name}(t)&&n.add(function t(e){var n=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(n.push.apply(n,d(t(e.object))),n.push.apply(n,d(t(e.property)))),n)}(t).slice(1).join("."))}),n}(function(t,e){var n=function(t){var e,n,r,i=[],a=null,o=0,u=t.length,s="";function l(){i.push(s+t.substring(e,n)),s="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))s+=t.substring(e,n),s+=t.substring(++n,++n),e=n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r?(e=n+1,a=r):e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&l(),o=e=n+1):"]"===r&&(o||eg("Access path missing open bracket: "+t),o>0&&l(),o=0,e=n+1):n>e?l():e=n+1}return o&&eg("Access path missing closing bracket: "+t),a&&eg("Access path missing closing quote: "+t),n>e&&(n++,l()),i}(t),r="return _["+n.map(rg).join("][")+"];";tg(Function("_",r),[t=1===n.length?n[0]:t],e||t)})("id"),tg(function(t){return t},ig,"identity"),tg(function(){return 0},ig,"zero"),tg(function(){return 1},ig,"one"),tg(function(){return!0},ig,"true"),tg(function(){return!1},ig,"false");var og=function(t){function e(t,n,r){var u;return f(this,e),(u=a(this,o(e).call(this,t))).model=n,u.filter=r,u.expr=lg(u.model,u.filter,i(u)),u._dependentFields=ag(u.expr),u}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,this.model,Ma(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),e}();function ug(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum",i=[],a=Ha(e,function(e){var a=Wa(e),o=t.getSelectionComponent(a,e),u=k(a+ip);if(o.project.timeUnit){var s=null!==n&&void 0!==n?n:t.component.data.raw,l=o.project.timeUnit.clone();s.parent?l.insertAsParentOf(s):s.parent=l}return"none"!==o.empty&&i.push(u),"vlSelectionTest(".concat(u,", ").concat(r)+("global"===o.resolve?")":", ".concat(k(o.resolve),")"))});return(i.length?"!("+i.map(function(t){return"length(data(".concat(t,"))")}).join(" || ")+") || ":"")+"(".concat(a,")")}function sg(t,e){var n=e.encoding,r=e.field;if(n||r){if(n&&!r){var i=t.project.items.filter(function(t){return t.channel===n});!i.length||i.length>1?(r=t.project.items[0].field,ps((i.length?"Multiple ":"No ")+"matching ".concat(k(n)," encoding found for selection ").concat(k(e.selection),". ")+'Using "field": '.concat(k(r),"."))):r=i[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&ps('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(k(r),"."));return"".concat(t.name,"[").concat(k(r),"]")}function lg(t,e,n){return Ha(e,function(e){return w(e)?e:function(t){return null===t||void 0===t?void 0:t.selection}(e)?ug(t,e.selection,n):Gs(e)})}function cg(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function fg(t){return Ju(t)?t.signal:k(t.value)}function hg(t,e,n){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},o=t.combine(),u=o.orient,s=o.scale,l=o.labelExpr,c=o.title,f=o.zindex,h=I(o,["orient","scale","labelExpr","title","zindex"]);for(var p in h){var v=oo[p],g=h[p];if(v&&v!==e&&"both"!==v)delete h[p];else if(io(g)){var m=g.condition,y=I(g,["condition"]),b=R(m),x=ro[p];if(x){var _=x.vgProp;cg(h,x.part,_,[].concat(d(b.map(function(t){var e=t.test,n=I(t,["test"]);return Object.assign({test:lg(null,e)},n)})),[y])),delete h[p]}else if(null===x){var w={signal:b.map(function(t){var e=t.test,n=I(t,["test"]);return"".concat(lg(null,e)," ? ").concat(fg(n)," : ")}).join("")+fg(y)};h[p]=w}}else if(Ju(g)){var k=ro[p];if(k){var A=k.vgProp;cg(h,k.part,A,g),delete h[p]}}}if("grid"===e){if(!h.grid)return;if(h.encode){var E=h.encode.grid;h.encode=Object.assign({},E?{grid:E}:{}),0===qa(h.encode).length&&delete h.encode}return Object.assign(Object.assign({scale:s,orient:u},h),{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Ka(f,0)})}if(a.header||!t.mainExtracted){if(void 0!==l){var M=l;(null===(i=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&Ju(h.encode.labels.update.text)&&(M=Ja(l,"datum.label",h.encode.labels.update.text.signal)),cg(h,"labels","text",{signal:M})}if(h.encode){var S=!0,C=!1,O=void 0;try{for(var D,F=ao[Symbol.iterator]();!(S=(D=F.next()).done);S=!0){var T=D.value;t.hasAxisPart(T)||delete h.encode[T]}}catch(j){C=!0,O=j}finally{try{S||null==F.return||F.return()}finally{if(C)throw O}}0===qa(h.encode).length&&delete h.encode}var N=function(t,e){if(t)return Xu(t)?t:t.map(function(t){return sc(t,e)}).join(", ")}(c,n);return Object.assign(Object.assign(Object.assign({scale:s,orient:u,grid:!1},N?{title:N}:{}),h),{zindex:Ka(f,0)})}}function dg(t){var e=t.component.axes,n=!0,r=!1,i=void 0;try{for(var a,o=Pu[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(e[u]){var s=!0,l=!1,c=void 0;try{for(var f,h=e[u][Symbol.iterator]();!(s=(f=h.next()).done);s=!0)if(!f.value.get("gridScale")){var d="x"===u?"height":"width";return[{name:d,update:t.getSizeSignalRef(d).signal}]}}catch(p){l=!0,c=p}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}}}}catch(p){r=!0,i=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return[]}var pg={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},vg={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelLimit:"limit",labelOrient:"orient",labelPadding:"offset"},gg=qa(pg),mg=qa(vg);function yg(t,e,n,r,i,a){var o,u,s,l=os(t,a,e.style);if(void 0!==l)return{configFrom:"style",configValue:l};var c=[].concat(d("band"===i?["axisBand","axisDiscrete"]:[]),d("point"===i?["axisPoint","axisDiscrete"]:[]),d(function(t){return t in sl}(i)?["axisQuantitative"]:[]),d("time"===i||"utc"===i?["axisTemporal"]:[])),f="x"===n?"axisX":"axisY",h=[].concat(d(c.map(function(t){return f+t.substr(4)})),d(c),[f],d(r?["axis"+Ga(r)]:[]),["axis"]),p=!0,v=!1,g=void 0;try{for(var m,y=h[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value;if(void 0!==(null===(o=e[b])||void 0===o?void 0:o[t]))return{configFrom:b,configValue:e[b][t]}}}catch(M){v=!0,g=M}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}var x=!0,_=!1,w=void 0;try{for(var k,A=h[Symbol.iterator]();!(x=(k=A.next()).done);x=!0){var E=k.value;if((null===(u=e[E])||void 0===u?void 0:u.style)&&void 0!==(l=os(t,null===(s=e[E])||void 0===s?void 0:s.style,e.style)))return{configFrom:"axis-config-style",configValue:l}}}catch(M){_=!0,w=M}finally{try{x||null==A.return||A.return()}finally{if(_)throw w}}return{}}function bg(t,e){if(void 0!==t)return t=eo(t),"top"===e||"bottom"===e?t<=45||315<=t?"top"===e?"bottom":"top":135<=t&&t<=225?"top"===e?"top":"bottom":"middle":t<=45||315<=t||135<=t&&t<=225?"middle":45<=t&&t<=135?"left"===e?"top":"bottom":"left"===e?"bottom":"top"}function xg(t,e){if(void 0!==t)return t=eo(t),"top"===e||"bottom"===e?t%180===0?"center":0<t&&t<180?"top"===e?"right":"left":"top"===e?"left":"right":(t+90)%180===0?"center":90<=t&&t<270?"left"===e?"left":"right":"left"===e?"right":"left"}function _g(t){switch(t){case $o:return"bottom";case Yo:return"left"}throw new Error(fs.INVALID_CHANNEL_FOR_AXIS)}var wg=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r._dependentFields=ag(r.transform.calculate),r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(Da(this.transform))}}],[{key:"parseAllForSortIndex",value:function(t,n){return n.forEachFieldDef(function(n,r){if(Ql(n)&&Bl(n.sort)){var i=n.field,a=n.timeUnit,o=n.sort,u=o.map(function(t,e){return"".concat(Gs({field:i,timeUnit:a,equal:t})," ? ").concat(e," : ")}).join("")+o.length;t=new e(t,{calculate:u,as:kg(n,r,{forAs:!0})})}}),t}}]),e}();function kg(t,e,n){return tc(t,Object.assign({prefix:e,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function Ag(t,e){return Ta(["top","bottom"],e)?"column":Ta(["left","right"],e)?"row":"row"===t?"row":"column"}function Eg(t,e,n,r){var i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return Ka(e&&e.header?e.header[t]:void 0,i[t],n.header[t])}function Mg(t,e,n,r){var i={},a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=Eg(c,e,n,r);void 0!==f&&(i[c]=f)}}catch(h){o=!0,u=h}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return i}var Sg=["row","column"],Cg=["header","footer"];function Og(t,e){var n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,a=Mg(["titleAnchor","titleAngle","titleOrient"],i,r,e),o=a.titleAnchor,u=a.titleAngle,s=Ag(e,a.titleOrient);return{name:"".concat(e,"-title"),type:"group",role:"".concat(s,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),Fg(u,s)),Dg(s,u,o)),Bg(r,i,e,gg,pg))}}function Dg(t,e){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}var n=xg(e,"row"===t?"left":"top");return n?{align:n}:{}}function Fg(t,e){var n=bg(t,"row"===e?"left":"top");return n?{baseline:n}:{}}function Tg(t,e){var n=t.component.layoutHeaders[e],r=[],i=!0,a=!1,o=void 0;try{for(var u,s=Cg[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;if(n[l]){var c=!0,f=!1,h=void 0;try{for(var d,p=n[l][Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=Rg(t,e,l,n,d.value);null!=v&&r.push(v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}function Ng(t,e){var n,r=t.sort;return zl(r)?{field:tc(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:x(r)?{field:kg(t,e,{expr:"datum"}),order:"ascending"}:{field:tc(t,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function jg(t,e,n){var r=Mg(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),i=r.format,a=r.formatType,o=r.labelAngle,u=r.labelAnchor,s=r.labelOrient,l=r.labelExpr,c=Cl({fieldDef:t,format:i,formatType:a,expr:"parent",config:n}).signal,f=Ag(e,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?Ja(Ja(l,"datum.label",c),"datum.value",tc(t,{expr:"parent"})):c}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Fg(o,f)),Dg(f,o,u)),Bg(n,t,e,mg,vg))}function Rg(t,e,n,r,i){if(i){var a=null,o=r.facetFieldDef,u=t.config?t.config:void 0;if(o&&i.labels){var s=Mg(["labelOrient"],o,u,e).labelOrient;("row"===e&&!Ta(["top","bottom"],s)||"column"===e&&!Ta(["left","right"],s))&&(a=jg(o,e,u))}var c=qy(t)&&!Ll(t.facet),f=i.axes,h=(null===f||void 0===f?void 0:f.length)>0;if(a||h){var d="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("".concat(e,"_").concat(n)),type:"group",role:"".concat(e,"-").concat(n)},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:Ng(o,e)}:{}),h&&c?{from:{data:t.getName("facet_domain_".concat(e))}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:l({},d,i.sizeSignal)}}:{}),h?{axes:f}:{})}}return null}var Pg={column:{start:0,end:1},row:{start:1,end:0}};function zg(t,e){return Pg[e][t]}function Bg(t,e,n,r,i){var a={},o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(i[f]){var h=Eg(f,e,t,n);void 0!==h&&(a[i[f]]=h)}}}catch(d){u=!0,s=d}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}return a}function Lg(t){return[].concat(d(qg(t,"width")),d(qg(t,"height")),d(qg(t,"childWidth")),d(qg(t,"childHeight")))}function qg(t,e){var n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];var i=t.getSizeSignalRef(e).signal;if("step"===r){var a=t.getScaleComponent(n);if(a){var o=a.get("type"),u=a.get("range");if(hl(o)&&Qu(u)){var s=t.scaleName(n);return qy(t.parent)&&"independent"===t.parent.component.resolve.scale[n]?[Ig(s,u)]:[Ig(s,u),{name:i,update:Ug(s,a,"domain('".concat(s,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var l=i.endsWith("width"),c=l?"containerSize()[0]":"containerSize()[1]",f=wf(t.config.view,l?"width":"height"),h="isFinite(".concat(c,") ? ").concat(c," : ").concat(f);return[{name:i,init:h,on:[{update:h,events:"window:resize"}]}]}return[{name:i,value:r}]}function Ig(t,e){return{name:t+"_step",value:e.step}}function Ug(t,e,n){var r=e.get("type"),i=e.get("padding"),a=Ka(e.get("paddingOuter"),i),o=e.get("paddingInner");return o="band"===r?void 0!==o?o:i:1,"bandspace(".concat(n,", ").concat(o,", ").concat(a,") * ").concat(t,"_step")}function Wg(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function Hg(t,e){return qa(t).reduce(function(n,r){var i=t[r];return Object.assign(Object.assign({},n),Gh(e,i,r,function(t){return Ju(t)?t:{value:t.value}}))},{})}function Vg(t,e){var n=t.scale[e],r=Ta(Pu,e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&ps(fs.independentScaleMeansIndependentGuide(e)),"independent"):t[r][e]||"shared"}var Gg=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,t),this.explicit=e,this.implicit=n}return h(t,[{key:"clone",value:function(){return new t(Ma(this.explicit),Ma(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(t){return Ka(this.explicit[t],this.implicit[t])}},{key:"getWithExplicit",value:function(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(t,e){void 0!==e.value&&this.set(t,e.value,e.explicit)}},{key:"set",value:function(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}},{key:"copyKeyFromSplit",value:function(t,e){void 0!==e.explicit[t]?this.set(t,e.explicit[t],!0):void 0!==e.implicit[t]&&this.set(t,e.implicit[t],!1)}},{key:"copyKeyFromObject",value:function(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}},{key:"copyAll",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=qa(t.combine())[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=t.getWithExplicit(o);this.setWithExplicit(o,u)}}catch(s){n=!0,r=s}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}}]),t}();function $g(t){return{explicit:!0,value:t}}function Yg(t){return{explicit:!1,value:t}}function Xg(t){return function(e,n,r,i){var a=t(e.value,n.value);return a>0?e:a<0?n:Jg(e,n,r,i)}}function Jg(t,e,n,r){return t.explicit&&e.explicit&&ps(fs.mergeConflictingProperty(n,r,t.value,e.value)),t}function Qg(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Jg;return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:Ea(t.value,e.value)?t:i(t,e,n,r)}var Zg=Object.assign(Object.assign({},{clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1}),{labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Kg=qa(Zg),tm=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Gg),e}();function em(t){return Ka(t.legend.type,nm(t))}function nm(t){var e=t.channel,n=t.timeUnit,r=t.scaleType,i=t.alwaysReturn;if(_u(e)){if(Ta(["quarter","month","day"],n))return"symbol";if(pl(r))return i?"gradient":void 0}return i?"symbol":void 0}function rm(t){var e=t.legend,n=t.legendConfig,r=t.timeUnit,i=t.channel,a=t.scaleType,o=Ka(e.orient,n.orient,"right"),u=em({legend:e,channel:i,timeUnit:r,scaleType:a,alwaysReturn:!0});return Ka(e.direction,n[u?"gradientDirection":"symbolDirection"],function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(o,u))}function im(t,e,n,r){var i=t.getSizeSignalRef(e).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function am(t,e,n){var r=e.getScaleComponent(n).get("type");return Ka(t.get("type"),nm({channel:n,scaleType:r,alwaysReturn:!0}))}function om(t){return sm(t,function(t,e){return Math.max(t,e.value)})}function um(t){return sm(t,function(t,e){return Ka(t,e.value)})}function sm(t,e){return function(t){return!!t&&!!t.condition&&(x(t.condition)||Jl(t.condition))}(t)?R(t.condition).reduce(e,t.value):Jl(t)?t.value:void 0}function lm(t,e,n){var r=e.get("selections");if(null===r||void 0===r?void 0:r.length){var i=k(n.field);return r.map(function(t){var e=k(Wa(t)+ip);return"(!length(data(".concat(e,")) || (").concat(t,"[").concat(i,"] && indexof(").concat(t,"[").concat(i,"], datum.value) >= 0))")}).join(" || ")}}var cm=Object.freeze({__proto__:null,symbols:function(t,e,n,r,i){var a,o,u,s,l;if("symbol"===am(i,n,r)){var c=n.markDef,f=n.encoding,h=n.config,d=n.mark,p=c.filled&&"trail"!==d,v=Object.assign(Object.assign({},function(t,e,n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=is(s,e.markDef,e.config);void 0!==l&&(t[s]={value:l})}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t}({},n,Co)),nd(n,{filled:p})),g=null!==(a=om(f.opacity))&&void 0!==a?a:c.opacity,m=lm(0,i,t);if(v.fill)if("fill"===r||p&&r===eu)delete v.fill;else if(v.fill.field)i.get("symbolFillColor")?delete v.fill:(v.fill=es(null!==(o=h.legend.symbolBaseFillColor)&&void 0!==o?o:"black"),v.fillOpacity=es(null!==g&&void 0!==g?g:1));else if(x(v.fill)){var y=null!==(l=null!==(s=um(null!==(u=f.fill)&&void 0!==u?u:f.color))&&void 0!==s?s:c.fill)&&void 0!==l?l:p&&c.color;y&&(v.fill=es(y))}if(v.stroke)if("stroke"===r||!p&&r===eu)delete v.stroke;else if(v.stroke.field)delete v.stroke;else if(x(v.stroke)){var b=Ka(um(f.stroke||f.color),c.stroke,p?c.color:void 0);b&&(v.stroke={value:b})}return r!==ou&&(m?v.opacity=[Object.assign({test:m},es(null!==g&&void 0!==g?g:1)),es(h.legend.unselectedOpacity)]:g&&(v.opacity=es(g))),v=Object.assign(Object.assign({},v),e),qa(v).length>0?v:void 0}},gradient:function(t,e,n,r,i){if("gradient"===am(i,n,r)){var a={},o=om(n.encoding.opacity)||n.markDef.opacity;return o&&(a.opacity=es(o)),a=Object.assign(Object.assign({},a),e),qa(a).length>0?a:void 0}},labels:function(t,e,n,r,i){var a=n.legend(r),o=n.config,u=lm(0,i,t),s=u?[{test:u,value:1},{value:o.legend.unselectedOpacity}]:void 0,l=Cl({fieldDef:t,format:a.format,formatType:a.formatType,field:"datum.value",config:o,isUTCScale:n.getScaleComponent(r).get("type")===Xs.UTC,omitNumberFormatAndEmptyTimeFormat:!0}),c=Object.assign(Object.assign(Object.assign({},s?{opacity:s}:{}),l?{text:l}:{}),e);return qa(c).length>0?c:void 0},entries:function(t,e,n,r,i){var a=i.get("selections");return(null===a||void 0===a?void 0:a.length)?{fill:{value:"transparent"}}:void 0},getFirstConditionValue:um});function fm(t){Ly(t)?t.component.legends=function(t){var e=t.encoding;return[eu,nu,ru,lu,cu,au,iu,ou,uu,su].reduce(function(n,r){var i=e[r];return!t.legend(r)||!t.getScaleComponent(r)||$l(i)&&r===iu&&i.type===el||(n[r]=function(t,e){var n,r=t.fieldDef(e),i=t.legend(e),a=new tm({},function(t,e){var n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:l({},e,n)}(t,e));!function(t,e,n){var r=t.fieldDef(e).field;lp(t,function(t){var i,a,o=null!==(i=t.project.hasField[r])&&void 0!==i?i:t.project.hasChannel[e];if(o&&zd.has(t)){var u=null!==(a=n.get("selections"))&&void 0!==a?a:[];u.push(t.name),n.set("selections",u,!1),o.hasLegend=!0}})}(t,e,a);var o=!0,u=!1,s=void 0;try{for(var c,f=Kg[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var h=c.value,d=dm(h,i,e,t);if(void 0!==d){var p=hm(d,h,i,r);(p||void 0===t.config.legend[h])&&a.set(h,d,p)}}}catch(y){u=!0,s=y}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}var v=null!==(n=i.encoding)&&void 0!==n?n:{},g=a.get("selections"),m=["labels","legend","title","symbols","gradient","entries"].reduce(function(n,i){var o,u=Hg(null!==(o=v[i])&&void 0!==o?o:{},t),s=cm[i]?cm[i](r,u,t,e,a):u;return void 0!==s&&qa(s).length>0&&(n[i]=Object.assign(Object.assign(Object.assign({},(null===g||void 0===g?void 0:g.length)?{name:"".concat(Wa(r.field),"_legend_").concat(i)}:{}),(null===g||void 0===g?void 0:g.length)?{interactive:!!g}:{}),{update:s})),n},{});return qa(m).length>0&&a.set("encode",m,!!i.encoding),a}(t,r)),n},{})}(t):t.component.legends=function(t){var e=t.component,n=e.legends,r=e.resolve,i=!0,a=!1,o=void 0;try{for(var u,s=function(){var e=u.value;fm(e),qa(e.component.legends).forEach(function(i){r.legend[i]=Vg(t.component.resolve,i),"shared"===r.legend[i]&&(n[i]=pm(n[i],e.component.legends[i]),n[i]||(r.legend[i]="independent",delete n[i]))})},l=t.children[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)s()}catch(c){a=!0,o=c}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return qa(n).forEach(function(e){var n=!0,i=!1,a=void 0;try{for(var o,u=t.children[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;s.component.legends[e]&&"shared"===r.legend[e]&&delete s.component.legends[e]}}catch(c){i=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}}),n}(t)}function hm(t,e,n,r){switch(e){case"values":return!!n.values;case"title":if("title"===e&&t===r.title)return!0}return t===n[e]}function dm(t,e,n,r){var i,a=r.encoding,o=r.mark,u=fc(a[n]),s=r.config.legend,l=null===(i=Rs(u.timeUnit))||void 0===i?void 0:i.unit,c=r.getScaleComponent(n).get("type");switch(t){case"direction":return rm({legend:e,legendConfig:s,timeUnit:l,channel:n,scaleType:c});case"format":if(gc(u))return;return Ol(u,e.format,r.config);case"formatType":if(gc(u))return;return e.formatType;case"gradientLength":return Ka(e.gradientLength,s.gradientLength,function(t){var e=t.legend,n=t.legendConfig,r=t.model,i=t.channel,a=t.scaleType,o=n.gradientHorizontalMaxLength,u=n.gradientHorizontalMinLength,s=n.gradientVerticalMaxLength,l=n.gradientVerticalMinLength;if(pl(a)){if("horizontal"===rm({legend:e,legendConfig:n,channel:i,scaleType:a})){var c=Ka(e.orient,n.orient);return"top"===c||"bottom"===c?im(r,"width",u,o):u}return im(r,"height",l,s)}}({model:r,legend:e,legendConfig:s,channel:n,scaleType:c}));case"labelOverlap":return Ka(e.labelOverlap,function(t){if(Ta(["quantile","threshold","log"],t))return"greedy"}(c));case"symbolType":return Ka(e.symbolType,function(t,e,n,r){var i;if("shape"!==e){var a=null!==(i=um(n))&&void 0!==i?i:r;if(a)return a}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(o,n,a.shape,r.markDef.shape));case"title":return oc(u,r.config,{allowDisabling:!0})||void 0;case"type":return em({legend:e,channel:n,timeUnit:l,scaleType:c,alwaysReturn:!1});case"values":return function(t,e){var n=t.values;return x(n)?bc(e,n):Ju(n)?n:void 0}(e,u)}return e[t]}function pm(t,e){var n,r,i,a,o,u;if(!t)return e.clone();var s=t.getWithExplicit("orient"),l=e.getWithExplicit("orient");if(!s.explicit||!l.explicit||s.value===l.value){var c=!1,f=!0,h=!1,d=void 0;try{for(var p,v=function(){var n=p.value,r=Qg(t.getWithExplicit(n),e.getWithExplicit(n),n,"legend",function(t,e){switch(n){case"symbolType":return r=t,"circle"===(i=e).value?i:r;case"title":return cs(t,e);case"type":return c=!0,Yg("symbol")}var r,i;return Jg(t,e,n,"legend")});t.setWithExplicit(n,r)},g=Kg[Symbol.iterator]();!(f=(p=g.next()).done);f=!0)v()}catch(m){h=!0,d=m}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}return c&&((null===(i=null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)||void 0===i||i)&&Va(t.implicit,["encode","gradient"]),(null===(u=null===(o=null===(a=t.explicit)||void 0===a?void 0:a.encode)||void 0===o?void 0:o.gradient)||void 0===u||u)&&Va(t.explicit,["encode","gradient"])),t}}function vm(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function gm(t){var e=t.component.legends,n={},r=!0,i=!1,a=void 0;try{for(var o,u=qa(e)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=t.getScaleComponent(s),c=Oa(l.get("domains"));if(n[c]){var f=!0,h=!1,d=void 0;try{for(var p,v=n[c][Symbol.iterator]();!(f=(p=v.next()).done);f=!0)pm(p.value,e[s])||n[c].push(e[s])}catch(g){h=!0,d=g}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}}else n[c]=[e[s].clone()]}}catch(g){i=!0,a=g}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return Ia(n).flat().map(mm)}function mm(t){var e,n,r,i,a=t.combine(),o=a.labelExpr,u=(a.selections,I(a,["labelExpr","selections"]));if(null===(e=u.encode)||void 0===e?void 0:e.symbols){var s=u.encode.symbols.update;!s.fill||"transparent"===s.fill.value||s.stroke||u.stroke||(s.stroke={value:"transparent"});var l=!0,c=!1,f=void 0;try{for(var h,d=lf[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;u[p]&&delete s[p]}}catch(x){c=!0,f=x}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}if(void 0!==o){var v=o;(null===(i=null===(r=null===(n=u.encode)||void 0===n?void 0:n.labels)||void 0===r?void 0:r.update)||void 0===i?void 0:i.text)&&Ju(u.encode.labels.update.text)&&(v=Ja(o,"datum.label",u.encode.labels.update.text.signal)),vm(u,"labels","text",{signal:v})}for(var g in u){var m=u[g];if(Ju(m)){var y=cf[g];if(y){var b=y.vgProp;vm(u,y.part,b,m),delete u[g]}}}return u}function ym(t){return Wy(t)||Uy(t)||Iy(t)?function(t){return t.children.reduce(function(t,e){return t.concat(e.assembleProjections())},bm(t))}(t):bm(t)}function bm(t){var e=t.component.projection;if(!e||e.merged)return[];var n=e.combine(),r=n.name,i=I(n,["name"]);if(e.data){var a={signal:"[".concat(e.size.map(function(t){return t.signal}).join(", "),"]")},o=e.data.reduce(function(e,n){var r=Ju(n)?n.signal:"data('".concat(t.lookupDataSource(n),"')");return Ta(e,r)||e.push(r),e},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:o.length>1?"[".concat(o.join(", "),"]"):o[0]}},i)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),i)]}var xm=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],_m=function(t){function e(t,n,r,i){var u;return f(this,e),(u=a(this,o(e).call(this,Object.assign({},n),{name:t}))).specifiedProjection=n,u.size=r,u.data=i,u.merged=!1,u}return s(e,Gg),h(e,[{key:"isFit",get:function(){return!!this.data}}]),e}();function wm(t){t.component.projection=Ly(t)?function(t){var e;if(t.hasProjection){var n=t.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,a=r?function(t){for(var e=[],n=0,r=[[Zo,Qo],[tu,Ko]];n<r.length;n++){var i=r[n];(t.channelHasField(i[0])||t.channelHasField(i[1]))&&e.push({signal:t.getName("geojson_".concat(e.length))})}return t.channelHasField(iu)&&t.fieldDef(iu).type===el&&e.push({signal:t.getName("geojson_".concat(e.length))}),0===e.length&&e.push(t.requestDataName(lh)),e}(t):void 0;return new _m(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=t.config.projection)&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{}),i,a)}}(t):function(t){if(0!==t.children.length){var e;t.children.forEach(function(t){return wm(t)});var n=ja(t.children,function(t){var n=t.component.projection;if(n){if(e){var r=function(t,e){var n=ja(xm,function(n){return!z(t.explicit,n)&&!z(e.explicit,n)||!(!z(t.explicit,n)||!z(e.explicit,n)||Oa(t.get(n))!==Oa(e.get(n)))});if(Oa(t.size)===Oa(e.size)){if(n)return t;if(Oa(t.explicit)===Oa({}))return e;if(Oa(e.explicit)===Oa({}))return t}return null}(e,n);return r&&(e=r),!!r}return e=n,!0}return!0});if(e&&n){var r=t.projectionName(!0),i=new _m(r,e.specifiedProjection,e.size,Ma(e.data));return t.children.forEach(function(t){var e,n=t.component.projection;n&&(n.isFit&&(e=i.data).push.apply(e,d(t.component.projection.data)),t.renameProjection(n.get("name"),r),n.merged=!0)}),i}}}(t)}function km(t,e){return"".concat(_c(t),"_").concat(e)}function Am(t,e,n){var r,i=km(null!==(r=pc(n,void 0))&&void 0!==r?r:{},e);return t.getName("".concat(i,"_bins"))}function Em(t,e,n){var r,i;r=function(t){return"as"in t}(t)?w(t.as)?[t.as,"".concat(t.as,"_end")]:[t.as[0],t.as[1]]:[tc(t,{forAs:!0}),tc(t,{binSuffix:"end",forAs:!0})];var a=Object.assign({},pc(e,void 0)),o=km(a,t.field),u=function(t,e){return{signal:t.getName("".concat(e,"_bins")),extentSignal:t.getName("".concat(e,"_extent"))}}(n,o),s=u.signal,l=u.extentSignal;if(Ec(a.extent)){var c=a.extent,f=c.selection;i=sg(n.getSelectionComponent(Wa(f),f),c),delete a.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:a,field:t.field,as:[r]},s?{signal:s}:{}),l?{extentSignal:l}:{}),i?{span:i}:{})}}var Mm=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).bins=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.bins))}},{key:"merge",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=qa(t.bins)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u in this.bins?(e(t.bins[u].signal,this.bins[u].signal),this.bins[u].as=Pa([].concat(d(this.bins[u].as),d(t.bins[u].as)),Da)):this.bins[u]=t.bins[u]}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,l=!1,c=void 0;try{for(var f,h=t.children[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;t.removeChild(p),p.parent=this}}catch(v){l=!0,c=v}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}t.remove()}},{key:"producedFields",value:function(){return new Set(Ia(this.bins).map(function(t){return t.as}).flat(2))}},{key:"dependentFields",value:function(){return new Set(Ia(this.bins).map(function(t){return t.field}))}},{key:"hash",value:function(){return"Bin ".concat(Da(this.bins))}},{key:"assemble",value:function(){return Ia(this.bins).flatMap(function(t){var e=[],n=r(t.as),i=n[0],a=n.slice(1),o=t.bin,u=o.extent,s=I(o,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Xa(t.field),as:i,signal:t.signal},Ec(u)?{extent:null}:{extent:u}),t.span?{span:{signal:"span(".concat(t.span,")")}}:{}),s);!u&&t.extentSignal&&(e.push({type:"extent",field:Xa(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),e.push(l);var c=!0,f=!1,h=void 0;try{for(var d,p=a[Symbol.iterator]();!(c=(d=p.next()).done);c=!0)for(var v=d.value,g=0;g<2;g++)e.push({type:"formula",expr:tc({field:i[g]},{expr:"datum"}),as:v[g]})}catch(m){f=!0,h=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e})}}],[{key:"makeFromEncoding",value:function(t,n){var r=n.reduceFieldDef(function(t,e,r){if(Yl(e)&&wc(e.bin)){var i=Em(e,e.bin,n),a=i.key,o=i.binComponent;t[a]=Object.assign(Object.assign(Object.assign({},o),t[a]),function(t,e,n,r){var i,a;if(xc(e,n)){var o=Ly(t)&&null!==(a=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==a?a:{},u=tc(e,{expr:"datum"}),s=tc(e,{expr:"datum",binSuffix:"end"});return{formulaAs:tc(e,{binSuffix:"range",forAs:!0}),formula:Tl(u,s,o.format,o.formatType,r)}}return{}}(n,e,r,n.config))}return t},{});return 0===qa(r).length?null:new e(t,r)}},{key:"makeFromTransform",value:function(t,n,r){var i=Em(n,n.bin,r),a=i.key,o=i.binComponent;return new e(t,l({},a,o))}}]),e}(),Sm=function(t){function e(t){var n,r;if(f(this,e),n=a(this,o(e).call(this,null)),ah(t=null!==t&&void 0!==t?t:{name:"source"})||(r=t.format?Object.assign({},Ca(t.format,["parse"])):{}),rh(t))n._data={values:t.values};else if(nh(t)){if(n._data={url:t.url},!r.type){var i=/(?:\.([^.]+))?$/.exec(t.url)[1];Ta(["json","csv","tsv","dsv","topojson"],i)||(i="json"),r.type=i}}else uh(t)?n._data={values:[{type:"Sphere"}]}:(ih(t)||ah(t))&&(n._data={});return n._generator=ah(t),t.name&&(n._name=t.name),r&&qa(r).length>0&&(n._data.format=r),n}return s(e,Md),h(e,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hasName",value:function(){return!!this._name}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}},{key:"data",get:function(){return this._data}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(t){this._name=t}},{key:"parent",set:function(t){throw new Error("Source nodes have to be roots.")}}]),e}();function Cm(t){var e=!0,n=!1,r=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=o.children[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;if(h.parent!==o)return console.error("Dataflow graph is inconsistent.",o,h),!1}}catch(d){s=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}if(!Cm(o.children))return!1}}catch(d){n=!0,r=d}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return!0}var Om=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).params=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(Da(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),e}(),Dm=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).params=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}},{key:"hash",value:function(){return"Hash ".concat(Da(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),e}();function Fm(t){return t instanceof Sm||t instanceof Om||t instanceof Dm}var Tm=function(){function t(){f(this,t),this._mutated=!1}return h(t,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),t}(),Nm=function(t){function e(){var t;return f(this,e),(t=a(this,o(e).call(this)))._continue=!1,t}return s(e,Tm),h(e,[{key:"setContinue",value:function(){this._continue=!0}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(t){if(Fm(t))return!1;var e=t.parent;return this.run(t).continueFlag&&this.optimizeNextFromLeaves(e),this.mutatedFlag}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(t){var e=t.continueFlag,n=t.mutatedFlag;e&&this.setContinue(),n&&this.setMutated()}}]),e}(),jm=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Tm),e}();function Rm(t,e,n,r){var i=Ly(r)?r.encoding[Tu(e)]:void 0;if(Yl(n)&&Ly(r)&&Hl(e,n,i,r.markDef,r.config))t.add(tc(n,{})),t.add(tc(n,{suffix:"end"})),n.bin&&xc(n,e)&&t.add(tc(n,{binSuffix:"range"}));else if(e in yu){var a=function(t){switch(t){case Qo:return"y";case Ko:return"y2";case Zo:return"x";case tu:return"x2"}}(e);t.add(r.getName(a))}else t.add(tc(n));return t}var Pm=function(t){function e(t,n,r){var i;return f(this,e),(i=a(this,o(e).call(this,t))).dimensions=n,i.measures=r,i}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,new Set(this.dimensions),Ma(this.measures))}},{key:"merge",value:function(t){return function(t,e){if(t.size!==e.size)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!e.has(u))return!1}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(this.dimensions,t.dimensions)?(function(t,e){var n,r=!0,i=!1,a=void 0;try{for(var o,u=qa(e)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=e[s],f=!0,h=!1,p=void 0;try{for(var v,g=qa(c)[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var m=v.value;s in t?t[s][m]=new Set([].concat(d(null!==(n=t[s][m])&&void 0!==n?n:[]),d(c[m]))):t[s]=l({},m,c[m])}}catch(y){h=!0,p=y}finally{try{f||null==g.return||g.return()}finally{if(h)throw p}}}}catch(y){i=!0,a=y}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}(this.measures,t.measures),!0):(function(){var t;(t=ds).debug.apply(t,arguments)}("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(t){t.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set([].concat(d(this.dimensions),d(qa(this.measures))))}},{key:"producedFields",value:function(){var t=new Set,e=!0,n=!1,r=void 0;try{for(var i,a=qa(this.measures)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=qa(this.measures[o])[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value,d=this.measures[o][h];0===d.size?t.add("".concat(h,"_").concat(o)):d.forEach(t.add,t)}}catch(p){s=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}catch(p){n=!0,r=p}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"hash",value:function(){return"Aggregate ".concat(Da({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var t=[],e=[],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=qa(this.measures)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=!0,c=!1,f=void 0;try{for(var h,p=qa(this.measures[s])[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value,g=!0,m=!1,y=void 0;try{for(var b,x=this.measures[s][v][Symbol.iterator]();!(g=(b=x.next()).done);g=!0){var _=b.value;n.push(_),t.push(v),e.push("*"===s?null:Xa(s))}}catch(w){m=!0,y=w}finally{try{g||null==x.return||x.return()}finally{if(m)throw y}}}}catch(w){c=!0,f=w}finally{try{l||null==p.return||p.return()}finally{if(c)throw f}}}}catch(w){i=!0,a=w}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{type:"aggregate",groupby:d(this.dimensions).map(Xa),ops:t,fields:e,as:n}}},{key:"groupBy",get:function(){return this.dimensions}}],[{key:"makeFromEncoding",value:function(t,n){var r=!1;n.forEachFieldDef(function(t){t.aggregate&&(r=!0)});var i={},a=new Set;return r?(n.forEachFieldDef(function(t,e){var r,o,u,s,l=t.aggregate,c=t.field;if(l)if("count"===l)i["*"]=null!==(r=i["*"])&&void 0!==r?r:{},i["*"].count=new Set([tc(t,{forAs:!0})]);else{if(zo(l)||Bo(l)){var f=zo(l)?"argmin":"argmax",h=l[f];i[h]=null!==(o=i[h])&&void 0!==o?o:{},i[h][f]=new Set([tc({op:f,field:h},{forAs:!0})])}else i[c]=null!==(u=i[c])&&void 0!==u?u:{},i[c][l]=new Set([tc(t,{forAs:!0})]);Wu(e)&&"unaggregated"===n.scaleDomain(e)&&(i[c]=null!==(s=i[c])&&void 0!==s?s:{},i[c].min=new Set([tc({field:c,aggregate:"min"},{forAs:!0})]),i[c].max=new Set([tc({field:c,aggregate:"max"},{forAs:!0})]))}else Rm(a,e,t,n)}),a.size+qa(i).length===0?null:new e(t,a,i)):null}},{key:"makeFromTransform",value:function(t,n){var r,i,a,o=new Set,u={},s=!0,l=!1,c=void 0;try{for(var f,h=n.aggregate[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value,p=d.op,v=d.field,g=d.as;p&&("count"===p?(u["*"]=null!==(r=u["*"])&&void 0!==r?r:{},u["*"].count=new Set([g||tc(d,{forAs:!0})])):(u[v]=null!==(i=u[v])&&void 0!==i?i:{},u[v][p]=new Set([g||tc(d,{forAs:!0})])))}}catch(k){l=!0,c=k}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}var m=!0,y=!1,b=void 0;try{for(var x,_=(null!==(a=n.groupby)&&void 0!==a?a:[])[Symbol.iterator]();!(m=(x=_.next()).done);m=!0){var w=x.value;o.add(w)}}catch(k){y=!0,b=k}finally{try{m||null==_.return||_.return()}finally{if(y)throw b}}return o.size+qa(u).length===0?null:new e(t,o,u)}}]),e}(),zm=function(t){function e(t,n,r,i){var u;f(this,e),(u=a(this,o(e).call(this,t))).model=n,u.name=r,u.data=i;var s=!0,l=!1,c=void 0;try{for(var h,p=ku[Symbol.iterator]();!(s=(h=p.next()).done);s=!0){var v=h.value,g=n.facet[v];if(g){var m=g.bin,y=g.sort;u[v]=Object.assign({name:n.getName("".concat(v,"_domain")),fields:[tc(g)].concat(d(wc(m)?[tc(g,{binSuffix:"end"})]:[]))},zl(y)?{sortField:y}:x(y)?{sortIndexField:kg(g,v)}:{})}}}catch(b){l=!0,c=b}finally{try{s||null==p.return||p.return()}finally{if(l)throw c}}return u.childModel=n.child,u}return s(e,Md),h(e,[{key:"hash",value:function(){var t="Facet",e=!0,n=!1,r=void 0;try{for(var i,a=ku[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this[o]&&(t+=" ".concat(o.charAt(0),":").concat(Da(this[o])))}}catch(u){n=!0,r=u}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"dependentFields",value:function(){var t=new Set(this.fields),e=!0,n=!1,r=void 0;try{for(var i,a=ku[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this[o]&&(this[o].sortField&&t.add(this[o].sortField.field),this[o].sortIndexField&&t.add(this[o].sortIndexField))}}catch(u){n=!0,r=u}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){for(var t={},e=0,n=["x","y"];e<n.length;e++){var r=n[e],i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type"),o=i.get("range");if(hl(a)&&Qu(o)){var u=xy(_y(this.childModel,r));u?t[r]=u:ps("Unknown field for ".concat(r,". Cannot calculate view size."))}}}return t}},{key:"assembleRowColumnHeaderData",value:function(t,e,n){var r={row:"y",column:"x"}[t],i=[],a=[],o=[];n&&n[r]&&(e?(i.push("distinct_".concat(n[r])),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[t],s=u.sortField,l=u.sortIndexField;if(s){var c=s.op,f=void 0===c?Nl:c,h=s.field;i.push(h),a.push(f),o.push(tc(s,{forAs:!0}))}else l&&(i.push(l),a.push("max"),o.push(l));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:a,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(t){var e,n,r=this.model.layout.columns,i=this.model.component.layoutHeaders,a=[],o={},u=!0,s=!1,l=void 0;try{for(var c,f=Sg[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value,d=!0,p=!1,v=void 0;try{for(var g,m=Cg[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value,b=null!==(e=i[h]&&i[h][y])&&void 0!==e?e:[],x=!0,_=!1,w=void 0;try{for(var k,A=b[Symbol.iterator]();!(x=(k=A.next()).done);x=!0)if((null===(n=k.value.axes)||void 0===n?void 0:n.length)>0){o[h]=!0;break}}catch(O){_=!0,w=O}finally{try{x||null==A.return||A.return()}finally{if(_)throw w}}}}catch(O){p=!0,v=O}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}if(o[h]){var E='length(data("'.concat(this.facet.name,'"))'),M="row"===h?r?{signal:"ceil(".concat(E," / ").concat(r,")")}:1:r?{signal:"min(".concat(E,", ").concat(r,")")}:{signal:E};a.push({name:"".concat(this.facet.name,"_").concat(h),transform:[{type:"sequence",start:0,stop:M}]})}}}catch(O){s=!0,l=O}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}var S=o.row,C=o.column;return(S||C)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}},{key:"assemble",value:function(){var t,e,n=[],r=null,i=this.getChildIndependentFieldsWithStep(),a=this.column,o=this.row,u=this.facet;if(a&&o&&(i.x||i.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var s=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),l=s.map(function(){return"distinct"});n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:s,ops:l}]})}for(var c=0,f=[Vo,Ho];c<f.length;c++){var h=f[c];this[h]&&n.push(this.assembleRowColumnHeaderData(h,r,i))}if(u){var p=this.assembleFacetHeaderData(i);p&&n.push.apply(n,d(p))}return n}},{key:"fields",get:function(){var t,e=[],n=!0,r=!1,i=void 0;try{for(var a,o=ku[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;(null===(t=this[u])||void 0===t?void 0:t.fields)&&e.push.apply(e,d(this[u].fields))}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}}]),e}();function Bm(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function Lm(t,e){var n=Ya(t);if("number"===e)return"toNumber(".concat(n,")");if("boolean"===e)return"toBoolean(".concat(n,")");if("string"===e)return"toString(".concat(n,")");if("date"===e)return"toDate(".concat(n,")");if("flatten"===e)return n;if(0===e.indexOf("date:")){var r=Bm(e.slice(5,e.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===e.indexOf("utc:")){var i=Bm(e.slice(4,e.length));return"utcParse(".concat(n,",'").concat(i,"')")}return ps(fs.unrecognizedParse(e)),null}function qm(t){var e={};return function t(e,n){if(ka(e))t(e.not,n);else if(wa(e)){var r=!0,i=!1,a=void 0;try{for(var o,u=e.and[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)t(o.value,n)}catch(d){i=!0,a=d}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else if(_a(e)){var s=!0,l=!1,c=void 0;try{for(var f,h=e.or[Symbol.iterator]();!(s=(f=h.next()).done);s=!0)t(f.value,n)}catch(d){l=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}}else n(e)}(t.filter,function(t){var n;if(Hs(t)){var r=null;zs(t)?r=t.equal:Us(t)?r=t.range[0]:Ws(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(gs(r)?e[t.field]="date":L(r)?e[t.field]="number":w(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}}),e}function Im(t){var e={};function n(t){var n;gc(t)?e[t.field]="date":"quantitative"===t.type&&w(n=t.aggregate)&&Ta(["min","max"],n)?e[t.field]="number":Za(t.field)>1?t.field in e||(e[t.field]="flatten"):Ql(t)&&zl(t.sort)&&Za(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Ly(t)||qy(t))&&t.forEachFieldDef(function(e,r){if(Yl(e))n(e);else{var i=Fu(r),a=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:a.type}))}}),Ly(t)){var r=t.mark,i=t.markDef,a=t.encoding;if(Ao(r)&&!t.encoding.order){var o=a["horizontal"===i.orient?"y":"x"];!$l(o)||"quantitative"!==o.type||o.field in e||(e[o.field]="number")}}return e}var Um=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t)))._parse=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(Da(this._parse))}},{key:"merge",value:function(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}},{key:"assembleFormatParse",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,a=qa(this._parse)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=this._parse[o];1===Za(o)&&(t[o]=u)}}catch(s){n=!0,r=s}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return t}},{key:"producedFields",value:function(){return new Set(qa(this._parse))}},{key:"dependentFields",value:function(){return new Set(qa(this._parse))}},{key:"assembleTransforms",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return qa(this._parse).filter(function(t){return!e||Za(t)>1}).map(function(e){var n=Lm(e,t._parse[e]);return n?{type:"formula",expr:n,as:Qa(e)}:null}).filter(function(t){return null!==t})}},{key:"parse",get:function(){return this._parse}}],[{key:"makeExplicit",value:function(t,e,n){var r={},i=e.data;return!ah(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}},{key:"makeWithAncestors",value:function(t,n,r,i){var a=!0,o=!1,u=void 0;try{for(var s,l=qa(r)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=i.getWithExplicit(c);void 0!==f.value&&(f.explicit||f.value===r[c]||"derived"===f.value||"flatten"===r[c]?delete r[c]:ps(fs.differentParse(c,r[c],f.value)))}}catch(C){o=!0,u=C}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var h=!0,d=!1,p=void 0;try{for(var v,g=qa(n)[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var m=v.value,y=i.get(m);void 0!==y&&(y===n[m]?delete n[m]:ps(fs.differentParse(m,n[m],y)))}}catch(C){d=!0,p=C}finally{try{h||null==g.return||g.return()}finally{if(d)throw p}}var b=new Gg(n,r);i.copyAll(b);var x={},_=!0,w=!1,k=void 0;try{for(var A,E=qa(b.combine())[Symbol.iterator]();!(_=(A=E.next()).done);_=!0){var M=A.value,S=b.get(M);null!==S&&(x[M]=S)}}catch(C){w=!0,k=C}finally{try{_||null==E.return||E.return()}finally{if(w)throw k}}return 0===qa(x).length||i.parseNothing?null:new e(t,x)}}]),e}(),Wm=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"addDimensions",value:function(t){this.transform.groupby=Pa(this.transform.groupby.concat(t),function(t){return t})}},{key:"dependentFields",value:function(){var t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(function(e){return t.add(e)}),this.transform.joinaggregate.map(function(t){return t.field}).filter(function(t){return void 0!==t}).forEach(function(e){return t.add(e)}),t}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(t){var e;return null!==(e=t.as)&&void 0!==e?e:tc(t)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=[],e=[],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=this.transform.joinaggregate[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.push(s.op),n.push(this.getDefaultName(s)),t.push(void 0===s.field?null:s.field)}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var l=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==l?{groupby:l}:{})}}]),e}(),Hm=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t)))._stack=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this._stack))}},{key:"addDimensions",value:function(t){var e;(e=this._stack.facetby).push.apply(e,d(t))}},{key:"dependentFields",value:function(){var t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(function(e){return t.add(e)}),this._stack.facetby.forEach(function(e){return t.add(e)}),this._stack.sort.field.forEach(function(e){return t.add(e)}),t}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(Da(this._stack))}},{key:"getGroupbyFields",value:function(){var t=this._stack,e=t.dimensionFieldDef,n=t.impute,r=t.groupby;return e?e.bin?n?[tc(e,{binSuffix:"mid"})]:[tc(e,{}),tc(e,{binSuffix:"end"})]:[tc(e)]:null!==r&&void 0!==r?r:[]}},{key:"assemble",value:function(){var t=[],e=this._stack,n=e.facetby,r=e.dimensionFieldDef,i=e.stackField,a=e.stackby,o=e.sort,u=e.offset,s=e.impute,l=e.as;if(s&&r){var c=r.band,f=void 0===c?.5:c;r.bin&&t.push({type:"formula",expr:"".concat(f,"*")+tc(r,{expr:"datum"})+"+".concat(1-f,"*")+tc(r,{expr:"datum",binSuffix:"end"}),as:tc(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[].concat(d(a),d(n)),key:tc(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[].concat(d(this.getGroupbyFields()),d(n)),field:i,sort:o,as:l,offset:u}),t}},{key:"stack",get:function(){return this._stack}}],[{key:"makeFromTransform",value:function(t,n){var r=n.stack,i=n.groupby,a=n.as,o=n.offset,u=void 0===o?"zero":o,s=[],l=[];if(void 0!==n.sort){var c=!0,f=!1,h=void 0;try{for(var d,p=n.sort[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;s.push(v.field),l.push(Ka(v.order,"ascending"))}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}return new e(t,{stackField:r,groupby:i,offset:u,sort:{field:s,order:l},facetby:[],as:function(t){return x(t)&&t.every(function(t){return w(t)})&&t.length>1}(a)?a:w(a)?[a,a+"_end"]:[n.stack+"_start",n.stack+"_end"]})}},{key:"makeFromEncoding",value:function(t,n){var r,i=n.stack,a=n.encoding;if(!i)return null;i.groupbyChannel&&(r=fc(a[i.groupbyChannel]));var o,u=function(t){return t.stack.stackBy.reduce(function(t,e){var n=tc(e.fieldDef);return n&&t.push(n),t},[])}(n),s=n.encoding.order;return o=x(s)||$l(s)?us(s):u.reduce(function(t,e){return t.field.push(e),t.order.push("descending"),t},{field:[],order:[]}),new e(t,{dimensionFieldDef:r,stackField:n.vgField(i.fieldChannel),facetby:[],stackby:u,sort:o,offset:i.offset,impute:i.impute,as:[n.vgField(i.fieldChannel,{suffix:"start",forAs:!0}),n.vgField(i.fieldChannel,{suffix:"end",forAs:!0})]})}}]),e}(),Vm=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"addDimensions",value:function(t){this.transform.groupby=Pa(this.transform.groupby.concat(t),function(t){return t})}},{key:"dependentFields",value:function(){var t,e,n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(function(t){return n.add(t)}),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach(function(t){return n.add(t.field)}),this.transform.window.map(function(t){return t.field}).filter(function(t){return void 0!==t}).forEach(function(t){return n.add(t)}),n}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(t){var e;return null!==(e=t.as)&&void 0!==e?e:tc(t)}},{key:"hash",value:function(){return"WindowTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t,e=[],n=[],r=[],i=[],a=!0,o=!1,u=void 0;try{for(var s,l=this.transform.window[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;n.push(c.op),r.push(this.getDefaultName(c)),i.push(void 0===c.param?null:c.param),e.push(void 0===c.field?null:c.field)}}catch(k){o=!0,u=k}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var f=this.transform.frame,h=this.transform.groupby;if(f&&null===f[0]&&null===f[1]&&n.every(function(t){return Lo(t)}))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==h?{groupby:h}:{});var d=[],p=[];if(void 0!==this.transform.sort){var v=!0,g=!1,m=void 0;try{for(var y,b=this.transform.sort[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var x=y.value;d.push(x.field),p.push(null!==(t=x.order)&&void 0!==t?t:"ascending")}}catch(k){g=!0,m=k}finally{try{v||null==b.return||b.return()}finally{if(g)throw m}}}var _={field:d,order:p},w=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:_},void 0!==w?{ignorePeers:w}:{}),void 0!==h?{groupby:h}:{}),void 0!==f?{frame:f}:{})}}]),e}(),Gm=function(t){function e(t){return f(this,e),a(this,o(e).call(this,t))}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null)}}]),h(e,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([ff])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:ff}}}]),e}(),$m=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){var e=t.parent;if(t instanceof Um){if(Fm(e))return this.flags;if(e.numChildren()>1)return this.setContinue(),this.flags;if(e instanceof Um)this.setMutated(),e.merge(t);else{if(La(e.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}]),e}(),Ym=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,jm),h(e,[{key:"mergeNodes",value:function(t,e){var n=e.shift(),r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;t.removeChild(s),s.parent=n,s.remove()}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"run",value:function(t){for(var e=t.children.map(function(t){return t.hash()}),n={},r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);var i=!0,a=!1,o=void 0;try{for(var u,s=qa(n)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;n[l].length>1&&(this.setMutated(),this.mergeNodes(t,n[l]))}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var c=!0,f=!1,h=void 0;try{for(var d,p=t.children[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;this.run(v)}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}return this.mutatedFlag}}]),e}(),Xm=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){return t instanceof Sd||t.numChildren()>0||t instanceof zm?this.flags:(this.setMutated(),t.remove(),this.flags)}}]),e}(),Jm=function(t){function e(){var t;return f(this,e),(t=a(this,o(e).apply(this,arguments))).fields=new Set,t.prev=null,t}return s(e,Nm),h(e,[{key:"run",value:function(t){if(this.setContinue(),t instanceof Cd){var e=t.producedFields();za(e,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([].concat(d(this.fields),d(e))),this.prev=t}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),e}(),Qm=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){this.setContinue();var e=t.parent.children.filter(function(t){return t instanceof Cd}),n=e.pop(),r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.setMutated(),n.merge(s)}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return this.flags}}]),e}();function Zm(t){if(t instanceof zm)if(1!==t.numChildren()||t.children[0]instanceof Sd){var e=t.model.component.data.main;!function t(e){if(e instanceof Sd&&e.type===lh&&1===e.numChildren()){var n=e.children[0];n instanceof zm||(n.swapWithParent(),t(e))}}(e);var n=(c=t,function t(e){if(!(e instanceof zm)){var n=e.clone();if(n instanceof Sd){var r=ay+n.getSource();n.setSource(r),c.model.component.data.outputNodes[r]=n}else(n instanceof Pm||n instanceof Hm||n instanceof Vm||n instanceof Wm)&&n.addDimensions(c.fields);return e.children.flatMap(t).forEach(function(t){return t.parent=n}),[n]}return e.children.flatMap(t)}),r=t.children.map(n).flat(),i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)u.value.parent=e}catch(f){a=!0,o=f}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var l=t.children[0];(l instanceof Pm||l instanceof Hm||l instanceof Vm||l instanceof Wm)&&l.addDimensions(t.fields),l.swapWithParent(),Zm(t)}else t.children.map(Zm);var c}var Km=function(t){function e(){return f(this,e),a(this,o(e).call(this))}return s(e,jm),h(e,[{key:"run",value:function(t){t instanceof Sd&&!t.isRequired()&&(this.setMutated(),t.remove());var e=!0,n=!1,r=void 0;try{for(var i,a=t.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this.run(o)}}catch(u){n=!0,r=u}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return this.mutatedFlag}}]),e}(),ty=function(t){function e(t){var n;return f(this,e),(n=a(this,o(e).call(this))).requiresSelectionId=t&&fp(t),n}return s(e,jm),h(e,[{key:"run",value:function(t){t instanceof Gm&&(this.requiresSelectionId&&(Fm(t.parent)||t.parent instanceof Pm||t.parent instanceof Um)||(this.setMutated(),t.remove()));var e=!0,n=!1,r=void 0;try{for(var i,a=t.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this.run(o)}}catch(u){n=!0,r=u}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return this.mutatedFlag}}]),e}(),ey=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){var e=t.parent,n=d(e.children),r=e.children.filter(function(t){return t instanceof Um});if(e.numChildren()>1&&r.length>=1){var i={},a=new Set,o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value.parse,h=!0,p=!1,v=void 0;try{for(var g,m=qa(f)[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var y=g.value;y in i?i[y]!==f[y]&&a.add(y):i[y]=f[y]}}catch(z){p=!0,v=z}finally{try{h||null==m.return||m.return()}finally{if(p)throw v}}}}catch(z){u=!0,s=z}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}var b=!0,x=!1,_=void 0;try{for(var w,k=a[Symbol.iterator]();!(b=(w=k.next()).done);b=!0)delete i[w.value]}catch(z){x=!0,_=z}finally{try{b||null==k.return||k.return()}finally{if(x)throw _}}if(0!==qa(i).length){this.setMutated();var A=new Um(e,i),E=!0,M=!1,S=void 0;try{for(var C,O=n[Symbol.iterator]();!(E=(C=O.next()).done);E=!0){var D=C.value;if(D instanceof Um){var F=!0,T=!1,N=void 0;try{for(var j,R=qa(i)[Symbol.iterator]();!(F=(j=R.next()).done);F=!0){var P=j.value;delete D.parse[P]}}catch(z){T=!0,N=z}finally{try{F||null==R.return||R.return()}finally{if(T)throw N}}}e.removeChild(D),D.parent=A,D instanceof Um&&0===qa(D.parse).length&&D.remove()}}catch(z){M=!0,S=z}finally{try{E||null==O.return||O.return()}finally{if(M)throw S}}}}return this.setContinue(),this.flags}}]),e}(),ny=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){var e=t.parent,n=e.children.filter(function(t){return t instanceof Pm}),r={},i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,c=Da(l.groupBy);c in r||(r[c]=[]),r[c].push(l)}}catch(A){a=!0,o=A}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var f=!0,h=!1,d=void 0;try{for(var p,v=qa(r)[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=r[p.value];if(g.length>1){var m=g.pop(),y=!0,b=!1,x=void 0;try{for(var _,w=g[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var k=_.value;m.merge(k)&&(e.removeChild(k),k.parent=m,k.remove(),this.setMutated())}}catch(A){b=!0,x=A}finally{try{y||null==w.return||w.return()}finally{if(b)throw x}}}}}catch(A){h=!0,d=A}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}return this.setContinue(),this.flags}}]),e}(),ry=function(t){function e(t){var n;return f(this,e),(n=a(this,o(e).call(this))).model=t,n}return s(e,Nm),h(e,[{key:"run",value:function(t){var e=t.parent,n=!(Fm(e)||e instanceof og||e instanceof Um||e instanceof Gm),r=[],i=[],a=!0,o=!1,u=void 0;try{for(var s,l=e.children[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;c instanceof Mm&&(n&&!La(e.producedFields(),c.dependentFields())?r.push(c):i.push(c))}}catch(E){o=!0,u=E}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(r.length>0){var f=r.pop(),h=!0,d=!1,p=void 0;try{for(var v,g=r[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var m=v.value;f.merge(m,this.model.renameSignal.bind(this.model))}}catch(E){d=!0,p=E}finally{try{h||null==g.return||g.return()}finally{if(d)throw p}}this.setMutated(),e instanceof Mm?e.merge(f,this.model.renameSignal.bind(this.model)):f.swapWithParent()}if(i.length>1){var y=i.pop(),b=!0,x=!1,_=void 0;try{for(var w,k=i[Symbol.iterator]();!(b=(w=k.next()).done);b=!0){var A=w.value;y.merge(A,this.model.renameSignal.bind(this.model))}}catch(E){x=!0,_=E}finally{try{b||null==k.return||k.return()}finally{if(x)throw _}}this.setMutated()}return this.setContinue(),this.flags}}]),e}(),iy=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Nm),h(e,[{key:"run",value:function(t){var e=t.parent,n=d(e.children);if(!Na(n,function(t){return t instanceof Sd})||e.numChildren()<=1)return this.setContinue(),this.flags;var r,i=[],a=!0,o=!1,u=void 0;try{for(var s,l=n[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(c instanceof Sd){for(var f=c;1===f.numChildren();){var h=f.children[0];if(!(h instanceof Sd))break;f=h}i.push.apply(i,d(f.children)),r?(e.removeChild(c),c.parent=r.parent,r.parent.removeChild(r),r.parent=f,this.setMutated()):r=f}else i.push(c)}}catch(x){o=!0,u=x}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(i.length){this.setMutated();var p=!0,v=!1,g=void 0;try{for(var m,y=i[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value;b.parent.removeChild(b),b.parent=r}}catch(x){v=!0,g=x}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}}return this.setContinue(),this.flags}}]),e}(),ay="scale_",oy=5;function uy(t){var e=[];return t.forEach(function t(n){0===n.numChildren()?e.push(n):n.children.forEach(t)}),e}function sy(t){return t}function ly(t,e){return e.map(function(e){if(t instanceof Nm){var n=t.optimizeNextFromLeaves(e);return t.reset(),n}return t.run(e)}).some(sy)}function cy(t,e){var n=t.sources,r=new Set;return r.add(ly(new Km,n)),r.add(ly(new ty(e),n)),n=n.filter(function(t){return t.numChildren()>0}),r.add(ly(new Xm,uy(n))),n=n.filter(function(t){return t.numChildren()>0}),r.add(ly(new $m,uy(n))),r.add(ly(new ry(e),uy(n))),r.add(ly(new Jm,uy(n))),r.add(ly(new ey,uy(n))),r.add(ly(new ny,uy(n))),r.add(ly(new Qm,uy(n))),r.add(ly(new Ym,n)),r.add(ly(new iy,uy(n))),t.sources=n,r.has(!0)}var fy=function(){function t(e){f(this,t),Object.defineProperty(this,"signal",{enumerable:!0,get:e})}return h(t,null,[{key:"fromName",value:function(e,n){return new t(function(){return e(n)})}}]),t}();function hy(t){Ly(t)?function(t){var e=t.component.scales,n=!0,r=!1,i=void 0;try{for(var a,o=qa(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=dy(t,u);if(e[u].setWithExplicit("domains",s),my(t,u),t.component.data.isFaceted){for(var l=t;!qy(l)&&l.parent;)l=l.parent;if("shared"===l.component.resolve.scale[u]){var c=!0,f=!1,h=void 0;try{for(var d,p=s.value[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;Zu(v)&&(v.data=ay+v.data.replace(ay,""))}}catch(g){f=!0,h=g}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}}}}catch(g){r=!0,i=g}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}(t):function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=t.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)hy(i.value)}catch(w){n=!0,r=w}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}var o=t.component.scales,u=!0,s=!1,l=void 0;try{for(var c,f=qa(o)[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value,d=void 0,p=null,v=!0,g=!1,m=void 0;try{for(var y,b=t.children[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var x=y.value.component.scales[h];if(x){d=void 0===d?x.getWithExplicit("domains"):Qg(d,x.getWithExplicit("domains"),"domains","scale",by);var _=x.get("selectionExtent");p&&_&&p.selection!==_.selection&&ps("The same selection must be used to override scale domains in a layered view."),p=_}}}catch(w){g=!0,m=w}finally{try{v||null==b.return||b.return()}finally{if(g)throw m}}o[h].setWithExplicit("domains",d),p&&o[h].set("selectionExtent",p,!0)}}catch(w){s=!0,l=w}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}(t)}function dy(t,e){var n=t.getScaleComponent(e).get("type"),r=function(t,e,n,r){if("unaggregated"===t){var i=yy(e,n),a=i.valid,o=i.reason;if(!a)return void ps(o)}else if(void 0===t&&r.useUnaggregatedDomain&&yy(e,n).valid)return"unaggregated";return t}(t.scaleDomain(e),t.fieldDef(e),n,t.config.scale);return r!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:r})),"x"===e&&t.channelHasField("x2")?t.channelHasField("x")?Qg(vy(n,r,t,"x"),vy(n,r,t,"x2"),"domain","scale",by):vy(n,r,t,"x2"):"y"===e&&t.channelHasField("y2")?t.channelHasField("y")?Qg(vy(n,r,t,"y"),vy(n,r,t,"y2"),"domain","scale",by):vy(n,r,t,"y2"):vy(n,r,t,e)}function py(t,e,n){var r,i=null===(r=Rs(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map(function(t){var r=yc(t,{timeUnit:n,type:e});return{signal:"{data: ".concat(r,"}")}})}(t,e,i):[t]}function vy(t,e,n,r){var i=n.fieldDef(r),a=n.fieldDef(Fu(r));if(function(t){return t&&t.unionWith}(e)){var o=vy(t,void 0,n,r),u=py(e.unionWith,a.type,i.timeUnit);return $g([].concat(d(o.value),d(u)))}if(Ju(e))return $g([e]);if(e&&"unaggregated"!==e&&!gl(e))return $g(py(e,a.type,i.timeUnit));var s=n.stack;if(s&&r===s.fieldChannel){if("normalize"===s.offset)return Yg([[0,1]]);var l=n.requestDataName(lh);return Yg([{data:l,field:n.vgField(r,{suffix:"start"})},{data:l,field:n.vgField(r,{suffix:"end"})}])}var c=Wu(r)?function(t,e,n){if(hl(n)){var r=t.fieldDef(e),i=r.sort;if(Bl(i))return{op:"min",field:kg(r,e),order:"ascending"};var a=t.stack,o=a?[].concat(d(a.groupbyField?[a.groupbyField]:[]),d(a.stackBy.map(function(t){return t.fieldDef.field}))):void 0;if(zl(i)){var u=a&&!Ta(o,i.field);return gy(i,u)}if(Pl(i)){var s=i.encoding,l=i.order,c=t.fieldDef(s),f=c.aggregate,h=c.field,p=a&&!Ta(o,h);if(zo(f)||Bo(f))return gy({field:tc(c),order:l},p);if(Lo(f)||!f)return gy({op:f,field:h,order:l},p)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(Ta(["ascending",void 0],i))return!0}}}(n,r,t):void 0;if("unaggregated"===e){var f=n.requestDataName(lh),h=i.field;return Yg([{data:f,field:tc({field:h,aggregate:"min"})},{data:f,field:tc({field:h,aggregate:"max"})}])}if(wc(i.bin)){if(hl(t))return Yg("bin-ordinal"===t?[]:[{data:Ua(c)?n.requestDataName(lh):n.requestDataName(ch),field:n.vgField(r,xc(i,r)?{binSuffix:"range"}:{}),sort:!0!==c&&_(c)?c:{field:n.vgField(r,{}),op:"min"}}]);var p=i.bin;if(wc(p)){var v=Am(n,i.field,p);return Yg([new fy(function(){var t=n.getSignalName(v);return"[".concat(t,".start, ").concat(t,".stop]")})])}return Yg([{data:n.requestDataName(lh),field:n.vgField(r,{})}])}if(i.timeUnit&&Ta(["time","utc"],t)&&Hl(r,i,Ly(n)?n.encoding[Tu(r)]:void 0,n.markDef,n.config)){var g=n.requestDataName(lh);return Yg([{data:g,field:n.vgField(r)},{data:g,field:n.vgField(r,{suffix:"end"})}])}return Yg(c?[{data:Ua(c)?n.requestDataName(lh):n.requestDataName(ch),field:n.vgField(r),sort:c}]:[{data:n.requestDataName(lh),field:n.vgField(r)}])}function gy(t,e){var n=t.op,r=t.field,i=t.order;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:e?"sum":Nl},r?{field:Xa(r)}:{}),i?{order:i}:{})}function my(t,e){var n=t.component.scales[e],r=t.specifiedScales[e].domain,i=t.fieldDef(e).bin,a=gl(r)&&r,o=Ac(i)&&Ec(i.extent)&&i.extent;(a||o)&&n.set("selectionExtent",null!==a&&void 0!==a?a:o,!0)}function yy(t,e){var n=t.aggregate,r=t.type;return n?w(n)&&!Wo[n]?{valid:!1,reason:fs.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:fs.unaggregatedDomainWithLogScale(t)}:{valid:!0}:{valid:!1,reason:fs.unaggregateDomainHasNoEffectForRawField(t)}}function by(t,e,n,r){return t.explicit&&e.explicit&&ps(fs.mergeConflictingDomainProperty(n,r,t.value,e.value)),{explicit:t.explicit,value:[].concat(d(t.value),d(e.value))}}function xy(t){if(Zu(t)&&w(t.field))return t.field;if(function(t){return!x(t)&&"fields"in t&&!("data"in t)}(t)){var e,n=!0,r=!1,i=void 0;try{for(var a,o=t.fields[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(Zu(u)&&w(u.field))if(e){if(e!==u.field)return ps("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=u.field}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return ps("Detected faceted independent scales that union domain of identical fields from different source detected. We will assume that this is the same field from a different fork of the same data source. However, if this is not case, the result view size maybe incorrect."),e}if(function(t){return!x(t)&&"fields"in t&&"data"in t}(t)){ps("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");var s=t.fields[0];return w(s)?s:void 0}}function _y(t,e){return function(t){var e=Pa(t.map(function(t){return Zu(t)?I(t,["sort"]):t}),Da),n=Pa(t.map(function(t){if(Zu(t)){var e=t.sort;return void 0===e||Ua(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}}).filter(function(t){return void 0!==t}),Da);if(0!==e.length){if(1===e.length){var r=t[0];if(Zu(r)&&n.length>0){var i=n[0];if(n.length>1)ps(fs.MORE_THAN_ONE_SORT),i=!0;else if(_(i)&&"field"in i){var a=i.field;r.field===a&&(i=!i.order||{order:i.order})}return Object.assign(Object.assign({},r),{sort:i})}return r}var o,u=Pa(n.map(function(t){return Ua(t)||!("op"in t)||t.op in Po?t:(ps(fs.domainSortDropped(t)),!0)}),Da);1===u.length?o=u[0]:u.length>1&&(ps(fs.MORE_THAN_ONE_SORT),o=!0);var s=Pa(t.map(function(t){return Zu(t)?t.data:null}),function(t){return t});return 1===s.length&&null!==s[0]?Object.assign({data:s[0],fields:e.map(function(t){return t.field})},o?{sort:o}:{}):Object.assign({fields:e},o?{sort:o}:{})}}(t.component.scales[e].get("domains").map(function(e){return Zu(e)&&(e.data=t.lookupDataSource(e.data)),e}))}function wy(t){return Wy(t)||Uy(t)||Iy(t)?t.children.reduce(function(t,e){return t.concat(wy(e))},ky(t)):ky(t)}function ky(t){return qa(t.component.scales).reduce(function(e,n){var r=t.component.scales[n];if(r.merged)return e;var i,a=r.combine(),o=a.name,u=a.type,s=a.selectionExtent,l=(a.domains,a.range,a.reverse),c=I(a,["name","type","selectionExtent","domains","range","reverse"]),f=function(t,e,n){return"x"!==n&&"y"!==n||!Qu(t)?t:{step:{signal:e+"_step"}}}(a.range,o,n);s&&(i=function(t,e){var n=e.selection;return{signal:sg(t.getSelectionComponent(n,Wa(n)),e)}}(t,s));var h=_y(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:u},h?{domain:h}:{}),i?{domainRaw:i}:{}),{range:f}),void 0!==l?{reverse:l}:{}),c)),e},[])}var Ay=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,{},{name:t}))).merged=!1,r.setWithExplicit("type",n),r}return s(e,Gg),h(e,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||Na(this.get("domains"),function(t){return x(t)&&2===t.length&&t[0]<=0&&t[1]>=0})}}]),e}(),Ey=["range","scheme"];function My(t){return"x"===t?"width":"y"===t?"height":void 0}function Sy(t){var e=t.component.scales;Uu.forEach(function(n){var r=e[n];if(r){var i=function(t,e){var n=e.specifiedScales[t],r=e.size,i=e.getScaleComponent(t).get("type"),a=!0,o=!1,u=void 0;try{for(var s,l=Ey[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(void 0!==n[c]){var f=bl(i,c),h=xl(t,c);if(f)if(h)ps(h);else switch(c){case"range":return $g(n[c]);case"scheme":return $g(Oy(n[c]))}else ps(fs.scalePropertyNotWorkWithScaleType(i,c,t))}}}catch(v){o=!0,u=v}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(t===$o||t===Yo){var d=t===$o?"width":"height",p=r[d];if(bf(p)){if(hl(i))return $g({step:p.step});ps(fs.stepDropped(d))}}return Yg(function(t,e){var n=e.size,r=e.config,i=e.mark,a=e.getSignalName.bind(e),o=e.fieldDef(t).type,u=e.getScaleComponent(t).get("type"),s=e.specifiedScales[t],l=s.domain,c=s.domainMid;switch(t){case $o:case Yo:if(Ta(["point","band"],u))if(t!==$o||n.width){if(t===Yo&&!n.height){var f=Af(r.view,"height");if(bf(f))return f}}else{var h=Af(r.view,"width");if(bf(h))return h}var d=My(t),p=e.getName(d);return t===Yo&&dl(u)?[fy.fromName(a,p),0]:[0,fy.fromName(a,p)];case au:var v=e.component.scales[t].get("zero"),g=function t(e,n,r){if(n)return Ju(n)?{signal:"".concat(n.signal," ? 0 : ").concat(t(e,!1,r))}:0;switch(e){case"bar":case"tick":return r.scale.minBandSize;case"line":case"trail":case"rule":return r.scale.minStrokeWidth;case"text":return r.scale.minFontSize;case"point":case"square":case"circle":return r.scale.minSize}throw new Error(fs.incompatibleChannel("size",e))}(i,v,r),m=function(t,e,n,r){var i={x:Cy(n,"x"),y:Cy(n,"y")};switch(t){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var a=Fy(e,i,r.view);return L(a)?a-1:new fy(function(){return"".concat(a.signal," - 1")});case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var o=Fy(e,i,r.view);return L(o)?Math.pow(Dy*o,2):new fy(function(){return"pow(".concat(Dy," * ").concat(o.signal,", 2)")})}throw new Error(fs.incompatibleChannel("size",t))}(i,n,e,r);return vl(u)?function(t,e,n){var r=function(){var r=Ju(e)?e.signal:e,i=Ju(t)?t.signal:t,a="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(a,", ").concat(a,")")};return Ju(e)?new fy(r):{signal:r()}}(g,m,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&x(n)?n.length+1:(ps(fs.domainRequiredForThresholdScale(r)),3)}}(u,r,l,t)):[g,m];case lu:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case cu:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case iu:return"symbol";case eu:case nu:case ru:return"ordinal"===u?"nominal"===o?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case ou:case uu:case su:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(t))}(t,e))}(n,t);r.setWithExplicit("range",i)}})}function Cy(t,e){var n=t.fieldDef(e);if(n&&n.bin&&wc(n.bin)){var r=Am(t,n.field,n.bin),i=My(e),a=t.getName(i);return new fy(function(){var e=t.getSignalName(r),n="(".concat(e,".stop - ").concat(e,".start) / ").concat(e,".step");return"".concat(t.getSignalName(a)," / (").concat(n,")")})}}function Oy(t){return function(t){return!w(t)&&!!t.name}(t)?Object.assign({scheme:t.name},Ca(t,["name"])):{scheme:t}}var Dy=.95;function Fy(t,e,n){var r=bf(t.width)?t.width.step:kf(n,"width"),i=bf(t.height)?t.height.step:kf(n,"height");return e.x||e.y?new fy(function(){var t=[e.x?e.x.signal:r,e.y?e.y.signal:i];return"min(".concat(t.join(", "),")")}):Math.min(r,i)}function Ty(t,e){Ly(t)?function(t,e){var n=t.component.scales;qa(n).forEach(function(r){var i=t.specifiedScales[r],a=n[r],o=t.getScaleComponent(r),u=t.fieldDef(r),s=t.config,l=i[e],c=o.get("type"),f=bl(c,e),h=xl(r,e);if(void 0!==l&&(f?h&&ps(h):ps(fs.scalePropertyNotWorkWithScaleType(c,e,r))),f&&void 0===h)if(void 0!==l)a.copyKeyFromObject(e,i);else{var d=function(t,e,n,r,i,a,o,u,s,l){var c=l.scale,f=r.type,h=r.sort;switch(t){case"bins":return function(t,e){var n=e.bin;if(wc(n)){var r=Am(t,e.field,n);return new fy(function(){return t.getSignalName(r)})}if(kc(n)&&Ac(n)&&void 0!==n.step)return{step:n.step}}(e,r);case"interpolate":return function(t,e){if(Ta([eu,nu,ru],t)&&"nominal"!==e)return"hcl"}(n,f);case"nice":return function(t,e,n){if(!n.bin&&!Ta([Xs.TIME,Xs.UTC],t))return!!Ta([$o,Yo],e)||void 0}(i,n,r);case"padding":return function(t,e,n,r,i,a){if(Ta([$o,Yo],t)){if(pl(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=i.type,u=i.orient;if("bar"===o&&!r.bin&&!r.timeUnit&&("vertical"===u&&"x"===t||"horizontal"===u&&"y"===t))return a.continuousBandSize}if(e===Xs.POINT)return n.pointPadding}}(n,i,c,r,s,l.bar);case"paddingInner":return function(t,e,n,r){if(void 0===t&&Ta([$o,Yo],e)){var i=r.bandPaddingInner,a=r.barBandPaddingInner,o=r.rectBandPaddingInner;return Ka(i,"bar"===n?a:o)}}(a,n,s.type,c);case"paddingOuter":return function(t,e,n,r,i,a){if(void 0===t)return Ta([$o,Yo],e)&&n===Xs.BAND?Ka(a.bandPaddingOuter,Ju(i)?{signal:"".concat(i.signal,"/2")}:i/2):void 0}(a,n,i,s.type,o,c);case"reverse":return function(t,e,n,r){var i=dl(t)&&"descending"===e;return"x"===n&&void 0!==r.xReverse?i?Ju(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse:!!i||void 0}(i,h,n,c);case"zero":return function(t,e,n,r,i){if(n&&"unaggregated"!==n&&dl(i)){if(x(n)){var a=n[0],o=n[n.length-1];if(a<=0&&o>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!vl(i))return!0;if(!e.bin&&Ta([$o,Yo],t)){var u=r.orient;return!Ta(["bar","area","line","trail"],r.type)||!("horizontal"===u&&"y"===t||"vertical"===u&&"x"===t)}return!1}(n,r,u,s,i)}return c[t]}(e,t,r,u,o.get("type"),o.get("padding"),o.get("paddingInner"),i.domain,t.markDef,s);void 0!==d&&a.set(e,d,!1)}})}(t,e):jy(t,e)}function Ny(t){Ly(t)?Sy(t):jy(t,"range")}function jy(t,e){var n=t.component.scales,r=!0,i=!1,a=void 0;try{for(var o,u=t.children[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;"range"===e?Ny(s):Ty(s,e)}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}qa(n).forEach(function(r){var i,a=!0,o=!1,u=void 0;try{for(var s,c=t.children[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value.component.scales[r];f&&(i=Qg(i,f.getWithExplicit(e),e,"scale",Xg(function(t,n){switch(e){case"range":return t.step&&n.step?t.step-n.step:0}return 0})))}}catch(l){o=!0,u=l}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}n[r].setWithExplicit(e,i)})}function Ry(t,e,n,r){var i=function(t,e,n){switch(e.type){case"nominal":case"ordinal":return _u(t)||"discrete"===$u(t)?("shape"===t&&"ordinal"===e.type&&ps(fs.discreteChannelCannotEncode(t,"ordinal")),"ordinal"):Ta(["x","y"],t)&&Ta(["rect","bar","image","rule"],n)?"band":"point";case"temporal":return _u(t)?"time":"discrete"===$u(t)?(ps(fs.discreteChannelCannotEncode(t,"temporal")),"ordinal"):e.timeUnit&&Rs(e.timeUnit).utc?"utc":"time";case"quantitative":return _u(t)?wc(e.bin)?"bin-ordinal":"linear":"discrete"===$u(t)?(ps(fs.discreteChannelCannotEncode(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(fs.invalidFieldType(e.type))}(e,n,r),a=t.type;return Wu(e)?void 0!==a?wl(e,a)?_l(a,n.type)?a:(ps(fs.scaleTypeNotWorkWithFieldDef(a,i)),i):(ps(fs.scaleTypeNotWorkWithChannel(e,a,i)),i):i:null}function Py(t){Ly(t)?t.component.scales=function(t){var e=t.encoding,n=t.mark;return Uu.reduce(function(r,i){var a,o,u=e[i];if($l(u)&&n===ko&&i===iu&&u.type===el)return r;if($l(u)?(a=u,o=u.scale):Gl(u)&&(a=u.condition,o=u.condition.scale),a&&null!==o&&!1!==o){var s=Ry(o=null!==o&&void 0!==o?o:{},i,a,n);r[i]=new Ay(t.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}(t):t.component.scales=function(t){var e=t.component.scales={},n={},r=t.component.resolve,i=!0,a=!1,o=void 0;try{for(var u,s=function(){var e=u.value;Py(e),qa(e.component.scales).forEach(function(i){var a;if(r.scale[i]=null!==(a=r.scale[i])&&void 0!==a?a:function(t,e){if(Wy(e)||qy(e))return"shared";if(Uy(e)||Iy(e))return Ta(Pu,t)?"independent":"shared";throw new Error("invalid model type for resolve")}(i,t),"shared"===r.scale[i]){var o=n[i],u=e.component.scales[i].getWithExplicit("type");o?function(t,e){var n=nl[t],r=nl[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}(o.value,u.value)?n[i]=Qg(o,u,"type","scale",zy):(r.scale[i]="independent",delete n[i]):n[i]=u}})},l=t.children[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)s()}catch(E){a=!0,o=E}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var c=!0,f=!1,h=void 0;try{for(var d,p=qa(n)[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value,g=t.scaleName(v,!0),m=n[v];e[v]=new Ay(g,m);var y=!0,b=!1,x=void 0;try{for(var _,w=t.children[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var k=_.value,A=k.component.scales[v];A&&(k.renameScale(A.get("name"),g),A.merged=!0)}}catch(E){b=!0,x=E}finally{try{y||null==w.return||w.return()}finally{if(b)throw x}}}}catch(E){f=!0,h=E}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}return e}(t)}var zy=Xg(function(t,e){return al(t)-al(e)}),By=function(){function t(){f(this,t),this.nameMap={}}return h(t,[{key:"rename",value:function(t,e){this.nameMap[t]=e}},{key:"has",value:function(t){return void 0!==this.nameMap[t]}},{key:"get",value:function(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}]),t}();function Ly(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function qy(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function Iy(t){return"repeat"===(null===t||void 0===t?void 0:t.type)}function Uy(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function Wy(t){return"layer"===(null===t||void 0===t?void 0:t.type)}var Hy=function(){function t(e,n,r,i,a,o,u,s){var l,c,h=this;f(this,t),this.type=n,this.parent=r,this.config=a,this.repeater=o,this.view=s,this.children=[],this.correctDataNames=function(t){return t.from&&t.from.data&&(t.from.data=h.lookupDataSource(t.from.data)),t.from&&t.from.facet&&t.from.facet.data&&(t.from.facet.data=h.lookupDataSource(t.from.facet.data)),t},this.parent=r,this.config=a,this.repeater=o,this.name=null!==(l=e.name)&&void 0!==l?l:i,this.title=Xu(e.title)?{text:e.title}:e.title,this.scaleNameMap=r?r.scaleNameMap:new By,this.projectionNameMap=r?r.projectionNameMap:new By,this.signalNameMap=r?r.signalNameMap:new By,this.data=e.data,this.description=e.description,this.transforms=(null!==(c=e.transform)&&void 0!==c?c:[]).map(function(t){return fh(t)?{filter:Aa(t.filter,Ys)}:t}),this.layout="layer"===n||"unit"===n?{}:function(t,e,n){var r,i,a=n[e],o={},u=a.spacing,s=a.columns;void 0!==u&&(o.spacing=u),void 0!==s&&(ql(t)&&!Ll(t.facet)||yf(t)&&x(t.repeat)||vf(t))&&(o.columns=s),gf(t)&&(o.columns=1);var l=!0,c=!1,f=void 0;try{for(var h,d=_f[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;if(void 0!==t[p])if("spacing"===p){var v=t[p];o[p]=L(v)?v:{row:null!==(r=v.row)&&void 0!==r?r:u,column:null!==(i=v.column)&&void 0!==i?i:u}}else o[p]=t[p]}}catch(g){c=!0,f=g}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}return o}(e,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:ql(e)||r&&r.component.data.isFaceted&&void 0===e.data},layoutSize:new Gg,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},u?Ma(u):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return h(t,[{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){!function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreRange;Py(t),hy(t);var n=!0,r=!1,i=void 0;try{for(var a,o=yl[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)Ty(t,a.value)}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e||Ny(t)}(this)}},{key:"parseProjection",value:function(){wm(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){fm(this)}},{key:"assembleGroupStyle",value:function(){var t,e;if("unit"===this.type||"layer"===this.type)return null!==(e=null===(t=this.view)||void 0===t?void 0:t.style)&&void 0!==e?e:"cell"}},{key:"assembleEncodeFromView",value:function(t){var e=I(t,["style"]),n={},r=!0,i=!1,a=void 0;try{for(var o,u=qa(e)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=e[s];void 0!==l&&(n[s]=es(l))}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},{key:"assembleGroupEncodeEntry",value:function(t){var e=void 0;return this.view&&(e=this.assembleEncodeFromView(this.view)),t||"unit"!==this.type&&"layer"!==this.type?e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==e&&void 0!==e?e:{})}},{key:"assembleLayout",value:function(){if(this.layout){var t=this.layout,e=t.spacing,n=I(t,["spacing"]),r=this.component,i=this.config,a=function(t,e){var n={},r=!0,i=!1,a=void 0;try{for(var o,u=ku[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=t[s];if(null===l||void 0===l?void 0:l.facetFieldDef){var c=Mg(["titleAnchor","titleOrient"],l.facetFieldDef,e,s),f=c.titleAnchor,h=Ag(s,c.titleOrient),d=zg(f,h);void 0!==d&&(n[h]=d)}}}catch(p){i=!0,a=p}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return qa(n).length>0?n:void 0}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),a?{titleBand:a}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var t=this.component.layoutHeaders,e=[],n=!0,r=!1,i=void 0;try{for(var a,o=ku[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;t[u].title&&e.push(Og(this,u))}}catch(p){r=!0,i=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,l=!1,c=void 0;try{for(var f,h=Sg[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value;e=e.concat(Tg(this,d))}}catch(p){l=!0,c=p}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}return e}},{key:"assembleAxes",value:function(){return function(t,e){var n=t.x,r=void 0===n?[]:n,i=t.y,a=void 0===i?[]:i;return[].concat(d(r.map(function(t){return hg(t,"grid",e)})),d(a.map(function(t){return hg(t,"grid",e)})),d(r.map(function(t){return hg(t,"main",e)})),d(a.map(function(t){return hg(t,"main",e)}))).filter(function(t){return t})}(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return gm(this)}},{key:"assembleProjections",value:function(){return ym(this)}},{key:"assembleTitle",value:function(){var t,e,n,r=null!==(t=this.title)&&void 0!==t?t:{},i=r.encoding,a=I(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},Yu(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text)return Ta(["unit","layer"],this.type)?Ta(["middle",void 0],o.anchor)&&(o.frame=null!==(e=o.frame)&&void 0!==e?e:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",qa(o).length>0?o:void 0}},{key:"assembleGroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);var n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||qy(this.parent)?wy(this):[];r.length>0&&(e.scales=r);var i=this.assembleAxes();i.length>0&&(e.axes=i);var a=this.assembleLegends();return a.length>0&&(e.legends=a),e}},{key:"getName",value:function(t){return Wa((this.name?this.name+"_":"")+t)}},{key:"requestDataName",value:function(t){var e,n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(e=r[n])&&void 0!==e?e:0)+1,n}},{key:"getSizeSignalRef",value:function(t){if(qy(this.parent)){var e=Bu(Wg(t)),n=this.component.scales[e];if(n&&!n.merged){var r=n.get("type"),i=n.get("range");if(hl(r)&&Qu(i)){var a=n.get("name"),o=xy(_y(this,e));return o?{signal:Ug(a,n,tc({aggregate:"distinct",field:o},{expr:"datum"}))}:(ps("Unknown field for ".concat(e,". Cannot calculate view size.")),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}},{key:"lookupDataSource",value:function(t){var e=this.component.data.outputNodes[t];return e?e.getSource():t}},{key:"getSignalName",value:function(t){return this.signalNameMap.get(t)}},{key:"renameSignal",value:function(t,e){this.signalNameMap.rename(t,e)}},{key:"renameScale",value:function(t,e){this.scaleNameMap.rename(t,e)}},{key:"renameProjection",value:function(t,e){this.projectionNameMap.rename(t,e)}},{key:"scaleName",value:function(t,e){return e?this.getName(t):Cu(t)&&Wu(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}},{key:"projectionName",value:function(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");var e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}},{key:"getSelectionComponent",value:function(t,e){var n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error(fs.selectionNotFound(e));return n}},{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}}]),t}(),Vy=function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,Hy),h(e,[{key:"vgField",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(t);if(n)return tc(n,e)}},{key:"reduceFieldDef",value:function(t,e){return Nc(this.getMapping(),function(e,n,r){var i=cc(n);return i?t(e,i,r):e},e)}},{key:"forEachFieldDef",value:function(t,e){Tc(this.getMapping(),function(e,n){var r=cc(e);r&&t(r,n)},e)}}]),e}(),Gy=function(t){function e(t,n){var r,i,u,s;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var l=null!==(i=r.transform.as)&&void 0!==i?i:[void 0,void 0];return r.transform.as=[null!==(u=l[0])&&void 0!==u?u:"value",null!==(s=l[1])&&void 0!==s?s:"density"],r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.density].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform,e=t.density,n=I(t,["density"]);return Object.assign({type:"kde",field:e},n)}}]),e}(),$y=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).filter=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(qa(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(Da(this.filter))}},{key:"assemble",value:function(){var t=this,e=qa(this.filter).reduce(function(e,n){var r=t.filter[n],i=tc(r,{expr:"datum"});return null!==r&&("temporal"===r.type?e.push("(isDate(".concat(i,") || (isValid(").concat(i,") && isFinite(+").concat(i,")))")):"quantitative"===r.type&&(e.push("isValid(".concat(i,")")),e.push("isFinite(+".concat(i,")")))),e},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}],[{key:"make",value:function(t,n){var r=n.config,i=n.mark;if("filter"!==rs("invalid",n.markDef,r))return null;var a=n.reduceFieldDef(function(t,e,r){var a=Wu(r)&&n.getScaleComponent(r);return a&&dl(a.get("type"))&&"count"!==e.aggregate&&!Ao(i)&&(t[e.field]=e),t},{});return qa(a).length?new e(t,a):null}}]),e}(),Yy=function(t){function e(t,n){var r;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var i=r.transform,u=i.flatten,s=i.as,l=void 0===s?[]:s;return r.transform.as=u.map(function(t,e){var n;return null!==(n=l[e])&&void 0!==n?n:t}),r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(this.parent,Ma(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform;return{type:"flatten",fields:t.flatten,as:t.as}}}]),e}(),Xy=function(t){function e(t,n){var r,i,u,s;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var l=null!==(i=r.transform.as)&&void 0!==i?i:[void 0,void 0];return r.transform.as=[null!==(u=l[0])&&void 0!==u?u:"key",null!==(s=l[1])&&void 0!==s?s:"value"],r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform;return{type:"fold",fields:t.fold,as:t.as}}}]),e}(),Jy=function(t){function e(t,n,r,i){var u;return f(this,e),(u=a(this,o(e).call(this,t))).fields=n,u.geojson=r,u.signal=i,u}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){var t,e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(w);return new Set([].concat(d(this.geojson?[this.geojson]:[]),d(e)))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(Da(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;for(var r=0,i=0,a=[[Zo,Qo],[tu,Ko]];i<a.length;i++){var o=a[i].map(function(t){return n.channelHasField(t)?n.fieldDef(t).field:Jl(n.encoding[t])?{expr:n.encoding[t].value+""}:void 0});(o[0]||o[1])&&(t=new e(t,o,null,n.getName("geojson_".concat(r++))))}if(n.channelHasField(iu)){var u=n.fieldDef(iu);u.type===el&&(t=new e(t,null,u.field,n.getName("geojson_".concat(r++))))}return t}}]),e}(),Qy=function(t){function e(t,n,r,i){var u;return f(this,e),(u=a(this,o(e).call(this,t))).projection=n,u.fields=r,u.as=i,u}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,this.projection,Ma(this.fields),Ma(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(w))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(Da(this.fields)," ").concat(Da(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(t,n){if(!n.projectionName())return t;for(var r=0,i=[[Zo,Qo],[tu,Ko]];r<i.length;r++){var a=i[r],o=a.map(function(t){return n.channelHasField(t)?n.fieldDef(t).field:Jl(n.encoding[t])?{expr:n.encoding[t].value+""}:void 0}),u=a[0]===tu?"2":"";(o[0]||o[1])&&(t=new e(t,n.projectionName(),o,[n.getName("x"+u),n.getName("y"+u)]))}return t}}]),e}(),Zy=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.impute,this.transform.key].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(t){var e=t.start,n=void 0===e?0:e,r=t.stop,i=t.step,a=[n,r].concat(d(i?[i]:[])).join(",");return{signal:"sequence(".concat(a,")")}}},{key:"hash",value:function(){return"Impute ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t,e=this.transform,n=e.impute,r=e.key,i=e.keyvals,a=e.method,o=e.groupby,u=e.value,s=e.frame,l=void 0===s?[null,null]:s,c=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:n,key:r},i?{keyvals:(t=i,void 0!==(null===t||void 0===t?void 0:t.stop)?this.processSequence(i):i)}:{}),{method:"value"}),o?{groupby:o}:{}),{value:a&&"value"!==a?null:u});return a&&"value"!==a?[c,Object.assign({type:"window",as:["imputed_".concat(n,"_value")],ops:[a],fields:[n],frame:l,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:"datum.".concat(n," === null ? datum.imputed_").concat(n,"_value : datum.").concat(n),as:n}]:[c]}}],[{key:"makeFromTransform",value:function(t,n){return new e(t,n)}},{key:"makeFromEncoding",value:function(t,n){var r=n.encoding,i=r.x,a=r.y;if($l(i)&&$l(a)){var o=i.impute?i:a.impute?a:void 0;if(void 0===o)return;var u=i.impute?a:a.impute?i:void 0,s=o.impute,l=s.method,c=s.value,f=s.frame,h=s.keyvals,d=jc(n.mark,r);return new e(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},l?{method:l}:{}),void 0!==c?{value:c}:{}),f?{frame:f}:{}),void 0!==h?{keyvals:h}:{}),d.length?{groupby:d}:{}))}return null}}]),e}(),Ky=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f(this,e),(t=a(this,o(e).call(this,n,r))).explicit=n,t.implicit=r,t.parseNothing=i,t}return s(e,Gg),h(e,[{key:"clone",value:function(){var t=u(o(e.prototype),"clone",this).call(this);return t.parseNothing=this.parseNothing,t}}]),e}(),tb=function(t){function e(t,n){var r,i,u,s;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var l=null!==(i=r.transform.as)&&void 0!==i?i:[void 0,void 0];return r.transform.as=[null!==(u=l[0])&&void 0!==u?u:n.on,null!==(s=l[1])&&void 0!==s?s:n.loess],r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.loess,this.transform.on].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform,e=t.loess,n=t.on,r=I(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}]),e}(),eb=function(t){function e(t,n,r){var i;return f(this,e),(i=a(this,o(e).call(this,t))).transform=n,i.secondary=r,i}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?R(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(Da({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:R(this.transform.as)}:{});else{var e=this.transform.as;w(e)||(ps(fs.NO_FIELDS_NEEDS_AS),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(t,n,r,i){var a=n.component.data.sources,o=r.from,u=null;if(function(t){return void 0!==t.data}(o)){var s=wb(o.data,a);s||(s=new Sm(o.data),a.push(s));var l=n.getName("lookup_".concat(i));u=new Sd(s,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=u}else if(function(t){return void 0!==t.selection}(o)){var c=o.selection;if(r=Object.assign({as:c},r),!(u=n.getSelectionComponent(Wa(c),c).materialized))throw new Error(fs.noSameUnitLookup(c))}return new e(t,r,u.getSource())}}]),e}(),nb=function(t){function e(t,n){var r,i,u,s;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var l=null!==(i=r.transform.as)&&void 0!==i?i:[void 0,void 0];return r.transform.as=[null!==(u=l[0])&&void 0!==u?u:"prob",null!==(s=l[1])&&void 0!==s?s:"value"],r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.quantile].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform,e=t.quantile,n=I(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}]),e}(),rb=function(t){function e(t,n){var r,i,u,s;f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r.transform=Ma(n);var l=null!==(i=r.transform.as)&&void 0!==i?i:[void 0,void 0];return r.transform.as=[null!==(u=l[0])&&void 0!==u?u:n.on,null!==(s=l[1])&&void 0!==s?s:n.regression],r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.regression,this.transform.on].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform,e=t.regression,n=t.on,r=I(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}]),e}(),ib=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"addDimensions",value:function(t){var e;this.transform.groupby=Pa((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),function(t){return t})}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){var t;return new Set([this.transform.pivot,this.transform.value].concat(d(null!==(t=this.transform.groupby)&&void 0!==t?t:[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){var t=this.transform,e=t.pivot,n=t.value,r=t.groupby,i=t.limit,a=t.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:n},void 0!==i?{limit:i}:{}),void 0!==a?{op:a}:{}),void 0!==r?{groupby:r}:{})}}]),e}(),ab=function(t){function e(t,n){var r;return f(this,e),(r=a(this,o(e).call(this,t))).transform=n,r}return s(e,Md),h(e,[{key:"clone",value:function(){return new e(null,Ma(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(Da(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),e}();function ob(t){var e=0;return function n(r,i){var a,o,u,s;if(r instanceof Sm&&(r.isGenerator||nh(r.data)||(t.push(i),i={name:null,source:i.name,transform:[]})),r instanceof Um&&(r.parent instanceof Sm&&!i.source?(i.format=Object.assign(Object.assign({},null!==(a=i.format)&&void 0!==a?a:{}),{parse:r.assembleFormatParse()}),(o=i.transform).push.apply(o,d(r.assembleTransforms(!0)))):(u=i.transform).push.apply(u,d(r.assembleTransforms()))),r instanceof zm)return i.name||(i.name="data_".concat(e++)),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source,void r.assemble().forEach(function(e){return t.push(e)});switch((r instanceof Om||r instanceof Dm||r instanceof $y||r instanceof og||r instanceof wg||r instanceof Qy||r instanceof Jy||r instanceof Pm||r instanceof eb||r instanceof Vm||r instanceof Wm||r instanceof Xy||r instanceof Yy||r instanceof Gy||r instanceof tb||r instanceof nb||r instanceof rb||r instanceof Gm||r instanceof ab||r instanceof ib)&&i.transform.push(r.assemble()),(r instanceof Mm||r instanceof Cd||r instanceof Zy||r instanceof Hm)&&(s=i.transform).push.apply(s,d(r.assemble())),r instanceof Sd&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof Sd?r.setSource(i.name):(i.name||(i.name="data_".concat(e++)),r.setSource(i.name),1===r.numChildren()&&(t.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Sd&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:i.name||(i.name="data_".concat(e++));var l=i.name;!i.source||i.transform.length>0?t.push(i):l=i.source,r.children.forEach(function(t){n(t,{name:null,source:l,transform:[]})})}}}function ub(t){return"top"===t||"left"===t?"header":"footer"}function sb(t,e){var n;if(t.channelHasField(e)){var r=t.facet[e],i=Eg("title",null,t.config,e),a=oc(r,t.config,{allowDisabling:!0,includeDefault:void 0===i||!!i});t.child.component.layoutHeaders[e].title&&(a=x(a)?a.join(", "):a,a+=" / "+t.child.component.layoutHeaders[e].title,t.child.component.layoutHeaders[e].title=null);var o=Eg("labelOrient",r,t.config,e),u=Ka((null!==(n=r.header)&&void 0!==n?n:{}).labels,!0),s=Ta(["bottom","right"],o)?"footer":"header";t.component.layoutHeaders[e]=l({title:a,facetFieldDef:r},s,"facet"===e?[]:[lb(t,e,u)])}}function lb(t,e,n){var r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function cb(t,e){var n,r=t.child;if(r.component.axes[e]){var i=t.component,a=i.layoutHeaders,o=i.resolve;if(o.axis[e]=Vg(o,e),"shared"===o.axis[e]){var u="x"===e?"column":"row",s=a[u],l=!0,c=!1,f=void 0;try{for(var h,d=r.component.axes[e][Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value,v=ub(p.get("orient"));s[v]=null!==(n=s[v])&&void 0!==n?n:[lb(t,u,!1)];var g=hg(p,"main",t.config,{header:!0});s[v][0].axes.push(g),p.mainExtracted=!0}}catch(m){c=!0,f=m}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}}}var fb=hb;function hb(t){db(t);var e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";pb(t,e),pb(t,n)}function db(t){var e=!0,n=!1,r=void 0;try{for(var i,a=t.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.parseLayoutSize()}catch(o){n=!0,r=o}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}function pb(t,e){var n,r=Wg(e),i=Bu(r),a=t.component.resolve,o=t.component.layoutSize,u=!0,s=!1,l=void 0;try{for(var c,f=t.children[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value.component.layoutSize.getWithExplicit(r),d=a.scale[i];if("independent"===d&&"step"===h.value){n=void 0;break}if(n){if("independent"===d&&n.value!==h.value){n=void 0;break}n=Qg(n,h,r,"")}else n=h}}catch(x){s=!0,l=x}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}if(n){var p=!0,v=!1,g=void 0;try{for(var m,y=t.children[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value;t.renameSignal(b.getName(r),t.getName(e)),b.component.layoutSize.set(r,"merged",!1)}}catch(x){v=!0,g=x}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}o.setWithExplicit(e,n)}else o.setWithExplicit(e,{explicit:!1,value:void 0})}function vb(t,e){var n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){var a=i.get("type"),o=i.get("range");if(hl(a)){var u=Af(r.view,e);return Qu(o)||bf(u)?"step":u}return wf(r.view,e)}if(t.hasProjection)return wf(r.view,e);var s=Af(r.view,e);return bf(s)?s.step:s}function gb(t,e){return function(t){return t&&!w(t)&&"repeat"in t}(t.field)?t.field.repeat in e?Object.assign(Object.assign({},t),{field:e[t.field.repeat]}):void ps(fs.noSuchRepeatedValue(t.field.repeat)):t}function mb(t,e){if(void 0!==(t=gb(t,e))){if(null===t)return null;if(Ul(t)&&zl(t.sort)){var n=gb(t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function yb(t,e){if(!$l(t)){if(Gl(t)){var n=mb(t.condition,e);return n?Object.assign(Object.assign({},t),{condition:n}):I(t,["condition"])}return t}var r=mb(t,e);return r||(Vl(t)?{condition:t.condition}:void 0)}function bb(t,e){var n={};for(var r in t)if(z(t,r)){var i=t[r];if(x(i))n[r]=i.map(function(t){return yb(t,e)}).filter(function(t){return t});else{var a=yb(i,e);void 0!==a&&(n[r]=a)}}return n}function xb(t,e,n){return tc(e,Object.assign({suffix:"by_".concat(tc(t))},null!==n&&void 0!==n?n:{}))}var _b=function(t){function e(t,n,r,u,s){var l;f(this,e),(l=a(this,o(e).call(this,t,"facet",n,r,s,u,t.resolve))).child=Jb(t.spec,i(l),l.getName("child"),void 0,u,s),l.children=[l.child];var c=function(t,e){return Ll(t)?bb(t,e):mb(t,e)}(t.facet,u);return l.facet=l.initFacet(c),l}return s(e,Vy),h(e,[{key:"initFacet",value:function(t){return Ll(t)?Nc(t,function(t,e,n){return Ta([Ho,Vo],n)?void 0===e.field?(ps(fs.emptyFieldDef(e,n)),t):(t[n]=hc(e,n),t):(ps(fs.incompatibleChannel(n,"facet")),t)},{}):{facet:hc(t,"facet")}}},{key:"channelHasField",value:function(t){return!!this.facet[t]}},{key:"fieldDef",value:function(t){return this.facet[t]}},{key:"parseData",value:function(){this.component.data=Ab(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){db(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=ku[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)sb(t,i.value)}catch(o){n=!0,r=o}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}cb(t,"x"),cb(t,"y")}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(t){return this.child.assembleSelectionTopLevelSignals(t)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(t){return this.child.assembleSelectionData(t)}},{key:"getHeaderLayoutMixins",value:function(){var t,e,n,r={},i=!0,a=!1,o=void 0;try{for(var u,s=ku[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,c=!0,f=!1,h=void 0;try{for(var d,p=Cg[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value,g=this.component.layoutHeaders[l],m=g[v],y=g.facetFieldDef;if(y){var b=Eg("titleOrient",y,this.config,l);if(Ta(["right","bottom"],b)){var x=Ag(l,b);r.titleAnchor=null!==(t=r.titleAnchor)&&void 0!==t?t:{},r.titleAnchor[x]="end"}}if(null===m||void 0===m?void 0:m[0]){var _="row"===l?"height":"width",w="header"===v?"headerBand":"footerBand";"facet"===l||this.child.component.layoutSize.get(_)||(r[w]=null!==(e=r[w])&&void 0!==e?e:{},r[w][l]=.5),g.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===l?"rowTitle":"columnTitle"]=10)}}}catch(k){f=!0,h=k}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}}}catch(k){a=!0,o=k}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}},{key:"assembleDefaultLayout",value:function(){var t=this.facet,e=t.column,n=t.row,r=e?this.columnDistinctSignal():n?1:void 0,i="all";return(n||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof e)){var t=this.getName("column_domain");return{signal:"length(data('".concat(t,"'))")}}}},{key:"assembleGroup",value:function(t){return this.parent&&this.parent instanceof e?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:tc(this.facet.column,{prefix:"distinct"})}}}}:{}),u(o(e.prototype),"assembleGroup",this).call(this,t)):u(o(e.prototype),"assembleGroup",this).call(this,t)}},{key:"getCardinalityAggregateForChild",value:function(){var t=[],n=[],r=[];if(this.child instanceof e){if(this.child.channelHasField("column")){var i=tc(this.child.facet.column);t.push(i),n.push("distinct"),r.push("distinct_".concat(i))}}else for(var a=0,o=["x","y"];a<o.length;a++){var u=o[a],s=this.child.component.scales[u];if(s&&!s.merged){var l=s.get("type"),c=s.get("range");if(hl(l)&&Qu(c)){var f=xy(_y(this.child,u));f?(t.push(f),n.push("distinct"),r.push("distinct_".concat(f))):ps("Unknown field for ".concat(u,". Cannot calculate view size."))}}}return{fields:t,ops:n,as:r}}},{key:"assembleFacet",value:function(){var t=this.component.data.facetRoot,e=t.name,n=t.data,r=this.facet,i=r.row,a=r.column,o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,l=o.as,c=[],f=!0,h=!1,d=void 0;try{for(var p,v=ku[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var g=p.value,m=this.facet[g];if(m){c.push(tc(m));var y=m.bin,b=m.sort;if(wc(y)&&c.push(tc(m,{binSuffix:"end"})),zl(b)){var _=b.field,w=b.op,k=void 0===w?Nl:w,A=xb(m,b);i&&a?(u.push(A),s.push("max"),l.push(A)):(u.push(_),s.push(k),l.push(A))}else if(x(b)){var E=kg(m,g);u.push(E),s.push("max"),l.push(E)}}}}catch(S){h=!0,d=S}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}var M=!!i&&!!a;return Object.assign({name:e,data:n,groupby:c},M||u.length>0?{aggregate:Object.assign(Object.assign({},M?{cross:M}:{}),u.length?{fields:u,ops:s,as:l}:{})}:{})}},{key:"facetSortFields",value:function(t){var e=this.facet[t];return e?zl(e.sort)?[xb(e,e.sort,{expr:"datum"})]:x(e.sort)?[kg(e,t,{expr:"datum"})]:[tc(e,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(t){var e=this.facet[t];if(e){var n=e.sort;return[(zl(n)?n.order:!x(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var t=this.facet,e=this.config;if(t.facet)return jg(t.facet,"facet",e);var n={row:["top","bottom"],column:["left","right"]},r=!0,i=!1,a=void 0;try{for(var o,u=Sg[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(t[s]){var l=Eg("labelOrient",t[s],e,s);if(Ta(n[s],l))return jg(t[s],s,e)}}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"assembleMarks",value:function(){var t=this,e=this.child,n=function(t){var e=[],n=ob(e);return t.children.forEach(function(e){return n(e,{source:t.name,name:null,transform:[]})}),e}(this.component.data.facetRoot),r=e.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||e.assembleTitle(),a=e.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},i?{title:i}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:ku.map(function(e){return t.facetSortFields(e)}).flat(),order:ku.map(function(e){return t.facetSortOrder(e)}).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup(function(t,e){if(t.component.selection&&qa(t.component.selection).length){var n=k(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:Oh("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return Jd(e)}(this,[])))]}},{key:"getMapping",value:function(){return this.facet}}]),e}();function wb(t,e){var n,r,i,a,o,u,s,l,c,f,h=!0,d=!1,p=void 0;try{for(var v,g=e[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var m=v.value,y=m.data;if((!t.name||!m.hasName()||t.name===m.dataName)&&!((null===(n=t.format)||void 0===n?void 0:n.mesh)&&(null===(r=y.format)||void 0===r?void 0:r.feature))&&(!((null===(i=t.format)||void 0===i?void 0:i.feature)||(null===(a=y.format)||void 0===a?void 0:a.feature))||(null===(o=t.format)||void 0===o?void 0:o.feature)===(null===(u=y.format)||void 0===u?void 0:u.feature))&&(!((null===(s=t.format)||void 0===s?void 0:s.mesh)||(null===(l=y.format)||void 0===l?void 0:l.mesh))||(null===(c=t.format)||void 0===c?void 0:c.mesh)===(null===(f=y.format)||void 0===f?void 0:f.mesh)))if(rh(t)&&rh(y)){if(Ea(t.values,y.values))return m}else if(nh(t)&&nh(y)){if(t.url===y.url)return m}else if(ih(t)&&t.name===m.dataName)return m}}catch(b){d=!0,p=b}finally{try{h||null==g.return||g.return()}finally{if(d)throw p}}return null}function kb(t,e){if(t.data||!t.parent){if(null===t.data){var n=new Sm([]);return e.push(n),n}var r=wb(t.data,e);if(r)return ah(t.data)||(r.data.format=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];Ra(t,null!==o&&void 0!==o?o:{})}return t}({},t.data.format,r.data.format)),!r.hasName()&&t.data.name&&(r.dataName=t.data.name),r;var i=new Sm(t.data);return e.push(i),i}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}function Ab(t){var e,n,r,i,a,o,u,s,c,f,h=kb(t,t.component.data.sources),d=t.component.data,p=d.outputNodes,v=d.outputNodeRefCounts,g=t.parent?t.parent.component.data.ancestorParse.clone():new Ky,m=t.data;ah(m)?(oh(m)?h=new Dm(h,m.sequence):sh(m)&&(h=new Om(h,m.graticule)),g.parseNothing=!0):null===(null===(e=null===m||void 0===m?void 0:m.format)||void 0===e?void 0:e.parse)&&(g.parseNothing=!0),h=null!==(n=Um.makeExplicit(h,t,g))&&void 0!==n?n:h,h=new Gm(h);var y=t.parent&&Wy(t.parent);(Ly(t)||qy(t))&&y&&(h=null!==(r=Mm.makeFromEncoding(h,t))&&void 0!==r?r:h),t.transforms.length>0&&(h=function(t,e,n){var r,i,a=0,o=!0,u=!1,s=void 0;try{for(var c,f=e.transforms[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var h=c.value,d=void 0,p=void 0;if(wh(h))p=t=new wg(t,h),d="derived";else if(fh(h)){var v=qm(h);p=t=null!==(r=Um.makeWithAncestors(t,{},v,n))&&void 0!==r?r:t,t=new og(t,e,h.filter)}else if(kh(h))p=t=Mm.makeFromTransform(t,h,e),d="number";else if(Eh(h))d="date",void 0===n.getWithExplicit(h.field).value&&(t=new Um(t,l({},h.field,d)),n.set(h.field,d,!1)),p=t=Cd.makeFromTransform(t,h);else if(Mh(h))p=t=Pm.makeFromTransform(t,h),d="number",fp(e)&&(t=new Gm(t));else if(hh(h))p=t=eb.make(t,e,h,a++),d="derived";else if(bh(h))p=t=new Vm(t,h),d="number";else if(xh(h))p=t=new Wm(t,h),d="number";else if(Sh(h))p=t=Hm.makeFromTransform(t,h),d="derived";else if(Ch(h))p=t=new Xy(t,h),d="derived";else if(_h(h))p=t=new Yy(t,h),d="derived";else if(dh(h))p=t=new ib(t,h),d="derived";else if(yh(h))t=new ab(t,h);else if(Ah(h))p=t=Zy.makeFromTransform(t,h),d="derived";else if(ph(h))p=t=new Gy(t,h),d="derived";else if(vh(h))p=t=new nb(t,h),d="derived";else if(gh(h))p=t=new rb(t,h),d="derived";else{if(!mh(h)){ps(fs.invalidTransformIgnored(h));continue}p=t=new tb(t,h),d="derived"}if(p&&void 0!==d){var g=!0,m=!1,y=void 0;try{for(var b,x=(null!==(i=p.producedFields())&&void 0!==i?i:[])[Symbol.iterator]();!(g=(b=x.next()).done);g=!0){var _=b.value;n.set(_,d,!1)}}catch(w){m=!0,y=w}finally{try{g||null==x.return||x.return()}finally{if(m)throw y}}}}}catch(w){u=!0,s=w}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}return t}(h,t,g));var b=function(t){var e={};if(Ly(t)&&t.component.selection){var n=!0,r=!1,i=void 0;try{for(var a,o=qa(t.component.selection)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=t.component.selection[u],l=!0,c=!1,f=void 0;try{for(var h,d=s.project.items[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;!p.channel&&Za(p.field)>1&&(e[p.field]="flatten")}}catch(v){c=!0,f=v}finally{try{l||null==d.return||d.return()}finally{if(c)throw f}}}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}return e}(t),x=Im(t);h=null!==(i=Um.makeWithAncestors(h,{},Object.assign(Object.assign({},b),x),g))&&void 0!==i?i:h,Ly(t)&&(h=Jy.parseAll(h,t),h=Qy.parseAll(h,t)),(Ly(t)||qy(t))&&(y||(h=null!==(a=Mm.makeFromEncoding(h,t))&&void 0!==a?a:h),h=null!==(o=Cd.makeFromEncoding(h,t))&&void 0!==o?o:h,h=wg.parseAllForSortIndex(h,t));var _=t.getName(ch),w=new Sd(h,_,ch,v);if(p[_]=w,h=w,Ly(t)){var k=Pm.makeFromEncoding(h,t);k&&(h=k,fp(t)&&(h=new Gm(h))),h=null!==(u=Zy.makeFromEncoding(h,t))&&void 0!==u?u:h,h=null!==(s=Hm.makeFromEncoding(h,t))&&void 0!==s?s:h}Ly(t)&&(h=null!==(c=$y.make(h,t))&&void 0!==c?c:h);var A=t.getName(lh),E=new Sd(h,A,lh,v);p[A]=E,h=E,Ly(t)&&function(t,e){lp(t,function(n){var r=n.name,i=t.getName("lookup_".concat(r));t.component.data.outputNodes[i]=n.materialized=new Sd(new og(e,t,{selection:r}),i,"lookup",t.component.data.outputNodeRefCounts)})}(t,E);var M=null;if(qy(t)){var S=t.getName("facet");h=null!==(f=function(t,e){var n=e.row,r=e.column;if(n&&r){for(var i=null,a=0,o=[n,r];a<o.length;a++){var u=o[a];if(zl(u.sort)){var s=u.sort,l=s.field,c=s.op;t=i=new Wm(t,{joinaggregate:[{op:void 0===c?Nl:c,field:l,as:xb(u,u.sort,{forAs:!0})}],groupby:[tc(u)]})}}return i}return null}(h,t.facet))&&void 0!==f?f:h,M=new zm(h,t,S,E.getSource()),p[S]=M,h=M}return Object.assign(Object.assign({},t.component.data),{outputNodes:p,outputNodeRefCounts:v,raw:w,main:E,facetRoot:M,ancestorParse:g})}var Eb=function(t){function e(t,n,r,i,u,s,l){return f(this,e),a(this,o(e).call(this,t,n,r,i,u,s,l))}return s(e,Hy),h(e,[{key:"parseData",value:function(){this.component.data=Ab(this),this.children.forEach(function(t){t.parseData()})}},{key:"parseSelections",value:function(){var t=this;this.component.selection={};var e=!0,n=!1,r=void 0;try{for(var i,a=function(){var e=i.value;e.parseSelections(),qa(e.component.selection).forEach(function(n){t.component.selection[n]=e.component.selection[n]})},o=this.children[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)a()}catch(u){n=!0,r=u}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"parseMarkGroup",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)r.value.parseMarkGroup()}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"parseAxesAndHeaders",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)r.value.parseAxesAndHeaders()}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"assembleSelectionTopLevelSignals",value:function(t){return this.children.reduce(function(t,e){return e.assembleSelectionTopLevelSignals(t)},t)}},{key:"assembleSignals",value:function(){return this.children.forEach(function(t){return t.assembleSignals()}),[]}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce(function(t,e){return[].concat(d(t),d(e.assembleLayoutSignals()))},Lg(this))}},{key:"assembleSelectionData",value:function(t){return this.children.reduce(function(t,e){return e.assembleSelectionData(t)},t)}},{key:"assembleMarks",value:function(){return this.children.map(function(t){var e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}}]),e}(),Mb=function(t){function e(t,n,r,u,s){var l,c,h,d,p;return f(this,e),l=a(this,o(e).call(this,t,"concat",n,r,s,u,t.resolve)),"shared"!==(null===(h=null===(c=t.resolve)||void 0===c?void 0:c.axis)||void 0===h?void 0:h.x)&&"shared"!==(null===(p=null===(d=t.resolve)||void 0===d?void 0:d.axis)||void 0===p?void 0:p.y)||ps(fs.CONCAT_CANNOT_SHARE_AXIS),l.children=l.getChildren(t).map(function(t,e){return Jb(t,i(l),l.getName("concat_"+e),void 0,u,s)}),l}return s(e,Eb),h(e,[{key:"getChildren",value:function(t){return gf(t)?t.vconcat:mf(t)?t.hconcat:t.concat}},{key:"parseLayoutSize",value:function(){hb(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleDefaultLayout",value:function(){var t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}]),e}(),Sb=Object.assign(Object.assign({gridScale:1,scale:1},uo),{labelExpr:1,encode:1}),Cb=qa(Sb),Ob=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f(this,e),(t=a(this,o(e).call(this))).explicit=n,t.implicit=r,t.mainExtracted=i,t}return s(e,Gg),h(e,[{key:"clone",value:function(){return new e(Ma(this.explicit),Ma(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!(!1===(e=this.get(t))||null===e));var e}}]),e}(),Db={bottom:"top",top:"bottom",left:"right",right:"left"};function Fb(t,e){if(!t)return e.map(function(t){return t.clone()});if(t.length===e.length){for(var n=t.length,r=0;r<n;r++){var i=t[r],a=e[r];if(!!i!==!!a)return;if(i&&a){var o=i.getWithExplicit("orient"),u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;t[r]=Tb(i,a)}}return t}}function Tb(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=function(){var n=a.value,r=Qg(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",function(t,e){switch(n){case"title":return cs(t,e);case"gridScale":return{explicit:t.explicit,value:Ka(t.value,e.value)}}return Jg(t,e,n,"axis")});t.setWithExplicit(n,r)},u=Cb[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)o()}catch(s){r=!0,i=s}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}return t}function Nb(t,e){var n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?ls(a,o):a||o||(void 0!==a?a:void 0!==o?o:void 0)}function jb(t,e,n,r,i){switch(e){case"titleAngle":case"labelAngle":return t===eo(n[e]);case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===Nb(r,i))return!0}return t===n[e]}var Rb=["Band","Point","Discrete","Quantitative","Temporal"],Pb=q([].concat(d(Rb.map(function(t){return"axisX".concat(t)})),d(Rb.map(function(t){return"axisY".concat(t)}))));function zb(t,e){var n,r=e.axis(t),i=new Ob,a=!0,o=!1,u=void 0;try{for(var s,l=Cb[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=Bb(c,r,t,e),h=lo(c)?yg(c,e.config,t,i.get("orient"),e.getScaleComponent(t).get("type"),r.style):{},d=h.configValue,p=void 0===d?void 0:d,v=h.configFrom,g=void 0===v?void 0:v,m=jb(f,c,r,e,t);void 0===f||!m&&void 0!==p?(Ta(["grid","orient","tickCount","labelExpr"],c)&&p||io(p)||Ju(p)||Ta(["style","axis-config-style"],g)||Ta(["axisQuantitative","axisTemporal"],g)||g in Pb)&&i.set(c,p,!1):i.set(c,f,m)}}catch(x){o=!0,u=x}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var y=null!==(n=r.encoding)&&void 0!==n?n:{},b=ao.reduce(function(n,r){var a;if(!i.hasAxisPart(r))return n;var o=Hg(null!==(a=y[r])&&void 0!==a?a:{},e),u="labels"===r?function(t,e,n){var r,i=null!==(r=t.fieldDef(e))&&void 0!==r?r:"x"===e?t.fieldDef("x2"):"y"===e?t.fieldDef("y2"):void 0,a=t.axis(e),o=Cl({fieldDef:i,field:"datum.value",format:a.format,formatType:a.formatType,config:t.config,isUTCScale:t.getScaleComponent(e).get("type")===Xs.UTC,omitTimeFormatConfig:!0,omitNumberFormatAndEmptyTimeFormat:!0}),u=Object.assign(Object.assign({},o?{text:o}:{}),n);return u=Object.assign(Object.assign({},u),n),0===qa(u).length?void 0:u}(e,t,o):o;return void 0!==u&&qa(u).length>0&&(n[r]={update:u}),n},{});return qa(b).length>0&&i.set("encode",b,!!r.encoding||void 0!==r.labelAngle),i}function Bb(t,e,n,r){var i=r.fieldDef(n),a=function(t,e,n,r){if(void 0!==e.labelAngle)return eo(e.labelAngle);var i=yg("labelAngle",t.config,n,_g(n),t.getScaleComponent(n).get("type"),e.style).configValue;return void 0!==i?eo(i):n===$o&&Ta([tl,Zs],r.type)?270:void 0}(r,e,n,i),o=Ka(e.orient,_g(n)),u=r.mark,s=r.config;switch(t){case"scale":return r.scaleName(n);case"gridScale":return function(t,e){var n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n)}(r,n);case"format":if(gc(i)||mc(i))return;return Ol(i,e.format,s);case"formatType":if(gc(i)||mc(i))return;return e.formatType;case"grid":if(kc(r.fieldDef(n).bin))return!1;var l=r.getScaleComponent(n).get("type");return Ka(e.grid,function(t,e){return!hl(t)&&!wc(e.bin)}(l,i));case"labelAlign":return Ka(e.labelAlign,xg(a,o));case"labelAngle":return a;case"labelBaseline":return Ka(e.labelBaseline,bg(a,o));case"labelFlush":return Ka(e.labelFlush,function(t,e){if("x"===e&&Ta(["quantitative","temporal"],t.type))return!0}(i,n));case"labelOverlap":var c=r.getScaleComponent(n).get("type");return Ka(e.labelOverlap,function(t,e){if("nominal"!==t.type)return"log"!==e||"greedy"}(i,c));case"orient":return o;case"tickCount":var f=r.getScaleComponent(n).get("type"),h="x"===n?"width":"y"===n?"height":void 0,d=h?r.getSizeSignalRef(h):void 0;return Ka(e.tickCount,function(t){var e,n=t.fieldDef,r=t.scaleType,i=t.size;if(!hl(r)&&"log"!==r&&!Ta(["month","hours","day","quarter"],null===(e=Rs(n.timeUnit))||void 0===e?void 0:e.unit))return wc(n.bin)?{signal:"ceil(".concat(i.signal,"/10)")}:{signal:"ceil(".concat(i.signal,"/40)")}}({fieldDef:i,scaleType:f,size:d}));case"title":var p="x"===n?"x2":"y2",v=r.fieldDef(p);return Ka(e.title,Nb(r,n),ss([Il(i)],v?[Il(v)]:[]));case"values":return function(t,e,n){var r=t.values;return x(r)?bc(n,r):Ju(r)?r:void 0}(e,0,i);case"zindex":return Ka(e.zindex,function(t,e){return"rect"===t&&ec(e)?1:0}(u,i))}return lo(t)?e[t]:void 0}function Lb(t,e,n,r){var i,a,o,u=r.graticule,s=So(t)?Object.assign({},t):{type:t},l=null!==(i=s.orient)&&void 0!==i?i:is("orient",s,n);if(s.orient=function(t,e,n){switch(t){case vo:case _o:case wo:case yo:case go:case ho:return}var r=e.x,i=e.y,a=e.x2,o=e.y2;switch(t){case fo:if($l(r)&&(kc(r.bin)||$l(i)&&i.aggregate&&!r.aggregate))return"vertical";if($l(i)&&(kc(i.bin)||$l(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&$l(r)&&r.type===Qs&&!wc(r.bin))return"horizontal";if(!o&&$l(i)&&i.type===Qs&&!wc(i.bin))return"vertical"}case mo:if(a&&o)return;case co:if(o)return $l(i)&&kc(i.bin)?"horizontal":"vertical";if(a)return $l(r)&&kc(r.bin)?"vertical":"horizontal";if(t===mo){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case po:case bo:var u=$l(r)&&nc(r),s=$l(i)&&nc(i);if(u&&!s)return"tick"!==t?"horizontal":"vertical";if(!u&&s)return"tick"!==t?"vertical":"horizontal";if(u&&s){var l=r,c=i,f=l.type===Ks,h=c.type===Ks;return f&&!h?"tick"!==t?"vertical":"horizontal":!f&&h?"tick"!==t?"horizontal":"vertical":!l.aggregate&&c.aggregate?"tick"!==t?"vertical":"horizontal":l.aggregate&&!c.aggregate?"tick"!==t?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(s.type,e,l),void 0!==l&&l!==s.orient&&ps(fs.orientOverridden(s.orient,l)),"bar"===s.type&&s.orient){var c=null!==(a=s.cornerRadiusEnd)&&void 0!==a?a:is("cornerRadiusEnd",s,n);if(void 0!==c){var f="horizontal"===s.orient&&e.x2||"vertical"===s.orient&&e.y2?["cornerRadius"]:Do[s.orient],h=!0,d=!1,p=void 0;try{for(var v,g=f[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)s[v.value]=c}catch(m){d=!0,p=m}finally{try{h||null==g.return||g.return()}finally{if(d)throw p}}void 0!==s.cornerRadiusEnd&&delete s.cornerRadiusEnd}}return void 0===Ka(s.opacity,is("opacity",s,n))&&(s.opacity=function(t,e){if(Ta([vo,bo,_o,wo],t)&&!Cc(e))return.7}(s.type,e)),void 0===s.filled&&(s.filled=!u&&function(t,e){var n=is("filled",t,e),r=t.type;return Ka(n,r!==vo&&r!==po&&r!==mo)}(s,n)),void 0===(null!==(o=s.cursor)&&void 0!==o?o:is("cursor",s,n))&&(s.cursor=function(t,e,n){return e.href||t.href||is("href",t,n)?"pointer":t.cursor}(s,e,n)),s}function qb(t,e){return t.config,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),sd("x",t,{defaultPos:"mid"})),sd("y",t,{defaultPos:"mid"})),ed("size",t)),function(t,e,n){return n?{shape:{value:n}}:ed("shape",t)}(t,0,e))}function Ib(t){var e=t.config,n=t.markDef,r=n.orient,i="horizontal"===r?"width":"height",a=t.getScaleComponent("horizontal"===r?"x":"y"),o=Ka(n[i],n.size,is("size",n,e,{vgChannel:i}),e.tick.bandSize);if(void 0!==o)return o;var u=a?a.get("range"):void 0;return u&&Qu(u)&&L(u.step)?3*u.step/4:3*kf(e.view,i)/4}var Ub={area:{vgMark:"area",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore"})),dd("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),dd("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),kd(t))}},bar:{vgMark:"rect",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),gd(t,"x","bar")),gd(t,"y","bar"))}},circle:{vgMark:"symbol",encodeEntry:function(t){return qb(t,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(t){return Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"}))},postEncodingTransform:function(t){var e=t.encoding.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},e&&$l(e)&&e.type===el?{field:tc(e,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore"})),gd(t,"x","image")),gd(t,"y","image")),rd(t,"url"))}},line:{vgMark:"line",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"})),sd("x",t,{defaultPos:"mid"})),sd("y",t,{defaultPos:"mid"})),ed("size",t,{vgChannel:"strokeWidth"})),kd(t))}},point:{vgMark:"symbol",encodeEntry:function(t){return qb(t)}},rect:{vgMark:"rect",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),gd(t,"x","rect")),gd(t,"y","rect"))}},rule:{vgMark:"rule",encodeEntry:function(t){var e=t.markDef.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),dd("x",t,{defaultPos:"horizontal"===e?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==e})),dd("y",t,{defaultPos:"vertical"===e?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==e})),ed("size",t,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:function(t){return qb(t,"square")}},text:{vgMark:"text",encodeEntry:function(t){var e=t.config;return t.encoding,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore"})),sd("x",t,{defaultPos:"mid"})),sd("y",t,{defaultPos:"mid"})),rd(t)),ed("size",t,{vgChannel:"fontSize"})),Ad("align",function(t,e,n){var r;if(void 0===(null!==(r=t.align)&&void 0!==r?r:is("align",t,n)))return"center"}(t.markDef,0,e))),Ad("baseline",function(t,e,n){var r;if(void 0===(null!==(r=t.baseline)&&void 0!==r?r:is("baseline",t,n)))return"middle"}(t.markDef,0,e)))}},tick:{vgMark:"rect",encodeEntry:function(t){var e=t.config,n=t.markDef,r=n.orient,i="horizontal"===r?"width":"height",a="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),sd("x",t,{defaultPos:"mid",vgChannel:"xc"})),sd("y",t,{defaultPos:"mid",vgChannel:"yc"})),ed("size",t,{defaultValue:Ib(t),vgChannel:i})),l({},a,{value:Ka(n.thickness,e.tick.thickness)}))}},trail:{vgMark:"trail",encodeEntry:function(t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_d(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),sd("x",t,{defaultPos:"mid"})),sd("y",t,{defaultPos:"mid"})),ed("size",t)),kd(t))}}};function Wb(t){return Ta([po,co,xo],t.mark)?function(t){var e=jc(t.mark,t.encoding),n=Gb(t,{fromPrefix:e.length>0?Hb:""});return e.length>0?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:Hb+t.requestDataName(lh),data:t.requestDataName(lh),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(t):Ta([fo],t.mark)?function(t){var e=ts.some(function(e){return t.markDef[e]||is(e,t.markDef,t.config)});if(t.stack&&!t.fieldDef("size")&&e){var n,r,i=Gb(t,{fromPrefix:Vb}),a=p(i,1)[0],o=t.scaleName(t.stack.fieldChannel),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.vgField(t.stack.fieldChannel,e)},s=function(t,e){var n=[u({prefix:"min",suffix:"start",expr:e}),u({prefix:"max",suffix:"start",expr:e}),u({prefix:"min",suffix:"end",expr:e}),u({prefix:"max",suffix:"end",expr:e})];return"".concat(t,"(").concat(n.map(function(t){return"scale('".concat(o,"',").concat(t,")")}).join(","),")")};"x"===t.stack.fieldChannel?(n=Object.assign(Object.assign({},Sa(a.encode.update,["y","yc","y2","height"].concat(ts))),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),r={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},a.encode.update=Object.assign(Object.assign({},Ca(a.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(n=Object.assign(Object.assign({},Sa(a.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),r={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},a.encode.update=Object.assign(Object.assign({},Ca(a.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));var c=!0,f=!1,h=void 0;try{for(var d,v=ts[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var g=d.value,m=is(g,t.markDef,t.config);a.encode.update[g]?(n[g]=a.encode.update[g],delete a.encode.update[g]):m&&(n[g]={value:m}),m&&(a.encode.update[g]={value:0})}}catch(x){f=!0,h=x}finally{try{c||null==v.return||v.return()}finally{if(f)throw h}}var y=t.fieldDef(t.stack.groupbyChannel),b=tc(y)?[tc(y)]:[];return((null===y||void 0===y?void 0:y.bin)||(null===y||void 0===y?void 0:y.timeUnit))&&b.push(tc(y,{binSuffix:"end"})),(n=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(function(e,n){if(a.encode.update[n])return Object.assign(Object.assign({},e),l({},n,a.encode.update[n]));var r=is(n,t.markDef,t.config);return void 0!==r?Object.assign(Object.assign({},e),l({},n,{value:r})):e},n)).stroke&&(n.strokeForeground={value:!0},n.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(lh),name:Vb+t.requestDataName(lh),groupby:b,aggregate:{fields:[u({suffix:"start"}),u({suffix:"start"}),u({suffix:"end"}),u({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:n},marks:[{type:"group",encode:{update:r},marks:[a]}]}]}return Gb(t)}(t):Gb(t)}var Hb="faceted_path_",Vb="stack_group_";function Gb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=t.mark,r=Ka(t.markDef.clip,function(t){var e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){var e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),i=ns(t.markDef),a=t.encoding.key,o=function(t){var e=t.encoding,n=t.stack,r=t.mark,i=t.markDef,a=t.config,o=e.order;if(!(!x(o)&&Jl(o)&&Fa(o.value)||!o&&Fa(i.order)||Fa(is("order",i,a)))){if((x(o)||$l(o))&&!n)return us(o,{expr:"datum"});if(Ao(r)){var u="horizontal"===i.orient?"y":"x",s=e[u];if($l(s)){var l=s.sort;return x(l)?{field:tc(s,{prefix:u,suffix:"sort_index",expr:"datum"})}:zl(l)?{field:tc({aggregate:Cc(t.encoding)?l.op:void 0,field:l.field},{expr:"datum"})}:Pl(l)?{field:tc(t.fieldDef(l.encoding),{expr:"datum"}),order:l.order}:{field:tc(s,{binSuffix:t.stack&&t.stack.impute?"mid":void 0,expr:"datum"})}}}}}(t),u=function(t){if(!t.component.selection)return null;for(var e=qa(t.component.selection).length,n=e,r=t.parent;r&&0===n;)n=qa(r.component.selection).length,r=r.parent;return n?{interactive:e>0}:null}(t),s=Ub[n].postEncodingTransform?Ub[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:Ub[n].vgMark},r?{clip:!0}:{}),i?{style:i}:{}),a?{key:a.field}:{}),o?{sort:o}:{}),u||{}),{from:{data:e.fromPrefix+t.requestDataName(lh)},encode:{update:Ub[n].encodeEntry(t)}}),s?{transform:s}:{})]}var $b=function(t){function e(t,n,r){var i,u,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;f(this,e),(i=a(this,o(e).call(this,t,"unit",n,r,c,l,void 0,xf(t)?t.view:void 0))).specifiedScales={},i.specifiedAxes={},i.specifiedLegends={},i.specifiedProjection={},i.selection={},i.children=[];var h=So(t.mark)?t.mark.type:t.mark,d=function(t,e){return bb(t,e)}(null!==(u=t.encoding)&&void 0!==u?u:{},l);i.markDef=Lb(t.mark,d,c,{graticule:t.data&&sh(t.data)});var p=i.encoding=Dc(d,i.markDef);return i.size=function(t){var e=t.encoding,n=t.size,r=!0,i=!1,a=void 0;try{for(var o,u=Pu[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=zu(s),c=cc(e[s]);bf(n[l])&&c&&nc(c)&&(delete n[l],ps(fs.stepDropped(l)))}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}({encoding:p,size:xf(t)?Object.assign(Object.assign(Object.assign({},s),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):s}),i.stack=If(h,p),i.specifiedScales=i.initScales(h,p),i.specifiedAxes=i.initAxes(p),i.specifiedLegends=i.initLegend(p),i.specifiedProjection=t.projection,i.selection=t.selection,i}return s(e,Vy),h(e,[{key:"scaleDomain",value:function(t){var e=this.specifiedScales[t];return e?e.domain:void 0}},{key:"axis",value:function(t){return this.specifiedAxes[t]}},{key:"legend",value:function(t){return this.specifiedLegends[t]}},{key:"initScales",value:function(t,e){return Uu.reduce(function(t,n){var r,i,a=e[n];return $l(a)?(r=a,i=a.scale):Gl(a)&&(r=a.condition,i=a.condition.scale),r&&(t[n]=null!==i&&void 0!==i?i:{}),t},{})}},{key:"initAxes",value:function(t){return[$o,Yo].reduce(function(e,n){var r=t[n];if($l(r)||n===$o&&$l(t.x2)||n===Yo&&$l(t.y2)){var i=$l(r)?r.axis:null;null!==i&&(e[n]=Object.assign({},i))}return e},{})}},{key:"initLegend",value:function(t){return qu.reduce(function(e,n){var r=t[n];if(r){var i=$l(r)?r.legend:Gl(r)?r.condition.legend:null;null!==i&&!1!==i&&function(t){switch(t){case eu:case nu:case ru:case au:case iu:case ou:case lu:case cu:return!0;case uu:case su:return!1}}(n)&&(e[n]=Object.assign({},i))}return e},{})}},{key:"parseData",value:function(){this.component.data=Ab(this)}},{key:"parseLayoutSize",value:function(){!function(t){var e=t.size,n=t.component,r=!0,i=!1,a=void 0;try{for(var o,u=Pu[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=zu(o.value);if(e[s]){var l=e[s];n.layoutSize.set(s,bf(l)?"step":l,!0)}else{var c=vb(t,s);n.layoutSize.set(s,c,!1)}}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}(this)}},{key:"parseSelections",value:function(){this.component.selection=function(t,e){var n,r={},i=t.config.selection,a=!0,o=!1,u=void 0;try{for(var s,l=function(){var a=s.value,o=Ma(e[a]),u=I(i[o.type],["fields","encodings"]);for(var l in u)"encodings"===l&&o.fields||"fields"===l&&o.encodings||("mark"===l&&(o[l]=Object.assign(Object.assign({},u[l]),o[l])),void 0!==o[l]&&!0!==o[l]||(o[l]=null!==(n=u[l])&&void 0!==n?n:o[l]));var c=Wa(a),f=r[c]=Object.assign(Object.assign({},o),{name:c,events:w(o.on)?Oh(o.on,"scope"):Ma(o.on)});$d(f,function(n){n.has(f)&&n.parse&&n.parse(t,f,o,e[a])})},c=qa(null!==e&&void 0!==e?e:{})[Symbol.iterator]();!(a=(s=c.next()).done);a=!0)l()}catch(f){o=!0,u=f}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return r}(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=Wb(this)}},{key:"parseAxesAndHeaders",value:function(){var t;this.component.axes=(t=this,Pu.reduce(function(e,n){return t.component.scales[n]&&t.axis(n)&&(e[n]=[zb(n,t)]),e},{}))}},{key:"assembleSelectionTopLevelSignals",value:function(t){return function(t,e){var n=!1;return lp(t,function(r,i){var a=r.name,o=k(a+ip);if(0===e.filter(function(t){return t.name===a}).length){var u="global"===r.resolve?"union":r.resolve,s="multi"===r.type?", true)":")";e.push({name:r.name,update:"".concat(up,"(").concat(o,", ").concat(k(u)).concat(s)})}n=!0,i.topLevelSignals&&(e=i.topLevelSignals(t,r,e)),$d(r,function(n){n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))})}),n&&0===e.filter(function(t){return"unit"===t.name}).length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),Jd(e)}(this,t)}},{key:"assembleSignals",value:function(){return[].concat(d(dg(this)),d((e=[],lp(t=this,function(n,r){var i,a=n.name,o=r.modifyExpr(t,n);(i=e).push.apply(i,d(r.signals(t,n))),$d(n,function(r){r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(o=r.modifyExpr(t,n,o))}),e.push({name:a+op,on:[{events:{signal:n.name+ap},update:"modify(".concat(k(n.name+ip),", ").concat(o,")")}]})}),Jd(e))));var t,e}},{key:"assembleSelectionData",value:function(t){return function(t,e){var n=d(e);return lp(t,function(e){var r={name:e.name+ip};if(e.init){var i=e.project.items.map(function(t){return I(t,["signals"])}),a=e.init.map(function(t){return Yd(t,!1)});r.values="interval"===e.type?[{unit:cp(t,{escape:!1}),fields:i,values:a}]:a.map(function(e){return{unit:cp(t,{escape:!1}),fields:i,values:e}})}n.filter(function(t){return t.name===e.name+ip}).length||n.push(r)}),n}(this,t)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return Lg(this)}},{key:"assembleMarks",value:function(){var t,e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&Wy(this.parent)||(e=Xd(this,e)),e.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"channelHasField",value:function(t){return Sc(this.encoding,t)}},{key:"fieldDef",value:function(t){return fc(this.encoding[t])}},{key:"hasProjection",get:function(){var t=this.encoding,e=this.mark===ko,n=t&&bu.some(function(e){return $l(t[e])});return e||n}},{key:"mark",get:function(){return this.markDef.type}}]),e}(),Yb=function(t){function e(t,n,r,u,s,l){var c;f(this,e),c=a(this,o(e).call(this,t,"layer",n,r,l,s,t.resolve,t.view));var h=Object.assign(Object.assign(Object.assign({},u),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});return c.children=t.layer.map(function(t,n){if(Pf(t))return new e(t,i(c),c.getName("layer_"+n),h,s,l);if(No(t))return new $b(t,i(c),c.getName("layer_"+n),h,s,l);throw new Error(fs.invalidSpec(t))}),c}return s(e,Hy),h(e,[{key:"parseData",value:function(){this.component.data=Ab(this);var t=!0,e=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)r.value.parseData()}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"parseLayoutSize",value:function(){var t;db(t=this),pb(t,"width"),pb(t,"height")}},{key:"parseSelections",value:function(){var t=this;this.component.selection={};var e=!0,n=!1,r=void 0;try{for(var i,a=function(){var e=i.value;e.parseSelections(),qa(e.component.selection).forEach(function(n){t.component.selection[n]=e.component.selection[n]})},o=this.children[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)a()}catch(u){n=!0,r=u}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"parseMarkGroup",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)r.value.parseMarkGroup()}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"parseAxesAndHeaders",value:function(){!function(t){var e,n=t.component,r=n.axes,i=n.resolve,a={top:0,bottom:0,right:0,left:0},o=!0,u=!1,s=void 0;try{for(var l,c=t.children[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;f.parseAxesAndHeaders();var h=!0,d=!1,p=void 0;try{for(var v,g=qa(f.component.axes)[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var m=v.value;i.axis[m]=Vg(t.component.resolve,m),"shared"===i.axis[m]&&(r[m]=Fb(r[m],f.component.axes[m]),r[m]||(i.axis[m]="independent",delete r[m]))}}catch(W){d=!0,p=W}finally{try{h||null==g.return||g.return()}finally{if(d)throw p}}}}catch(W){u=!0,s=W}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}for(var y=0,b=[$o,Yo];y<b.length;y++){var x=b[y],_=!0,w=!1,k=void 0;try{for(var A,E=t.children[Symbol.iterator]();!(_=(A=E.next()).done);_=!0){var M=A.value;if(M.component.axes[x]){if("independent"===i.axis[x]){r[x]=(null!==(e=r[x])&&void 0!==e?e:[]).concat(M.component.axes[x]);var S=!0,C=!1,O=void 0;try{for(var D,F=M.component.axes[x][Symbol.iterator]();!(S=(D=F.next()).done);S=!0){var T=D.value,N=T.getWithExplicit("orient"),j=N.value,R=N.explicit;if(a[j]>0&&!R){var P=Db[j];a[j]>a[P]&&T.set("orient",P,!1)}a[j]++}}catch(W){C=!0,O=W}finally{try{S||null==F.return||F.return()}finally{if(C)throw O}}}delete M.component.axes[x]}}}catch(W){w=!0,k=W}finally{try{_||null==E.return||E.return()}finally{if(w)throw k}}if("independent"===i.axis[x]&&r[x]&&r[x].length>1){var z=!0,B=!1,L=void 0;try{for(var q,I=r[x][Symbol.iterator]();!(z=(q=I.next()).done);z=!0){var U=q.value;U.get("grid")&&!U.explicit.grid&&(U.implicit.grid=!1)}}catch(W){B=!0,L=W}finally{try{z||null==I.return||I.return()}finally{if(B)throw L}}}}}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(t){return this.children.reduce(function(t,e){return e.assembleSelectionTopLevelSignals(t)},t)}},{key:"assembleSignals",value:function(){return this.children.reduce(function(t,e){return t.concat(e.assembleSignals())},dg(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce(function(t,e){return t.concat(e.assembleLayoutSignals())},Lg(this))}},{key:"assembleSelectionData",value:function(t){return this.children.reduce(function(t,e){return e.assembleSelectionData(t)},t)}},{key:"assembleTitle",value:function(){var t=u(o(e.prototype),"assembleTitle",this).call(this);if(t)return t;var n=!0,r=!1,i=void 0;try{for(var a,s=this.children[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)if(t=a.value.assembleTitle())return t}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=t.children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;Ly(u)&&(e=Xd(u,e))}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}(this,this.children.flatMap(function(t){return t.assembleMarks()}))}},{key:"assembleLegends",value:function(){return this.children.reduce(function(t,e){return t.concat(e.assembleLegends())},gm(this))}}]),e}(),Xb=function(t){function e(t,n,r,i,u){var s;return f(this,e),s=a(this,o(e).call(this,t,"repeat",n,r,u,i,t.resolve)),t.resolve&&t.resolve.axis&&("shared"===t.resolve.axis.x||"shared"===t.resolve.axis.y)&&ps(fs.REPEAT_CANNOT_SHARE_AXIS),s.repeat=t.repeat,s.children=s._initChildren(t,s.repeat,i,u),s}return s(e,Eb),h(e,[{key:"_initChildren",value:function(t,e,n,r){var i=[],a=!x(e)&&e.row||[n?n.row:null],o=!x(e)&&e.column||[n?n.column:null],u=x(e)&&e||[n?n.repeat:null],s=!0,l=!1,c=void 0;try{for(var f,h=u[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value,p=!0,v=!1,g=void 0;try{for(var m,y=a[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=m.value,_=!0,w=!1,k=void 0;try{for(var A,E=o[Symbol.iterator]();!(_=(A=E.next()).done);_=!0){var M=A.value,S=(d?"__repeat_repeat_".concat(d):"")+(b?"__repeat_row_".concat(b):"")+(M?"__repeat_column_".concat(M):""),C={repeat:d,row:b,column:M};i.push(Jb(t.spec,this,this.getName("child"+S),void 0,C,r))}}catch(O){w=!0,k=O}finally{try{_||null==E.return||E.return()}finally{if(w)throw k}}}}catch(O){v=!0,g=O}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}}}catch(O){l=!0,c=O}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}return i}},{key:"parseLayoutSize",value:function(){fb(this)}},{key:"assembleDefaultLayout",value:function(){var t=this.repeat,e=x(t)?void 0:t.column?t.column.length:1;return Object.assign(Object.assign({},e?{columns:e}:{}),{bounds:"full",align:"all"})}}]),e}();function Jb(t,e,n,r,i,a){if(ql(t))return new _b(t,e,n,i,a);if(Pf(t))return new Yb(t,e,n,r,i,a);if(No(t))return new $b(t,e,n,r,i,a);if(yf(t))return new Xb(t,e,n,i,a);if(function(t){return gf(t)||mf(t)||vf(t)}(t))return new Mb(t,e,n,i,a);throw new Error(fs.invalidSpec(t))}var Qb=new(function(t){function e(){return f(this,e),a(this,o(e).apply(this,arguments))}return s(e,zf),h(e,[{key:"mapUnit",value:function(t,e){var n=e.config;if(t.encoding){var r=t.encoding,i=t.transform,a=Oc(r,n),o=a.bins,u=a.timeUnits,s=a.aggregate,l=a.groupby,c=a.encoding,f=[].concat(d(i||[]),d(o),d(u),d(0===s.length?[]:[{aggregate:s,groupby:l}]));return Object.assign(Object.assign(Object.assign({},t),f.length>0?{transform:f}:{}),{encoding:c})}return t}}]),e}()),Zb=g;e.compile=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.logger&&(e=n.logger,ds=e),n.fieldTitle&&ac(n.fieldTitle),n.formatTypes&&function(t){El=new Set(t)}(n.formatTypes);try{var r=Df(T(n.config,t.config)),i=Qf(t,r),a=Jb(i,null,"",void 0,void 0,r);return a.parse(),function(t,e){Cm(t.sources);for(var n=0,r=0,i=0;i<oy&&cy(t,e);i++)n++;t.sources.map(Zm);for(var a=0;a<oy&&cy(t,e);a++)r++;Cm(t.sources),Math.max(n,r)===oy&&ps("Maximum optimization runs(".concat(oy,") reached."))}(a.component.data,a),{spec:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=t.config?jf(t.config):void 0,a=[].concat(t.assembleSelectionData([]),function(t,e){var n,r,i=[],a=ob(i),o=0;t.sources.forEach(function(t){t.hasName()||(t.dataName="source_".concat(o++));var e=t.assemble();a(t,e)}),i.forEach(function(t){0===t.transform.length&&delete t.transform});var u=0,s=!0,l=!1,c=void 0;try{for(var f,h=i.entries()[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var d=f.value,v=p(d,2),g=v[0],m=v[1];0!==(null!==(n=m.transform)&&void 0!==n?n:[]).length||m.source||i.splice(u++,0,i.splice(g,1)[0])}}catch(D){l=!0,c=D}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}for(var y=0,b=i;y<b.length;y++){var x=b[y],_=!0,w=!1,k=void 0;try{for(var A,E=(null!==(r=x.transform)&&void 0!==r?r:[])[Symbol.iterator]();!(_=(A=E.next()).done);_=!0){var M=A.value;"lookup"===M.type&&(M.from=t.outputNodes[M.from].getSource())}}catch(D){w=!0,k=D}finally{try{_||null==E.return||E.return()}finally{if(w)throw k}}}for(var S=0,C=i;S<C.length;S++){var O=C[S];O.name in e&&(O.values=e[O.name])}return i}(t.component.data,n)),o=t.assembleProjections(),u=t.assembleTitle(),s=t.assembleGroupStyle(),l=t.assembleGroupEncodeEntry(!0),c=t.assembleLayoutSignals();return c=c.filter(function(t){return"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)}),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),e),u?{title:u}:{}),s?{style:s}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),t.assembleGroup([].concat(d(c),d(t.assembleSelectionTopLevelSignals([]))))),i?{config:i}:{}),r?{usermeta:r}:{})}(a,function(t,e,n,r){var i,a=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===e?e={type:"pad"}:w(e)&&(e={type:e}),a&&o&&("fit"===(i=e.type)||"fit-x"===i||"fit-y"===i))if("step"===a&&"step"===o)ps(fs.droppingFit()),e.type="pad";else if("step"===a||"step"===o){var u="step"===a?"width":"height";ps(fs.droppingFit(Bu(u)));var s="width"===u?"height":"width";e.type=function(t){return t?"fit-".concat(Bu(t)):"fit"}(s)}return Object.assign(Object.assign(Object.assign({},1===qa(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),eh(n)),eh(t))}(t,i.autosize,r,a),t.datasets,t.usermeta),normalized:i}}finally{n.logger&&(ds=hs),n.fieldTitle&&ac(rc)}},e.extractTransforms=function(t,e){return Qb.map(t,{config:e})},e.normalize=Qf,e.version=Zb,Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,n(47).Buffer)},2150:function(t,e,n){var r=n(407),i=n(409),a=n(408);t.exports=function(t){return r(t)||i(t)||a()}},2151:function(t,e,n){var r=n(406);function i(e,n,a){return!function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?t.exports=i=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a}:t.exports=i=Reflect.construct,i.apply(null,arguments)}t.exports=i}}]);
//# sourceMappingURL=13.3e6c0e06.chunk.js.map